(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{tVPo:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n("s7LF"),i=n("mwYl"),c=n("tAww"),r=n("rCAV"),o=n("x6mR"),s=n("Ky6R"),l=n("75v4"),u=n("LvDl"),b=n("2Vo4"),d=n("Kj3r"),f=n("8Y7J");let m=(()=>{class e extends o.a{constructor(e){super(e),this.ResultType=l.a,this.resultType$=new b.a(null),this.resultTypeControl=new a.j(null),this.results$=new b.a(null),this.allowedResultTypes$=new b.a([l.a.LIST]),this.rendering$=new b.a(!1),this.moreFilters$=new b.a(!1),this.ignoreNextUpdate=!1,this.nextRequestState=e.get(i.a);const t={page:0};t.resultType=this.getInitialResultType();for(const n of this.getFormControlNames()||[])t[n]=null;this.form=this.formBuilder.group(t)}getInitialFormValue(e){return e.query||{}}onDataInitialized(e){this.form.patchValue(this.getInitialFormValue(e)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(e=>{const t=this.previousResultType;this.previousResultType=e,this.resultType$.next(e),this.shouldUpdateOnResultTypeChange(e,t)&&this.update(),null!=t&&t===e||(this.rendering=!0,this.stateManager.set("resultType",e),this.onResultTypeChanged(e,t))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe(Object(d.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>{this.shouldUpdateOnChange(e)&&this.update(),this.previousValue=e}),!0),this.previousResultType!==l.a.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(e,t){return e!==l.a.CATEGORIES&&([l.a.LIST,l.a.TILES].includes(t)!==[l.a.LIST,l.a.TILES].includes(e)||t===l.a.MAP!=(e===l.a.MAP))}shouldUpdateOnChange(e){return!Object(u.isEqual)(this.previousValue,e)}get results(){return this.results$.value}set results(e){this.results$.next(e)}get rendering(){return this.rendering$.value}set rendering(e){this.rendering$.next(e)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(e){this.allowedResultTypes$.next(e)}get moreFilters(){return this.moreFilters$.value}set moreFilters(e){this.moreFilters$.next(e)}get pageData(){const e=this.form.value;return{page:e.page,pageSize:e.pageSize}}set pageData(e){this.form.patchValue(e)}get resultType(){return this.resultTypeControl.value}set resultType(e){null==e&&(e=this.getInitialResultType()),this.resultTypeControl.setValue(e)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new c.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return"filter_list"}showLessFiltersIcon(){return"filter_list"}onResultTypeChanged(e,t){}getInitialResultType(){return l.a.LIST}update(e){if(this.ignoreNextUpdate)return;e&&(this.form.patchValue(e,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const t=this.form.value;t.pageSize=this.layout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(t)).subscribe(e=>{this.resultType===l.a.CATEGORIES&&(this.resultType=this.allowedResultTypes.find(e=>e!==l.a.CATEGORIES)),this.results=s.a.from(e)}))}resetPage(e=!1){this.form.patchValue({page:0},{emitEvent:e})}doIgnoringUpdate(e){this.ignoreNextUpdate=!0;try{e()}finally{this.ignoreNextUpdate=!1}}}return e.\u0275fac=function(t){return new(t||e)(f.Nb(f.r))},e.\u0275dir=f.Ib({type:e,features:[f.wb]}),e})()},uWZ6:function(e,t,n){"use strict";n.r(t),n.d(t,"BankingModule",(function(){return Os}));var a=n("XDzf"),i=n("Do6i"),c=n("i+BT"),r=n("rCAV"),o=n("tVPo"),s=n("ObUu"),l=n("PvCH"),u=n("2Vo4"),b=n("vkgz"),d=n("8Y7J"),f=n("8UBS"),m=n("SVse"),h=n("HQV3"),p=n("2KYv"),g=n("n1JJ"),y=n("DAJ4"),v=n("s7LF"),k=n("JFlR"),S=n("7HWn"),T=n("WYBn"),z=n("chz4"),w=n("6g1M"),F=n("iXUt"),I=n("JbOn"),O=n("DIHi"),C=n("Aw04"),P=n("qCwG"),H=n("I9hm");function x(e,t){1&e&&d.Ob(0,"hr",7)}function D(e,t){if(1&e&&(d.Tb(0,"div",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.Jc(" ",e.account.type.name," ")}}function N(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",9),d.Hc(2),d.Sb(),d.Tb(3,"div",10),d.Ob(4,"user-link",11),d.Sb(),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.Jc(" ",e.i18n.general.user," "),d.zb(2),d.kc("user",e.account.user)}}function A(e,t){1&e&&d.Ob(0,"hr")}function $(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.ec(2,"currency"),d.Qb()),2&e){const e=d.dc().$implicit,t=d.dc(2);d.zb(1),d.Jc(" ",d.gc(2,1,e.amount,t.currency)," ")}}const E=function(e,t,n){return{negative:e,positive:t,"status-value-last":n}};function R(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",12),d.Tb(2,"span",13),d.Hc(3),d.Sb(),d.Sb(),d.Tb(4,"div",14),d.Fc(5,$,3,4,"ng-container",5),d.Sb(),d.Qb()),2&e){const e=t.$implicit,n=t.last,a=d.dc(2);d.zb(1),d.kc("ngClass",n?"status-label-last":""),d.zb(2),d.Ic(e.label),d.zb(1),d.kc("ngClass",d.pc(4,E,e.alwaysNegative||a.format.isNegative(e.amount),!e.alwaysNegative&&a.format.isPositive(e.amount),n)),d.zb(1),d.kc("ngIf",e.amount)}}function U(e,t){if(1&e&&(d.Tb(0,"div",1),d.Fc(1,x,1,0,"hr",2),d.Tb(2,"div",3),d.Fc(3,D,2,1,"div",4),d.Fc(4,N,5,2,"ng-container",5),d.Fc(5,A,1,0,"hr",5),d.Fc(6,R,6,8,"ng-container",6),d.Sb(),d.Sb()),2&e){const e=d.dc();d.zb(1),d.kc("ngIf",e.showSeparator),d.zb(2),d.kc("ngIf",e.showAccount),d.zb(1),d.kc("ngIf",e.account.user&&e.showUser),d.zb(1),d.kc("ngIf",e.showAccount||e.account.user&&e.showUser),d.zb(1),d.kc("ngForOf",e.indicators$.value)}}let M=(()=>{class e extends P.a{constructor(e){super(e),this.mode="current",this._showAccount=!1,this._showUser=!1,this._showSeparator=!1,this.indicators$=new u.a(null)}get showAccount(){return this._showAccount}set showAccount(e){this._showAccount=Object(s.E)(e)}get showUser(){return this._showUser}set showUser(e){this._showUser=Object(s.E)(e)}get showSeparator(){return this._showSeparator}set showSeparator(e){this._showSeparator=Object(s.E)(e)}ngOnInit(){this.updateIndicators()}get status(){return this.account.status}get currency(){return this.account.currency}updateIndicators(){const e=[],t=this.status,n=(t,n,a=!1)=>{t&&e.push({label:n,amount:t,alwaysNegative:!this.format.isZero(t)&&a})};if("current"===this.mode)n(t.balance,this.i18n.account.balance),t.availableBalance!==t.balance&&n(t.availableBalance,this.i18n.account.availableBalance),t.reservedAmount&&!this.format.isZero(t.reservedAmount)&&n(t.reservedAmount,this.i18n.account.reservedAmount,!0),t.creditLimit&&!this.format.isZero(t.creditLimit)&&n(t.creditLimit,this.i18n.account.negativeLimit),t.upperCreditLimit&&!this.format.isZero(t.upperCreditLimit)&&n(t.upperCreditLimit,this.i18n.account.positiveLimit);else{if(this.layout.gtxxs&&null!=t.balanceAtBegin&&n(t.balanceAtBegin,this.i18n.account.balanceOn(this.format.formatAsDate(t.beginDate))),this.layout.gtxxs&&null!=t.balanceAtEnd&&n(t.balanceAtEnd,this.i18n.account.balanceOn(this.format.formatAsDate(t.endDate))),null!=t.incoming&&t.incoming.sum&&n(t.incoming.sum,this.i18n.account.totalIncome),null!=t.outgoing&&t.outgoing.sum){let e=t.outgoing.sum;this.format.isZero(e)||(e="-"+e),n(e,this.i18n.account.totalOutflow)}null!=t.netInflow&&n(t.netInflow,this.i18n.account.netInflow)}this.indicators$.next(e)}ngOnChanges(e){(e.mode||e.account||e.showAccount)&&this.updateIndicators()}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r))},e.\u0275cmp=d.Hb({type:e,selectors:[["account-status-view"]],inputs:{account:"account",mode:"mode",showAccount:"showAccount",showUser:"showUser",showSeparator:"showSeparator"},features:[d.wb,d.xb],decls:2,vars:3,consts:[["class","container mw-100 px-0",4,"ngIf"],[1,"container","mw-100","px-0"],["class","mt-0",4,"ngIf"],[1,"row","no-gutters"],["class","status-label col-12",4,"ngIf"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"mt-0"],[1,"status-label","col-12"],[1,"status-label","col-6","col-md-3","mb-0"],[1,"status-label","col-6","col-md-9","mb-0"],[3,"user"],[1,"status-label","col-6","col-sm-3",3,"ngClass"],[1,"ellipsis"],[1,"status-value","col-6","col-sm-3",3,"ngClass"]],template:function(e,t){if(1&e&&(d.Fc(0,U,7,5,"div",0),d.ec(1,"async")),2&e){var n;const e=(null==(n=d.fc(1,1,t.indicators$))?null:n.length)>0;d.kc("ngIf",e)}},directives:[m.t,m.s,S.a,m.q],pipes:[m.b,H.a],styles:[".status-label[_ngcontent-%COMP%], .status-value[_ngcontent-%COMP%]{font-weight:500;white-space:nowrap;margin:0;line-height:1em;min-height:1.4rem;display:flex;align-items:center}.status-label[_ngcontent-%COMP%]:not(.status-label-last), .status-value[_ngcontent-%COMP%]:not(.status-value-last){margin-bottom:.2rem}.status-label[_ngcontent-%COMP%]{color:#495057}.status-value[_ngcontent-%COMP%]{align-items:center;justify-content:flex-end}.container[_ngcontent-%COMP%]{width:100%}hr[_ngcontent-%COMP%]{margin-top:.8rem;margin-bottom:.9rem}@media (min-width:316px){.status-label[_ngcontent-%COMP%]{padding-left:.4rem}.status-label[_ngcontent-%COMP%]:not(.status-label-last), .status-value[_ngcontent-%COMP%]:not(.status-value-last){margin-bottom:.4rem}}@media (min-width:576px){.container[_ngcontent-%COMP%]{padding:1em 0}.status-label[_ngcontent-%COMP%], .status-label-last[_ngcontent-%COMP%]:not(.status-label-last), .status-value[_ngcontent-%COMP%], .status-value[_ngcontent-%COMP%]:not(.status-value-last){padding:0}.status-value[_ngcontent-%COMP%]{justify-content:flex-start}}body.dark   [_nghost-%COMP%]     .status-label{color:#d7d7d7}"],changeDetection:0}),e})();var L=n("oj/z"),B=n("wwxf"),J=n("sifq"),V=n("iInd"),j=n("yL40");function G(e,t){1&e&&d.Pb(0)}function _(e,t){1&e&&d.Ob(0,"div",15)}function q(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",15),d.Tb(2,"label-value",16),d.Ob(3,"user-link",17),d.Sb(),d.Sb(),d.Fc(4,_,1,0,"div",12),d.Qb()),2&e){const e=d.dc(3);d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("user",e.data.account.user),d.zb(1),d.kc("ngIf",e.layout.gtsm$)}}function Q(e,t){if(1&e&&d.Ob(0,"field-option",20),2&e){const e=t.$implicit;d.kc("id",e.id)("value",e)("text",e.name)}}function Y(e,t){if(1&e&&(d.Tb(0,"div",15),d.Tb(1,"single-selection-field",18),d.Fc(2,Q,1,3,"field-option",19),d.Sb(),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.general.period),d.zb(1),d.kc("ngForOf",e.data.preselectedPeriods)}}function W(e,t){if(1&e&&d.Ob(0,"field-option",20),2&e){const e=t.$implicit;d.kc("id",e.id)("value",e)("text",e.name)}}function K(e,t){if(1&e&&(d.Tb(0,"div",15),d.Tb(1,"single-selection-field",21),d.Fc(2,W,1,3,"field-option",19),d.Sb(),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.account.transferFilter)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("ngForOf",e.data.transferFilters)}}function Z(e,t){1&e&&d.Ob(0,"div",15)}function X(e,t){if(1&e&&d.Fc(0,Z,1,0,"div",12),2&e){const e=d.dc(3);d.kc("ngIf",e.layout.gtsm$)}}function ee(e,t){if(1&e&&(d.Tb(0,"div",15),d.Ob(1,"date-field",22),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.general.beginDate)}}function te(e,t){if(1&e&&(d.Tb(0,"div",15),d.Ob(1,"date-field",23),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.general.endDate)}}function ne(e,t){if(1&e&&(d.Tb(0,"div",15),d.Ob(1,"input-field",35),d.Sb()),2&e){const e=d.dc(4);d.zb(1),d.kc("mask",e.data.transactionNumberMask)("label",e.i18n.transaction.number)}}function ae(e,t){if(1&e&&d.Ob(0,"field-option",38),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.display)}}function ie(e,t){if(1&e&&(d.Tb(0,"div",15),d.Tb(1,"single-selection-field",36),d.Fc(2,ae,1,2,"field-option",37),d.Sb(),d.Sb()),2&e){const e=d.dc(4);d.zb(1),d.kc("label",e.i18n.general.operator)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("ngForOf",e.data.operators)}}function ce(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",15),d.Ob(2,"decimal-field",24),d.Sb(),d.Tb(3,"div",15),d.Ob(4,"decimal-field",25),d.Sb(),d.Tb(5,"div",15),d.Tb(6,"single-selection-field",26),d.Ob(7,"field-option",27),d.Ob(8,"field-option",28),d.Sb(),d.Sb(),d.Tb(9,"div",15),d.Ob(10,"user-field",29),d.Sb(),d.Fc(11,ne,2,2,"div",12),d.Fc(12,ie,3,3,"div",12),d.Tb(13,"div",15),d.Tb(14,"single-selection-field",30),d.Ob(15,"field-option",31),d.Ob(16,"field-option",32),d.Ob(17,"field-option",33),d.Ob(18,"field-option",34),d.Sb(),d.Sb(),d.Qb()),2&e){const e=d.dc(3);d.zb(2),d.kc("label",e.i18n.account.minAmount)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("scale",e.currency.decimalDigits),d.zb(2),d.kc("label",e.i18n.account.maxAmount)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("scale",e.currency.decimalDigits),d.zb(2),d.kc("label",e.i18n.account.direction)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("text",e.i18n.account.incoming),d.zb(1),d.kc("text",e.i18n.account.outgoing),d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("ngIf",e.data.transactionNumberMask),d.zb(1),d.kc("ngIf",(null==e.data.operators?null:e.data.operators.length)>0),d.zb(2),d.kc("label",e.i18n.general.orderBy),d.zb(1),d.kc("text",e.i18n.account.orderBy.dateDesc),d.zb(1),d.kc("text",e.i18n.account.orderBy.dateAsc),d.zb(1),d.kc("text",e.i18n.account.orderBy.amountAsc),d.zb(1),d.kc("text",e.i18n.account.orderBy.amountDesc)}}const re=function(e){return{"border-0":e}};function oe(e,t){if(1&e&&(d.Tb(0,"form",10),d.ec(1,"async"),d.Tb(2,"div",11),d.Fc(3,q,5,3,"ng-container",6),d.Fc(4,Y,3,2,"div",12),d.Fc(5,K,3,3,"div",13),d.ec(6,"async"),d.Fc(7,X,1,1,"ng-template",null,14,d.Gc),d.Fc(9,ee,2,1,"div",12),d.ec(10,"async"),d.Fc(11,te,2,1,"div",12),d.ec(12,"async"),d.Fc(13,ce,19,20,"ng-container",6),d.ec(14,"async"),d.Sb(),d.Sb()),2&e){const e=d.uc(8),t=d.dc(2);var n;const i=null==(null==(n=t.form.value||d.fc(10,13,t.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin);var a;const c=null==(null==(a=t.form.value||d.fc(12,15,t.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end);d.kc("formGroup",t.form)("ngClass",d.nc(19,re,d.fc(1,9,t.noStatus$))),d.zb(3),d.kc("ngIf",t.data.account.user&&!t.self),d.zb(1),d.kc("ngIf",(null==t.data.preselectedPeriods?null:t.data.preselectedPeriods.length)>1),d.zb(1),d.kc("ngIf",d.fc(6,11,t.layout.gtxxs$)&&(null==t.data.transferFilters?null:t.data.transferFilters.length)>1)("ngIfElse",e),d.zb(4),d.kc("ngIf",i),d.zb(2),d.kc("ngIf",c),d.zb(2),d.kc("ngIf",d.fc(14,17,t.layout.gtxxs$))}}function se(e,t){if(1&e&&(d.Ob(0,"account-status-view",40),d.ec(1,"async"),d.ec(2,"async"),d.ec(3,"async"),d.ec(4,"async")),2&e){const e=d.dc(3);d.kc("account",e.status$.value)("mode",d.fc(1,5,e.moreFilters$)?"period":"current")("showSeparator",d.fc(2,7,e.showForm$))("showAccount",d.fc(3,9,e.layout.ltsm$)&&e.multipleAccounts)("showUser",!e.self&&!1===d.fc(4,11,e.showForm$))}}function le(e,t){1&e&&d.Ob(0,"spinner")}function ue(e,t){if(1&e&&(d.Rb(0),d.Fc(1,se,5,13,"account-status-view",39),d.ec(2,"async"),d.ec(3,"async"),d.Fc(4,le,1,0,"spinner",6),d.ec(5,"async"),d.Qb()),2&e){const e=d.dc(2);d.zb(1),d.kc("ngIf",d.fc(2,2,e.status$)&&(d.fc(3,4,e.layout.gtxxs$)||0===(null==e.results?null:e.results.page))),d.zb(3),d.kc("ngIf",null===d.fc(5,6,e.status$))}}function be(e,t){if(1&e&&(d.Tb(0,"mobile-result",41),d.Tb(1,"div",42),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.kc("avatarImage",n.avatarImage(e))("avatarIcon",n.avatarIcon(e))("date",e.date)("amount",e.amount)("currency",n.currency),d.zb(2),d.Jc(" ",n.subjectName(e)," ")}}function de(e,t){if(1&e&&(d.Tb(0,"th",48),d.Hc(1),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.Ic(e.i18n.general.description)}}function fe(e,t){if(1&e&&(d.Tb(0,"a",54),d.Hc(1),d.Sb()),2&e){const e=d.dc(2).$implicit,t=d.dc(3);d.kc("routerLink",t.path(e)),d.zb(1),d.Jc(" ",e.description," ")}}function me(e,t){if(1&e&&(d.Tb(0,"td"),d.Fc(1,fe,2,2,"a",53),d.Sb()),2&e){const e=d.dc().$implicit;d.zb(1),d.kc("ngIf",e.description)}}const he=function(e,t){return{positive:e,negative:t}};function pe(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",49),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.path(n))})),d.Tb(2,"td",44),d.Ob(3,"avatar",50),d.Sb(),d.Tb(4,"td"),d.Tb(5,"a",51),d.Hc(6),d.ec(7,"date"),d.Sb(),d.Sb(),d.Tb(8,"td"),d.Tb(9,"a",51),d.Hc(10),d.Sb(),d.Sb(),d.Fc(11,me,2,1,"td",6),d.ec(12,"async"),d.Tb(13,"td",46),d.Tb(14,"a",52),d.Hc(15),d.ec(16,"currency"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.kc("image",n.avatarImage(e))("icon",n.avatarIcon(e)),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",d.fc(7,10,e.date)," "),d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",n.subjectName(e)," "),d.zb(1),d.kc("ngIf",d.fc(12,12,n.layout.gtsm$)),d.zb(3),d.kc("routerLink",n.path(e))("ngClass",d.oc(18,he,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),d.zb(1),d.Jc(" ",d.hc(16,14,e.amount,n.currency,!0)," ")}}function ge(e,t){if(1&e&&(d.Tb(0,"table",43),d.Tb(1,"thead"),d.Ob(2,"th",44),d.Tb(3,"th"),d.Hc(4),d.Sb(),d.Tb(5,"th"),d.Hc(6),d.Sb(),d.Fc(7,de,2,1,"th",45),d.ec(8,"async"),d.Tb(9,"th",46),d.Hc(10),d.Sb(),d.Sb(),d.Tb(11,"tbody"),d.Fc(12,pe,17,21,"ng-container",47),d.ec(13,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(13,7,e.results$))?null:n.results;d.zb(4),d.Ic(e.i18n.general.date),d.zb(2),d.Ic(e.i18n.transaction.fromTo),d.zb(1),d.kc("ngIf",d.fc(8,5,e.layout.gtsm$)),d.zb(3),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function ye(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",4),d.ec(1,"async"),d.Fc(2,oe,15,21,"form",5),d.ec(3,"async"),d.Fc(4,ue,6,8,"ng-container",6),d.ec(5,"async"),d.Sb(),d.Tb(6,"results-layout",7),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(7,"async"),d.Fc(8,be,3,6,"mobile-result",8),d.Fc(9,ge,14,9,"table",9),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.title)("mobileHeading",e.i18n.account.mobileTitle)("headingActions",d.fc(1,8,e.headingActions$)),d.zb(2),d.kc("ngIf",d.fc(3,10,e.showForm$)),d.zb(2),d.kc("ngIf",!1===d.fc(5,12,e.noStatus$)),d.zb(2),d.kc("results",d.fc(7,14,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}function ve(e,t){1&e&&d.Ob(0,"spinner",55)}let ke=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.accountsService=t,this.bankingHelper=n,this.status$=new u.a(null),this.noStatus$=new u.a(!1),this.showForm$=new u.a(!1)}get type(){return null==this.data?null:this.data.account.type}get number(){return null==this.data?null:this.data.account.number}get currency(){return null==this.data?null:this.data.account.currency}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}get transferFilters(){return null==this.data?null:this.data.transferFilters}get title(){const e=this.type;if(null==e)return null;const t=this.layout.ltsm?null:this.number;return null==t?e.name:e.name+" - "+t}getFormControlNames(){return["transferFilter","preselectedPeriod","periodBegin","periodEnd","minAmount","maxAmount","transactionNumber","direction","user","by","orderBy"]}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.ownerParam=e.owner,this.typeParam=e.type,this.self=this.authHelper.isSelf(this.ownerParam),this.multipleAccounts=this.accountTypes.length>1,this.stateManager.cache("data",this.accountsService.getAccountHistoryDataByOwnerAndType({owner:this.ownerParam,accountType:this.typeParam})).subscribe(e=>{this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.exportActions=this.exportHelper.headingActions(e.exportFormats,e=>this.accountsService.exportAccountHistory$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value)))),this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.layout.xxs$.subscribe(()=>this.updateShowForm(e))),this.addSub(this.moreFilters$.subscribe(()=>this.updateShowForm(e))),this.updateShowForm(e)}updateShowForm(e){this.showForm$.next(this.layout.xxs&&!Object(s.h)(e.preselectedPeriods)||this.moreFilters)}toSearchParams(e){const t=e;return t.transferFilters=null==e.transferFilter?[]:[e.transferFilter.id],t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=r.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],t.owner=this.ownerParam,t.accountType=this.typeParam,t}doSearch(e){return this.accountsService.searchAccountHistory$Response(e).pipe(Object(b.a)(()=>{e.fields=["status"],this.addSub(this.accountsService.getAccountStatusByOwnerAndType(e).subscribe(e=>{const t=Object.assign(Object.assign({},this.data.account),{status:(e||{}).status});null==t.status?(this.noStatus$.next(!0),this.moreFilters=!0,this.headingActions=this.exportActions):this.headingActions=[this.moreFiltersAction,...this.exportActions],this.status$.next(t)}))}))}get accountTypes(){return(((this.login.auth||{}).permissions||{}).banking.accounts.filter(e=>!1!==e.visible)||[]).map(e=>e.account.type)}subjectName(e){return this.bankingHelper.subjectName(e.relatedAccount)}path(e){return["/banking","transfer",this.data.account.id,this.bankingHelper.transactionNumberOrId(e)]}avatarIcon(e){return"user"===e.relatedAccount.kind?"user":"account_balance_circle"}avatarImage(e){return"user"===e.relatedAccount.kind?e.relatedAccount.user.image:null}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}get toLink(){return e=>this.path(e)}resolveMenu(e){const t=new l.a(l.b.ACCOUNT_HISTORY,{accountType:e.account.type});return e.account.kind===a.a.SYSTEM?t:this.authHelper.userMenu(e.account.user,t)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.a),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["account-history"]],features:[d.wb],decls:8,vars:7,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],["class","filters-form",3,"formGroup","ngClass",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form",3,"formGroup","ngClass"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-12 col-md-6",4,"ngIf","ngIfElse"],["noTransferFilters",""],[1,"col-12","col-md-6"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","transferFilter",3,"label","emptyOption"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","prefix","suffix","scale"],["labelPosition","side","formControlName","direction",3,"label","emptyOption"],["value","credit",3,"text"],["value","debit",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["labelPosition","side","formControlName","by",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],[3,"account","mode","showSeparator","showAccount","showUser",4,"ngIf"],[3,"account","mode","showSeparator","showAccount","showUser"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%",4,"ngIf"],[1,"amount"],[4,"ngFor","ngForOf"],["width","30%"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[3,"routerLink","ngClass"],["class","d-inline-block",3,"routerLink",4,"ngIf"],[1,"d-inline-block",3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.ec(2,"async"),d.Fc(3,G,1,0,"ng-container",1),d.Sb(),d.Fc(4,ye,10,16,"ng-template",null,2,d.Gc),d.Fc(6,ve,1,0,"ng-template",null,3,d.Gc)),2&e){const e=d.uc(5);d.kc("ready",d.fc(1,3,t.noStatus$)||d.fc(2,5,t.status$)),d.zb(3),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,p.a,g.a,y.a,v.I,v.w,v.n,m.q,k.a,S.a,T.a,v.v,v.l,m.s,z.a,w.a,F.a,I.a,O.a,C.a,M,L.a,B.a,J.a,V.h],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();var Se=n("dVyd"),Te=n("x6mR"),ze=n("9d5G"),we=n("LvDl"),Fe=n("SxV6");function Ie(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",4),d.ec(1,"async"),d.Tb(2,"payment-step-form",5),d.bc("availablePaymentTypes",(function(t){return d.wc(e),d.dc().availablePaymentTypes=t})),d.ec(3,"async"),d.Sb(),d.Tb(4,"actions",6),d.Tb(5,"action-button",7),d.bc("action",(function(){return d.wc(e),d.dc().toConfirm()})),d.ec(6,"async"),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.title)("mobileHeading",e.mobileTitle)("mode",d.fc(1,11,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("data",e.data)("pos",e.pos)("form",e.form)("currency",d.fc(3,13,e.currency$))("paymentTypeData$",e.paymentTypeData$)("customValuesControlGetter",e.customValuesControlGetter),d.zb(3),d.kc("disabled",d.fc(6,15,e.requesting$))("label",e.i18n.general.next)}}function Oe(e,t){if(1&e){const e=d.Ub();d.Tb(0,"action-button",7),d.bc("action",(function(){return d.wc(e),d.dc(2).perform()})),d.ec(1,"async"),d.Sb()}if(2&e){const e=d.dc(2);d.kc("disabled",!e.canConfirm||d.fc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function Ce(e,t){1&e&&d.Hc(0,"\xa0")}const Pe=function(){return[]};function He(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",8),d.ec(1,"async"),d.Tb(2,"payment-step-confirm",9),d.bc("confirmationModeChanged",(function(t){return d.wc(e),d.dc().confirmationMode$.next(t)}))("confirmed",(function(t){return d.wc(e),d.dc().perform(t)})),d.Sb(),d.Tb(3,"actions",6),d.Fc(4,Oe,2,4,"action-button",10),d.ec(5,"async"),d.Fc(6,Ce,1,0,"ng-template",null,11,d.Gc),d.Tb(8,"button",12),d.bc("click",(function(){return d.wc(e),d.dc().backToForm()})),d.Hc(9),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.uc(7),t=d.dc();d.kc("heading",t.i18n.transaction.title.paymentConfirmation)("mobileHeading",t.i18n.transaction.mobileTitle.paymentConfirmation)("mode",d.fc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("pos",t.pos)("preview",t.preview)("confirmationPassword",t.confirmationPassword)("showPaymentType",(t.availablePaymentTypes||d.mc(14,Pe)).length>1),d.zb(2),d.kc("ngIf",d.fc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),d.zb(5),d.Jc(" ",t.i18n.general.previous," ")}}function xe(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",8),d.ec(1,"async"),d.Ob(2,"payment-step-done",13),d.Tb(3,"actions",6),d.Tb(4,"button",14),d.bc("click",(function(){return d.wc(e),d.dc().viewPerformed()})),d.Hc(5),d.Sb(),d.Tb(6,"button",12),d.bc("click",(function(){return d.wc(e),d.dc().reload()})),d.Hc(7),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.doneTitle)("mobileHeading",e.doneMobileTitle)("mode",d.fc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("performed",e.performed),d.zb(3),d.Jc(" ",e.i18n.transaction.doneView," "),d.zb(2),d.Jc(" ",e.i18n.transaction.doneNew," ")}}function De(e,t){1&e&&(d.Tb(0,"page-content"),d.Ob(1,"spinner"),d.Sb())}const Ne=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,i=t.get("firstInstallmentIsNow").value;if(Object(s.h)(e.value)&&("futureDate"===n||n===a.W.SCHEDULED&&!i))return{required:!0}}return null},Ae=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,i=t.get("repeatUntilCanceled").value;if(n===a.W.RECURRING&&!i){const t=parseInt(e.value,10);return isNaN(t)?{required:!0}:v.G.min(2)(e)}}return null},$e=e=>{const t=e.parent;if(t){const n=t.get("scheduling").value,i=t.get("firstOccurrenceIsNow").value;if(Object(s.h)(e.value)&&n===a.W.RECURRING&&!i)return{required:!0}}return null};let Ee=(()=>{class e extends Te.a{constructor(e,t,n,a,i){super(e),this.bankingHelper=t,this.paymentsService=n,this.posService=a,this.changeDetector=i,this.ConfirmationMode=ze.a,this.steps=["form","confirm","done"],this.step$=new u.a(null),this.currency$=new u.a(null),this.paymentTypeData$=new u.a(null),this.customValuesControls=new Map,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get paymentTypeData(){return this.paymentTypeData$.value}set paymentTypeData(e){this.paymentTypeData$.next(e),this.updatePaymentTypeData(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.pos="pos"===e.url[e.url.length-1].path,this.pos||(this.fromParam=e.params.from,this.fromSelf=this.authHelper.isSelf(this.fromParam),this.fromSystem=this.authHelper.isSystem(this.fromParam),this.toParam=e.params.to,this.toSelf=null!=this.toParam&&this.authHelper.isSelf(this.toParam),this.toSystem=null!=this.toParam&&this.authHelper.isSystem(this.toParam)),this.pos?(this.title=this.i18n.transaction.title.pos,this.mobileTitle=this.i18n.transaction.mobileTitle.pos):this.fromSystem?this.toSystem?(this.title=this.i18n.transaction.title.paymentSystemToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToSystem):(this.title=this.i18n.transaction.title.paymentSystemToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentSystemToUser):this.toSelf?(this.title=this.i18n.transaction.title.paymentToSelf,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSelf):this.toSystem?(this.title=this.i18n.transaction.title.paymentToSystem,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToSystem):(this.title=this.i18n.transaction.title.paymentToUser,this.mobileTitle=this.i18n.transaction.mobileTitle.paymentToUser),this.form=this.buildForm(),this.confirmationPassword=this.formBuilder.control(null),this.addSub(this.pos?this.posService.dataForReceivePayment({}).subscribe(e=>this.data=e):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:this.toParam}).subscribe(e=>this.data=e)),this.addSub(this.form.get("account").valueChanges.subscribe(e=>this.updateCurrency(this.data,e))),this.addSub(this.paymentTypeData$.subscribe(e=>{null!=this.lastPaymentTypeData&&Object(we.isEqual)(this.lastPaymentTypeData,e)||this.adjustForm(e),this.lastPaymentTypeData=e})),this.addSub(this.form.valueChanges.subscribe(e=>this.adjustFormValidators(e)))}buildForm(){return this.formBuilder.group({account:null,subject:[this.pos?null:this.toParam,v.G.required],type:[null,v.G.required],amount:[null,v.G.required],description:null,scheduling:[a.W.DIRECT,v.G.required],installmentsCount:null,firstInstallmentIsNow:!0,firstInstallmentDate:[null,Ne],repeatUntilCanceled:!0,occurrencesCount:[null,Ae],firstOccurrenceIsNow:!0,firstOccurrenceDate:[null,$e]})}updateCurrency(e,t){let n=null;!Object(s.h)(t)&&e&&e.accounts&&(n=e.accounts.find(e=>e.type.id===t)),this.currency=n?n.currency:null}adjustForm(e){const t=this.form.get("description");(e||{}).descriptionAvailability===a.i.REQUIRED?t.setValidators(v.G.required):Object(s.c)(t)}adjustFormValidators(e){if(this.lastValue&&Object(we.isEqual)(this.lastValue,e))return;this.lastValue=e;const t=this.form.get("firstInstallmentDate");"futureDate"===e.scheduling||e.scheduling===a.W.SCHEDULED&&!e.firstInstallmentIsNow?t.setValidators(v.G.required):Object(s.c)(t);const n=this.form.get("installmentsCount");e.scheduling===a.W.SCHEDULED?n.setValidators(v.G.compose([v.G.required,v.G.min(2)])):Object(s.c)(n);const i=this.form.get("occurrencesCount"),c=this.form.get("firstOccurrenceDate");e.scheduling===a.W.RECURRING?(e.repeatUntilCanceled?Object(s.c)(i):i.setValidators(v.G.compose([v.G.required,v.G.min(2)])),e.firstOccurrenceIsNow?Object(s.c)(c):c.setValidators(v.G.required)):(Object(s.c)(i),Object(s.c)(c)),this.changeDetector.detectChanges()}onDataInitialized(e){if(Object(s.h)(e.accounts))this.notification.error(this.i18n.transaction.noAccounts);else{this.step="form";const t=e.accounts[0].type.id;this.form.patchValue({account:t},{emitEvent:!1}),this.updateCurrency(e,t)}}updatePaymentTypeData(e){const t=this.form.get("amount");e&&e.fixedAmount?(t.setValue(e.fixedAmount),t.disable()):t.disabled&&t.enable()}backToForm(){this.step="form"}toConfirm(){const e={},t=this.paymentTypeData;if(t&&t.customFields)for(const n of t.customFields)e[n.internalName]=this.customValuesControlGetter(n);this.form.setControl("customValues",new v.m(e)),Object(s.F)(this.form)&&this.addSub(this.confirmDataRequest().subscribe(e=>{this.preview=e,this.step="confirm",this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.confirmationPassword.setValidators(e.confirmationPasswordInput?v.G.required:null),Object(s.y)()}))}perform(e){if(e&&this.confirmationPassword.setValue(e),!Object(s.F)(this.confirmationPassword))return;let t;t=this.pos?this.posService.receivePayment({body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}):this.paymentsService.performPayment({owner:this.fromParam,body:this.preview.payment,confirmationPassword:this.confirmationPassword.value}),t.pipe(Object(Fe.a)()).subscribe(e=>{this.performed=e,this.step="done",Object(s.y)()})}confirmDataRequest(){const e=Object(we.cloneDeep)(this.form.value),t=e;switch(e.scheduling){case"futureDate":t.scheduling=a.W.SCHEDULED,t.installmentsCount=1;break;case a.W.SCHEDULED:e.firstInstallmentIsNow&&(t.firstInstallmentDate=null);break;case a.W.RECURRING:e.repeatUntilCanceled&&(t.occurrencesCount=null),e.firstOccurrenceIsNow&&(t.firstOccurrenceDate=null)}return delete e.firstInstallmentIsNow,delete e.repeatUntilCanceled,delete e.firstOccurrenceIsNow,this.pos?this.posService.previewReceivePayment({body:t}):this.paymentsService.previewPayment({owner:this.fromParam,body:t})}get doneTitle(){if(this.performed)return this.performed.authorizationStatus===a.rb.PENDING?this.i18n.transaction.title.pendingPayment:this.i18n.transaction.title.processedPayment}get doneMobileTitle(){if(this.performed)return this.performed.authorizationStatus===a.rb.PENDING?this.i18n.transaction.mobileTitle.pendingPayment:this.i18n.transaction.mobileTitle.processedPayment}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.performed)])}reload(){this.step=null,this.currency=null,this.paymentTypeData=null,super.reload()}locateControl(e){return Object(s.t)(this.form,e)}get customValuesControlGetter(){return e=>{const t=e.internalName;let n=this.customValuesControls.get(t);return null==n&&(n=this.formBuilder.control(e.defaultValue,e.required?v.G.required:null),this.customValuesControls.set(t,n)),n}}resolveMenu(e){return this.pos?l.b.POS:this.fromSystem?this.toSystem?l.b.PAYMENT_TO_SYSTEM:l.b.PAYMENT_TO_USER:this.authHelper.userMenu(e.fromUser,this.toSystem?l.b.PAYMENT_TO_SYSTEM:this.toSelf?l.b.PAYMENT_TO_SELF:l.b.PAYMENT_TO_USER)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(c.a),d.Nb(i.z),d.Nb(Se.a),d.Nb(d.h))},e.\u0275cmp=d.Hb({type:e,selectors:[["payment"]],features:[d.wb],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","pos","form","currency","paymentTypeData$","customValuesControlGetter","availablePaymentTypes"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"pos","preview","confirmationPassword","showPaymentType","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""],[1,"btn","btn-outline-primary",3,"click"],[1,"flex-grow-1","d-flex","flex-column",3,"performed"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.ec(2,"async"),d.Fc(3,Ie,7,17,"page-content",1),d.Fc(4,He,10,15,"page-content",2),d.Fc(5,xe,8,8,"page-content",2),d.Fc(6,De,2,0,"page-content",3),d.Sb()),2&e&&(d.kc("ready",d.fc(1,5,t.data$))("ngSwitch",d.fc(2,7,t.step$)),d.zb(3),d.kc("ngSwitchCase","form"),d.zb(1),d.kc("ngSwitchCase","confirm"),d.zb(1),d.kc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),e})();var Re=n("/q9M"),Ue=n("/uUt");function Me(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",4),d.ec(1,"async"),d.Ob(2,"receive-qr-payment-step-form",5),d.ec(3,"async"),d.ec(4,"async"),d.ec(5,"async"),d.Tb(6,"actions",6),d.Tb(7,"action-button",7),d.bc("action",(function(){return d.wc(e),d.dc().toPending()})),d.ec(8,"async"),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.i18n.transaction.title.receiveQrPayment)("mobileHeading",e.i18n.transaction.mobileTitle.receiveQrPayment)("mode",d.fc(1,10,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("data",e.data)("form",e.form)("transferTypes",d.fc(3,12,e.paymentTypes$))("type",d.fc(4,14,e.paymentType$))("typeData",d.fc(5,16,e.paymentTypeData$)),d.zb(5),d.kc("disabled",d.fc(8,18,e.requesting$))("label",e.i18n.general.next)}}function Le(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",13),d.bc("click",(function(){return d.wc(e),d.dc(2).share()})),d.ec(1,"async"),d.Hc(2),d.Sb()}if(2&e){const e=d.dc(2);d.kc("disabled",d.fc(1,2,e.requesting$)),d.zb(2),d.Ic(e.i18n.general.share)}}function Be(e,t){1&e&&d.Ob(0,"span")}function Je(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",8),d.ec(1,"async"),d.Ob(2,"receive-qr-payment-step-pending",9),d.ec(3,"async"),d.ec(4,"async"),d.Tb(5,"actions",6),d.Fc(6,Le,3,4,"button",10),d.Fc(7,Be,1,0,"ng-template",null,11,d.Gc),d.Tb(9,"button",12),d.bc("click",(function(){return d.wc(e),d.dc().reload()})),d.Hc(10),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.uc(8),t=d.dc();d.kc("heading",t.i18n.transaction.title.receiveQrPayment)("mobileHeading",t.i18n.transaction.mobileTitle.receiveQrPayment)("mode",d.fc(1,8,t.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("ticket",d.fc(3,10,t.ticket$))("qrCodeUrl",d.fc(4,12,t.qrCodeUrl$)),d.zb(4),d.kc("ngIf",t.supportsShare)("ngIfElse",e),d.zb(4),d.Jc(" ",t.i18n.general.previous," ")}}function Ve(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",8),d.ec(1,"async"),d.Ob(2,"receive-qr-payment-step-done",14),d.ec(3,"async"),d.Tb(4,"actions",6),d.Tb(5,"button",15),d.bc("click",(function(){return d.wc(e),d.dc().viewPerformed()})),d.Hc(6),d.Sb(),d.Tb(7,"button",12),d.bc("click",(function(){return d.wc(e),d.dc().reload()})),d.Hc(8),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.i18n.transaction.title.receiveQrPayment)("mobileHeading",e.i18n.transaction.mobileTitle.receiveQrPayment)("mode",d.fc(1,6,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("payment",d.fc(3,8,e.payment$)),d.zb(4),d.Jc(" ",e.i18n.transaction.doneView," "),d.zb(2),d.Jc(" ",e.i18n.transaction.doneNew," ")}}function je(e,t){1&e&&(d.Tb(0,"page-content"),d.Ob(1,"spinner"),d.Sb())}let Ge=(()=>{class e extends Te.a{constructor(e,t,n,a){super(e),this.ticketsService=t,this.pushNotifications=n,this.bankingHelper=a,this.step$=new u.a(null),this.ticket$=new u.a(null),this.paymentTypes$=new u.a([]),this.paymentType$=new u.a(null),this.paymentTypeData$=new u.a(null),this.payment$=new u.a(null),this.paymentTypeDataCache=new Map,this.qrCodeUrl$=new u.a(null),this.supportsShare=Object(s.C)()}ngOnInit(){super.ngOnInit(),this.addSub(this.ticketsService.dataForNewTicket().subscribe(e=>this.data=e)),this.addSub(this.step$.subscribe(e=>this.onStepChanged(e)))}ngOnDestroy(){super.ngOnDestroy(),this.unsubscribePush(),this.destroyQrCode()}onDataInitialized(e){Object(s.h)(e.accounts)||Object(s.h)(e.paymentTypes)?this.notification.error(this.i18n.transaction.noAccounts):(this.form=this.formBuilder.group({account:[null,v.G.required],type:[null,v.G.required],amount:[null,v.G.required],description:null}),this.paymentTypeDataCache.set(e.paymentTypes[0].id,e.paymentTypeData),this.addSub(this.form.controls.type.valueChanges.pipe(Object(Ue.a)()).subscribe(e=>this.onPaymentTypeChange(e))),this.addSub(this.form.controls.account.valueChanges.pipe(Object(Ue.a)()).subscribe(t=>this.onAccountChange(t,e))),this.form.patchValue({account:e.accounts[0].id}),this.step$.next("form"))}onAccountChange(e,t){const n=t.accounts.find(t=>t.id===e),a=n?t.paymentTypes.filter(e=>e.to.id===n.type.id):[];this.paymentTypes$.next(a),this.form.patchValue({type:0===a.length?null:a[0].id})}onPaymentTypeChange(e){const t=(this.paymentTypes$.value||[]).find(t=>t.id===e);if(!t)return void this.notification.error(this.i18n.transaction.noTypes);const n=n=>{(this.paymentType$.value||{}).id!==e&&(this.paymentTypeDataCache.set(e,n),this.paymentType$.next(t),this.paymentTypeData$.next(n),this.form.setControl("customValues",this.fieldHelper.customValuesFormGroup(n.customFields)),this.form.controls.type.setValidators(n.descriptionAvailability===a.i.REQUIRED?v.G.required:null))},i=this.paymentTypeDataCache.get(e);i?n(i):this.addSub(this.ticketsService.dataForNewTicket({type:e}).subscribe(e=>{n(e.paymentTypeData)}))}toPending(){Object(s.F)(this.form)&&this.addSub(this.ticketsService.newTicket({body:this.form.value}).subscribe(e=>{this.ticket$.next(e),this.addSub(this.ticketsService.getTicketQrCode({ticket:e.ticketNumber,size:a.D.MEDIUM}).subscribe(e=>{this.qrCodeUrl$.next(URL.createObjectURL(e))})),this.step$.next("pending")}))}viewPerformed(){this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(this.payment$.value)])}onStepChanged(e){"pending"===e?this.pushSub=this.pushNotifications.ticket$.subscribe(e=>{const t=this.ticket$.value;t&&t.id===e.id&&(this.payment$.next(e.transaction),this.step$.next("done"))}):(this.unsubscribePush(),this.destroyQrCode())}unsubscribePush(){this.pushSub&&(this.pushSub.unsubscribe(),this.pushSub=null)}destroyQrCode(){this.qrCodeUrl$.value&&(URL.revokeObjectURL(this.qrCodeUrl$.value),this.qrCodeUrl$.next(null))}share(){const e=this.ticket$.value;navigator.share&&navigator.share({url:e.approveUrl,title:this.i18n.transaction.ticketShareTitle,text:this.i18n.transaction.ticketShareText({user:e.to.user.display,amount:this.format.formatAsCurrency(e.currency,e.amount)})})}resolveMenu(){return l.b.RECEIVE_QR_PAYMENT}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.F),d.Nb(Re.a),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["receive-qr-payment"]],features:[d.wb],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["hideBack","","last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1","d-flex","flex-column",3,"data","form","transferTypes","type","typeData"],["forceRow",""],[3,"disabled","label","action"],["hideBack","","last","",3,"heading","mobileHeading","mode"],[3,"ticket","qrCodeUrl"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["empty",""],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-primary",3,"disabled","click"],[3,"payment"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.ec(2,"async"),d.Fc(3,Me,9,20,"page-content",1),d.Fc(4,Je,11,14,"page-content",2),d.Fc(5,Ve,9,10,"page-content",2),d.Fc(6,je,2,0,"page-content",3),d.Sb()),2&e&&(d.kc("ready",d.fc(1,5,t.data$))("ngSwitch",d.fc(2,7,t.step$)),d.zb(3),d.kc("ngSwitchCase","form"),d.zb(1),d.kc("ngSwitchCase","pending"),d.zb(1),d.kc("ngSwitchCase","done"))},encapsulation:2,changeDetection:0}),e})();var _e=n("c/PD");function qe(e,t){1&e&&d.Pb(0)}function Qe(e,t){1&e&&d.Ob(0,"div",7)}function Ye(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",7),d.Tb(2,"label-value",16),d.Ob(3,"user-link",17),d.Sb(),d.Sb(),d.Fc(4,Qe,1,0,"div",9),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("user",e.data.user),d.zb(1),d.kc("ngIf",e.layout.gtsm$)}}function We(e,t){if(1&e&&d.Ob(0,"field-option",20),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.name)}}function Ke(e,t){if(1&e&&(d.Tb(0,"div",7),d.Tb(1,"single-selection-field",18),d.Fc(2,We,1,2,"field-option",19),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.transaction.account)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("ngForOf",e.data.accountTypes)}}function Ze(e,t){if(1&e&&(d.Tb(0,"mobile-result",21),d.Tb(1,"div",22),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.kc("date",e.date)("amount",e.amount)("avatarImage",n.bankingHelper.avatarImage(e.transaction.related))("avatarIcon",n.bankingHelper.avatarIcon(e.transaction.related))("currency",n.currencies.get(e.currency)),d.zb(2),d.Jc(" ",n.bankingHelper.subjectName(e.transaction.related)," ")}}const Xe=function(e){return{"pb-0":e}},et=function(e,t){return{positive:e,negative:t}};function tt(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",27),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.bankingHelper.transactionPath(n.transaction))})),d.Tb(2,"td",28),d.ec(3,"async"),d.Ob(4,"avatar",29),d.Sb(),d.Tb(5,"td"),d.Tb(6,"a",30),d.Hc(7),d.ec(8,"date"),d.Sb(),d.Sb(),d.Tb(9,"td"),d.Tb(10,"a",30),d.Hc(11),d.Sb(),d.Sb(),d.Tb(12,"td"),d.Tb(13,"a",31),d.Hc(14),d.Sb(),d.Sb(),d.Tb(15,"td",25),d.Tb(16,"a",32),d.Hc(17),d.ec(18,"currency"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(2),d.kc("ngClass",d.nc(20,Xe,d.fc(3,12,n.layout.xxs$))),d.zb(2),d.kc("image",n.bankingHelper.avatarImage(e.transaction.related))("icon",n.bankingHelper.avatarIcon(e.transaction.related)),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e.transaction)),d.zb(1),d.Jc(" ",d.fc(8,14,e.dueDate)," "),d.zb(3),d.kc("routerLink",n.bankingHelper.transactionPath(e.transaction)),d.zb(1),d.Jc(" ",n.bankingHelper.subjectName(e.transaction.related)," "),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e.transaction)),d.zb(1),d.Jc(" ",n.number(e)," "),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e.transaction))("ngClass",d.oc(22,et,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),d.zb(1),d.Jc(" ",d.hc(18,16,e.amount,n.currencies.get(e.transaction.currency),!0)," ")}}function nt(e,t){if(1&e&&(d.Tb(0,"table",23),d.Tb(1,"thead"),d.Ob(2,"th",24),d.Tb(3,"th"),d.Hc(4),d.Sb(),d.Tb(5,"th"),d.Hc(6),d.Sb(),d.Tb(7,"th"),d.Hc(8),d.Sb(),d.Tb(9,"th",25),d.Hc(10),d.Sb(),d.Sb(),d.Tb(11,"tbody"),d.Fc(12,tt,19,25,"ng-container",26),d.ec(13,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(13,5,e.results$))?null:n.results;d.zb(4),d.Ic(e.i18n.transaction.dueDate),d.zb(2),d.Ic(e.i18n.transaction.fromTo),d.zb(2),d.Ic(e.i18n.transaction.installmentNumber),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function at(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",3),d.Tb(1,"form",4),d.Tb(2,"div",5),d.Fc(3,Ye,5,3,"ng-container",6),d.Tb(4,"div",7),d.Ob(5,"single-selection-field",8),d.Sb(),d.Fc(6,Ke,3,3,"div",9),d.Tb(7,"div",7),d.Ob(8,"date-field",10),d.Sb(),d.Tb(9,"div",7),d.Ob(10,"date-field",11),d.Sb(),d.Tb(11,"div",7),d.Ob(12,"user-field",12),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(13,"results-layout",13),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(14,"async"),d.Fc(15,Ze,3,6,"mobile-result",14),d.Fc(16,nt,14,7,"table",15),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.i18n.transaction.title.scheduled)("mobileHeading",e.i18n.transaction.mobileTitle.scheduled),d.zb(1),d.kc("formGroup",e.form),d.zb(2),d.kc("ngIf",e.data.user&&!e.self),d.zb(2),d.kc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),d.zb(1),d.kc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.zb(2),d.kc("label",e.i18n.general.beginDate),d.zb(2),d.kc("label",e.i18n.general.endDate),d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("results",d.fc(14,13,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let it=(()=>{class e extends o.a{constructor(e,t,n,a){super(e),this.installmentsService=t,this.bankingHelper=n,this.transactionStatusService=a,this.currencies=new Map}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.owner,this.self=this.authHelper.isSelf(this.param),this.stateManager.cache("data",this.installmentsService.getInstallmentsDataForSearch({owner:this.param,fields:["user","accountTypes","query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.h)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e})}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.status=a.G.SCHEDULED,t}get statusOptions(){return Object.values(a.G).map(e=>({value:e,text:this.transactionStatusService.installmentStatus(e)}))}toSearchParams(e){const t=e;return t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.statuses=[e.status],t}resolveMenu(e){return this.authHelper.userMenu(e.user,l.b.SCHEDULED_PAYMENTS)}doSearch(e){return this.installmentsService.searchInstallments$Response(e)}get toLink(){return e=>this.bankingHelper.transactionPath(e.transaction)}number(e){return e.totalInstallments?this.i18n.transaction.installmentNumberOfTotal({number:e.number,total:e.totalInstallments}):String(e.number)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.q),d.Nb(c.a),d.Nb(_e.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["search-owner-installments"]],features:[d.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","future5","fieldSize","full",3,"label"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["forceSign","",3,"date","amount","avatarImage","avatarIcon","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],[3,"image","icon"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[3,"routerLink","ngClass"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,qe,1,0,"ng-container",1),d.Sb(),d.Fc(3,at,17,15,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,v.I,v.w,v.n,T.a,v.v,v.l,w.a,I.a,p.a,g.a,y.a,k.a,S.a,m.s,z.a,B.a,m.q,J.a,V.h],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();function ct(e,t){1&e&&d.Pb(0)}function rt(e,t){1&e&&d.Ob(0,"div",7)}function ot(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",7),d.Tb(2,"label-value",14),d.Ob(3,"user-link",15),d.Sb(),d.Sb(),d.Fc(4,rt,1,0,"div",9),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("user",e.data.user),d.zb(1),d.kc("ngIf",e.layout.gtsm$)}}function st(e,t){if(1&e&&d.Ob(0,"field-option",18),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.name)}}function lt(e,t){if(1&e&&(d.Tb(0,"div",7),d.Tb(1,"single-selection-field",16),d.Fc(2,st,1,2,"field-option",17),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.transaction.account)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("ngForOf",e.data.accountTypes)}}function ut(e,t){if(1&e&&d.Ob(0,"field-option",21),2&e){const e=t.$implicit;d.kc("id",e.id)("value",e)("text",e.name)}}function bt(e,t){if(1&e&&(d.Tb(0,"div",7),d.Tb(1,"single-selection-field",19),d.Fc(2,ut,1,3,"field-option",20),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.period),d.zb(1),d.kc("ngForOf",e.data.preselectedPeriods)}}function dt(e,t){if(1&e&&d.Ob(0,"field-option",24),2&e){const e=t.$implicit;d.kc("value",e)("id",e.id)("text",e.name)}}function ft(e,t){if(1&e&&(d.Tb(0,"div",7),d.Tb(1,"single-selection-field",22),d.Fc(2,dt,1,3,"field-option",23),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.account.transferFilter)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("ngForOf",e.transferFilters$.value)}}function mt(e,t){if(1&e&&(d.Tb(0,"div",7),d.Ob(1,"date-field",25),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.beginDate)}}function ht(e,t){if(1&e&&(d.Tb(0,"div",7),d.Ob(1,"date-field",26),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.endDate)}}function pt(e,t){if(1&e&&(d.Tb(0,"mobile-result",27),d.Tb(1,"div",28),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.kc("avatarImage",n.bankingHelper.avatarImage(e.related))("avatarIcon",n.bankingHelper.avatarIcon(e.related))("date",e.date)("amount",e.amount)("currency",n.currencies.get(e.currency)),d.zb(2),d.Jc(" ",n.bankingHelper.subjectName(e.related)," ")}}const gt=function(e){return{"pb-0":e}},yt=function(e,t){return{positive:e,negative:t}};function vt(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",33),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.bankingHelper.transactionPath(n))})),d.Tb(2,"td",30),d.Ob(3,"avatar",34),d.Sb(),d.Tb(4,"td"),d.Tb(5,"a",35),d.Hc(6),d.ec(7,"date"),d.Sb(),d.Sb(),d.Tb(8,"td"),d.Tb(9,"a",35),d.Hc(10),d.Sb(),d.Sb(),d.Tb(11,"td"),d.Tb(12,"a",36),d.Hc(13),d.Sb(),d.Sb(),d.Tb(14,"td",37),d.ec(15,"async"),d.Tb(16,"a",38),d.Hc(17),d.ec(18,"currency"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.kc("image",n.bankingHelper.avatarImage(e.related))("icon",n.bankingHelper.avatarIcon(e.related)),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",d.fc(7,12,e.date)," "),d.zb(3),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",n.bankingHelper.subjectName(e.related)," "),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",n.bankingHelper.scheduling(e)," "),d.zb(1),d.kc("ngClass",d.nc(20,gt,d.fc(15,14,n.layout.xxs$))),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e))("ngClass",d.oc(22,yt,n.format.isPositive(e.amount),n.format.isNegative(e.amount))),d.zb(1),d.Jc(" ",d.hc(18,16,e.amount,n.currencies.get(e.currency),!0)," ")}}function kt(e,t){if(1&e&&(d.Tb(0,"table",29),d.Tb(1,"thead"),d.Ob(2,"th",30),d.Tb(3,"th"),d.Hc(4),d.Sb(),d.Tb(5,"th"),d.Hc(6),d.Sb(),d.Tb(7,"th"),d.Hc(8),d.Sb(),d.Tb(9,"th",31),d.Hc(10),d.Sb(),d.Sb(),d.Tb(11,"tbody"),d.Fc(12,vt,19,25,"ng-container",32),d.ec(13,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(13,5,e.results$))?null:n.results;d.zb(4),d.Ic(e.i18n.general.date),d.zb(2),d.Ic(e.i18n.transaction.fromTo),d.zb(2),d.Ic(e.i18n.transaction.scheduling),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function St(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",3),d.Tb(1,"form",4),d.Tb(2,"div",5),d.Fc(3,ot,5,3,"ng-container",6),d.Tb(4,"div",7),d.Ob(5,"single-selection-field",8),d.Sb(),d.Fc(6,lt,3,3,"div",9),d.Fc(7,bt,3,2,"div",9),d.Fc(8,ft,3,3,"div",9),d.ec(9,"async"),d.Fc(10,mt,2,1,"div",9),d.ec(11,"async"),d.Fc(12,ht,2,1,"div",9),d.ec(13,"async"),d.Tb(14,"div",7),d.Ob(15,"user-field",10),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(16,"results-layout",11),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(17,"async"),d.Fc(18,pt,3,6,"mobile-result",12),d.Fc(19,kt,14,7,"table",13),d.Sb()}if(2&e){const e=d.dc();var n;const t=null==(null==(n=e.form.value||d.fc(11,17,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin);var a;const i=null==(null==(a=e.form.value||d.fc(13,19,e.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end);d.kc("heading",e.heading)("mobileHeading",e.mobileHeading),d.zb(1),d.kc("formGroup",e.form),d.zb(2),d.kc("ngIf",e.data.user&&!e.self),d.zb(2),d.kc("label",e.i18n.general.status)("fieldOptions",e.statusOptions),d.zb(1),d.kc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.zb(1),d.kc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),d.zb(1),d.kc("ngIf",d.fc(9,15,e.transferFilters$).length>0),d.zb(2),d.kc("ngIf",t),d.zb(2),d.kc("ngIf",i),d.zb(3),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("results",d.fc(17,21,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Tt=(()=>{class e extends o.a{constructor(e,t,n,a){super(e),this.transactionsService=t,this.transactionStatusService=n,this.bankingHelper=a,this.transferFilters$=new u.a([]),this.currencies=new Map}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;switch(this.kind=e.data.kind,this.param=e.params.owner,this.self=this.authHelper.isSelf(this.param),this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations}this.stateManager.cache("data",this.transactionsService.getTransactionsDataForSearch({owner:this.param,fields:["user","accountTypes","visibleKinds","transferFilters","preselectedPeriods","query"]})).subscribe(e=>{this.bankingHelper.preProcessPreselectedPeriods(e,this.form),(e.accountTypes||[]).forEach(e=>{const t=e.currency;this.currencies.set(t.id,t),Object(s.h)(t.internalName)||this.currencies.set(t.internalName,t)}),this.data=e}),this.addSub(this.form.get("accountType").valueChanges.subscribe(e=>{this.form.patchValue({transferFilter:null},{emitEvent:!1});const t=this.data.transferFilters.filter(t=>t.accountType.id===e);this.transferFilters$.next(t)}))}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=this.exportHelper.headingActions(e.exportFormats,e=>this.transactionsService.exportTransactions$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))}doSearch(e){return this.transactionsService.searchTransactions$Response(e)}getFormControlNames(){return["status","accountType","transferFilter","user","preselectedPeriod","periodBegin","periodEnd"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);switch(this.kind){case"authorized":t.status=a.rb.PENDING}return t}get statusOptions(){switch(this.kind){case"authorized":return Object.values(a.rb).map(e=>({value:e,text:this.transactionStatusService.authorizationStatus(e)}))}}toSearchParams(e){const t=e;switch(t.owner=this.param,t.accountTypes=e.accountType?[e.accountType]:null,t.transferFilters=e.transferFilter?[e.transferFilter]:null,t.datePeriod=this.bankingHelper.resolveDatePeriod(e),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0}return t}resolveMenu(e){let t;switch(this.kind){case"authorized":t=l.b.AUTHORIZED_PAYMENTS}return this.authHelper.userMenu(e.user,t)}get toLink(){return e=>this.bankingHelper.transactionPath(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.H),d.Nb(_e.a),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["search-owner-transactions"]],features:[d.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","accountType",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","transferFilter",3,"label","emptyOption"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["forceSign","",3,"avatarImage","avatarIcon","date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"image","icon"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[1,"amount",3,"ngClass"],[3,"routerLink","ngClass"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,ct,1,0,"ng-container",1),d.Sb(),d.Fc(3,St,20,23,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,v.I,v.w,v.n,T.a,v.v,v.l,I.a,p.a,g.a,y.a,k.a,S.a,m.s,z.a,w.a,B.a,J.a,V.h,m.q],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();function zt(e,t){1&e&&d.Pb(0)}function wt(e,t){if(1&e&&(d.Tb(0,"div",8),d.Ob(1,"single-selection-field",13),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.status)("fieldOptions",e.statusOptions)}}function Ft(e,t){if(1&e&&d.Ob(0,"field-option",16),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.name)}}function It(e,t){if(1&e&&(d.Tb(0,"div",8),d.Tb(1,"single-selection-field",14),d.Fc(2,Ft,1,2,"field-option",15),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),d.zb(1),d.kc("ngForOf",e.currencies)}}function Ot(e,t){if(1&e&&d.Ob(0,"field-option",19),2&e){const e=t.$implicit;d.kc("id",e.id)("value",e)("text",e.name)}}function Ct(e,t){if(1&e&&(d.Tb(0,"div",8),d.Tb(1,"single-selection-field",17),d.Fc(2,Ot,1,3,"field-option",18),d.Sb(),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.general.period),d.zb(1),d.kc("ngForOf",e.data.preselectedPeriods)}}function Pt(e,t){if(1&e&&(d.Tb(0,"div",8),d.Ob(1,"date-field",20),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.general.beginDate)}}function Ht(e,t){if(1&e&&(d.Tb(0,"div",8),d.Ob(1,"date-field",21),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.kc("label",e.i18n.general.endDate)}}function xt(e,t){if(1&e&&(d.Rb(0),d.Fc(1,Ct,3,2,"div",6),d.Fc(2,Pt,2,1,"div",6),d.ec(3,"async"),d.Fc(4,Ht,2,1,"div",6),d.ec(5,"async"),d.Qb()),2&e){const e=d.dc(2);var n;const t=null==(null==(n=e.form.value||d.fc(3,3,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin);var a;const i=null==(null==(a=e.form.value||d.fc(5,5,e.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end);d.zb(1),d.kc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>0),d.zb(1),d.kc("ngIf",t),d.zb(2),d.kc("ngIf",i)}}const Dt=function(e,t){return{from:e,to:t}};function Nt(e,t){if(1&e&&(d.Tb(0,"mobile-result",22),d.Tb(1,"div",23),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.kc("date",e.date)("amount",e.amount)("currency",n.currenciesByKey.get(e.currency)),d.zb(2),d.Jc(" ",n.i18n.transaction.fromToText(d.oc(4,Dt,n.bankingHelper.subjectName(e.from),n.bankingHelper.subjectName(e.to)))," ")}}const At=function(e){return{"pb-0":e}};function $t(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",27),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.bankingHelper.transactionPath(n))})),d.Tb(2,"td"),d.Tb(3,"a",28),d.Hc(4),d.ec(5,"date"),d.Sb(),d.Sb(),d.Tb(6,"td"),d.Tb(7,"a",28),d.Hc(8),d.Sb(),d.Sb(),d.Tb(9,"td"),d.Tb(10,"a",28),d.Hc(11),d.Sb(),d.Sb(),d.Tb(12,"td"),d.Tb(13,"a",29),d.Hc(14),d.Sb(),d.Sb(),d.Tb(15,"td",30),d.ec(16,"async"),d.Tb(17,"a",28),d.Hc(18),d.ec(19,"currency"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",d.fc(5,11,e.date)," "),d.zb(3),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",n.bankingHelper.subjectName(e.from)," "),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",n.bankingHelper.subjectName(e.to)," "),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",n.bankingHelper.scheduling(e)," "),d.zb(1),d.kc("ngClass",d.nc(18,At,d.fc(16,13,n.layout.xxs$))),d.zb(2),d.kc("routerLink",n.bankingHelper.transactionPath(e)),d.zb(1),d.Jc(" ",d.gc(19,15,e.amount,n.currenciesByKey.get(e.currency))," ")}}function Et(e,t){if(1&e&&(d.Tb(0,"table",24),d.Tb(1,"thead"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Tb(4,"th"),d.Hc(5),d.Sb(),d.Tb(6,"th"),d.Hc(7),d.Sb(),d.Tb(8,"th"),d.Hc(9),d.Sb(),d.Tb(10,"th",25),d.Hc(11),d.Sb(),d.Sb(),d.Tb(12,"tbody"),d.Fc(13,$t,20,20,"ng-container",26),d.ec(14,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(14,6,e.results$))?null:n.results;d.zb(3),d.Ic(e.i18n.general.date),d.zb(2),d.Ic(e.i18n.transaction.from),d.zb(2),d.Ic(e.i18n.transaction.to),d.zb(2),d.Ic(e.i18n.transaction.scheduling),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function Rt(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",3),d.Tb(1,"form",4),d.Tb(2,"div",5),d.Fc(3,wt,2,2,"div",6),d.Fc(4,It,3,3,"div",6),d.Fc(5,xt,6,7,"ng-container",7),d.Tb(6,"div",8),d.Ob(7,"user-field",9),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(8,"results-layout",10),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(9,"async"),d.Fc(10,Nt,3,7,"mobile-result",11),d.Fc(11,Et,15,8,"table",12),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.heading)("mobileHeading",e.mobileHeading),d.zb(1),d.kc("formGroup",e.form),d.zb(2),d.kc("ngIf",(null==e.statusOptions?null:e.statusOptions.length)>0),d.zb(1),d.kc("ngIf",(null==e.currencies?null:e.currencies.length)>1),d.zb(1),d.kc("ngIf",e.usePeriod),d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("results",d.fc(9,10,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Ut=(()=>{class e extends o.a{constructor(e,t,n,a){super(e),this.transactionsService=t,this.transactionStatusService=n,this.bankingHelper=a,this.usePeriod=!0,this.currenciesByKey=new Map}ngOnInit(){switch(super.ngOnInit(),this.kind=this.route.snapshot.data.kind,this.kind){case"authorized":this.heading=this.i18n.transaction.title.authorizations,this.mobileHeading=this.i18n.transaction.mobileTitle.authorizations;break;case"myAuth":this.heading=this.i18n.transaction.title.pendingMyAuthorization,this.mobileHeading=this.i18n.transaction.mobileTitle.pendingMyAuthorization,this.usePeriod=!1}this.stateManager.cache("data",this.transactionsService.getTransactionsOverviewDataForSearch({fields:["user","accountTypes",...this.usePeriod?["preselectedPeriods"]:[],"query"]})).subscribe(e=>{this.usePeriod&&this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.currencies=[...new Set(e.accountTypes.map(e=>e.currency))],this.currencies.sort((e,t)=>e.name.localeCompare(t.name)),this.currenciesByKey=new Map,this.currencies.forEach(e=>this.currenciesByKey.set(e.id,e)),this.headingActions=this.exportHelper.headingActions(e.exportFormats,e=>this.transactionsService.exportTransactionsOverview$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))}doSearch(e){return this.transactionsService.searchTransactionsOverview$Response(e)}getFormControlNames(){return["status","currency","user","preselectedPeriod","periodBegin","periodEnd"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);switch(this.kind){case"authorized":t.status=a.rb.PENDING}return t}get statusOptions(){switch(this.kind){case"authorized":return Object.values(a.rb).map(e=>({value:e,text:this.transactionStatusService.authorizationStatus(e)}));case"myAuth":return null}}toSearchParams(e){const t=e;switch(t.currencies=e.currency?[e.currency]:[],this.usePeriod&&(t.datePeriod=this.bankingHelper.resolveDatePeriod(e)),this.kind){case"authorized":t.authorizationStatuses=[e.status],t.authorized=!0;break;case"myAuth":t.pendingMyAuthorization=!0}return t}resolveMenu(e){let t;switch(this.kind){case"authorized":t=this.dataForUiHolder.role===a.eb.BROKER?l.b.BROKER_AUTHORIZED_PAYMENTS_OVERVIEW:l.b.AUTHORIZED_PAYMENTS_OVERVIEW;break;case"myAuth":t=l.b.PENDING_MY_AUTHORIZATION}return this.authHelper.userMenu(e.user,t)}get toLink(){return e=>this.bankingHelper.transactionPath(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.H),d.Nb(_e.a),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["search-transactions-overview"]],features:[d.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","formControlName","status",3,"label","fieldOptions"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","today","fieldSize","full",3,"label"],[3,"date","amount","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"d-inline-block",3,"routerLink"],[1,"amount",3,"ngClass"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,zt,1,0,"ng-container",1),d.Sb(),d.Fc(3,Rt,12,12,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,v.I,v.w,v.n,I.a,v.v,v.l,p.a,g.a,y.a,T.a,m.s,z.a,w.a,B.a,V.h,m.q],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();var Mt=n("MhyI"),Lt=n("/kmK");function Bt(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"label-value",5),d.Hc(2),d.Sb(),d.Ob(3,"hr"),d.Qb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.transaction.number),d.zb(1),d.Jc(" ",e.transaction.transactionNumber," ")}}function Jt(e,t){1&e&&d.Ob(0,"hr")}function Vt(e,t){if(1&e&&(d.Tb(0,"label-value",5),d.Hc(1),d.Sb()),2&e){const e=d.dc().$implicit,t=d.dc(2);d.kc("label",t.i18n.general.performedBy),d.zb(1),d.Jc(" ",e.by.display," ")}}function jt(e,t){if(1&e&&d.Ob(0,"label-value",8),2&e){const e=d.dc().$implicit,t=d.dc(2);d.kc("label",t.i18n.general.comments)("value",e.comments)}}function Gt(e,t){if(1&e&&(d.Rb(0),d.Fc(1,Jt,1,0,"hr",3),d.Tb(2,"label-value",5),d.Hc(3),d.Sb(),d.Fc(4,Vt,2,2,"label-value",6),d.Tb(5,"label-value",5),d.Hc(6),d.ec(7,"dateTime"),d.Sb(),d.Fc(8,jt,1,2,"label-value",7),d.Qb()),2&e){const e=t.$implicit,n=t.first,a=d.dc(2);d.zb(1),d.kc("ngIf",!n),d.zb(1),d.kc("label",a.i18n.general.action),d.zb(1),d.Jc(" ",a.actionLabel(e)," "),d.zb(1),d.kc("ngIf",e.by),d.zb(1),d.kc("label",a.i18n.general.date),d.zb(1),d.Jc(" ",d.fc(7,7,e.date)," "),d.zb(2),d.kc("ngIf",e.comments)}}function _t(e,t){if(1&e&&(d.Tb(0,"page-content",2),d.Fc(1,Bt,4,2,"ng-container",3),d.Fc(2,Gt,9,9,"ng-container",4),d.Sb()),2&e){const e=d.dc();d.kc("heading",e.i18n.transaction.title.authorizationHistory)("mobileHeading",e.i18n.transaction.mobileTitle.authorizationHistory),d.zb(1),d.kc("ngIf",e.transaction.transactionNumber),d.zb(1),d.kc("ngForOf",e.transaction.authorizations)}}let qt=(()=>{class e extends Mt.a{constructor(e,t,n){super(e),this.transactionsService=t,this.transactionStatusService=n}get transaction(){return this.data}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("key");this.addSub(this.transactionsService.viewTransaction({key:e,fields:["transactionNumber","date","amount","kind","type","from","to","authorizations"]}).subscribe(e=>{this.data=e}))}actionLabel(e){return this.transactionStatusService.authorizationAction(e.action)}resolveMenu(e){return this.authHelper.accountMenu(e.from,e.to)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.H),d.Nb(_e.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["view-authorization-history"]],features:[d.wb],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"label"],[3,"label",4,"ngIf"],["valueFormat","break",3,"label","value",4,"ngIf"],["valueFormat","break",3,"label","value"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,_t,3,4,"page-content",1),d.Sb()),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,m.t,h.a,m.s,k.a],pipes:[m.b,Lt.a],encapsulation:2,changeDetection:0}),e})();var Qt=n("w0j7"),Yt=n("Bp6V"),Wt=n("0D+q"),Kt=n("aLb1"),Zt=n("tAww"),Xt=n("nznZ"),en=n("UXR7");function tn(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.number),d.zb(1),d.Jc(" ",e.transfer.transactionNumber,"\n")}}function nn(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Tb(1,"a",7),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.chargedBackBy),d.zb(1),d.kc("routerLink",e.path(e.transfer.chargedBackBy)),d.zb(1),d.Jc(" ",e.transfer.chargedBackBy.display," ")}}function an(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Tb(1,"a",7),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.chargebackOf),d.zb(1),d.kc("routerLink",e.path(e.transfer.chargebackOf)),d.zb(1),d.Jc(" ",e.transfer.chargebackOf.display," ")}}function cn(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.general.performedBy),d.zb(1),d.Jc(" ",e.transfer.transaction.by.display,"\n")}}function rn(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.receivedBy),d.zb(1),d.Jc(" ",e.transfer.transaction.receivedBy.display,"\n")}}function on(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.channel),d.zb(1),d.Jc(" ",e.transfer.transaction.channel.name,"\n")}}function sn(e,t){1&e&&d.Ob(0,"custom-field-value",8),2&e&&d.kc("fieldValue",t.$implicit)}function ln(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Hc(1),d.Sb()),2&e){const e=t.$implicit;d.kc("label",e.flow.name),d.zb(1),d.Jc(" ",e.name,"\n")}}function un(e,t){if(1&e&&d.Ob(0,"label-value",9),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.authorizationComments)("value",e.lastAuthComment)}}function bn(e,t){if(1&e&&d.Ob(0,"label-value",9),2&e){const e=d.dc();d.kc("label",e.i18n.general.description)("value",e.transfer.transaction.description)}}function dn(e,t){if(1&e&&(d.Tb(0,"label-value",1),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.number),d.zb(1),d.Jc(" ",e.transfer.parent.transactionNumber," ")}}function fn(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"h2",10),d.Hc(2),d.ec(3,"async"),d.Sb(),d.Fc(4,dn,2,2,"label-value",0),d.Tb(5,"label-value",1),d.Hc(6),d.ec(7,"dateTime"),d.Sb(),d.Tb(8,"label-value",1),d.Hc(9),d.ec(10,"currency"),d.Sb(),d.Tb(11,"label-value",1),d.Ob(12,"user-link",2),d.Sb(),d.Tb(13,"label-value",1),d.Ob(14,"user-link",2),d.Sb(),d.Tb(15,"label-value",1),d.Hc(16),d.Sb(),d.Tb(17,"actions"),d.Tb(18,"a",11),d.Hc(19),d.Sb(),d.Sb(),d.Qb()),2&e){const e=d.dc();d.zb(2),d.Ic(d.fc(3,14,e.layout.gtxs$)?e.i18n.transaction.title.parentTransfer:e.i18n.transaction.mobileTitle.parentTransfer),d.zb(2),d.kc("ngIf",e.transfer.parent.transactionNumber),d.zb(1),d.kc("label",e.i18n.general.date),d.zb(1),d.Jc(" ",d.fc(7,16,e.transfer.parent.date)," "),d.zb(2),d.kc("label",e.i18n.transaction.amount),d.zb(1),d.Jc(" ",d.gc(10,18,e.transfer.parent.amount,e.transfer.parent.currency)," "),d.zb(2),d.kc("label",e.i18n.transaction.from),d.zb(1),d.kc("account",e.transfer.parent.from),d.zb(1),d.kc("label",e.i18n.transaction.to),d.zb(1),d.kc("account",e.transfer.parent.to),d.zb(1),d.kc("label",e.i18n.transaction.type),d.zb(1),d.Jc(" ",e.transfer.parent.type.name," "),d.zb(2),d.kc("routerLink",e.path(e.transfer.parent)),d.zb(1),d.Jc(" ",e.i18n.transaction.viewThisTransfer," ")}}function mn(e,t){if(1&e&&(d.Tb(0,"div"),d.Hc(1),d.Ob(2,"user-link",2),d.Sb()),2&e){const e=d.dc().$implicit,t=d.dc(2);d.zb(1),d.Jc(" ",t.i18n.transaction.from," "),d.zb(1),d.kc("account",e.from)}}function hn(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.Qb()),2&e){const e=d.dc(3);d.zb(1),d.Jc(" ",e.i18n.transaction.to,"")}}function pn(e,t){if(1&e&&(d.Tb(0,"mobile-result",16),d.Tb(1,"div",17),d.Fc(2,mn,3,2,"div",6),d.Tb(3,"div"),d.Fc(4,hn,2,1,"ng-container",6),d.Ob(5,"user-link",2),d.Sb(),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.kc("date",e.date)("amount",((null==e.from.user?null:e.from.user.id)===(null==n.login.user?null:n.login.user.id)?"-":"")+e.amount)("amountColor",(null==e.from.user?null:e.from.user.id)===(null==n.login.user?null:n.login.user.id))("currency",e.currency),d.zb(2),d.kc("ngIf",(null==e.from.user?null:e.from.user.id)!==(null==n.login.user?null:n.login.user.id)),d.zb(2),d.kc("ngIf",(null==e.from.user?null:e.from.user.id)!==(null==n.login.user?null:n.login.user.id)),d.zb(1),d.kc("account",e.to)}}function gn(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",21),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.path(n))})),d.Tb(1,"td"),d.Tb(2,"a",7),d.Hc(3),d.ec(4,"date"),d.Sb(),d.Sb(),d.Tb(5,"td"),d.Tb(6,"a",7),d.Ob(7,"user-link",2),d.Sb(),d.Sb(),d.Tb(8,"td"),d.Tb(9,"a",7),d.Ob(10,"user-link",2),d.Sb(),d.Sb(),d.Tb(11,"td",19),d.Tb(12,"a",7),d.Hc(13),d.ec(14,"currency"),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",d.fc(4,8,e.date)," "),d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.kc("account",e.from),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.kc("account",e.to),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",d.gc(14,10,e.amount,e.currency)," ")}}function yn(e,t){if(1&e&&(d.Tb(0,"table",18),d.Tb(1,"thead"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Tb(4,"th"),d.Hc(5),d.Sb(),d.Tb(6,"th"),d.Hc(7),d.Sb(),d.Tb(8,"th",19),d.Hc(9),d.Sb(),d.Sb(),d.Tb(10,"tbody"),d.Fc(11,gn,15,13,"tr",20),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(3),d.Ic(e.i18n.general.date),d.zb(2),d.Ic(e.i18n.transaction.from),d.zb(2),d.Ic(e.i18n.transaction.to),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",e.transfer.children)}}function vn(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"h2",12),d.Hc(2),d.ec(3,"async"),d.Sb(),d.Tb(4,"results-layout",13),d.Fc(5,pn,6,7,"mobile-result",14),d.Fc(6,yn,12,5,"table",15),d.Sb(),d.Qb()),2&e){const e=d.dc();d.zb(2),d.Ic(d.fc(3,3,e.layout.gtxs$)?e.i18n.transaction.title.childTransfers:e.i18n.transaction.mobileTitle.childTransfers),d.zb(2),d.kc("results",e.transfer.children)("toLink",e.toLink)}}let kn=(()=>{class e extends P.a{constructor(e,t){super(e),this.bankingHelper=t}ngOnInit(){super.ngOnInit();const e=this.transfer.transaction||{};Object(s.h)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments),this.hasAdditionalData=!Object(s.h)(this.lastAuthComment)||!!this.transfer.parent||!Object(s.h)(this.transfer.children)}path(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["transfer-details"]],inputs:{transfer:"transfer",headingActions:"headingActions"},features:[d.wb],decls:24,vars:27,consts:[[3,"label",4,"ngIf"],[3,"label"],[3,"account"],[3,"fieldValue",4,"ngFor","ngForOf"],[3,"label",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"routerLink"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"mt-4"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"mt-4","mb-0"],[3,"results","toLink"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"date","amount","amountColor","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(d.Fc(0,tn,2,2,"label-value",0),d.Tb(1,"label-value",1),d.Hc(2),d.ec(3,"dateTime"),d.Sb(),d.Tb(4,"label-value",1),d.Hc(5),d.ec(6,"currency"),d.Sb(),d.Fc(7,nn,3,3,"label-value",0),d.Fc(8,an,3,3,"label-value",0),d.Fc(9,cn,2,2,"label-value",0),d.Fc(10,rn,2,2,"label-value",0),d.Tb(11,"label-value",1),d.Ob(12,"user-link",2),d.Sb(),d.Tb(13,"label-value",1),d.Ob(14,"user-link",2),d.Sb(),d.Tb(15,"label-value",1),d.Hc(16),d.Sb(),d.Fc(17,on,2,2,"label-value",0),d.Fc(18,sn,1,1,"custom-field-value",3),d.Fc(19,ln,2,2,"label-value",4),d.Fc(20,un,1,2,"label-value",5),d.Fc(21,bn,1,2,"label-value",5),d.Fc(22,fn,20,21,"ng-container",6),d.Fc(23,vn,7,5,"ng-container",6)),2&e&&(d.kc("ngIf",t.transfer.transactionNumber),d.zb(1),d.kc("label",t.i18n.general.date),d.zb(1),d.Jc(" ",d.fc(3,22,t.transfer.date),"\n"),d.zb(2),d.kc("label",t.i18n.transaction.amount),d.zb(1),d.Jc(" ",d.gc(6,24,t.transfer.amount,t.transfer.currency),"\n"),d.zb(2),d.kc("ngIf",t.transfer.chargedBackBy),d.zb(1),d.kc("ngIf",t.transfer.chargebackOf),d.zb(1),d.kc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.by),d.zb(1),d.kc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.receivedBy),d.zb(1),d.kc("label",t.i18n.transaction.from),d.zb(1),d.kc("account",t.transfer.from),d.zb(1),d.kc("label",t.i18n.transaction.to),d.zb(1),d.kc("account",t.transfer.to),d.zb(1),d.kc("label",t.i18n.transaction.type),d.zb(1),d.Jc(" ",t.transfer.type.name,"\n"),d.zb(1),d.kc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.channel),d.zb(1),d.kc("ngForOf",null==t.transfer.transaction?null:t.transfer.transaction.customValues),d.zb(1),d.kc("ngForOf",t.transfer.statuses),d.zb(1),d.kc("ngIf",t.lastAuthComment),d.zb(1),d.kc("ngIf",null==t.transfer.transaction?null:t.transfer.transaction.description),d.zb(1),d.kc("ngIf",t.transfer.parent),d.zb(1),d.kc("ngIf",(null==t.transfer.children?null:t.transfer.children.length)>0))},directives:[m.t,k.a,S.a,m.s,V.h,Xt.a,en.a,p.a,g.a,y.a,B.a],pipes:[Lt.a,H.a,m.b,j.a],encapsulation:2,changeDetection:0}),e})();var Sn=n("Wpnw"),Tn=n("978R"),zn=n("H4pW");function wn(e,t){if(1&e&&d.Ob(0,"transfer-details",5),2&e){const e=d.dc(2);d.kc("transfer",e.transaction.transfer)}}function Fn(e,t){if(1&e&&(d.Tb(0,"page-content",3),d.ec(1,"async"),d.Fc(2,wn,1,1,"transfer-details",4),d.Sb()),2&e){const e=d.dc(),t=d.uc(4);d.kc("heading",e.title)("mobileHeading",e.mobileTitle)("headingActions",d.fc(1,5,e.headingActions$)),d.zb(2),d.kc("ngIf",e.transaction.transfer)("ngIfElse",t)}}function In(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.number),d.zb(1),d.Jc(" ",e.transaction.transactionNumber," ")}}function On(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.ec(2,"currency"),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.dueAmount),d.zb(1),d.Jc(" ",d.gc(2,2,e.transaction.dueAmount,e.transaction.currency)," ")}}function Cn(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.general.performedBy),d.zb(1),d.Jc(" ",e.transaction.by.display," ")}}function Pn(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.receivedBy),d.zb(1),d.Jc(" ",e.transaction.receivedBy.display," ")}}function Hn(e,t){if(1&e&&d.Ob(0,"user-link",15),2&e){const e=d.dc(2);d.kc("user",e.transaction.fromUser)}}function xn(e,t){if(1&e&&d.Hc(0),2&e){const e=d.dc(2);d.Jc(" ",e.transaction.type.from.name," ")}}function Dn(e,t){if(1&e&&d.Ob(0,"user-link",15),2&e){const e=d.dc(2);d.kc("user",e.transaction.toUser)}}function Nn(e,t){if(1&e&&d.Hc(0),2&e){const e=d.dc(2);d.Jc(" ",e.transaction.type.to.name," ")}}function An(e,t){1&e&&d.Ob(0,"custom-field-value",16),2&e&&d.kc("fieldValue",t.$implicit)}function $n(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.channel),d.zb(1),d.Jc(" ",e.transaction.channel.name," ")}}function En(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.ec(2,"date"),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.dueDate),d.zb(1),d.Jc(" ",d.fc(2,2,e.transaction.installments[0].dueDate)," ")}}function Rn(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.ec(2,"date"),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.nextOccurrence),d.zb(1),d.Jc(" ",d.fc(2,2,e.transaction.nextOccurrenceDate)," ")}}function Un(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.occurrencesCount),d.zb(1),d.Jc(" ",e.transaction.occurrencesCount," ")}}function Mn(e,t){if(1&e&&d.Ob(0,"label-value",17),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.authorizationComments)("value",e.lastAuthComment)}}function Ln(e,t){if(1&e&&d.Ob(0,"label-value",17),2&e){const e=d.dc(2);d.kc("label",e.i18n.general.description)("value",e.transaction.description)}}function Bn(e,t){1&e&&d.Ob(0,"th",23)}function Jn(e,t){if(1&e&&(d.Tb(0,"thead"),d.Tb(1,"th"),d.Hc(2),d.Sb(),d.Tb(3,"th"),d.Hc(4),d.Sb(),d.Tb(5,"th"),d.Hc(6),d.Sb(),d.Tb(7,"th",21),d.Hc(8),d.Sb(),d.Fc(9,Bn,1,0,"th",22),d.Sb()),2&e){const e=d.dc(3);d.zb(2),d.Ic(e.i18n.transaction.installmentNumber),d.zb(2),d.Ic(e.i18n.transaction.dueDate),d.zb(2),d.Ic(e.i18n.general.status),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(1),d.kc("ngIf",e.hasActions)}}function Vn(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",31),d.bc("click",(function(){d.wc(e);const t=d.dc(2).$implicit;return d.dc(3).processInstallment(t)})),d.Ob(1,"icon",32),d.Sb()}if(2&e){const e=d.dc(5);d.kc("tooltip",e.i18n.transaction.processInstallment)}}const jn=function(e){return{"ml-2":e}};function Gn(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",33),d.bc("click",(function(){d.wc(e);const t=d.dc(2).$implicit;return d.dc(3).settleInstallment(t)})),d.Ob(1,"icon",34),d.Sb()}if(2&e){const e=d.dc(2).$implicit,t=d.dc(3);d.kc("tooltip",t.i18n.transaction.settleInstallment)("ngClass",d.nc(2,jn,e.canProcess))}}function _n(e,t){if(1&e&&(d.Tb(0,"td",28),d.Fc(1,Vn,2,1,"button",29),d.Fc(2,Gn,2,4,"button",30),d.Sb()),2&e){const e=d.dc().$implicit;d.zb(1),d.kc("ngIf",e.canProcess),d.zb(1),d.kc("ngIf",e.canSettle)}}const qn=function(e){return{"cursor-pointer":e}};function Qn(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",24),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.path(n)?a.router.navigate(a.path(n)):null})),d.Tb(1,"td"),d.Tb(2,"maybe-link",25),d.Hc(3),d.Sb(),d.Sb(),d.Tb(4,"td"),d.Tb(5,"maybe-link",25),d.Hc(6),d.ec(7,"date"),d.Sb(),d.Sb(),d.Tb(8,"td"),d.Tb(9,"maybe-link",25),d.Hc(10),d.Sb(),d.Sb(),d.Tb(11,"td",26),d.Tb(12,"maybe-link",25),d.Hc(13),d.ec(14,"currency"),d.Sb(),d.Sb(),d.Fc(15,_n,3,2,"td",27),d.Sb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.kc("ngClass",d.nc(15,qn,n.path(e))),d.zb(2),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",e.number," "),d.zb(2),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",d.fc(7,10,e.dueDate)," "),d.zb(3),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",n.installmentStatus(e.status)," "),d.zb(2),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",d.gc(14,12,e.amount,n.transaction.currency)," "),d.zb(2),d.kc("ngIf",n.hasActions)}}function Yn(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"h2",18),d.Hc(2),d.Sb(),d.Tb(3,"table",19),d.Fc(4,Jn,10,5,"thead",14),d.ec(5,"async"),d.Tb(6,"tbody"),d.Fc(7,Qn,16,17,"tr",20),d.Sb(),d.Sb(),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.Ic(e.i18n.transaction.installments),d.zb(2),d.kc("ngIf",d.fc(5,3,e.layout.gtxs$)),d.zb(3),d.kc("ngForOf",e.transaction.installments)}}function Wn(e,t){1&e&&d.Ob(0,"th",23)}function Kn(e,t){if(1&e&&(d.Tb(0,"thead"),d.Tb(1,"th"),d.Hc(2),d.Sb(),d.Tb(3,"th"),d.Hc(4),d.Sb(),d.Tb(5,"th"),d.Hc(6),d.Sb(),d.Tb(7,"th",26),d.Hc(8),d.Sb(),d.Fc(9,Wn,1,0,"th",22),d.Sb()),2&e){const e=d.dc(3);d.zb(2),d.Ic(e.i18n.transaction.installmentNumber),d.zb(2),d.Ic(e.i18n.general.date),d.zb(2),d.Ic(e.i18n.general.status),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(1),d.kc("ngIf",e.hasActions)}}function Zn(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",31),d.bc("click",(function(){d.wc(e);const t=d.dc(2).$implicit;return d.dc(3).processOccurrence(t)})),d.Ob(1,"icon",32),d.Sb()}if(2&e){const e=d.dc(5);d.kc("tooltip",e.i18n.transaction.processFailedOccurrence)}}function Xn(e,t){if(1&e&&(d.Tb(0,"td",23),d.Fc(1,Zn,2,1,"button",29),d.Sb()),2&e){const e=d.dc().$implicit;d.zb(1),d.kc("ngIf",e.canProcess)}}function ea(e,t){if(1&e){const e=d.Ub();d.Tb(0,"tr",24),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.path(n)?a.router.navigate(a.path(n)):null})),d.Tb(1,"td"),d.Tb(2,"maybe-link",25),d.Hc(3),d.Sb(),d.Sb(),d.Tb(4,"td"),d.Tb(5,"maybe-link",25),d.Hc(6),d.ec(7,"date"),d.Sb(),d.Sb(),d.Tb(8,"td"),d.Tb(9,"maybe-link",25),d.Hc(10),d.Sb(),d.Sb(),d.Tb(11,"td",26),d.Tb(12,"maybe-link",25),d.Hc(13),d.ec(14,"currency"),d.Sb(),d.Sb(),d.Fc(15,Xn,2,1,"td",22),d.Sb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.kc("ngClass",d.nc(15,qn,n.path(e))),d.zb(2),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",e.number," "),d.zb(2),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",d.fc(7,10,e.dueDate)," "),d.zb(3),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",n.installmentStatus(e.status)," "),d.zb(2),d.kc("link",n.path(e)),d.zb(1),d.Jc(" ",d.gc(14,12,e.amount,n.transaction.currency)," "),d.zb(2),d.kc("ngIf",n.hasActions)}}function ta(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"h2",18),d.Hc(2),d.Sb(),d.Tb(3,"table",35),d.Fc(4,Kn,10,5,"thead",14),d.ec(5,"async"),d.Tb(6,"tbody"),d.Fc(7,ea,16,17,"tr",20),d.Sb(),d.Sb(),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.Jc(" ",e.i18n.transaction.occurrences," "),d.zb(2),d.kc("ngIf",d.fc(5,3,e.layout.gtxs$)),d.zb(3),d.kc("ngForOf",e.transaction.occurrences)}}const na=function(){return[]};function aa(e,t){if(1&e&&(d.Fc(0,In,2,2,"label-value",6),d.Ob(1,"label-value",7),d.Tb(2,"label-value",8),d.Hc(3),d.ec(4,"dateTime"),d.Sb(),d.Tb(5,"label-value",8),d.Hc(6),d.ec(7,"currency"),d.Sb(),d.Fc(8,On,3,5,"label-value",6),d.Fc(9,Cn,2,2,"label-value",6),d.Fc(10,Pn,2,2,"label-value",6),d.Tb(11,"label-value",8),d.Fc(12,Hn,1,1,"user-link",9),d.Fc(13,xn,1,1,"ng-template",null,10,d.Gc),d.Sb(),d.Tb(15,"label-value",8),d.Fc(16,Dn,1,1,"user-link",9),d.Fc(17,Nn,1,1,"ng-template",null,11,d.Gc),d.Sb(),d.Tb(19,"label-value",8),d.Hc(20),d.Sb(),d.Fc(21,An,1,1,"custom-field-value",12),d.Fc(22,$n,2,2,"label-value",6),d.Fc(23,En,3,4,"label-value",6),d.Fc(24,Rn,3,4,"label-value",6),d.Fc(25,Un,2,2,"label-value",6),d.Fc(26,Mn,1,2,"label-value",13),d.Fc(27,Ln,1,2,"label-value",13),d.Fc(28,Yn,8,5,"ng-container",14),d.Fc(29,ta,8,5,"ng-container",14)),2&e){const e=d.uc(14),t=d.uc(18),n=d.dc();d.kc("ngIf",n.transaction.transactionNumber),d.zb(1),d.kc("label",n.i18n.general.status)("value",n.status),d.zb(1),d.kc("label",n.i18n.general.date),d.zb(1),d.Jc(" ",d.fc(4,27,n.transaction.date)," "),d.zb(2),d.kc("label",n.i18n.transaction.amount),d.zb(1),d.Jc(" ",d.gc(7,29,n.transaction.amount,n.transaction.currency)," "),d.zb(2),d.kc("ngIf",n.hasDueAmount),d.zb(1),d.kc("ngIf",n.transaction.by),d.zb(1),d.kc("ngIf",null==n.transaction?null:n.transaction.receivedBy),d.zb(1),d.kc("label",n.i18n.transaction.from),d.zb(1),d.kc("ngIf",n.transaction.fromUser)("ngIfElse",e),d.zb(3),d.kc("label",n.i18n.transaction.to),d.zb(1),d.kc("ngIf",n.transaction.toUser)("ngIfElse",t),d.zb(3),d.kc("label",n.i18n.transaction.type),d.zb(1),d.Jc(" ",n.transaction.type.name," "),d.zb(1),d.kc("ngForOf",n.transaction.customValues),d.zb(1),d.kc("ngIf",n.transaction.channel),d.zb(1),d.kc("ngIf",1===(n.transaction.installments||d.mc(32,na)).length),d.zb(1),d.kc("ngIf",n.transaction.nextOccurrenceDate),d.zb(1),d.kc("ngIf",n.transaction.occurrencesCount),d.zb(1),d.kc("ngIf",n.lastAuthComment),d.zb(1),d.kc("ngIf",n.transaction.description),d.zb(1),d.kc("ngIf",(n.transaction.installments||d.mc(33,na)).length>1),d.zb(1),d.kc("ngIf",(n.transaction.occurrences||d.mc(34,na)).length>0)}}let ia=(()=>{class e extends Mt.a{constructor(e,t,n,a,i,c,r,o,s){super(e),this.transactionsService=t,this.installmentsService=n,this.transactionStatusService=a,this.pendingPaymentsService=i,this.scheduledPaymentsService=c,this.recurringPaymentsService=r,this.transfersService=o,this.operationHelper=s,this.hasDueAmount=!1,this.hasActions=!1}get status(){return this.transactionStatusService.transactionStatus(this.transaction)}get transaction(){return this.data}get key(){return this.route.snapshot.paramMap.get("key")}ngOnInit(){super.ngOnInit(),this.addSub(this.transactionsService.viewTransaction({key:this.key}).subscribe(e=>{[this.title,this.mobileTitle]=this.titles(e.kind),this.headingActions=this.initActions(e),this.hasDueAmount=e.dueAmount&&!this.format.isZero(e.dueAmount),this.hasActions=!!(e.installments||e.occurrences||[]).find(e=>e.canProcess||e.canSettle),this.data=e,e.transfer&&(e.transfer.transaction=e),Object(s.h)(e.authorizations)||(this.lastAuthComment=e.authorizations[0].comments)}))}initActions(e){var t,n;const i=this.exportHelper.headingActions(e.exportFormats,t=>this.transactionsService.exportTransaction$Response({format:t.internalName,key:e.id})),c=e.authorizationPermissions||{};Object(s.h)(e.authorizations)||i.push(new Zt.c("check_circle_outline",this.i18n.transaction.viewAuthorizations,()=>this.router.navigate(["banking","transaction",this.key,"authorization-history"]))),c.authorize&&i.push(new Zt.c("thumb_up",this.i18n.transaction.authorizePending,()=>this.authorize())),c.deny&&i.push(new Zt.c("thumb_down",this.i18n.transaction.denyPending,()=>this.deny())),c.cancel&&i.push(new Zt.c("cancel",this.i18n.transaction.cancelAuthorization,()=>this.cancelAuthorization()));const r=e.scheduledPaymentPermissions||{};r.block&&i.push(new Zt.c("block",this.i18n.transaction.blockScheduling,()=>this.blockScheduled())),r.unblock&&i.push(new Zt.c("schedule",this.i18n.transaction.unblockScheduling,()=>this.unblockScheduled())),r.cancel&&i.push(new Zt.c("cancel",this.i18n.transaction.cancelScheduled,()=>this.cancelScheduled())),r.settle&&i.push(new Zt.c("done_all",this.i18n.transaction.settleScheduled,()=>this.settleScheduled())),e.kind===a.sb.SCHEDULED_PAYMENT&&1===e.installments.length&&e.installments[0].canProcess&&i.push(new Zt.c("play_circle_outline",this.i18n.transaction.processScheduled,()=>this.processScheduled(e.installments[0]))),(null===(t=e.recurringPaymentPermissions)||void 0===t?void 0:t.cancel)&&i.push(new Zt.c("cancel",this.i18n.transaction.cancelRecurring,()=>this.cancelRecurring())),(null===(n=e.transfer)||void 0===n?void 0:n.canChargeback)&&i.push(new Zt.c("undo",this.i18n.transaction.chargebackTransfer,()=>this.chargeback()));for(const a of(e.transfer||{}).operations||[])i.push(this.operationHelper.headingAction(a,e.transfer.id));return i}get authorizationFields(){return[{internalName:"comments",name:this.i18n.general.comments,type:a.p.TEXT}]}authDeviceConfirmation(e){return()=>({type:a.s.MANAGE_AUTHORIZATION,transaction:this.transaction.id,authorizationAction:e})}authorize(){this.notification.confirm({title:this.i18n.transaction.authorizePending,labelPosition:"above",customFields:this.authorizationFields,passwordInput:this.transaction.confirmationPasswordInput,createDeviceConfirmation:this.authDeviceConfirmation(a.h.AUTHORIZE),callback:e=>{this.addSub(this.pendingPaymentsService.authorizePendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(e=>{e?this.notification.warning(this.i18n.transaction.authorizePendingDoneStillPending):this.notification.snackBar(this.i18n.transaction.authorizePendingDone),this.reload()}))}})}deny(){this.notification.confirm({title:this.i18n.transaction.denyPending,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(a.h.DENY),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.pendingPaymentsService.denyPendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.denyPendingDone)))}})}cancelAuthorization(){this.notification.confirm({title:this.i18n.transaction.cancelAuthorization,labelPosition:"above",customFields:this.authorizationFields,createDeviceConfirmation:this.authDeviceConfirmation(a.h.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.pendingPaymentsService.cancelPendingPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword,body:{comments:e.customValues.comments}}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelAuthorizationDone)))}})}schedDeviceConfirmation(e){return()=>({type:a.s.MANAGE_SCHEDULED_PAYMENT,transaction:this.transaction.id,scheduledPaymentAction:e})}blockScheduled(){this.notification.confirm({title:this.i18n.transaction.blockScheduling,message:this.i18n.transaction.blockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(a.fb.BLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.blockScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.blockSchedulingDone)))}})}unblockScheduled(){this.notification.confirm({title:this.i18n.transaction.unblockScheduling,message:this.i18n.transaction.unblockSchedulingMessage,createDeviceConfirmation:this.schedDeviceConfirmation(a.fb.UNBLOCK),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.unblockScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.unblockSchedulingDone)))}})}cancelScheduled(){this.notification.confirm({title:this.i18n.transaction.cancelScheduled,message:this.i18n.transaction.cancelScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(a.fb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.cancelScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelScheduledDone)))}})}settleScheduled(){this.notification.confirm({title:this.i18n.transaction.settleScheduled,message:this.i18n.transaction.settleScheduledMessage,createDeviceConfirmation:this.schedDeviceConfirmation(a.fb.SETTLE),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.scheduledPaymentsService.settleScheduledPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleScheduledDone)))}})}recurrDeviceConfirmation(e){return()=>({type:a.s.MANAGE_RECURRING_PAYMENT,transaction:this.transaction.id,recurringPaymentAction:e})}cancelRecurring(){this.notification.confirm({title:this.i18n.transaction.cancelRecurring,message:this.i18n.transaction.cancelRecurringMessage,createDeviceConfirmation:this.recurrDeviceConfirmation(a.bb.CANCEL),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.recurringPaymentsService.cancelRecurringPayment({key:this.transaction.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.cancelRecurringDone)))}})}chargebackDeviceConfirmation(){return()=>({type:a.s.CHARGEBACK,transfer:this.transaction.transfer.id})}chargeback(){this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transaction.confirmationPasswordInput,callback:e=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transaction.transfer.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.chargebackTransferDone)))}})}titles(e){switch(e){case a.sb.SCHEDULED_PAYMENT:return[this.i18n.transaction.title.detailsScheduled,this.i18n.transaction.mobileTitle.detailsScheduled];case a.sb.RECURRING_PAYMENT:return[this.i18n.transaction.title.detailsRecurring,this.i18n.transaction.mobileTitle.detailsRecurring];case a.sb.PAYMENT_REQUEST:return[this.i18n.transaction.title.detailsRequest,this.i18n.transaction.mobileTitle.detailsRequest];case a.sb.CHARGEBACK:return[this.i18n.transaction.title.detailsChargeback,this.i18n.transaction.mobileTitle.detailsChargeback];case a.sb.TICKET:return[this.i18n.transaction.title.detailsTicket,this.i18n.transaction.mobileTitle.detailsTicket];case a.sb.EXTERNAL_PAYMENT:return[this.i18n.transaction.title.detailsExternal,this.i18n.transaction.mobileTitle.detailsExternal];default:return[this.i18n.transaction.title.detailsPayment,this.i18n.transaction.mobileTitle.detailsPayment]}}installmentStatus(e){return this.transactionStatusService.installmentStatus(e)}path(e){const t=e.transferTransactionNumber||e.transferId;if(t)return["/banking","transfer",t]}installmentDeviceConfirmation(e,t){return()=>({type:a.s.MANAGE_INSTALLMENT,installment:t.id,installmentAction:e})}settleInstallment(e){this.notification.confirm({title:this.i18n.transaction.settleInstallment,message:this.i18n.transaction.settleInstallmentMessage(String(e.number)),createDeviceConfirmation:this.installmentDeviceConfirmation(a.F.SETTLE,e),passwordInput:this.transaction.confirmationPasswordInput,callback:t=>{this.addSub(this.installmentsService.settleInstallment({key:e.id,confirmationPassword:t.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(this.i18n.transaction.settleInstallmentDone)))}})}isScheduledPayment(){return this.data.kind===a.sb.SCHEDULED_PAYMENT}processInstallment(e){this.notification.confirm({title:this.i18n.transaction.processInstallment,message:this.i18n.transaction.processInstallmentMessage(e.number),createDeviceConfirmation:this.installmentDeviceConfirmation(a.F.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processInstallmentDone)})}processOccurrence(e){this.notification.confirm({title:this.i18n.transaction.processFailedOccurrence,message:this.i18n.transaction.processFailedOccurrenceMessage(e.number),createDeviceConfirmation:this.failedOccurreneceDeviceConfirmation(a.x.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processFailedOccurrenceDone)})}processScheduled(e){this.notification.confirm({title:this.i18n.transaction.processScheduled,message:this.i18n.transaction.processScheduledMessage,createDeviceConfirmation:this.installmentDeviceConfirmation(a.F.PROCESS,e),passwordInput:this.transaction.confirmationPasswordInput,callback:this.processCallback(e.id,this.i18n.transaction.processScheduledDone)})}processCallback(e,t){return n=>this.addSub(this.installmentsService.processInstallment({key:e,confirmationPassword:n.confirmationPassword}).subscribe(()=>this.sendNotificationAndReload(t)))}sendNotificationAndReload(e){this.notification.snackBar(e),this.reload()}failedOccurreneceDeviceConfirmation(e,t){return()=>({type:a.s.MANAGE_FAILED_OCCURRENCE,failedOccurrence:t.id,failedOccurrenceAction:e})}resolveMenu(e){return this.authHelper.accountMenu(e.from,e.to)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.H),d.Nb(i.q),d.Nb(_e.a),d.Nb(Qt.a),d.Nb(Wt.a),d.Nb(Yt.a),d.Nb(i.I),d.Nb(Kt.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["view-transaction"]],features:[d.wb],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["transactionFields",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"transfer",4,"ngIf","ngIfElse"],[3,"transfer"],[3,"label",4,"ngIf"],[3,"label","value"],[3,"label"],[3,"user",4,"ngIf","ngIfElse"],["fromSystem",""],["toSystem",""],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"fieldValue"],["valueFormat","break",3,"label","value"],[1,"border-0","mt-4"],[1,"table","table-hover"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"amount"],["class","actions",4,"ngIf"],[1,"actions"],[3,"ngClass","click"],[3,"link"],[1,"text-right"],["class","actions actions-multiple",4,"ngIf"],[1,"actions","actions-multiple"],["class","btn btn-icon align-items-center",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon align-items-center",3,"tooltip","ngClass","click",4,"ngIf"],[1,"btn","btn-icon","align-items-center",3,"tooltip","click"],["icon","play_circle_outline"],[1,"btn","btn-icon","align-items-center",3,"tooltip","ngClass","click"],["icon","thumb_up"],[1,"table","table-hover","cursor-pointer"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Fn,3,7,"page-content",1),d.Sb(),d.Fc(3,aa,30,35,"ng-template",null,2,d.Gc)),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,m.t,h.a,kn,k.a,m.s,S.a,Xt.a,m.q,Sn.a,Tn.b,zn.a],pipes:[m.b,Lt.a,H.a,j.a],encapsulation:2,changeDetection:0}),e})();var ca=n("4APx");function ra(e,t){1&e&&d.Pb(0)}function oa(e,t){if(1&e&&d.Ob(0,"field-option",24),2&e){const e=t.$implicit;d.kc("id",e.id)("value",e)("text",e.name)}}function sa(e,t){if(1&e&&(d.Tb(0,"div",10),d.Tb(1,"single-selection-field",22),d.Fc(2,oa,1,3,"field-option",23),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.period),d.zb(1),d.kc("ngForOf",e.data.preselectedPeriods)}}function la(e,t){if(1&e&&d.Ob(0,"field-option",27),2&e){const e=t.$implicit,n=d.dc(3);d.kc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function ua(e,t){if(1&e&&(d.Tb(0,"div",10),d.Tb(1,"multi-selection-field",25),d.Fc(2,la,1,5,"field-option",26),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.user.groupFilter),d.zb(1),d.kc("ngForOf",e.data.groups)}}function ba(e,t){if(1&e&&d.Ob(0,"field-option",31),2&e){const e=t.$implicit,n=d.dc(3);d.kc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function da(e,t){if(1&e&&d.Ob(0,"field-option",31),2&e){const e=t.$implicit,n=d.dc(3);d.kc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function fa(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"div",9),d.Tb(2,"div",10),d.Tb(3,"single-selection-field",28),d.Fc(4,ba,1,4,"field-option",29),d.Sb(),d.Sb(),d.Tb(5,"div",10),d.Tb(6,"single-selection-field",30),d.Fc(7,da,1,4,"field-option",29),d.Sb(),d.Sb(),d.Qb()),2&e){const e=d.dc(2);d.zb(3),d.kc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.fromAccount),d.zb(1),d.kc("ngForOf",e.data.accountTypes),d.zb(2),d.kc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.transaction.toAccount),d.zb(1),d.kc("ngForOf",e.data.accountTypes)}}function ma(e,t){if(1&e&&d.Ob(0,"field-option",34),2&e){const e=t.$implicit,n=d.dc(3);d.kc("value",n.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("category",n.singleAccount||null==e.accountType?null:e.accountType.name)}}function ha(e,t){if(1&e&&(d.Tb(0,"div",10),d.Tb(1,"multi-selection-field",32),d.Fc(2,ma,1,5,"field-option",33),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.account.transferFilter),d.zb(1),d.kc("ngForOf",e.filters$.value)}}function pa(e,t){if(1&e&&d.Ob(0,"field-option",37),2&e){const e=t.$implicit;d.kc("id",e.id)("internalName",e.internalName)("value",e.internalName)("text",e.name)}}function ga(e,t){if(1&e&&(d.Tb(0,"div",10),d.Tb(1,"multi-selection-field",35),d.Fc(2,pa,1,4,"field-option",36),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.transaction.channel),d.zb(1),d.kc("ngForOf",e.data.channels)}}function ya(e,t){if(1&e&&(d.Tb(0,"div",10),d.Ob(1,"date-field",38),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.beginDate)}}function va(e,t){if(1&e&&(d.Tb(0,"div",10),d.Ob(1,"date-field",39),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.endDate)}}function ka(e,t){if(1&e&&(d.Tb(0,"div",10),d.Ob(1,"input-field",40),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("mask",e.transactionNumberPattern)("label",e.i18n.transaction.number)}}const Sa=function(e,t){return{from:e,to:t}};function Ta(e,t){if(1&e&&(d.Tb(0,"mobile-result",41),d.Tb(1,"div",42),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.kc("date",e.date)("amount",e.amount)("currency",e.currency),d.zb(2),d.Jc(" ",n.i18n.transaction.fromToText(d.oc(4,Sa,n.bankingHelper.ownerName(e.from),n.bankingHelper.ownerName(e.to))),"")}}function za(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",46),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.path(n))})),d.Tb(2,"td"),d.Tb(3,"a",47),d.Hc(4),d.ec(5,"date"),d.Sb(),d.Sb(),d.Tb(6,"td"),d.Tb(7,"a",47),d.Hc(8),d.Sb(),d.Sb(),d.Tb(9,"td"),d.Tb(10,"a",47),d.Hc(11),d.Sb(),d.Sb(),d.Tb(12,"td",44),d.Tb(13,"a",47),d.Hc(14),d.ec(15,"currency"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",d.fc(5,8,e.date)," "),d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",n.bankingHelper.ownerName(e.from)," "),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",n.bankingHelper.ownerName(e.to)," "),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",d.gc(15,10,n.format.abs(e.amount),e.currency)," ")}}function wa(e,t){if(1&e&&(d.Tb(0,"table",43),d.Tb(1,"thead"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Tb(4,"th"),d.Hc(5),d.Sb(),d.Tb(6,"th"),d.Hc(7),d.Sb(),d.Tb(8,"th",44),d.Hc(9),d.Sb(),d.Sb(),d.Tb(10,"tbody"),d.Fc(11,za,16,13,"ng-container",45),d.ec(12,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(12,5,e.results$))?null:n.results;d.zb(3),d.Ic(e.i18n.general.date),d.zb(2),d.Ic(e.i18n.transaction.from),d.zb(2),d.Ic(e.i18n.transaction.to),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function Fa(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",4),d.ec(1,"async"),d.Tb(2,"form",5),d.Tb(3,"div",6),d.Fc(4,sa,3,2,"div",7),d.Fc(5,ua,3,3,"div",7),d.Fc(6,fa,8,6,"ng-container",8),d.Fc(7,ha,3,3,"div",7),d.ec(8,"async"),d.Fc(9,ga,3,3,"div",7),d.Ob(10,"div",9),d.Fc(11,ya,2,1,"div",7),d.ec(12,"async"),d.Fc(13,va,2,1,"div",7),d.ec(14,"async"),d.Tb(15,"div",10),d.Ob(16,"decimal-field",11),d.Sb(),d.Tb(17,"div",10),d.Ob(18,"decimal-field",12),d.Sb(),d.Tb(19,"div",10),d.Ob(20,"user-field",13),d.Sb(),d.Fc(21,ka,2,2,"div",7),d.Tb(22,"div",10),d.Tb(23,"single-selection-field",14),d.Ob(24,"field-option",15),d.Ob(25,"field-option",16),d.Ob(26,"field-option",17),d.Ob(27,"field-option",18),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(28,"results-layout",19),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(29,"async"),d.Fc(30,Ta,3,7,"mobile-result",20),d.Fc(31,wa,13,7,"table",21),d.Sb()}if(2&e){const e=d.dc();var n;const t=null==(null==(n=e.form.value||d.fc(12,33,e.form.valueChanges))||null==n.preselectedPeriod?null:n.preselectedPeriod.begin);var a;const i=null==(null==(a=e.form.value||d.fc(14,35,e.form.valueChanges))||null==a.preselectedPeriod?null:a.preselectedPeriod.end);d.kc("heading",e.i18n.transaction.title.transfersOverview)("mobileHeading",e.i18n.transaction.mobileTitle.transfersOverview)("headingActions",d.fc(1,29,e.headingActions$)),d.zb(2),d.kc("formGroup",e.form),d.zb(2),d.kc("ngIf",(null==e.data.preselectedPeriods?null:e.data.preselectedPeriods.length)>1),d.zb(1),d.kc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),d.zb(1),d.kc("ngIf",(null==e.data.accountTypes?null:e.data.accountTypes.length)>1),d.zb(1),d.kc("ngIf",d.fc(8,31,e.filters$).length>0),d.zb(2),d.kc("ngIf",(null==e.data.channels?null:e.data.channels.length)>1),d.zb(2),d.kc("ngIf",t),d.zb(2),d.kc("ngIf",i),d.zb(3),d.kc("label",e.i18n.account.minAmount)("scale",e.singleCurrency?e.singleCurrency.decimalDigits:2)("prefix",e.singleCurrency?e.singleCurrency.prefix:null)("suffix",e.singleCurrency?e.singleCurrency.suffix:null),d.zb(2),d.kc("label",e.i18n.account.maxAmount)("scale",e.singleCurrency?e.singleCurrency.decimalDigits:2)("prefix",e.singleCurrency?e.singleCurrency.prefix:null)("suffix",e.singleCurrency?e.singleCurrency.suffix:null),d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("ngIf",e.hasTransactionNumber),d.zb(2),d.kc("label",e.i18n.general.orderBy),d.zb(1),d.kc("text",e.i18n.account.orderBy.dateDesc),d.zb(1),d.kc("text",e.i18n.account.orderBy.dateAsc),d.zb(1),d.kc("text",e.i18n.account.orderBy.amountAsc),d.zb(1),d.kc("text",e.i18n.account.orderBy.amountDesc),d.zb(1),d.kc("results",d.fc(29,37,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}function Ia(e,t){1&e&&d.Ob(0,"spinner",48)}let Oa=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.transfersService=t,this.bankingHelper=n,this.filters$=new u.a([])}get preselectedPeriods(){return null==this.data?null:this.data.preselectedPeriods}get transferFilters(){return null==this.data?null:this.data.transferFilters}getFormControlNames(){return["preselectedPeriod","periodBegin","periodEnd","groups","channels","fromAccountType","toAccountType","transferFilters","transferKinds","chargedBack","minAmount","maxAmount","transactionNumber","user","by","orderBy"]}getInitialFormValue(e){const t=super.getInitialFormValue(e);return t.orderBy=t.orderBy||a.pb.DATE_DESC,t}ngOnInit(){super.ngOnInit(),this.stateManager.cache("data",this.transfersService.getTransferDataForSearch()).subscribe(e=>{this.data=e})}onDataInitialized(e){super.onDataInitialized(e),this.singleCurrency=(e.currencies||[])[0],this.singleAccount=(e.accountTypes||[])[0];const t=(e.currencies||[]).map(e=>e.transactionNumberPattern).filter(e=>e).reduce((e,t)=>e.includes(t)?e:[...e,t],[]);this.hasTransactionNumber=t.length>0,this.transactionNumberPattern=1===t.length?t[0]:null,this.bankingHelper.preProcessPreselectedPeriods(e,this.form),this.addSub(this.form.controls.fromAccountType.valueChanges.subscribe(t=>this.updateFilters(e,t))),this.updateFilters(e),this.headingActions=this.exportHelper.headingActions(e.exportFormats,e=>this.transfersService.exportTransfers$Response(Object.assign({format:e.internalName},this.toSearchParams(this.form.value))))}toSearchParams(e){const t=e;return t.transferFilters=null==e.transferFilter?[]:[e.transferFilter.id],t.datePeriod=this.bankingHelper.resolveDatePeriod(e),t.amountRange=r.a.rangeFilter(e.minAmount,e.maxAmount),t.fields=[],t}doSearch(e){return this.transfersService.searchTransfers$Response(e)}path(e){return["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]}get toLink(){return e=>this.path(e)}updateFilters(e,t){let n=e.transferFilters||[];Object(s.h)(t)||(n=n.filter(e=>e.accountType.id===t)),this.filters$.next(n)}resolveMenu(){return this.dataForUiHolder.role===a.eb.ADMINISTRATOR?l.b.ADMIN_TRANSFERS_OVERVIEW:l.b.BROKER_TRANSFERS_OVERVIEW}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.I),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["search-transfers-overview"]],features:[d.wb],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["loadingIndicators",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],[1,"w-100","d-none","d-sm-block"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label"],["value","dateDesc",3,"text"],["value","dateAsc",3,"text"],["value","amountAsc",3,"text"],["value","amountDesc",3,"text"],["resultType","list",3,"results","toLink","rendering$","update"],["forceSign","",3,"date","amount","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","formControlName","preselectedPeriod",3,"label"],[3,"id","value","text",4,"ngFor","ngForOf"],[3,"id","value","text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"emptyLabel","label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","fromAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","toAccountType",3,"emptyOption","label"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","transferFilters",3,"emptyLabel","label"],[3,"value","internalName","id","text","category",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","category"],["labelPosition","side","formControlName","channels",3,"emptyLabel","label"],[3,"id","internalName","value","text",4,"ngFor","ngForOf"],[3,"id","internalName","value","text"],["labelPosition","side","formControlName","periodBegin","minDate","past5","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past5","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","transactionNumber",3,"mask","label"],["forceSign","",3,"date","amount","currency"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"p-3"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,ra,1,0,"ng-container",1),d.Sb(),d.Fc(3,Fa,32,39,"ng-template",null,2,d.Gc),d.Fc(5,Ia,1,0,"ng-template",null,3,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,v.I,v.w,v.n,F.a,v.v,v.l,I.a,T.a,z.a,p.a,g.a,y.a,m.s,ca.a,w.a,O.a,C.a,B.a,V.h,L.a],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();function Ca(e,t){if(1&e&&(d.Tb(0,"page-content",2),d.ec(1,"async"),d.Ob(2,"transfer-details",3),d.ec(3,"async"),d.Sb()),2&e){const e=d.dc();d.kc("heading",e.i18n.transaction.title.detailsTransfer)("mobileHeading",e.i18n.transaction.mobileTitle.detailsTransfer)("headingActions",d.fc(1,5,e.headingActions$)),d.zb(2),d.kc("headingActions",d.fc(3,7,e.headingActions$))("transfer",e.transfer)}}let Pa=(()=>{class e extends Mt.a{constructor(e,t,n,a){super(e),this.bankingHelper=t,this.transfersService=n,this.operationHelper=a}get transfer(){return this.data}ngOnInit(){super.ngOnInit();const e=this.route.snapshot;this.accountId=e.params.account,this.addSub(this.transfersService.viewTransfer({key:e.params.key}).subscribe(e=>{this.headingActions=this.initActions(e),this.data=e}))}initActions(e){const t=this.exportHelper.headingActions(e.exportFormats,t=>this.transfersService.exportTransfer$Response({format:t.internalName,key:e.id})),n=e.transaction||{};Object(s.h)(n.authorizations)||t.push(new Zt.c("check_circle_outline",this.i18n.transaction.viewAuthorizations,()=>{this.router.navigate(["banking","transaction",this.bankingHelper.transactionNumberOrId(n),"authorization-history"])})),e.canChargeback&&t.push(new Zt.c("undo",this.i18n.transaction.chargebackTransfer,()=>{this.chargeback()}));for(const a of e.operations||[])t.push(this.operationHelper.headingAction(a,e.id));return t}chargebackDeviceConfirmation(){return()=>({type:a.s.CHARGEBACK,transfer:this.transfer.id})}chargeback(){this.notification.confirm({title:this.i18n.transaction.chargebackTransfer,message:this.i18n.transaction.chargebackTransferMessage,createDeviceConfirmation:this.chargebackDeviceConfirmation(),passwordInput:this.transfer.confirmationPasswordInput,callback:e=>{this.addSub(this.transfersService.chargebackTransfer({key:this.transfer.id,confirmationPassword:e.confirmationPassword}).subscribe(()=>{this.notification.snackBar(this.i18n.transaction.chargebackTransferDone),this.reload()}))}})}resolveMenu(e){return this.authHelper.transferMenu(e,this.accountId)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(c.a),d.Nb(i.I),d.Nb(Kt.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["view-transfer"]],features:[d.wb],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"headingActions","transfer"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Ca,4,9,"page-content",1),d.Sb()),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,m.t,h.a,kn],pipes:[m.b],encapsulation:2,changeDetection:0}),e})();var Ha=n("bqp0");function xa(e,t){if(1&e&&d.Ob(0,"user-info",5),2&e){const e=d.dc();d.kc("user",e.user)}}function Da(e,t){if(1&e&&(d.Tb(0,"mobile-result",6),d.Tb(1,"div",7),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit;d.kc("avatarImage",e.image),d.zb(2),d.Jc(" ",e.voucherTitle," ")}}function Na(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",10),d.bc("click",(function(){d.wc(e);const n=t.$implicit;return d.dc(2).selectType(n)})),d.Tb(2,"td",11),d.Ob(3,"avatar",12),d.Sb(),d.Tb(4,"td"),d.Tb(5,"div"),d.Tb(6,"a",13),d.bc("click",(function(){d.wc(e);const n=t.$implicit;return d.dc(2).selectType(n)})),d.Hc(7),d.Sb(),d.Tb(8,"div"),d.Hc(9),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit;d.zb(3),d.kc("image",e.image),d.zb(4),d.Jc(" ",e.voucherTitle," "),d.zb(2),d.Jc(" ",e.voucherDescription," ")}}function Aa(e,t){if(1&e&&(d.Tb(0,"table",8),d.Tb(1,"tbody"),d.Fc(2,Na,10,3,"ng-container",9),d.Sb(),d.Sb()),2&e){const e=d.dc();d.zb(2),d.kc("ngForOf",e.types)}}let $a=(()=>{class e extends P.a{constructor(e){super(e),this.typeSelected=new d.n}get selectType(){return e=>this.typeSelected.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r))},e.\u0275cmp=d.Hb({type:e,selectors:[["buy-vouchers-step-list-types"]],inputs:{types:"types",user:"user"},outputs:{typeSelected:"typeSelected"},features:[d.wb],decls:5,vars:6,consts:[[3,"mode","heading","mobileHeading"],["labelCols","2",3,"user",4,"ngIf"],["resultType","list",3,"results","onClick"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelCols","2",3,"user"],["avatarRoundBorders","false","avatarIcon","user",3,"avatarImage"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar"],["icon","shopping_cart","size","xlarge","roundBorders","false",3,"image"],["ngClass","font-weight-bold",3,"click"]],template:function(e,t){1&e&&(d.Tb(0,"page-content",0),d.Fc(1,xa,1,1,"user-info",1),d.Sb(),d.Tb(2,"results-layout",2),d.Fc(3,Da,3,2,"mobile-result",3),d.Fc(4,Aa,3,1,"table",4),d.Sb()),2&e&&(d.kc("mode",t.user&&!t.authHelper.isSelf(t.user)?"normal":"empty")("heading",t.i18n.voucher.title.buy)("mobileHeading",t.i18n.voucher.mobileTitle.buy),d.zb(1),d.kc("ngIf",t.user&&!t.authHelper.isSelf(t.user)),d.zb(1),d.kc("results",t.types)("onClick",t.selectType))},directives:[h.a,m.t,p.a,g.a,y.a,Ha.a,B.a,m.s,J.a,m.q],encapsulation:2,changeDetection:0}),e})();var Ea=n("Y+zs");function Ra(e,t){if(1&e&&d.Ob(0,"user-info",8),2&e){const e=d.dc();d.kc("user",e.data.user)}}function Ua(e,t){if(1&e&&(d.Tb(0,"label-value",2),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.voucher.buy.minTimeToRedeem),d.zb(1),d.Jc(" ",e.i18n.voucher.buy.minTimeToRedeemAfterBuy(e.format.formatTimeInterval(e.data.minimumTimeToRedeem))," ")}}const Ma=function(e,t){return{min:e,max:t}};function La(e,t){if(1&e&&(d.Ob(0,"label-value",9),d.ec(1,"currency"),d.ec(2,"currency")),2&e){const e=d.dc();d.kc("label",e.i18n.voucher.buy.amountRange)("value",e.format.formatRange(d.oc(8,Ma,d.gc(1,2,e.data.amountRange.min,e.currency),d.gc(2,5,e.data.amountRange.max,e.currency))))}}function Ba(e,t){if(1&e&&d.Ob(0,"custom-field-input",10),2&e){const e=t.$implicit,n=d.dc();d.kc("field",e)("formControl",n.customFieldControlsMap.get(e.internalName))}}let Ja=(()=>{class e extends P.a{constructor(e){super(e)}get currency(){return this.data.account.currency}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r))},e.\u0275cmp=d.Hb({type:e,selectors:[["buy-vouchers-step-form"]],inputs:{data:"data",form:"form",customFieldControlsMap:"customFieldControlsMap"},features:[d.wb],decls:12,vars:17,consts:[[3,"formGroup"],[3,"user",4,"ngIf"],["kind","fieldView",3,"label"],["kind","fieldView",3,"label",4,"ngIf"],["type","number","formControlName","count","required","","fieldSize","small",3,"label"],["formControlName","amount","required","",3,"label","prefix","suffix","scale"],["kind","fieldView",3,"label","value",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],[3,"user"],["kind","fieldView",3,"label","value"],[3,"field","formControl"]],template:function(e,t){1&e&&(d.Rb(0,0),d.Fc(1,Ra,1,1,"user-info",1),d.Tb(2,"label-value",2),d.Hc(3),d.Sb(),d.Tb(4,"label-value",2),d.Hc(5),d.ec(6,"currency"),d.Sb(),d.Fc(7,Ua,2,2,"label-value",3),d.Ob(8,"input-field",4),d.Ob(9,"decimal-field",5),d.Fc(10,La,3,11,"label-value",6),d.Fc(11,Ba,1,2,"custom-field-input",7),d.Qb()),2&e&&(d.kc("formGroup",t.form),d.zb(1),d.kc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),d.zb(1),d.kc("label",t.i18n.voucher.buy.originAccount),d.zb(1),d.Jc(" ",t.data.account.type.name," "),d.zb(1),d.kc("label",t.i18n.account.availableBalance),d.zb(1),d.Jc(" ",d.gc(6,14,t.data.account.status.availableBalance,t.currency)," "),d.zb(2),d.kc("ngIf",t.data.minimumTimeToRedeem),d.zb(1),d.kc("label",t.i18n.voucher.buy.numberOfVouchers),d.zb(1),d.kc("label",t.i18n.voucher.buy.amountPerVoucher)("prefix",t.currency.prefix)("suffix",t.currency.suffix)("scale",t.currency.decimalDigits),d.zb(1),d.kc("ngIf",(null==t.data.amountRange?null:t.data.amountRange.min)||(null==t.data.amountRange?null:t.data.amountRange.max)),d.zb(1),d.kc("ngForOf",t.data.customFields))},directives:[v.w,v.n,m.t,k.a,O.a,v.v,v.l,v.D,F.a,m.s,Ha.a,Ea.a,v.k],pipes:[H.a],encapsulation:2,changeDetection:0}),e})();var Va=n("OTwK"),ja=n("k1dt"),Ga=n("5Wk5"),_a=n("lS/A"),qa=n("bBjs");function Qa(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"user-info",3),d.Qb()),2&e){const e=d.dc();d.zb(1),d.kc("user",e.data.user)}}function Ya(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"label-value",4),d.ec(2,"async"),d.Ob(3,"format-field-value",5,6),d.Sb(),d.Qb()),2&e){const e=t.$implicit,n=d.uc(4),a=d.dc();d.zb(1),d.kc("hidden",!n.hasValue)("label",e.name)("labelPosition",a.labelOnTop(d.fc(2,6,a.layout.ltsm$),e)?"top":"auto"),d.zb(2),d.kc("object",a.buyVoucher)("fields",a.data.customFields)("fieldName",e.internalName)}}function Wa(e,t){1&e&&d.Ob(0,"hr")}function Ka(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Fc(1,Wa,1,0,"hr",0),d.ec(2,"async"),d.Tb(3,"form",7),d.Tb(4,"confirmation-password",8),d.bc("confirmationModeChanged",(function(t){return d.wc(e),d.dc().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return d.wc(e),d.dc().confirmed.emit(t)})),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=d.dc();d.zb(1),d.kc("ngIf",d.fc(2,4,e.layout.gtxxs$)),d.zb(2),d.kc("formGroup",e.form),d.zb(1),d.kc("passwordInput",e.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let Za=(()=>{class e extends P.a{constructor(e){super(e),this.confirmationModeChanged=new d.n,this.confirmed=new d.n}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.createDeviceConfirmation=()=>({type:a.s.BUY_VOUCHERS,amount:this.buyVoucher.amount,voucherType:this.data.type.id,numberOfVouchers:this.buyVoucher.count}),this.confirmationPasswordInput||this.addShortcut(ja.k,()=>this.confirmed.emit())}labelOnTop(e,t){return!!e&&[a.p.RICH_TEXT,a.p.TEXT].includes(t?t.type:null)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r))},e.\u0275cmp=d.Hb({type:e,selectors:[["buy-vouchers-step-confirm"]],inputs:{confirmationPasswordInput:"confirmationPasswordInput",confirmationPassword:"confirmationPassword",buyVoucher:"buyVoucher",data:"data"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[d.wb],decls:10,vars:12,consts:[[4,"ngIf"],[3,"label"],[4,"ngFor","ngForOf"],[3,"user"],[3,"hidden","label","labelPosition"],[3,"object","fields","fieldName"],["formatFieldValue",""],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(d.Fc(0,Qa,2,1,"ng-container",0),d.Tb(1,"label-value",1),d.Hc(2),d.Sb(),d.Tb(3,"label-value",1),d.Hc(4),d.Sb(),d.Tb(5,"label-value",1),d.Hc(6),d.ec(7,"currency"),d.Sb(),d.Fc(8,Ya,5,8,"ng-container",2),d.Fc(9,Ka,5,6,"ng-container",0)),2&e&&(d.kc("ngIf",t.data.user&&!t.authHelper.isSelf(t.data.user)),d.zb(1),d.kc("label",t.i18n.general.type),d.zb(1),d.Jc(" ",t.data.type.voucherTitle,"\n"),d.zb(1),d.kc("label",t.i18n.voucher.buy.numberOfVouchers),d.zb(1),d.Jc(" ",t.buyVoucher.count,"\n"),d.zb(1),d.kc("label",t.i18n.voucher.buy.amountPerVoucher),d.zb(1),d.Jc(" ",d.gc(7,9,t.buyVoucher.amount,t.data.account.currency),"\n"),d.zb(2),d.kc("ngForOf",t.data.customFields),d.zb(1),d.kc("ngIf",t.confirmationPasswordInput))},directives:[m.t,k.a,m.s,Ha.a,Ga.a,v.I,v.w,v.n,_a.a,qa.a,v.v,v.l],pipes:[H.a,m.b],encapsulation:2,changeDetection:0}),e})();function Xa(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"buy-vouchers-step-list-types",4),d.bc("typeSelected",(function(t){return d.wc(e),d.dc().toForm(t)})),d.Sb(),d.Qb()}if(2&e){const e=d.dc();d.zb(1),d.kc("user",e.data.user)("types",e.data.types)}}function ei(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",10),d.bc("click",(function(){return d.wc(e),d.dc(2).backToSelectType()})),d.Hc(1),d.Sb()}if(2&e){const e=d.dc(2);d.zb(1),d.Jc(" ",e.i18n.general.previous," ")}}function ti(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",5),d.ec(1,"async"),d.Ob(2,"buy-vouchers-step-form",6),d.Tb(3,"actions",7),d.Tb(4,"action-button",8),d.bc("action",(function(){return d.wc(e),d.dc().toConfirm()})),d.ec(5,"async"),d.Sb(),d.Fc(6,ei,2,1,"button",9),d.Sb(),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.dataTypeForBuy.type.voucherTitle)("mobileHeading",e.dataTypeForBuy.type.voucherTitle)("mode",d.fc(1,9,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("data",e.dataTypeForBuy)("form",e.form)("customFieldControlsMap",e.customFieldControlsMap),d.zb(2),d.kc("disabled",d.fc(5,11,e.requesting$))("label",e.i18n.general.next),d.zb(2),d.kc("ngIf",!e.singleType)}}function ni(e,t){if(1&e){const e=d.Ub();d.Tb(0,"action-button",8),d.bc("action",(function(){return d.wc(e),d.dc(2).buy()})),d.ec(1,"async"),d.Sb()}if(2&e){const e=d.dc(2);d.kc("disabled",!e.canConfirm||d.fc(1,2,e.requesting$))("label",e.i18n.general.confirm)}}function ai(e,t){1&e&&d.Hc(0,"\xa0")}function ii(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",5),d.ec(1,"async"),d.Tb(2,"buy-vouchers-step-confirm",11),d.bc("confirmationModeChanged",(function(t){return d.wc(e),d.dc().confirmationMode$.next(t)}))("confirmed",(function(t){return d.wc(e),d.dc().buy(t)})),d.Sb(),d.Tb(3,"actions",7),d.Fc(4,ni,2,4,"action-button",12),d.ec(5,"async"),d.Fc(6,ai,1,0,"ng-template",null,13,d.Gc),d.Tb(8,"button",10),d.bc("click",(function(){return d.wc(e),d.dc().backToForm()})),d.Hc(9),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.uc(7),t=d.dc();d.kc("heading",t.i18n.voucher.title.buyConfirmation)("mobileHeading",t.i18n.voucher.mobileTitle.buyConfirmation)("mode",d.fc(1,10,t.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("buyVoucher",t.form.value)("data",t.dataTypeForBuy)("confirmationPasswordInput",t.dataTypeForBuy.confirmationPasswordInput)("confirmationPassword",t.confirmationPassword),d.zb(2),d.kc("ngIf",d.fc(5,12,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),d.zb(5),d.Jc(" ",t.i18n.general.previous," ")}}function ci(e,t){1&e&&(d.Tb(0,"page-content"),d.Ob(1,"spinner"),d.Sb())}let ri=(()=>{class e extends Te.a{constructor(e,t){super(e),this.voucherService=t,this.ConfirmationMode=ze.a,this.step$=new u.a(null),this.singleType=!1,this.confirmationMode$=new u.a(null)}get step(){return this.step$.value}set step(e){this.step$.next(e)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.user=this.authHelper.isSelf(e.user)?this.ApiHelper.SELF:e.user,this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user}).subscribe(e=>this.data=e))}onDataInitialized(e){const t=e.types||[];1===t.length?(this.singleType=!0,this.toForm(t[0])):this.step="select-type"}get currency(){return this.dataTypeForBuy.account.currency}buy(e){if(e&&this.confirmationPassword.setValue(e),this.confirmationPasswordInput&&!Object(s.F)(this.confirmationPassword))return;const t=this.form.value;t.type=this.dataTypeForBuy.type.id,this.addSub(this.voucherService.buyVouchers({user:this.user,confirmationPassword:this.confirmationPasswordInput?this.confirmationPassword.value:null,body:t}).subscribe(e=>{this.router.navigate(1===e.length?["banking","vouchers",e[0]]:["banking",this.user,"vouchers","bought"]),this.notification.snackBar(this.i18n.voucher.buy.done)}))}backToSelectType(){this.step="select-type"}backToForm(){this.step="form"}toForm(e){this.addSub(this.voucherService.getVoucherDataForBuy({user:this.user,type:e.id}).subscribe(e=>{this.dataTypeForBuy=e,this.buildForm(),this.step="form"}))}toConfirm(){Object(s.F)(this.form)&&(this.canConfirm=this.authHelper.canConfirm(this.confirmationPasswordInput),this.canConfirm?(this.confirmationPasswordInput&&(this.confirmationPassword?this.confirmationPassword.reset():(this.confirmationPassword=this.formBuilder.control(null),this.confirmationPassword.setValidators(v.G.required))),this.step="confirm"):this.notification.warning(this.authHelper.getConfirmationMessage(this.confirmationPasswordInput)))}get confirmationPasswordInput(){return this.dataTypeForBuy.confirmationPasswordInput}buildForm(){if(this.form)this.form.reset();else if(this.customFieldControlsMap=this.fieldHelper.customValuesFormControlMap(this.dataTypeForBuy.customFields),this.form=this.formBuilder.group({count:new v.j(""),amount:new v.j("")}),this.customFieldControlsMap.size>0){const e=new v.m({});for(const t of this.customFieldControlsMap)e.addControl(t[0],t[1]);this.form.setControl("customValues",e)}this.form.get("count").setValue(1)}resolveMenu(e){return this.authHelper.userMenu(e.user,l.b.BUY_VOUCHER)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.M))},e.\u0275cmp=d.Hb({type:e,selectors:[["buy-vouchers"]],features:[d.wb],decls:7,vars:9,consts:[[3,"ready","ngSwitch"],[4,"ngSwitchCase"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"user","types","typeSelected"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1",3,"data","form","customFieldControlsMap"],["forceRow",""],[3,"disabled","label","action"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary",3,"click"],[1,"flex-grow-1",3,"buyVoucher","data","confirmationPasswordInput","confirmationPassword","confirmationModeChanged","confirmed"],[3,"disabled","label","action",4,"ngIf","ngIfElse"],["spacer",""]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.ec(2,"async"),d.Fc(3,Xa,2,2,"ng-container",1),d.Fc(4,ti,7,13,"page-content",2),d.Fc(5,ii,10,14,"page-content",2),d.Fc(6,ci,2,0,"page-content",3),d.Sb()),2&e&&(d.kc("ready",d.fc(1,5,t.data$))("ngSwitch",d.fc(2,7,t.step$)),d.zb(3),d.kc("ngSwitchCase","select-type"),d.zb(1),d.kc("ngSwitchCase","form"),d.zb(1),d.kc("ngSwitchCase","confirm"))},directives:[f.a,m.x,m.y,m.z,$a,h.a,Ja,en.a,Va.a,m.t,Za,L.a],pipes:[m.b],encapsulation:2,changeDetection:0}),e})();var oi=n("5pUo"),si=n("LqlI"),li=n("pBnU"),ui=n("cvAk");const bi=["inputField"];function di(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",14,15),d.bc("click",(function(){return d.wc(e),d.dc(3).showScanQrCode()})),d.Ob(2,"icon",16),d.Sb()}if(2&e){const e=d.dc(3);d.kc("tooltip",e.i18n.field.user.scanQrCodeTooltip)}}function fi(e,t){if(1&e){const e=d.Ub();d.Tb(0,"div"),d.Pb(1,6),d.Tb(2,"div",7),d.Tb(3,"div",8),d.Tb(4,"label-value",9),d.Ob(5,"input-field",10,11),d.Fc(7,di,3,1,"button",12),d.Sb(),d.Sb(),d.Sb(),d.Tb(8,"actions"),d.Tb(9,"action-button",13),d.bc("action",(function(){return d.wc(e),d.dc(2).submit()})),d.ec(10,"async"),d.Sb(),d.Sb(),d.Sb()}if(2&e){const e=d.dc(2),t=d.uc(6);d.zb(1),d.kc("ngTemplateOutlet",t),d.zb(3),d.kc("label",e.i18n.voucher.token),d.zb(1),d.kc("mask",e.mask)("formControl",e.token)("placeholder",e.mask),d.zb(4),d.kc("disabled",d.fc(10,7,e.requesting$))("label",e.i18n.general.submit)}}function mi(e,t){if(1&e&&(d.Tb(0,"page-content",4),d.ec(1,"async"),d.Fc(2,fi,11,9,"div",5),d.ec(3,"async"),d.Sb()),2&e){const e=d.dc(),t=d.uc(8);d.kc("heading",e.i18n.voucher.title.redeem)("mobileHeading",e.i18n.voucher.mobileTitle.redeem)("mode",d.fc(1,5,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("ngIf",d.fc(3,7,e.data$))("ngIfElse",t)}}const hi=function(e){return{"flex-grow-1":e}};function pi(e,t){if(1&e&&(d.Tb(0,"div",27),d.Ob(1,"avatar",28),d.Sb()),2&e){const e=d.dc(3);d.kc("ngClass",d.nc(2,hi,!e.dataForRedeem.type.voucherDescription)),d.zb(1),d.kc("image",e.dataForRedeem.type.image)}}function gi(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",29),d.Hc(2),d.Sb(),d.Qb()),2&e){const e=d.dc(3);d.zb(2),d.Jc("",e.dataForRedeem.type.voucherDescription," ")}}function yi(e,t){if(1&e&&(d.Tb(0,"label-value",23),d.Ob(1,"user-link",30),d.Sb()),2&e){const e=d.dc(3);d.kc("label",e.i18n.voucher.buy.buyer),d.zb(1),d.kc("user",e.dataForRedeem.buyer)}}function vi(e,t){if(1&e&&d.Ob(0,"custom-field-input",31),2&e){const e=t.$implicit,n=d.dc(3);d.kc("field",e)("formControl",n.form.get(e.internalName))}}const ki=function(e){return{"d-flex flex-row-reverse justify-content-between":e}};function Si(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Pb(1,6),d.Tb(2,"notification",17),d.Hc(3),d.Sb(),d.Tb(4,"div",18),d.Tb(5,"div",19),d.ec(6,"async"),d.Fc(7,pi,2,4,"div",20),d.Fc(8,gi,3,1,"ng-container",21),d.Sb(),d.Ob(9,"hr",22),d.Tb(10,"label-value",23),d.Hc(11),d.Sb(),d.Tb(12,"label-value",23),d.Hc(13),d.Sb(),d.Fc(14,yi,2,2,"label-value",24),d.Tb(15,"label-value",23),d.Hc(16),d.ec(17,"currency"),d.Sb(),d.Fc(18,vi,1,2,"custom-field-input",25),d.Sb(),d.Tb(19,"actions"),d.Tb(20,"action-button",13),d.bc("action",(function(){return d.wc(e),d.dc(2).submit()})),d.ec(21,"async"),d.Sb(),d.Tb(22,"button",26),d.bc("click",(function(){return d.wc(e),d.dc(2).backToForm()})),d.Hc(23),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=d.dc(2),t=d.uc(6);d.zb(1),d.kc("ngTemplateOutlet",t),d.zb(2),d.Jc(" ",e.i18n.voucher.redeem.confirm," "),d.zb(2),d.kc("ngClass",d.nc(23,ki,d.fc(6,16,e.layout.gtsm$)&&e.dataForRedeem.type.image)),d.zb(2),d.kc("ngIf",e.dataForRedeem.type.image),d.zb(1),d.kc("ngIf",e.dataForRedeem.type.voucherDescription),d.zb(2),d.kc("label",e.i18n.general.type),d.zb(1),d.Jc(" ",e.dataForRedeem.type.name," "),d.zb(1),d.kc("label",e.i18n.voucher.token),d.zb(1),d.Jc(" ",e.dataForRedeem.token," "),d.zb(1),d.kc("ngIf",e.dataForRedeem.buyer),d.zb(1),d.kc("label",e.i18n.transaction.amount),d.zb(1),d.Jc(" ",d.gc(17,18,e.dataForRedeem.amount,e.dataForRedeem.type.configuration.currency)," "),d.zb(2),d.kc("ngForOf",e.dataForRedeem.customFields),d.zb(2),d.kc("disabled",d.fc(21,21,e.requesting$))("label",e.i18n.general.submit),d.zb(3),d.Jc(" ",e.i18n.general.previous," ")}}function Ti(e,t){if(1&e&&(d.Tb(0,"page-content",4),d.ec(1,"async"),d.Fc(2,Si,24,25,"ng-container",5),d.ec(3,"async"),d.Sb()),2&e){const e=d.dc(),t=d.uc(8);d.kc("heading",e.i18n.voucher.title.redeem)("mobileHeading",e.i18n.voucher.mobileTitle.redeem)("mode",d.fc(1,5,e.layout.ltsm$)?"fullHeight":"normal"),d.zb(2),d.kc("ngIf",d.fc(3,7,e.dataForRedeem$))("ngIfElse",t)}}function zi(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"user-info",30),d.Ob(2,"hr"),d.Qb()),2&e){const e=d.dc(2);d.zb(1),d.kc("user",e.data.user)}}function wi(e,t){if(1&e&&d.Fc(0,zi,3,1,"ng-container",21),2&e){const e=d.dc();d.kc("ngIf",!e.self)}}function Fi(e,t){1&e&&(d.Tb(0,"page-content"),d.Ob(1,"spinner"),d.Sb())}let Ii=(()=>{class e extends Te.a{constructor(e,t,n){super(e),this.voucherService=t,this.modal=n,this.step$=new u.a(null),this.token=new v.j("",v.G.required),this.mask="",this.dataForRedeem$=new u.a(null)}get dataForRedeem(){return this.dataForRedeem$.value}set dataForRedeem(e){this.dataForRedeem$.next(e)}get step(){return this.step$.value}set step(e){this.step$.next(e)}submit(){if("form"===this.step){if(!Object(s.F)(this.token))return;this.addSub(this.voucherService.getVoucherDataForRedeem({user:this.userId,token:this.token.value}).subscribe(e=>{this.dataForRedeem=e,this.form=this.fieldHelper.customValuesFormGroup(this.dataForRedeem.customFields),this.step="confirm"}))}else this.addSub(this.voucherService.redeemVoucher({user:this.userId,token:this.token.value,body:{customValues:this.form.value}}).subscribe(e=>{this.router.navigate(["banking","vouchers",e.voucherId]),this.notification.info(this.i18n.voucher.redeem.done)}))}backToForm(){this.step="form"}ngOnInit(){super.ngOnInit(),this.userId=this.route.snapshot.paramMap.get("user"),this.addSub(this.voucherService.getVoucherInitialDataForRedeem({user:this.userId}).subscribe(e=>{this.data=e,this.mask=this.data.mask?this.data.mask:"",this.self=this.authHelper.isSelf(e.user)})),this.step="form"}reload(){this.step="form",super.reload()}resolveMenu(e){return this.authHelper.userMenu(e.user,l.b.REDEEM_VOUCHER)}showScanQrCode(){this.modal.show(oi.a,{class:"modal-form"}).content.select.pipe(Object(Fe.a)()).subscribe(e=>{this.token.setValue(e),this.submit()}),this.modal.onHide.pipe(Object(Fe.a)()).subscribe(()=>Object(s.j)(this.inputField,!0))}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.M),d.Nb(si.b))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-redeem-voucher"]],viewQuery:function(e,t){var n;1&e&&d.Lc(bi,!0),2&e&&d.tc(n=d.cc())&&(t.inputField=n.first)},features:[d.wb],decls:9,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],["active_user",""],["loading",""],[3,"heading","mobileHeading","mode"],[4,"ngIf","ngIfElse"],[3,"ngTemplateOutlet"],[1,"d-flex","flex-grow-1"],[1,"flex-grow-1"],["kind","field",3,"label"],["type","text","focused","","required","",3,"mask","formControl","placeholder"],["inputField",""],["class","btn btn-icon",3,"tooltip","click",4,"extraCell"],[3,"disabled","label","action"],[1,"btn","btn-icon",3,"tooltip","click"],["scanQrCodeButton",""],["icon","scan_qr_code"],["ngClass","mb-3","type","warning"],[1,"d-flex","flex-grow-1","flex-column"],[3,"ngClass"],["class","image d-flex justify-content-center mt-2 mb-4",3,"ngClass",4,"ngIf"],[4,"ngIf"],[1,"mt-3"],[3,"label"],[3,"label",4,"ngIf"],[3,"field","formControl",4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary",3,"click"],[1,"image","d-flex","justify-content-center","mt-2","mb-4",3,"ngClass"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"break-nl"],[3,"user"],[3,"field","formControl"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.ec(2,"async"),d.Fc(3,mi,4,9,"page-content",1),d.Fc(4,Ti,4,9,"page-content",1),d.Sb(),d.Fc(5,wi,1,1,"ng-template",null,2,d.Gc),d.Fc(7,Fi,2,0,"ng-template",null,3,d.Gc)),2&e&&(d.kc("ready",d.fc(1,4,t.data$))("ngSwitch",d.fc(2,6,t.step$)),d.zb(3),d.kc("ngSwitchCase","form"),d.zb(1),d.kc("ngSwitchCase","confirm"))},directives:[f.a,m.x,m.y,h.a,m.t,m.A,k.a,O.a,qa.a,v.D,C.a,v.v,v.k,li.a,en.a,Va.a,Tn.b,zn.a,ui.a,m.q,m.s,J.a,S.a,Ea.a,Ha.a,L.a],pipes:[m.b,H.a],encapsulation:2,changeDetection:0}),e})();function Oi(e,t){1&e&&d.Pb(0)}function Ci(e,t){1&e&&d.Ob(0,"div",7)}function Pi(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",7),d.Tb(2,"label-value",14),d.Ob(3,"user-link",15),d.Sb(),d.Sb(),d.Fc(4,Ci,1,0,"div",16),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("user",e.data.user),d.zb(1),d.kc("ngIf",e.layout.gtsm$)}}function Hi(e,t){if(1&e&&d.Ob(0,"field-option",17),2&e){const e=t.$implicit;d.kc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function xi(e,t){if(1&e&&(d.Tb(0,"mobile-result",18),d.Tb(1,"div",19),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit;d.kc("date",e.creationDate)("amount",e.amount)("amountColor",!1)("currency",e.type.configuration.currency),d.zb(2),d.Jc(" ",e.type.name," ")}}function Di(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",23),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.path(n))})),d.Tb(2,"td"),d.Tb(3,"a",24),d.Hc(4),d.ec(5,"date"),d.Sb(),d.Sb(),d.Tb(6,"td"),d.Tb(7,"a",24),d.Hc(8),d.ec(9,"date"),d.Sb(),d.Sb(),d.Tb(10,"td"),d.Tb(11,"a",24),d.Hc(12),d.Sb(),d.Sb(),d.Tb(13,"td"),d.Tb(14,"a",24),d.Hc(15),d.Sb(),d.Sb(),d.Tb(16,"td",21),d.Tb(17,"a",24),d.Hc(18),d.ec(19,"currency"),d.Sb(),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Ic(d.fc(5,10,e.creationDate)),d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Ic(d.fc(9,12,e.expirationDate)),d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Ic(n.voucherStatus(e.status)),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Ic(e.type.name),d.zb(2),d.kc("routerLink",n.path(e)),d.zb(1),d.Ic(d.gc(19,14,e.amount,e.type.configuration.currency))}}function Ni(e,t){if(1&e&&(d.Tb(0,"table",20),d.Tb(1,"tbody"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Tb(4,"th"),d.Hc(5),d.Sb(),d.Tb(6,"th"),d.Hc(7),d.Sb(),d.Tb(8,"th"),d.Hc(9),d.Sb(),d.Tb(10,"th",21),d.Hc(11),d.Sb(),d.Fc(12,Di,20,17,"ng-container",22),d.ec(13,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(13,6,e.results$))?null:n.results;d.zb(3),d.Ic(e.i18n.general.creationDate),d.zb(2),d.Ic(e.i18n.general.expirationDate),d.zb(2),d.Ic(e.i18n.general.status),d.zb(2),d.Ic(e.i18n.general.type),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(1),d.kc("ngForOf",t)}}function Ai(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",3),d.Tb(1,"form",4),d.Tb(2,"div",5),d.Fc(3,Pi,5,3,"ng-container",6),d.Tb(4,"div",7),d.Tb(5,"multi-selection-field",8),d.Fc(6,Hi,1,4,"field-option",9),d.Sb(),d.Sb(),d.Tb(7,"div",7),d.Ob(8,"multi-selection-field",10),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(9,"results-layout",11),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(10,"async"),d.Fc(11,xi,3,5,"mobile-result",12),d.Fc(12,Ni,14,8,"table",13),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.i18n.voucher.title.searchBought)("mobileHeading",e.i18n.voucher.mobileTitle.bought),d.zb(1),d.kc("formGroup",e.form),d.zb(2),d.kc("ngIf",e.data.user&&!e.self),d.zb(2),d.kc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.type),d.zb(1),d.kc("ngForOf",e.data.types),d.zb(2),d.kc("emptyLabel",e.i18n.general.notApplied)("label",e.i18n.general.status)("fieldOptions",e.statusOptions),d.zb(1),d.kc("results",d.fc(10,13,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}let $i=(()=>{class e extends o.a{constructor(e,t){super(e),this.vouchersService=t}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.params;this.self=this.authHelper.isSelf(e.user),this.user=this.self?this.ApiHelper.SELF:e.user,this.addSub(this.vouchersService.getUserVouchersDataForSearch({user:this.user,relation:a.Kb.BOUGHT}).subscribe(e=>{this.form.patchValue(e.query),this.data=e}))}get statusOptions(){return Object.values(a.Lb).map(e=>({value:e,text:this.voucherStatus(e)}))}getFormControlNames(){return["types","statuses"]}toSearchParams(e){const t=Object(we.cloneDeep)(e);return t.user=this.user,t}doSearch(e){return this.vouchersService.searchUserVouchers$Response(e)}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/",e.id]}voucherStatus(e){switch(e){case a.Lb.CANCELED:return this.i18n.voucher.status.canceled;case a.Lb.EXPIRED:return this.i18n.voucher.status.expired;case a.Lb.OPEN:return this.i18n.voucher.status.open;case a.Lb.PENDING:return this.i18n.voucher.status.pending;case a.Lb.REDEEMED:return this.i18n.voucher.status.redeemed}}resolveMenu(e){return this.authHelper.userMenu(e.user,l.b.SEARCH_BOUGHT_VOUCHERS)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.M))},e.\u0275cmp=d.Hb({type:e,selectors:[["search-bought-vouchers"]],features:[d.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],[4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","types",3,"emptyLabel","label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["resultType","list",3,"results","rendering$","toLink","update"],[3,"date","amount","amountColor","currency",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[3,"value","internalName","id","text"],[3,"date","amount","amountColor","currency"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Oi,1,0,"ng-container",1),d.Sb(),d.Fc(3,Ai,13,15,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,v.I,v.w,v.n,ca.a,v.v,v.l,m.s,p.a,g.a,y.a,k.a,S.a,z.a,B.a,V.h],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();function Ei(e,t){1&e&&d.Pb(0)}function Ri(e,t){1&e&&d.Ob(0,"div",9)}function Ui(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",9),d.Tb(2,"label-value",15),d.Ob(3,"user-link",16),d.Sb(),d.Sb(),d.Fc(4,Ri,1,0,"div",7),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.kc("label",e.i18n.general.user),d.zb(1),d.kc("user",e.data.user),d.zb(1),d.kc("ngIf",e.layout.gtsm$)}}function Mi(e,t){if(1&e&&d.Ob(0,"field-option",19),2&e){const e=t.$implicit;d.kc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Li(e,t){if(1&e&&(d.Tb(0,"div",9),d.Tb(1,"multi-selection-field",17),d.Fc(2,Mi,1,4,"field-option",18),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.general.type),d.zb(1),d.kc("ngForOf",e.data.types)}}function Bi(e,t){if(1&e&&d.Ob(0,"field-option",22),2&e){const e=t.$implicit;d.kc("value",e.id)("id",e.id)("text",e.display)}}function Ji(e,t){if(1&e&&(d.Tb(0,"div",9),d.Tb(1,"single-selection-field",20),d.Fc(2,Bi,1,3,"field-option",21),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("emptyOption",e.i18n.general.notApplied)("label",e.i18n.general.operator),d.zb(1),d.kc("ngForOf",e.data.operators)}}function Vi(e,t){if(1&e&&(d.Tb(0,"mobile-result",23),d.Tb(1,"div",24),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=t.$implicit;d.kc("date",e.redeemDate)("amount",e.amount)("currency",e.type.configuration.currency)("amountColor",!1),d.zb(2),d.Jc(" ",e.type.name," ")}}function ji(e,t){if(1&e&&(d.Tb(0,"th"),d.Hc(1),d.Sb()),2&e){const e=d.dc(3);d.zb(1),d.Ic(e.i18n.general.operator)}}function Gi(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.Qb()),2&e){const e=d.dc(2).$implicit;d.zb(1),d.Jc(" ",null!=e.redeemBy&&e.redeemBy.user?e.redeemBy.display:""," ")}}function _i(e,t){if(1&e&&(d.Tb(0,"td"),d.Fc(1,Gi,2,1,"ng-container",6),d.Sb()),2&e){const e=d.dc().$implicit;d.zb(1),d.kc("ngIf",e.redeemBy)}}function qi(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",28),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.path(n))})),d.Tb(2,"td"),d.Tb(3,"a",29),d.Hc(4),d.ec(5,"date"),d.Sb(),d.Sb(),d.Fc(6,_i,2,1,"td",6),d.Tb(7,"td"),d.Hc(8),d.Sb(),d.Tb(9,"td",26),d.Hc(10),d.ec(11,"currency"),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.kc("routerLink",n.path(e)),d.zb(1),d.Jc(" ",d.fc(5,5,e.redeemDate)," "),d.zb(2),d.kc("ngIf",n.data.operators.length>0),d.zb(2),d.Jc(" ",e.type.name," "),d.zb(2),d.Jc(" ",d.gc(11,7,e.amount,e.type.configuration.currency)," ")}}function Qi(e,t){if(1&e&&(d.Tb(0,"table",25),d.Tb(1,"thead"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Fc(4,ji,2,1,"th",6),d.Tb(5,"th"),d.Hc(6),d.Sb(),d.Tb(7,"th",26),d.Hc(8),d.Sb(),d.Sb(),d.Tb(9,"tbody"),d.Fc(10,qi,12,10,"ng-container",27),d.ec(11,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(11,5,e.results$))?null:n.results;d.zb(3),d.Ic(e.i18n.voucher.redeem.date),d.zb(1),d.kc("ngIf",e.data.operators.length>0),d.zb(2),d.Ic(e.i18n.general.type),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function Yi(e,t){if(1&e){const e=d.Ub();d.Tb(0,"page-content",3),d.Tb(1,"form",4),d.Tb(2,"div",5),d.Fc(3,Ui,5,3,"ng-container",6),d.Fc(4,Li,3,2,"div",7),d.Fc(5,Ji,3,3,"div",7),d.Tb(6,"div",8),d.Tb(7,"div",9),d.Ob(8,"date-field",10),d.Sb(),d.Tb(9,"div",9),d.Ob(10,"date-field",11),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Tb(11,"results-layout",12),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(12,"async"),d.Fc(13,Vi,3,5,"mobile-result",13),d.Fc(14,Qi,12,7,"table",14),d.Sb()}if(2&e){const e=d.dc();d.kc("heading",e.i18n.voucher.title.redeemed)("mobileHeading",e.i18n.voucher.mobileTitle.redeemed),d.zb(1),d.kc("formGroup",e.form),d.zb(2),d.kc("ngIf",e.data.user&&!e.self),d.zb(1),d.kc("ngIf",(null==e.data.types?null:e.data.types.length)>1),d.zb(1),d.kc("ngIf",(null==e.data.operators?null:e.data.operators.length)>0),d.zb(3),d.kc("label",e.i18n.general.beginDate),d.zb(2),d.kc("label",e.i18n.general.endDate),d.zb(1),d.kc("results",d.fc(12,11,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let Wi=(()=>{class e extends o.a{constructor(e,t){super(e),this.voucherService=t}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("user");this.addSub(this.voucherService.getUserVouchersDataForSearch({user:e,relation:a.Kb.REDEEMED}).subscribe(e=>{this.data=e,this.self=this.authHelper.isSelf(e.user)}))}getFormControlNames(){return["types","periodBegin","periodEnd","operator"]}toSearchParams(e){const t=e;return t.user=this.route.snapshot.paramMap.get("user"),t.relation=a.Kb.REDEEMED,t.redeemBy=e.operator,(e.periodBegin||e.periodEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.periodBegin,e.periodEnd)),t}doSearch(e){return this.voucherService.searchUserVouchers$Response(e)}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/",e.id]}resolveMenu(e){return this.authHelper.userMenu(e.user,l.b.SEARCH_REDEEMED)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.M))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-search-redeemed-vouchers"]],features:[d.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row","no-gutters"],[4,"ngIf"],["class","col-12 col-md-6",4,"ngIf"],[1,"row","no-gutters","col-12"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["resultType","list",3,"results","toLink","rendering$","update"],[3,"date","amount","currency","amountColor",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","operator",3,"emptyOption","label"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],[3,"date","amount","currency","amountColor"],[1,"cell-text","cell-main"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Ei,1,0,"ng-container",1),d.Sb(),d.Fc(3,Yi,15,13,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,h.a,v.I,v.w,v.n,w.a,v.v,v.l,p.a,g.a,y.a,k.a,S.a,ca.a,m.s,z.a,T.a,B.a,V.h],pipes:[m.b,j.a,H.a],encapsulation:2,changeDetection:0}),e})();var Ki=n("wR2l");function Zi(e,t){if(1&e&&d.Ob(0,"field-option",15),2&e){const e=t.$implicit;d.kc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)}}function Xi(e,t){if(1&e&&(d.Tb(0,"div",4),d.Tb(1,"multi-selection-field",13),d.Fc(2,Zi,1,4,"field-option",14),d.Sb(),d.Sb()),2&e){const e=d.dc();d.zb(1),d.kc("label",e.i18n.general.type),d.zb(1),d.kc("ngForOf",e.data.types)}}function ec(e,t){if(1&e&&d.Ob(0,"field-option",31),2&e){const e=t.$implicit;d.kc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function tc(e,t){if(1&e&&(d.Tb(0,"div",4),d.Tb(1,"multi-selection-field",29),d.Fc(2,ec,1,5,"field-option",30),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.voucher.buyerGroups),d.zb(1),d.kc("ngForOf",e.data.userGroups)}}function nc(e,t){if(1&e&&d.Ob(0,"field-option",31),2&e){const e=t.$implicit;d.kc("value",e.id)("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function ac(e,t){if(1&e&&(d.Tb(0,"div",4),d.Tb(1,"multi-selection-field",32),d.Fc(2,nc,1,5,"field-option",30),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("label",e.i18n.voucher.redeemerGroups),d.zb(1),d.kc("ngForOf",e.data.userGroups)}}function ic(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",16),d.Tb(2,"div",4),d.Ob(3,"date-field",17),d.Sb(),d.Tb(4,"div",4),d.Ob(5,"date-field",18),d.Sb(),d.Sb(),d.Tb(6,"div",16),d.Tb(7,"div",4),d.Ob(8,"date-field",19),d.Sb(),d.Tb(9,"div",4),d.Ob(10,"date-field",20),d.Sb(),d.Sb(),d.Tb(11,"div",16),d.Tb(12,"div",4),d.Ob(13,"date-field",21),d.Sb(),d.Tb(14,"div",4),d.Ob(15,"date-field",22),d.Sb(),d.Sb(),d.Tb(16,"div",16),d.Tb(17,"div",4),d.Ob(18,"decimal-field",23,24),d.Sb(),d.Tb(20,"div",4),d.Ob(21,"decimal-field",25,24),d.Sb(),d.Sb(),d.Fc(23,tc,3,2,"div",3),d.Tb(24,"div",4),d.Tb(25,"label-value",26),d.Ob(26,"user-field",27),d.Sb(),d.Sb(),d.Fc(27,ac,3,2,"div",3),d.Tb(28,"div",4),d.Tb(29,"label-value",26),d.Ob(30,"user-field",28),d.Sb(),d.Sb(),d.Qb()),2&e){const e=d.dc();d.zb(3),d.kc("label",e.i18n.general.creationDate),d.zb(2),d.kc("label",e.i18n.general.to),d.zb(3),d.kc("label",e.i18n.general.expirationDate),d.zb(2),d.kc("label",e.i18n.general.to),d.zb(3),d.kc("label",e.i18n.voucher.redeem.date),d.zb(2),d.kc("label",e.i18n.general.to),d.zb(3),d.kc("label",e.i18n.transaction.amount)("scale",e.maxScale),d.zb(3),d.kc("label",e.i18n.general.to)("scale",e.maxScale),d.zb(2),d.kc("ngIf",(null==e.data.userGroups?null:e.data.userGroups.length)>1),d.zb(2),d.kc("label",e.i18n.voucher.buy.buyer),d.zb(1),d.kc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1),d.zb(1),d.kc("ngIf",(null==e.data.userGroups?null:e.data.userGroups.length)>1),d.zb(2),d.kc("label",e.i18n.voucher.redeem.redeemer),d.zb(1),d.kc("autoSearch",!0)("allowContacts",!0)("allowSearch",!0)("allowPrincipal",!1)}}function cc(e,t){if(1&e&&d.Ob(0,"field-option",9),2&e){const e=t.$implicit,n=d.dc();d.kc("value",e)("text",n.orderBy(e))}}let rc=(()=>{class e extends P.a{constructor(e,t){super(e),this.bankingHelper=t}ngOnInit(){super.ngOnInit(),this.mask=this.data.mask?this.data.mask:"",this.form.patchValue({creationType:"all",printed:"all"})}get statusOptions(){return Object.values(a.Lb).map(e=>({value:e,text:this.bankingHelper.voucherStatus(e)}))}get creationTypeOptions(){const e=Object.values(a.Ib);return[{value:"all",text:this.i18n.general.all}].concat(e.map(e=>({value:e,text:this.bankingHelper.voucherCreationType(e)})))}get maxScale(){return this.data.types.map(e=>e.configuration.currency.decimalDigits).reduce((e,t,n,a)=>e>t?e:t)}orderByOptions(){return Object.values(a.Jb)}orderBy(e){switch(e){case a.Jb.CREATION_DATE_ASC:return this.i18n.voucher.sort.creationDateAsc;case a.Jb.CREATION_DATE_DESC:return this.i18n.voucher.sort.creationDateDesc;case a.Jb.EXPIRATION_DATE_ASC:return this.i18n.voucher.sort.expirationDateAsc;case a.Jb.EXPIRATION_DATE_DESC:return this.i18n.voucher.sort.expirationDateDesc;case a.Jb.REDEEM_DATE_ASC:return this.i18n.voucher.sort.redeemDateAsc;case a.Jb.REDEEM_DATE_DESC:return this.i18n.voucher.sort.redeemDateDesc}}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["voucher-filters"]],inputs:{data:"data",heading:"heading",mobileHeading:"mobileHeading",form:"form",moreFilters:"moreFilters",headingActions:"headingActions"},features:[d.wb],decls:19,vars:23,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions","emptyLabel"],["type","text","formControlName","token",3,"label","mask","placeholder"],["labelPosition","side","formControlName","creationType",3,"label","fieldOptions"],["labelPosition","side","formControlName","printed",3,"label"],[3,"value","text"],[4,"ngIf"],["labelPosition","side","formControlName","orderBy",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["labelPosition","side","formControlName","types",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","creationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","creationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expirationBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","expirationEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","redeemBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","redeemEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["formControlName","amountMin",3,"label","scale"],["amount",""],["formControlName","amountMax",3,"label","scale"],["kind","field",3,"label"],["formControlName","buyer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["formControlName","redeemer",3,"autoSearch","allowContacts","allowSearch","allowPrincipal"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","buyerGroups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","redeemerGroups",3,"label"]],template:function(e,t){1&e&&(d.Tb(0,"page-content",0),d.Tb(1,"form",1),d.Tb(2,"div",2),d.Fc(3,Xi,3,2,"div",3),d.Tb(4,"div",4),d.Ob(5,"multi-selection-field",5),d.Sb(),d.Tb(6,"div",4),d.Ob(7,"input-field",6),d.Sb(),d.Tb(8,"div",4),d.Ob(9,"radio-group-field",7),d.Sb(),d.Tb(10,"div",4),d.Tb(11,"radio-group-field",8),d.Ob(12,"field-option",9),d.Ob(13,"field-option",9),d.Ob(14,"field-option",9),d.Sb(),d.Sb(),d.Fc(15,ic,31,22,"ng-container",10),d.Tb(16,"div",4),d.Tb(17,"single-selection-field",11),d.Fc(18,cc,1,2,"field-option",12),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Sb()),2&e&&(d.kc("heading",t.heading)("mobileHeading",t.mobileHeading)("headingActions",t.headingActions),d.zb(1),d.kc("formGroup",t.form),d.zb(2),d.kc("ngIf",(null==t.data.types?null:t.data.types.length)>1),d.zb(2),d.kc("label",t.i18n.general.status)("fieldOptions",t.statusOptions)("emptyLabel",t.i18n.general.notApplied),d.zb(2),d.kc("label",t.i18n.voucher.token)("mask",t.mask)("placeholder",t.mask),d.zb(2),d.kc("label",t.i18n.voucher.creationType)("fieldOptions",t.creationTypeOptions),d.zb(2),d.kc("label",t.i18n.general.printed),d.zb(1),d.kc("value","all")("text",t.i18n.general.all),d.zb(1),d.kc("value","true")("text",t.i18n.general.yes),d.zb(1),d.kc("value","false")("text",t.i18n.general.no),d.zb(1),d.kc("ngIf",t.moreFilters),d.zb(2),d.kc("label",t.i18n.general.orderBy),d.zb(1),d.kc("ngForOf",t.orderByOptions()))},directives:[h.a,v.I,v.w,v.n,m.t,ca.a,v.v,v.l,O.a,C.a,Ki.a,z.a,T.a,m.s,w.a,F.a,k.a,I.a],encapsulation:2,changeDetection:0}),e})();function oc(e,t){1&e&&d.Pb(0)}function sc(e,t){if(1&e&&(d.Tb(0,"mobile-result"),d.Tb(1,"div"),d.Tb(2,"div",7),d.Tb(3,"div",8),d.Hc(4),d.Sb(),d.Tb(5,"div",8),d.Hc(6),d.Sb(),d.Sb(),d.Tb(7,"div",9),d.Hc(8),d.ec(9,"currency"),d.Sb(),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.zb(4),d.Jc(" ",e.type.name," "),d.zb(2),d.Jc(" ",n.bankingHelper.voucherStatus(e.status)," "),d.zb(2),d.Jc(" ",d.gc(9,3,e.amount,e.type.configuration.currency)," ")}}function lc(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Tb(1,"tr",13),d.bc("click",(function(){d.wc(e);const n=t.$implicit,a=d.dc(3);return a.router.navigate(a.path(n))})),d.Tb(2,"td"),d.Hc(3),d.ec(4,"date"),d.Sb(),d.Tb(5,"td"),d.Hc(6),d.ec(7,"date"),d.Sb(),d.Tb(8,"td"),d.Hc(9),d.Sb(),d.Tb(10,"td"),d.Hc(11),d.Sb(),d.Tb(12,"td",11),d.Hc(13),d.ec(14,"currency"),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=t.$implicit,n=d.dc(3);d.zb(3),d.Ic(d.fc(4,5,e.creationDate)),d.zb(3),d.Jc(" ",d.fc(7,7,e.expirationDate),""),d.zb(3),d.Jc(" ",n.bankingHelper.voucherStatus(e.status)," "),d.zb(2),d.Jc(" ",e.type.name," "),d.zb(2),d.Jc(" ",d.gc(14,9,e.amount,e.type.configuration.currency)," ")}}function uc(e,t){if(1&e&&(d.Tb(0,"table",10),d.Tb(1,"thead"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Tb(4,"th"),d.Hc(5),d.Sb(),d.Tb(6,"th"),d.Hc(7),d.Sb(),d.Tb(8,"th"),d.Hc(9),d.Sb(),d.Tb(10,"th",11),d.Hc(11),d.Sb(),d.Sb(),d.Tb(12,"tbody"),d.Fc(13,lc,15,12,"ng-container",12),d.ec(14,"async"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);var n;const t=null==(n=d.fc(14,6,e.results$))?null:n.results;d.zb(3),d.Ic(e.i18n.general.creationDate),d.zb(2),d.Ic(e.i18n.general.expirationDate),d.zb(2),d.Ic(e.i18n.general.status),d.zb(2),d.Ic(e.i18n.general.type),d.zb(2),d.Ic(e.i18n.transaction.amount),d.zb(2),d.kc("ngForOf",t)}}function bc(e,t){if(1&e){const e=d.Ub();d.Ob(0,"voucher-filters",3),d.ec(1,"async"),d.ec(2,"async"),d.Tb(3,"results-layout",4),d.bc("update",(function(t){return d.wc(e),d.dc().update(t)})),d.ec(4,"async"),d.Fc(5,sc,10,6,"mobile-result",5),d.Fc(6,uc,15,8,"table",6),d.Sb()}if(2&e){const e=d.dc();d.kc("data",e.data)("form",e.form)("heading",e.i18n.voucher.title.search)("mobileHeading",e.i18n.voucher.mobileTitle.search)("moreFilters",d.fc(1,9,e.moreFilters$))("headingActions",d.fc(2,11,e.headingActions$)),d.zb(3),d.kc("results",d.fc(4,13,e.results$))("toLink",e.toLink)("rendering$",e.rendering$)}}let dc=(()=>{class e extends o.a{constructor(e,t,n){super(e),this.voucherService=t,this.bankingHelper=n}ngOnInit(){super.ngOnInit(),this.addSub(this.voucherService.getVouchersDataForSearch({}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=[this.moreFiltersAction],this.form.patchValue(e.query)}getFormControlNames(){return["types","creationBegin","creationEnd","statuses","token","creationType","printed","amountMin","amountMax","expirationBegin","expirationEnd","redeemBegin","redeemEnd","buyer","redeemer","buyerGroups","redeemerGroups","orderBy"]}toSearchParams(e){const t=e;return(e.redeemBegin||e.redeemEnd)&&(t.redeemPeriod=this.ApiHelper.dateRangeFilter(e.redeemBegin,e.redeemEnd)),(e.creationBegin||e.creationEnd)&&(t.creationPeriod=this.ApiHelper.dateRangeFilter(e.creationBegin,e.creationEnd)),(e.expirationBegin||e.expirationEnd)&&(t.expirationPeriod=this.ApiHelper.dateRangeFilter(e.expirationBegin,e.expirationEnd)),(e.amountMin||e.amountMax)&&(t.amountRange=this.ApiHelper.rangeFilter(e.amountMin,e.amountMax)),"all"===e.printed&&(t.printed=null),"all"===e.creationType&&(t.creationType=null),t}doSearch(e){return this.voucherService.searchVouchers$Response(e)}get statusOptions(){return Object.values(a.Lb).map(e=>({value:e,text:this.bankingHelper.voucherStatus(e)}))}get creationTypeOptions(){return Object.values(a.Ib).map(e=>({value:e,text:this.bankingHelper.voucherCreationType(e)})).concat({value:null,text:this.i18n.general.all})}get toLink(){return e=>this.path(e)}path(e){return["/banking/vouchers/",e.id]}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}resolveMenu(e){return l.b.SEARCH_VOUCHERS}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.M),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["search-vouchers"]],features:[d.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"data","form","heading","mobileHeading","moreFilters","headingActions"],["resultType","list",3,"results","toLink","rendering$","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"cell-main","float-left"],[1,"cell-text"],[1,"float-right"],[1,"table","table-hover","cursor-pointer"],[1,"amount"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,oc,1,0,"ng-container",1),d.Sb(),d.Fc(3,bc,7,15,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(4);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",t.data)("ngIfThen",e)}},directives:[f.a,m.t,rc,p.a,g.a,y.a,B.a,m.s],pipes:[m.b,H.a,j.a],encapsulation:2,changeDetection:0}),e})();var fc=n("cyUc");function mc(e,t){if(1&e&&(d.Tb(0,"div",14),d.Ob(1,"avatar",15),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("image",e.data.type.image)}}function hc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.creationType),d.zb(1),d.Jc(" ",e.bankingHelper.voucherCreationType(e.data.creationType)," ")}}function pc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Ob(1,"user-link",16),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.owner),d.zb(1),d.kc("user",e.data.owner)}}function gc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Ob(1,"user-link",16),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.buy.buyer),d.zb(1),d.kc("user",e.data.buyer)}}function yc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Tb(1,"a",17),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.buy.payment),d.zb(1),d.kc("routerLink",e.transferPath(e.data.buy)),d.zb(1),d.Jc(" ",e.bankingHelper.transactionNumberOrId(e.data.buy)," ")}}function vc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.ec(2,"dateTime"),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.redeem.date),d.zb(1),d.Jc(" ",d.fc(2,2,e.data.redeemDate)," ")}}function kc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Ob(1,"user-link",16),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.redeem.redeemer),d.zb(1),d.kc("user",e.data.redeemer)}}function Sc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Ob(1,"user-link",16),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.general.operator),d.zb(1),d.kc("user",e.data.redeemBy)}}function Tc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Tb(1,"a",17),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.redeem.payment),d.zb(1),d.kc("routerLink",e.transferPath(e.data.redeem)),d.zb(1),d.Jc(" ",e.bankingHelper.transactionNumberOrId(e.data.redeem)," ")}}function zc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.general.status),d.zb(1),d.Jc(" ",e.data.redeemAfterDate," ")}}function wc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.ec(2,"dateTime"),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.general.expirationDate),d.zb(1),d.Jc(" ",d.fc(2,2,e.data.expirationDate)," ")}}function Fc(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Hc(1),d.ec(2,"dateTime"),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.refundDate),d.zb(1),d.Jc(" ",d.fc(2,2,e.data.refund.date)," ")}}function Ic(e,t){if(1&e&&(d.Tb(0,"label-value",8),d.Tb(1,"a",17),d.Hc(2),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.kc("label",e.i18n.voucher.refundPayment),d.zb(1),d.kc("routerLink",e.transferPath(e.data.refund)),d.zb(1),d.Jc(" ",e.bankingHelper.transactionNumberOrId(e.data.refund)," ")}}function Oc(e,t){if(1&e&&(d.Rb(0,18),d.Tb(1,"h2",11),d.Hc(2),d.Sb(),d.Tb(3,"div",19),d.Hc(4),d.Sb(),d.Qb()),2&e){const e=d.dc(2);d.zb(2),d.Jc(" ",e.i18n.general.description," "),d.zb(2),d.Jc(" ",e.data.description," ")}}function Cc(e,t){1&e&&(d.Ob(0,"img",20),d.ec(1,"trust")),2&e&&d.kc("src",d.gc(1,1,t.ngIf,"url"),d.yc)}function Pc(e,t){if(1&e&&(d.Tb(0,"page-content",3),d.ec(1,"async"),d.Tb(2,"div",4),d.Tb(3,"div",5),d.Fc(4,mc,2,1,"div",6),d.Tb(5,"div",7),d.Tb(6,"label-value",8),d.Hc(7),d.Sb(),d.Tb(8,"label-value",8),d.Hc(9),d.Sb(),d.Tb(10,"label-value",8),d.Hc(11),d.ec(12,"currency"),d.Sb(),d.Fc(13,hc,2,2,"label-value",9),d.Tb(14,"label-value",8),d.Hc(15),d.ec(16,"dateTime"),d.Sb(),d.Fc(17,pc,2,2,"label-value",9),d.Fc(18,gc,2,2,"label-value",9),d.Fc(19,yc,3,3,"label-value",9),d.Tb(20,"label-value",8),d.Hc(21),d.Sb(),d.Fc(22,vc,3,4,"label-value",9),d.Fc(23,kc,2,2,"label-value",9),d.Fc(24,Sc,2,2,"label-value",9),d.Fc(25,Tc,3,3,"label-value",9),d.Fc(26,zc,2,2,"label-value",9),d.Fc(27,wc,3,4,"label-value",9),d.Fc(28,Fc,3,4,"label-value",9),d.Fc(29,Ic,3,3,"label-value",9),d.Sb(),d.Sb(),d.Fc(30,Oc,5,2,"ng-container",10),d.Ob(31,"hr",11),d.Tb(32,"div",12),d.Fc(33,Cc,2,4,"img",13),d.ec(34,"async"),d.Sb(),d.Sb(),d.Sb()),2&e){const e=d.dc();d.kc("heading",e.data.title)("mobileHeading",e.data.title)("headingActions",d.fc(1,28,e.headingActions$)),d.zb(4),d.kc("ngIf",e.data.type.image),d.zb(2),d.kc("label",e.i18n.general.type),d.zb(1),d.Jc(" ",e.data.type.name," "),d.zb(1),d.kc("label",e.i18n.voucher.token),d.zb(1),d.Jc(" ",e.data.token," "),d.zb(1),d.kc("label",e.i18n.transaction.amount),d.zb(1),d.Jc(" ",d.gc(12,30,e.data.amount,e.data.type.configuration.currency)," "),d.zb(2),d.kc("ngIf",e.data.creationType),d.zb(1),d.kc("label",e.i18n.general.creationDate),d.zb(1),d.Jc(" ",d.fc(16,33,e.data.creationDate)," "),d.zb(2),d.kc("ngIf",e.data.owner),d.zb(1),d.kc("ngIf",e.data.buyer),d.zb(1),d.kc("ngIf",e.data.buy),d.zb(1),d.kc("label",e.i18n.general.status),d.zb(1),d.Jc(" ",e.bankingHelper.voucherStatus(e.data.status)," "),d.zb(1),d.kc("ngIf",e.data.redeemDate),d.zb(1),d.kc("ngIf",e.data.redeemer),d.zb(1),d.kc("ngIf",null==e.data.redeemBy?null:e.data.redeemBy.user),d.zb(1),d.kc("ngIf",e.data.redeem),d.zb(1),d.kc("ngIf",!e.data.redeemAfterDateReached),d.zb(1),d.kc("ngIf",e.data.expirationDate),d.zb(1),d.kc("ngIf",e.data.refund),d.zb(1),d.kc("ngIf",e.data.refund),d.zb(1),d.kc("ngIf",e.data.description),d.zb(3),d.kc("ngIf",d.fc(34,35,e.qrCodeUrl$))}}function Hc(e,t){1&e&&(d.Tb(0,"page-content"),d.Ob(1,"spinner"),d.Sb())}let xc=(()=>{class e extends Mt.a{constructor(e,t,n){super(e),this.voucherService=t,this.bankingHelper=n,this.qrCodeUrl$=new u.a(null)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.paramMap.get("key");this.addSub(this.voucherService.viewVoucher({key:e}).subscribe(e=>this.data=e))}onDataInitialized(e){this.addSub(this.voucherService.getVoucherQrCode({key:e.id,size:a.D.MEDIUM}).subscribe(e=>this.qrCodeUrl$.next(URL.createObjectURL(e)))),this.createCancelDeviceConfirmation=()=>({type:a.s.MANAGE_VOUCHER,voucher:e.id,voucherAction:a.Gb.CANCEL}),this.createChangeExpirationDeviceConfirmation=()=>({type:a.s.MANAGE_VOUCHER,voucher:e.id,voucherAction:a.Gb.CHANGE_EXPIRATION}),this.canConfirm=this.authHelper.canConfirm(e.confirmationPasswordInput),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("confirmationPassword",v.G.required)),this.headingActions=this.initActions(e)}initActions(e){const t=this.exportHelper.headingActions(e.exportFormats,t=>this.voucherService.exportVoucher$Response({format:t.internalName,key:e.id}));return e.cancelAction&&t.push(new Zt.c("cancel",e.cancelAction===a.Hb.CANCEL_AND_REFUND?this.i18n.voucher.cancelAndRefund:this.i18n.general.cancel,()=>{this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.notification.confirm({title:this.cancelConfirmationTitle(e.cancelAction),passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.createCancelDeviceConfirmation,callback:e=>this.cancel(e.confirmationPassword)})})),e.canChangeExpirationDate&&t.push(new Zt.c("update",this.i18n.voucher.changeExpirationDate,()=>{this.canConfirm||this.notification.warning(this.authHelper.getConfirmationMessage(e.confirmationPasswordInput)),this.notification.confirm({passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.createChangeExpirationDeviceConfirmation,customFields:this.changeExpirationFields,callback:t=>{this.addSub(this.voucherService.changeVoucherExpirationDate({key:e.id,confirmationPassword:t.confirmationPassword,body:{comments:t.customValues.comments,newExpirationDate:t.customValues.newExpirationDate}}).subscribe(()=>{this.notification.snackBar(this.i18n.voucher.expirationDateChanged),this.reload()}))}})})),t}cancel(e){!e&&this.confirmationPassword&&(e=this.confirmationPassword.value),Object(s.F)(this.confirmationPassword)&&this.addSub(this.voucherService.cancelVoucher({key:this.data.id,confirmationPassword:e}).subscribe(()=>{this.reload(),this.notification.snackBar(this.i18n.voucher.cancel.done)}))}cancelConfirmationTitle(e){switch(e){case a.Hb.CANCEL_AND_REFUND:return this.i18n.voucher.cancel.refundConfirmation;case a.Hb.CANCEL_PENDING_PACK:return this.i18n.voucher.cancel.packConfirmation;case a.Hb.CANCEL_GENERATED:case a.Hb.CANCEL_PENDING_SINGLE:return this.i18n.voucher.cancel.confirmation}}get changeExpirationFields(){return[{internalName:"newExpirationDate",name:this.i18n.general.newExpirationDate,type:a.p.DATE,required:!0},{internalName:"comments",name:this.i18n.general.comments,type:a.p.TEXT}]}transferPath(e){return null===e.authorizationStatus||e.authorizationStatus===a.rb.AUTHORIZED?["/banking","transfer",this.bankingHelper.transactionNumberOrId(e)]:["/banking","transaction",this.bankingHelper.transactionNumberOrId(e)]}resolveMenu(e){return e.redeemer&&this.authHelper.isSelfOrOwner(e.redeemer)?l.b.SEARCH_REDEEMED:e.buyer&&this.authHelper.isSelfOrOwner(e.buyer)?l.b.SEARCH_BOUGHT_VOUCHERS:this.authHelper.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(i.M),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["app-view-voucher"]],features:[d.wb],decls:6,vars:7,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf","ngIfElse"],["loading",""],[3,"heading","mobileHeading","headingActions"],[1,"d-flex","flex-grow-1","flex-column"],[1,"d-flex","flex-column","flex-sm-row-reverse","justify-content-sm-between"],["class","image d-flex justify-content-center mt-2 mb-4 align-self-center",4,"ngIf"],[1,"d-flex","flex-column","flex-grow-1"],[3,"label"],[3,"label",4,"ngIf"],["class","d-flex justify-content-start",4,"ngIf"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4","align-self-center"],["size","160","imageSize","200","useLightbox","",3,"image"],[3,"user"],[3,"routerLink"],[1,"d-flex","justify-content-start"],[1,"break-nl"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){if(1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Pc,35,37,"page-content",1),d.ec(3,"async"),d.Sb(),d.Fc(4,Hc,2,0,"ng-template",null,2,d.Gc)),2&e){const e=d.uc(5);d.kc("ready",d.fc(1,3,t.data$)),d.zb(2),d.kc("ngIf",d.fc(3,5,t.data$))("ngIfElse",e)}},directives:[f.a,m.t,h.a,k.a,J.a,S.a,V.h,L.a],pipes:[m.b,H.a,Lt.a,fc.a],encapsulation:2,changeDetection:0}),e})();const Dc=[{path:"",canActivateChild:[n("ofEL").a],children:[{path:":owner/account/:type",component:ke},{path:"transfer/:key",component:Pa},{path:"transfer/:account/:key",component:Pa},{path:"transaction/:key",component:ia},{path:"transfers-overview",component:Oa},{path:"transaction/:key/authorization-history",component:qt},{path:":from/payment",component:Ee},{path:":from/payment/:to",component:Ee},{path:"pos",component:Ee},{path:"qr",component:Ge},{path:":owner/installments",component:it},{path:":owner/authorized-payments",component:Tt,data:{kind:"authorized"}},{path:"authorized-payments",component:Ut,data:{kind:"authorized"}},{path:"pending-my-authorization",component:Ut,data:{kind:"myAuth"}},{path:":user/vouchers/redeem",component:Ii},{path:":user/vouchers/redeemed",component:Wi},{path:":user/vouchers/buy",component:ri},{path:":user/vouchers/bought",component:$i},{path:"vouchers/:key",component:xc},{path:"vouchers",component:dc}]}];let Nc=(()=>{class e{}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},imports:[[V.i.forChild(Dc)],V.i]}),e})();function Ac(e,t){if(1&e&&(d.Tb(0,"notification",6),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.zb(1),d.Jc(" ",e.i18n.transaction.requiresAuthorization,"\n")}}function $c(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Ob(1,"user-link",8),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.fromUser),d.zb(1),d.kc("user",e.fromUser)}}function Ec(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.fromAccount),d.zb(1),d.Jc(" ",e.preview.fromAccount.type.name,"\n")}}function Rc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Ob(1,"user-link",8),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.toUser),d.zb(1),d.kc("user",e.toUser)}}function Uc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.toAccount),d.zb(1),d.Jc(" ",e.preview.toAccount.type.name,"\n")}}function Mc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Hc(1),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.type),d.zb(1),d.Jc(" ",e.preview.paymentType.name,"\n")}}function Lc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Hc(1),d.ec(2,"currency"),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.amount),d.zb(1),d.Jc(" ",d.gc(2,2,e.preview.mainAmount,e.preview.currency),"\n")}}function Bc(e,t){if(1&e&&(d.Tb(0,"div"),d.Hc(1),d.ec(2,"currency"),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.zb(1),d.Kc(" ",e.fee.name,": ",d.gc(2,2,e.amount,n.preview.currency)," ")}}function Jc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Fc(1,Bc,3,5,"div",9),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.appliedFees),d.zb(1),d.kc("ngForOf",e.fees)}}function Vc(e,t){1&e&&d.Ob(0,"custom-field-value",10),2&e&&d.kc("fieldValue",t.$implicit)}function jc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Hc(1),d.ec(2,"date"),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.dueDate),d.zb(1),d.Jc(" ",d.fc(2,2,e.preview.installments[0].dueDate),"\n")}}function Gc(e,t){if(1&e&&(d.Tb(0,"thead"),d.Tb(1,"th"),d.Hc(2),d.Sb(),d.Tb(3,"th"),d.Hc(4),d.Sb(),d.Tb(5,"th",12),d.Hc(6),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.zb(2),d.Ic(e.i18n.transaction.installmentNumber),d.zb(2),d.Ic(e.i18n.transaction.dueDate),d.zb(2),d.Ic(e.i18n.transaction.amount)}}function _c(e,t){if(1&e&&(d.Tb(0,"tr"),d.Tb(1,"td"),d.Hc(2),d.Sb(),d.Tb(3,"td"),d.Hc(4),d.ec(5,"date"),d.Sb(),d.Tb(6,"td",12),d.Hc(7),d.ec(8,"currency"),d.Sb(),d.Sb()),2&e){const e=t.$implicit,n=d.dc(2);d.zb(2),d.Jc(" ",e.number," "),d.zb(2),d.Jc(" ",d.fc(5,3,e.dueDate)," "),d.zb(3),d.Jc(" ",d.gc(8,5,e.mainAmount,n.preview.currency)," ")}}function qc(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Tb(1,"table",11),d.Fc(2,Gc,7,3,"thead",4),d.ec(3,"async"),d.Tb(4,"tbody"),d.Fc(5,_c,9,8,"tr",9),d.Sb(),d.Sb(),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.installments),d.zb(2),d.kc("ngIf",d.fc(3,3,e.layout.gtxs$)),d.zb(3),d.kc("ngForOf",e.preview.installments)}}function Qc(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.Qb()),2&e){const e=d.dc(3);d.zb(1),d.Jc(" ",e.i18n.transaction.recurringPaymentNowManual," ")}}function Yc(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.Qb()),2&e){const e=d.dc(3);d.zb(1),d.Jc(" ",e.i18n.transaction.recurringPaymentNowFixed(e.preview.payment.occurrencesCount)," ")}}function Wc(e,t){if(1&e&&(d.Rb(0),d.Fc(1,Qc,2,1,"ng-container",4),d.Fc(2,Yc,2,1,"ng-container",4),d.Qb()),2&e){const e=d.dc(2);d.zb(1),d.kc("ngIf",null==e.preview.payment.occurrencesCount),d.zb(1),d.kc("ngIf",null!=e.preview.payment.occurrencesCount)}}function Kc(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.ec(2,"date"),d.Qb()),2&e){const e=d.dc(3);d.zb(1),d.Jc(" ",e.i18n.transaction.recurringPaymentDateManual(d.fc(2,1,e.preview.payment.firstOccurrenceDate))," ")}}const Zc=function(e,t){return{date:e,count:t}};function Xc(e,t){if(1&e&&(d.Rb(0),d.Hc(1),d.ec(2,"date"),d.Qb()),2&e){const e=d.dc(3);d.zb(1),d.Jc(" ",e.i18n.transaction.recurringPaymentDateFixed(d.oc(3,Zc,d.fc(2,1,e.preview.payment.firstOccurrenceDate),e.preview.payment.occurrencesCount))," ")}}function er(e,t){if(1&e&&(d.Fc(0,Kc,3,3,"ng-container",4),d.Fc(1,Xc,3,6,"ng-container",4)),2&e){const e=d.dc(2);d.kc("ngIf",null==e.preview.payment.occurrencesCount),d.zb(1),d.kc("ngIf",null!=e.preview.payment.occurrencesCount)}}function tr(e,t){if(1&e&&(d.Tb(0,"label-value",7),d.Fc(1,Wc,3,2,"ng-container",13),d.Fc(2,er,2,2,"ng-template",null,14,d.Gc),d.Sb()),2&e){const e=d.uc(3),t=d.dc();d.kc("label",t.i18n.transaction.recurringPayment),d.zb(1),d.kc("ngIf",null==t.preview.payment.firstOccurrenceDate)("ngIfElse",e)}}function nr(e,t){if(1&e&&d.Ob(0,"label-value",15),2&e){const e=d.dc();d.kc("label",e.i18n.general.description)("value",e.preview.payment.description)}}function ar(e,t){1&e&&d.Ob(0,"hr")}function ir(e,t){1&e&&d.Ob(0,"hr")}function cr(e,t){if(1&e&&(d.Rb(0),d.Fc(1,ir,1,0,"hr",4),d.ec(2,"async"),d.Tb(3,"div",16),d.Hc(4),d.Sb(),d.Qb()),2&e){const e=d.dc();d.zb(1),d.kc("ngIf",d.fc(2,2,e.layout.gtxxs$)),d.zb(3),d.Ic(e.preview.confirmationMessage)}}function rr(e,t){1&e&&d.Ob(0,"hr")}function or(e,t){if(1&e){const e=d.Ub();d.Rb(0),d.Fc(1,rr,1,0,"hr",4),d.ec(2,"async"),d.Tb(3,"form",17),d.Tb(4,"confirmation-password",18),d.bc("confirmationModeChanged",(function(t){return d.wc(e),d.dc().confirmationModeChanged.emit(t)}))("confirmed",(function(t){return d.wc(e),d.dc().confirmed.emit(t)})),d.Sb(),d.Sb(),d.Qb()}if(2&e){const e=d.dc();d.zb(1),d.kc("ngIf",d.fc(2,5,e.layout.gtxxs$)),d.zb(2),d.kc("formGroup",e.form),d.zb(1),d.kc("pos",e.pos)("passwordInput",e.preview.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}let sr=(()=>{class e extends P.a{constructor(e,t){super(e),this.bankingHelper=t,this.confirmationModeChanged=new d.n,this.confirmed=new d.n}ngOnInit(){super.ngOnInit(),this.fromUser=this.preview.fromAccount.user,this.fromSelf=this.fromUser&&this.authHelper.isSelf(this.fromUser),this.fromSystem=this.preview.fromAccount.kind===a.a.SYSTEM,this.toUser=this.preview.toAccount.user,this.toSelf=this.toUser&&this.authHelper.isSelf(this.toUser),this.toSystem=this.preview.toAccount.kind===a.a.SYSTEM,this.form=this.formBuilder.group({}),this.form.setControl("confirmationPassword",this.confirmationPassword),this.fees=this.preview.fees,Object(s.h)(this.fees)&&1===(this.preview.installments||[]).length&&(this.fees=this.preview.installments[0].fees),this.createDeviceConfirmation=()=>this.pos?this.preview.payment:{type:a.s.PERFORM_PAYMENT,from:r.a.accountOwner(this.preview.fromAccount),to:r.a.accountOwner(this.preview.toAccount),paymentType:this.preview.paymentType.id,amount:this.preview.payment.amount},this.preview.confirmationPasswordInput||this.addShortcut(ja.k,()=>this.confirmed.emit())}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(c.a))},e.\u0275cmp=d.Hb({type:e,selectors:[["payment-step-confirm"]],inputs:{pos:"pos",preview:"preview",confirmationPassword:"confirmationPassword",showPaymentType:"showPaymentType"},outputs:{confirmationModeChanged:"confirmationModeChanged",confirmed:"confirmed"},features:[d.wb],decls:20,vars:23,consts:[["class","mb-3","type","warning",4,"ngIf"],[3,"label",4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["valueFormat","break",3,"label","value",4,"ngIf"],[4,"ngIf"],[1,"totalAmount",3,"label"],["type","warning",1,"mb-3"],[3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[3,"fieldValue"],[1,"table","table-hover"],[1,"text-right"],[4,"ngIf","ngIfElse"],["occurrencesDateSet",""],["valueFormat","break",3,"label","value"],[1,"break-nl"],[3,"formGroup"],["focused","","formControlName","confirmationPassword",3,"pos","passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"]],template:function(e,t){1&e&&(d.Fc(0,Ac,2,1,"notification",0),d.Fc(1,$c,2,2,"label-value",1),d.Fc(2,Ec,2,2,"label-value",1),d.Fc(3,Rc,2,2,"label-value",1),d.Fc(4,Uc,2,2,"label-value",1),d.Fc(5,Mc,2,2,"label-value",1),d.Fc(6,Lc,3,5,"label-value",1),d.Fc(7,Jc,2,2,"label-value",1),d.Fc(8,Vc,1,1,"custom-field-value",2),d.Fc(9,jc,3,4,"label-value",1),d.Fc(10,qc,6,5,"label-value",1),d.Fc(11,tr,4,3,"label-value",1),d.Fc(12,nr,1,2,"label-value",3),d.Fc(13,ar,1,0,"hr",4),d.ec(14,"async"),d.Tb(15,"label-value",5),d.Hc(16),d.ec(17,"currency"),d.Sb(),d.Fc(18,cr,5,4,"ng-container",4),d.Fc(19,or,5,7,"ng-container",4)),2&e&&(d.kc("ngIf",t.preview.pendingAuthorization),d.zb(1),d.kc("ngIf",!t.fromSelf&&t.fromUser),d.zb(1),d.kc("ngIf",t.fromSystem),d.zb(1),d.kc("ngIf",t.toUser),d.zb(1),d.kc("ngIf",t.toSystem),d.zb(1),d.kc("ngIf",t.showPaymentType),d.zb(1),d.kc("ngIf",null!=t.preview.mainAmount&&t.preview.totalAmount!==t.preview.mainAmount),d.zb(1),d.kc("ngIf",(null==t.fees?null:t.fees.length)>0),d.zb(1),d.kc("ngForOf",t.preview.customValues),d.zb(1),d.kc("ngIf",1===(null==t.preview.installments?null:t.preview.installments.length)),d.zb(1),d.kc("ngIf",(null==t.preview.installments?null:t.preview.installments.length)>1),d.zb(1),d.kc("ngIf","recurring"===t.preview.payment.scheduling),d.zb(1),d.kc("ngIf",t.preview.payment.description),d.zb(1),d.kc("ngIf",d.fc(14,18,t.layout.gtxxs$)),d.zb(2),d.kc("label",t.i18n.transaction.totalAmount),d.zb(1),d.Jc(" ",d.gc(17,20,t.preview.totalAmount,t.preview.currency),"\n"),d.zb(2),d.kc("ngIf",(t.preview.confirmationMessage||"").length>0),d.zb(1),d.kc("ngIf",t.preview.confirmationPasswordInput))},directives:[m.t,m.s,k.a,ui.a,S.a,Xt.a,v.I,v.w,v.n,_a.a,qa.a,v.v,v.l],pipes:[m.b,H.a,j.a],encapsulation:2,changeDetection:0}),e})(),lr=(()=>{class e extends P.a{constructor(e,t){super(e),this.performPayment=t}ngOnInit(){super.ngOnInit(),this.performed.authorizationStatus===a.rb.PENDING?(this.icon="scheduled",this.message=this.performed.transactionNumber?this.i18n.transaction.pendingWithNumber(this.performed.transactionNumber):this.i18n.transaction.pending):(this.icon="done",this.message=this.performed.transactionNumber?this.i18n.transaction.processedWithNumber(this.performed.transactionNumber):this.i18n.transaction.processed),this.addShortcut(ja.k,()=>this.performPayment.viewPerformed())}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(Ee))},e.\u0275cmp=d.Hb({type:e,selectors:[["payment-step-done"]],inputs:{performed:"performed"},features:[d.wb],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Ob(3,"icon",3),d.Sb(),d.Tb(4,"div",4),d.Hc(5),d.Sb(),d.Sb(),d.Sb()),2&e&&(d.zb(3),d.kc("icon",t.icon),d.zb(2),d.Ic(t.message))},directives:[zn.a],encapsulation:2,changeDetection:0}),e})();var ur=n("a/z7"),br=n("Kj3r"),dr=n("Xel3"),fr=n("Zcpn"),mr=n("YG2p");const hr=["toUser"],pr=["amount"];function gr(e,t){if(1&e&&(d.Tb(0,"label-value",15),d.Ob(1,"user-link",16),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.fromUser),d.zb(1),d.kc("user",e.fromUser)}}const yr=function(e,t,n){return{positive:e,negative:t,"text-right":n}};function vr(e,t){if(1&e&&(d.Tb(0,"label-value",18),d.ec(1,"async"),d.Tb(2,"div",19),d.ec(3,"async"),d.Hc(4),d.ec(5,"currency"),d.Sb(),d.Sb()),2&e){const e=d.dc(2);d.kc("label",d.fc(1,3,e.accountBalanceLabel$)),d.zb(2),d.kc("ngClass",d.pc(10,yr,e.format.isPositive(e.singleAccount.status.balance),e.format.isNegative(e.singleAccount.status.balance),d.fc(3,5,e.layout.ltsm$))),d.zb(2),d.Jc(" ",d.gc(5,7,e.singleAccount.status.balance,e.singleAccount.currency)," ")}}function kr(e,t){if(1&e&&(d.Rb(0),d.Fc(1,vr,6,14,"label-value",17),d.Qb()),2&e){const e=d.dc();d.zb(1),d.kc("ngIf",e.singleAccount.status)}}function Sr(e,t){1&e&&d.Ob(0,"br")}function Tr(e,t){1&e&&d.Hc(0," - ")}function zr(e,t){if(1&e&&(d.Rb(0),d.Fc(1,Sr,1,0,"br",2),d.ec(2,"async"),d.Fc(3,Tr,1,0,"ng-template",null,30,d.Gc),d.Hc(5),d.Qb()),2&e){const e=d.uc(4),t=d.dc().$implicit,n=d.dc(2);d.zb(1),d.kc("ngIf",d.fc(2,3,n.layout.ltsm$))("ngIfElse",e),d.zb(4),d.Jc(" ",t.number," ")}}const wr=function(e,t){return{positive:e,negative:t}};function Fr(e,t){if(1&e&&(d.Tb(0,"div",31),d.Hc(1),d.ec(2,"currency"),d.Sb()),2&e){const e=d.dc().$implicit,t=d.dc(2);d.kc("ngClass",d.oc(5,wr,t.format.isPositive(e.status.balance),t.format.isNegative(e.status.balance))),d.zb(1),d.Jc(" ",d.gc(2,2,e.status.balance,e.currency)," ")}}function Ir(e,t){if(1&e){const e=d.Ub();d.Tb(0,"div",23),d.Tb(1,"div"),d.Tb(2,"div",24),d.Tb(3,"input",25,26),d.bc("keyup.enter",(function(){return d.wc(e),d.uc(4).click()})),d.Sb(),d.Tb(5,"label",27),d.Tb(6,"div",28),d.Hc(7),d.Fc(8,zr,6,5,"ng-container",14),d.Sb(),d.Sb(),d.Sb(),d.Sb(),d.Fc(9,Fr,3,8,"div",29),d.Sb()}if(2&e){const e=t.$implicit,n=d.dc(2);d.zb(1),d.Bb(n.pos?"col":"col-7 col-sm-8 col-md-5"),d.zb(2),d.kc("id","from_"+e.id)("value",e.type.id),d.zb(2),d.kc("for","from_"+e.id),d.zb(2),d.Jc(" ",e.type.name," "),d.zb(1),d.kc("ngIf",e.number),d.zb(1),d.kc("ngIf",!n.pos&&e.status)}}function Or(e,t){if(1&e&&(d.Tb(0,"label-value",20),d.Fc(1,Ir,10,8,"div",21),d.Ob(2,"field-errors",22),d.Sb()),2&e){const e=d.dc();d.kc("label",e.pos?e.i18n.transaction.toAccount:e.i18n.transaction.fromAccount),d.zb(1),d.kc("ngForOf",e.data.accounts),d.zb(1),d.kc("control",e.form.get("account"))}}function Cr(e,t){if(1&e&&d.Ob(0,"field-option",37),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.display)}}function Pr(e,t){if(1&e&&(d.Tb(0,"single-selection-field",35),d.Fc(1,Cr,1,2,"field-option",36),d.Sb()),2&e){const e=d.dc(2);d.zb(1),d.kc("ngForOf",e.data.allowedUsers)}}const Hr=function(e){return[e]},xr=function(e){return{usersToExclude:e}};function Dr(e,t){if(1&e){const e=d.Ub();d.Tb(0,"user-field",38,39),d.bc("selected",(function(t){d.wc(e),d.dc(2);const n=d.uc(10);return t?n.focus():null})),d.Sb()}if(2&e){const e=d.dc(2);d.kc("autoSearch",!e.allowPrincipal)("filters",d.nc(9,xr,e.fromUser&&!e.fromSelf?d.nc(7,Hr,e.fromParam):null))("allowContacts",e.allowContacts)("allowSearch",e.allowSearch)("allowPrincipal",e.allowPrincipal)("allowQrCode",e.allowQrCode)("principalTypes",e.data.principalTypes)}}function Nr(e,t){if(1&e&&(d.Tb(0,"label-value",32),d.Fc(1,Pr,2,1,"single-selection-field",33),d.Fc(2,Dr,2,11,"ng-template",null,34,d.Gc),d.Sb()),2&e){const e=d.uc(3),t=d.dc();d.kc("label",t.pos?t.i18n.transaction.fromUser:t.i18n.transaction.toUser),d.zb(1),d.kc("ngIf",t.fixedUsersList)("ngIfElse",e)}}function Ar(e,t){if(1&e&&(d.Tb(0,"label-value",40),d.Ob(1,"user-link",16),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.toUser),d.zb(1),d.kc("user",e.toUser)}}function $r(e,t){if(1&e&&d.Ob(0,"field-option",37),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.name)}}function Er(e,t){if(1&e&&(d.Tb(0,"single-selection-field",41,42),d.Fc(2,$r,1,2,"field-option",36),d.ec(3,"async"),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.type),d.zb(2),d.kc("ngForOf",d.fc(3,2,e.paymentTypes$))}}function Rr(e,t){if(1&e&&d.Ob(0,"custom-field-input",43),2&e){const e=t.$implicit,n=d.dc();d.kc("field",e)("formControl",n.customValuesControlGetter(e))}}function Ur(e,t){if(1&e&&d.Ob(0,"field-option",49),2&e){const e=d.dc(2);d.kc("text",e.i18n.transaction.schedulingSingle)}}function Mr(e,t){if(1&e&&d.Ob(0,"field-option",50),2&e){const e=d.dc(2);d.kc("text",e.i18n.transaction.schedulingInstallments)}}function Lr(e,t){if(1&e&&d.Ob(0,"field-option",51),2&e){const e=d.dc(2);d.kc("text",e.i18n.transaction.schedulingRecurring)}}function Br(e,t){if(1&e&&(d.Tb(0,"single-selection-field",44),d.Ob(1,"field-option",45),d.Fc(2,Ur,1,1,"field-option",46),d.Fc(3,Mr,1,1,"field-option",47),d.Fc(4,Lr,1,1,"field-option",48),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.scheduling),d.zb(1),d.kc("text",e.i18n.transaction.schedulingDirect),d.zb(1),d.kc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>0),d.zb(1),d.kc("ngIf",(null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.maxInstallments)>1),d.zb(1),d.kc("ngIf",null==e.paymentTypeData$.value?null:e.paymentTypeData$.value.allowsRecurringPayments)}}function Jr(e,t){if(1&e&&d.Ob(0,"date-field",52),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.dueDate)}}function Vr(e,t){if(1&e&&d.Ob(0,"date-field",52),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.firstInstallmentDate)}}function jr(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"input-field",53),d.Tb(2,"radio-group-field",54),d.Ob(3,"field-option",37),d.Ob(4,"field-option",37),d.Sb(),d.Fc(5,Vr,1,1,"date-field",55),d.Qb()),2&e){const e=d.dc();d.zb(1),d.kc("label",e.i18n.transaction.installmentsCount),d.zb(1),d.kc("label",e.i18n.transaction.firstInstallment),d.zb(1),d.kc("value",!0)("text",e.i18n.general.now),d.zb(1),d.kc("value",!1)("text",e.i18n.general.futureDate),d.zb(1),d.kc("ngIf",!1===e.form.value.firstInstallmentIsNow)}}function Gr(e,t){if(1&e&&d.Ob(0,"date-field",60),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.firstOccurrenceDate)}}function _r(e,t){if(1&e&&d.Ob(0,"input-field",61),2&e){const e=d.dc(2);d.kc("label",e.i18n.transaction.occurrencesCount)}}function qr(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"radio-group-field",56),d.Ob(2,"field-option",37),d.Ob(3,"field-option",37),d.Sb(),d.Fc(4,Gr,1,1,"date-field",57),d.Tb(5,"radio-group-field",58),d.Ob(6,"field-option",37),d.Ob(7,"field-option",37),d.Sb(),d.Fc(8,_r,1,1,"input-field",59),d.Qb()),2&e){const e=d.dc();d.zb(1),d.kc("label",e.i18n.transaction.firstOccurrence),d.zb(1),d.kc("value",!0)("text",e.i18n.general.now),d.zb(1),d.kc("value",!1)("text",e.i18n.general.futureDate),d.zb(1),d.kc("ngIf",!1===e.form.value.firstOccurrenceIsNow),d.zb(1),d.kc("label",e.i18n.transaction.repeatUntil),d.zb(1),d.kc("value",!0)("text",e.i18n.transaction.repeatUntilManual),d.zb(1),d.kc("value",!1)("text",e.i18n.transaction.repeatUntilFixed),d.zb(1),d.kc("ngIf",!1===e.form.value.repeatUntilCanceled)}}function Qr(e,t){if(1&e&&d.Ob(0,"textarea-field",63),2&e){const e=d.dc().ngIf,t=d.dc();d.kc("required","required"===e)("label",t.i18n.general.description)}}function Yr(e,t){if(1&e&&(d.Rb(0),d.Fc(1,Qr,1,2,"textarea-field",62),d.Qb()),2&e){const e=t.ngIf;d.zb(1),d.kc("ngIf","disabled"!==e)}}const Wr=[ur.a.FORBIDDEN,ur.a.UNAUTHORIZED,ur.a.NOT_FOUND];let Kr=(()=>{class e extends P.a{constructor(e,t,n,a){super(e),this.bankingHelper=t,this.paymentsService=n,this.posService=a,this.availablePaymentTypes=new d.n,this.accountBalanceLabel$=new u.a(null),this.fixedDestination=!1,this.paymentTypes$=new u.a(null)}ngOnInit(){super.ngOnInit(),this.fromParam=this.route.snapshot.params.from,this.dataCache=this.stateManager.get("dataCache",()=>new Map),this.fixedDestination=null!=this.data.toKind,this.fromUser=this.data.fromUser,this.fromSelf=this.authHelper.isSelf(this.fromUser),this.toUser=this.data.toUser,this.fixedDestination?this.setFetchedPaymentTypes(this.data):this.addSub(this.form.get("subject").valueChanges.pipe(Object(Ue.a)(),Object(br.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.fetchPaymentTypes())),this.addSub(this.form.get("account").valueChanges.pipe(Object(Ue.a)(),Object(br.a)(r.a.DEBOUNCE_TIME)).subscribe(()=>this.adjustPaymentTypes())),this.addSub(this.form.get("type").valueChanges.pipe(Object(Ue.a)(),Object(br.a)(r.a.DEBOUNCE_TIME)).subscribe(e=>this.fetchPaymentTypeData(e))),this.addSub(this.layout.xxs$.subscribe(()=>this.updateAccountBalanceLabel())),this.updateAccountBalanceLabel()}updateAccountBalanceLabel(){this.accountBalanceLabel$.next(this.layout.xxs?this.i18n.account.balance:this.i18n.transaction.accountBalance)}fetchPaymentTypes(){this.dataCache.clear(),this.fetchedPaymentTypes=null;const e=r.a.escapeNumeric(this.form.value.subject);""!==e&&this.errorHandler.requestWithCustomErrorHandler(t=>{let n;n=this.pos?this.posService.dataForReceivePayment({from:e,fields:["fromUser","paymentTypes","paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:e,fields:["toUser","paymentTypes","paymentTypeData"]}),n.pipe(Object(Fe.a)()).subscribe(e=>{this.setFetchedPaymentTypes(e)},e=>{if(this.allowPrincipal&&this.userField&&e.status===ur.a.NOT_FOUND){let t=e.error;if("string"==typeof t)try{t=JSON.parse(t)}catch(n){t={}}const a=t.entityType;if(!Object(s.a)(a)&&a.endsWith("User"))return void this.userField.search()}Wr.includes(e.status)||t(e)})})}adjustPaymentTypes(){const e=this.form.value;if(0===(e.subject||"").trim().length)return;const t=this.fetchedPaymentTypes||[];Object(s.h)(t)&&this.notification.error(this.i18n.transaction.noTypes);const n=t.filter(t=>t.from.id===e.account);let a=this.form.value.type,i=null;Object(s.h)(n)?i={message:this.i18n.transaction.noTypesSelection}:(this.paymentTypes$.next(n),n.find(e=>e.id===a)||(a=n[0].id),this.form.get("account").setErrors(null)),this.form.patchValue({type:a}),this.form.get("account").setErrors(i),this.form.get("account").markAsTouched(),Object(s.h)(a)||this.fetchPaymentTypeData(a),this.availablePaymentTypes.emit(n)}setFetchedPaymentTypes(e){this.userField&&(this.userField.user=this.pos?e.fromUser:e.toUser),this.fetchedPaymentTypes=e.paymentTypes;const t=e.paymentTypeData;t&&this.dataCache.set(t.id,t),this.adjustPaymentTypes()}fetchPaymentTypeData(e){const t=this.form.value;if(Object(s.h)(t.subject)||Object(s.h)(e))return;const n=this.dataCache.get(e);n?this.setPaymentTypeData(n):(this.setPaymentTypeData(null),this.errorHandler.requestWithCustomErrorHandler(n=>{let a;a=this.pos?this.posService.dataForReceivePayment({from:t.subject,type:e,fields:["paymentTypeData"]}):this.paymentsService.dataForPerformPayment({owner:this.fromParam,to:t.subject,type:e,fields:["paymentTypeData"]}),a.pipe(Object(Fe.a)()).subscribe(e=>{this.setPaymentTypeData(e.paymentTypeData)},e=>{Wr.includes(e.status)||n(e)})}))}setPaymentTypeData(e){((this.paymentTypeData$.value||{}).id||null)!==((e||{}).id||null)&&(e&&(this.dataCache.set(e.id,e),Object(s.j)(this.amountField)),this.paymentTypeData$.next(e))}get fixedUsersList(){return!Object(s.h)(this.data.allowedUsers)}get allowQrCode(){return this.allowPrincipal&&this.data.allowScanQrCode}get allowPrincipal(){return!Object(s.h)(this.data.principalTypes)}get allowSearch(){return this.data.allowAutocomplete}get allowContacts(){return this.data.allowContacts}get singleAccount(){const e=this.data.accounts||[];return 1===e.length?e[0]:null}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(c.a),d.Nb(i.z),d.Nb(i.B))},e.\u0275cmp=d.Hb({type:e,selectors:[["payment-step-form"]],viewQuery:function(e,t){var n;1&e&&(d.Lc(hr,!0),d.Cc(pr,!0)),2&e&&(d.tc(n=d.cc())&&(t.userField=n.first),d.tc(n=d.cc())&&(t.amountField=n.first))},inputs:{data:"data",pos:"pos",form:"form",currency:"currency",paymentTypeData$:"paymentTypeData$",customValuesControlGetter:"customValuesControlGetter"},outputs:{availablePaymentTypes:"availablePaymentTypes"},features:[d.wb],decls:22,vars:29,consts:[[3,"formGroup"],["kind","field",3,"label",4,"ngIf"],[4,"ngIf","ngIfElse"],["multipleAccounts",""],["kind","field","required","",3,"label",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","type","required","",3,"label",4,"ngIf"],["formControlName","amount","required","",3,"focused","label","scale","prefix","suffix"],["amount",""],[3,"field","formControl",4,"ngFor","ngForOf"],["formControlName","scheduling","required","",3,"label",4,"ngIf"],[3,"ngSwitch"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngSwitchCase"],[4,"ngSwitchCase"],[4,"ngIf"],["kind","field",3,"label"],[3,"user"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label",4,"ngIf"],["kind","fieldView","labelPosition","sideForced","noWrapLabel","",3,"label"],[1,"w-100","text-nowrap","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["required","","kind","field",3,"label"],["class","w-100 row no-gutters mb-2",4,"ngFor","ngForOf"],[3,"control"],[1,"w-100","row","no-gutters","mb-2"],[1,"custom-control","custom-radio"],["type","radio","formControlName","account",1,"custom-control-input",3,"id","value","keyup.enter"],["radio",""],[1,"custom-control-label",3,"for"],[1,"ml-1"],["class","col-5 col-sm-4 col-md-7 pl-2 text-right text-xs-left font-weight-bold",3,"ngClass",4,"ngIf"],["separator",""],[1,"col-5","col-sm-4","col-md-7","pl-2","text-right","text-xs-left","font-weight-bold",3,"ngClass"],["kind","field","required","",3,"label"],["focused","","formControlName","subject",4,"ngIf","ngIfElse"],["toUserField",""],["focused","","formControlName","subject"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["focused","","formControlName","subject",3,"autoSearch","filters","allowContacts","allowSearch","allowPrincipal","allowQrCode","principalTypes","selected"],["toUser",""],["kind","fieldView",3,"label"],["formControlName","type","required","",3,"label"],["type",""],[3,"field","formControl"],["formControlName","scheduling","required","",3,"label"],["value","direct",3,"text"],["value","futureDate",3,"text",4,"ngIf"],["value","scheduled",3,"text",4,"ngIf"],["value","recurring",3,"text",4,"ngIf"],["value","futureDate",3,"text"],["value","scheduled",3,"text"],["value","recurring",3,"text"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","required","","numbersOnly","","formControlName","installmentsCount",3,"label"],["formControlName","firstInstallmentIsNow",3,"label"],["formControlName","firstInstallmentDate","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","firstOccurrenceIsNow",3,"label"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label",4,"ngIf"],["formControlName","repeatUntilCanceled",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label",4,"ngIf"],["formControlName","firstOccurrenceDate","minDate","tomorrow","required","","minDate","tomorrow","maxDate","future5",3,"label"],["type","number","fieldSize","small","numbersOnly","","formControlName","occurrencesCount","required","",3,"label"],["formControlName","description","required","",3,"required","label",4,"ngIf"],["formControlName","description","required","",3,"required","label"]],template:function(e,t){if(1&e&&(d.Rb(0,0),d.Fc(1,gr,2,2,"label-value",1),d.Fc(2,kr,2,1,"ng-container",2),d.Fc(3,Or,3,3,"ng-template",null,3,d.Gc),d.Fc(5,Nr,4,3,"label-value",4),d.Fc(6,Ar,2,2,"label-value",5),d.Fc(7,Er,4,4,"single-selection-field",6),d.ec(8,"async"),d.Ob(9,"decimal-field",7,8),d.Fc(11,Rr,1,2,"custom-field-input",9),d.ec(12,"async"),d.Fc(13,Br,5,5,"single-selection-field",10),d.ec(14,"async"),d.ec(15,"async"),d.Rb(16,11),d.Fc(17,Jr,1,1,"date-field",12),d.Fc(18,jr,6,7,"ng-container",13),d.Fc(19,qr,9,12,"ng-container",13),d.Qb(),d.Fc(20,Yr,2,1,"ng-container",14),d.ec(21,"async"),d.Qb()),2&e){const e=d.uc(4);var n;const r=(null==(n=d.fc(8,19,t.paymentTypes$))?null:n.length)>1;var a;const o=null==(a=d.fc(12,21,t.paymentTypeData$))?null:a.customFields;var i=null;const s=(null==(i=d.fc(14,23,t.paymentTypeData$))?null:i.allowsRecurringPayments)||(null==(i=d.fc(15,25,t.paymentTypeData$))?null:i.maxInstallments)>0;var c;const l=(null==(c=d.fc(21,27,t.paymentTypeData$))?null:c.descriptionAvailability)||"disabled";d.kc("formGroup",t.form),d.zb(1),d.kc("ngIf",t.fromUser&&!t.fromSelf),d.zb(1),d.kc("ngIf",t.singleAccount)("ngIfElse",e),d.zb(3),d.kc("ngIf",!t.fixedDestination),d.zb(1),d.kc("ngIf",t.fixedDestination&&t.toUser),d.zb(1),d.kc("ngIf",r),d.zb(2),d.kc("focused",t.fixedDestination)("label",t.i18n.transaction.amount)("scale",null==t.currency?null:t.currency.decimalDigits)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix),d.zb(2),d.kc("ngForOf",o),d.zb(2),d.kc("ngIf",s),d.zb(3),d.kc("ngSwitch",t.form.value.scheduling),d.zb(1),d.kc("ngSwitchCase","futureDate"),d.zb(1),d.kc("ngSwitchCase","scheduled"),d.zb(1),d.kc("ngSwitchCase","recurring"),d.zb(1),d.kc("ngIf",l)}},directives:[v.w,v.n,m.t,F.a,v.v,v.l,v.D,qa.a,m.s,m.x,m.y,k.a,S.a,m.q,dr.a,v.A,v.e,T.a,z.a,I.a,Ea.a,v.k,w.a,O.a,fr.a,Ki.a,mr.a],pipes:[m.b,H.a],encapsulation:2,changeDetection:0}),e})(),Zr=(()=>{class e extends P.a{constructor(e,t){super(e),this.receiveQrPayment=t}ngOnInit(){super.ngOnInit(),this.payment.authorizationStatus===a.rb.PENDING?(this.icon="scheduled",this.message=this.payment.transactionNumber?this.i18n.transaction.pendingWithNumber(this.payment.transactionNumber):this.i18n.transaction.pending):(this.icon="done",this.message=this.payment.transactionNumber?this.i18n.transaction.processedWithNumber(this.payment.transactionNumber):this.i18n.transaction.processed),this.addShortcut(ja.k,()=>this.receiveQrPayment.viewPerformed())}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r),d.Nb(Ge))},e.\u0275cmp=d.Hb({type:e,selectors:[["receive-qr-payment-step-done"]],inputs:{payment:"payment"},features:[d.wb],decls:6,vars:2,consts:[[1,"text-center","text-sm-left","px-3"],[1,"d-inline-flex","flex-column","flex-sm-row","align-items-center"],[1,"d-flex","justify-content-center","py-4","positive","pr-0","pr-sm-4","positive"],["size","3rem",3,"icon"],[1,"py-4"]],template:function(e,t){1&e&&(d.Tb(0,"div",0),d.Tb(1,"div",1),d.Tb(2,"div",2),d.Ob(3,"icon",3),d.Sb(),d.Tb(4,"div",4),d.Hc(5),d.Sb(),d.Sb(),d.Sb()),2&e&&(d.zb(3),d.kc("icon",t.icon),d.zb(2),d.Ic(t.message))},directives:[zn.a],encapsulation:2,changeDetection:0}),e})();const Xr=["amount"];function eo(e,t){if(1&e&&d.Ob(0,"field-option",8),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.type.name)}}function to(e,t){if(1&e&&(d.Tb(0,"radio-group-field",6),d.Fc(1,eo,1,2,"field-option",7),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.toAccount),d.zb(1),d.kc("ngForOf",e.data.accounts)}}function no(e,t){if(1&e&&d.Ob(0,"field-option",8),2&e){const e=t.$implicit;d.kc("value",e.id)("text",e.name)}}function ao(e,t){if(1&e&&(d.Tb(0,"single-selection-field",9),d.Fc(1,no,1,2,"field-option",7),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.type),d.zb(1),d.kc("ngForOf",e.transferTypes)}}function io(e,t){if(1&e&&d.Ob(0,"custom-field-input",11),2&e){const e=t.$implicit;d.kc("formControlName",e.internalName)("field",e)}}function co(e,t){if(1&e&&(d.Rb(0,0),d.Fc(1,io,1,2,"custom-field-input",10),d.Qb()),2&e){const e=d.dc();d.kc("formGroup",e.form.controls.customValues),d.zb(1),d.kc("ngForOf",e.typeData.customFields)}}function ro(e,t){if(1&e&&d.Ob(0,"textarea-field",12),2&e){const e=d.dc();d.kc("label",e.i18n.general.description)("required","required"===(null==e.typeData?null:e.typeData.descriptionAvailability))}}let oo=(()=>{class e extends P.a{constructor(e){super(e)}get singleAccount(){return 1===this.data.accounts.length}get currency(){return null==this.typeData?null:this.typeData.currency}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r))},e.\u0275cmp=d.Hb({type:e,selectors:[["receive-qr-payment-step-form"]],viewQuery:function(e,t){var n;1&e&&d.Cc(Xr,!0),2&e&&d.tc(n=d.cc())&&(t.amountField=n.first)},inputs:{data:"data",form:"form",transferTypes:"transferTypes",type:"type",typeData:"typeData"},features:[d.wb],decls:6,vars:9,consts:[[3,"formGroup"],["formControlName","account","required","","asColumn","",3,"label",4,"ngIf"],["formControlName","type",3,"label",4,"ngIf"],["formControlName","amount","focused","","required","",3,"label","prefix","suffix","scale"],[3,"formGroup",4,"ngIf"],["formControlName","description",3,"label","required",4,"ngIf"],["formControlName","account","required","","asColumn","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","type",3,"label"],[3,"formControlName","field",4,"ngFor","ngForOf"],[3,"formControlName","field"],["formControlName","description",3,"label","required"]],template:function(e,t){1&e&&(d.Rb(0,0),d.Fc(1,to,2,2,"radio-group-field",1),d.Fc(2,ao,2,2,"single-selection-field",2),d.Ob(3,"decimal-field",3),d.Fc(4,co,2,2,"ng-container",4),d.Fc(5,ro,1,2,"textarea-field",5),d.Qb()),2&e&&(d.kc("formGroup",t.form),d.zb(1),d.kc("ngIf",!t.singleAccount),d.zb(1),d.kc("ngIf",(null==t.transferTypes?null:t.transferTypes.length)>1),d.zb(1),d.kc("label",t.i18n.transaction.amount)("prefix",null==t.currency?null:t.currency.prefix)("suffix",null==t.currency?null:t.currency.suffix)("scale",null==t.currency?null:t.currency.decimalDigits),d.zb(1),d.kc("ngIf",(null==t.typeData||null==t.typeData.customFields?null:t.typeData.customFields.length)>0),d.zb(1),d.kc("ngIf","disabled"!==(null==t.typeData?null:t.typeData.descriptionAvailability)))},directives:[v.w,v.n,m.t,F.a,v.v,v.l,qa.a,v.D,Ki.a,m.s,z.a,T.a,Ea.a,mr.a],encapsulation:2,changeDetection:0}),e})();function so(e,t){if(1&e){const e=d.Ub();d.Tb(0,"button",10),d.bc("click",(function(){return d.wc(e),d.dc(2).copyUrl()})),d.Ob(1,"icon",11),d.Sb()}if(2&e){const e=d.dc(2);d.kc("tooltip",e.i18n.general.copyToClipboard)}}function lo(e,t){if(1&e&&(d.Tb(0,"label-value",3),d.Tb(1,"div",8),d.Hc(2),d.Sb(),d.Fc(3,so,2,1,"button",9),d.Sb()),2&e){const e=d.dc();d.kc("label",e.i18n.transaction.ticketShareUrl),d.zb(2),d.Ic(e.ticket.approveUrl)}}let uo=(()=>{class e extends P.a{constructor(e){super(e),this.supportsShare=Object(s.C)()}copyUrl(){Object(s.f)(this.ticket.approveUrl),this.notification.snackBar(this.i18n.general.copyToClipboardDone)}}return e.\u0275fac=function(t){return new(t||e)(d.Nb(d.r))},e.\u0275cmp=d.Hb({type:e,selectors:[["receive-qr-payment-step-pending"]],inputs:{ticket:"ticket",qrCodeUrl:"qrCodeUrl"},features:[d.wb],decls:10,vars:9,consts:[[1,"d-flex","justify-content-center","align-items-center"],[1,"mb-3",3,"src"],[3,"label","value"],[3,"label"],[1,"d-flex"],[1,"flex-grow-1"],["bootstrap","","size","1.5rem",1,"p-0","ml-2"],[3,"label",4,"ngIf"],[1,"w-100"],["class","btn btn-icon","type","button",3,"tooltip","click",4,"extraCell"],["type","button",1,"btn","btn-icon",3,"tooltip","click"],["icon","link"]],template:function(e,t){1&e&&(d.Tb(0,"div",0),d.Ob(1,"img",1),d.ec(2,"trust"),d.Sb(),d.Ob(3,"label-value",2),d.Tb(4,"label-value",3),d.Tb(5,"div",4),d.Tb(6,"div",5),d.Hc(7),d.Sb(),d.Ob(8,"spinner",6),d.Sb(),d.Sb(),d.Fc(9,lo,4,2,"label-value",7)),2&e&&(d.zb(1),d.kc("src",d.gc(2,6,t.qrCodeUrl,"url"),d.yc),d.zb(2),d.kc("label",t.i18n.transaction.amount)("value",t.format.formatAsCurrency(t.ticket.currency,t.ticket.amount)),d.zb(1),d.kc("label",t.i18n.general.status),d.zb(3),d.Ic(t.i18n.transaction.status.pending),d.zb(2),d.kc("ngIf",!t.supportsShare))},directives:[k.a,L.a,m.t,li.a,Tn.b,zn.a],pipes:[fc.a],encapsulation:2,changeDetection:0}),e})();var bo=n("PCNd"),fo=n("CNMR"),mo=n("aHM3"),ho=n("6No5"),po=n("38Bd"),go=n("p4Ho"),yo=n("FE24"),vo=n("GTjh"),ko=n("7Ub2"),So=n("yThH"),To=n("vdzA"),zo=n("TmPS"),wo=n("9A/v"),Fo=n("Aeop"),Io=n("AFEp"),Oo=n("A0yp"),Co=n("z6Sj"),Po=n("pgV1"),Ho=n("wezA"),xo=n("f0aj"),Do=n("yWxo"),No=n("T9y1"),Ao=n("RRWt"),$o=n("o/nJ"),Eo=n("0xrI"),Ro=n("AH7H"),Uo=n("yHfF"),Mo=n("lrfU"),Lo=n("aVfl"),Bo=n("G1xJ"),Jo=n("VpKs"),Vo=n("yk18"),jo=n("nGVv"),Go=n("sYqu"),_o=n("559x"),qo=n("0C6t"),Qo=n("uao2"),Yo=n("fe3a"),Wo=n("m98c"),Ko=n("z3FF"),Zo=n("z332"),Xo=n("pz1b"),es=n("bER3"),ts=n("ZJXG"),ns=n("wUcZ"),as=n("yRWz"),is=n("/edM"),cs=n("PzFp"),rs=n("7qm1"),os=n("sARG"),ss=n("IAdc"),ls=n("vHbw"),us=n("USuC"),bs=n("Y49Y"),ds=n("2V/7"),fs=n("HZ9B"),ms=n("g9Ug"),hs=n("jOM4"),ps=n("DFH8"),gs=n("C2xC"),ys=n("H52G"),vs=n("T23z"),ks=n("NjAj"),Ss=n("csas"),Ts=n("U9jX"),zs=n("g1uo"),ws=n("cLCZ"),Fs=n("kmyw"),Is=n("/NTq");let Os=(()=>{class e{}return e.\u0275mod=d.Lb({type:e}),e.\u0275inj=d.Kb({factory:function(t){return new(t||e)},imports:[[Nc,bo.a]]}),e})();d.zc(Ee,[V.j,V.f,V.h,V.g,V.k,m.q,m.r,m.s,m.t,m.A,m.w,m.x,m.y,m.z,m.u,m.v,v.I,v.x,v.H,v.e,v.y,v.B,v.b,v.E,v.F,v.A,v.v,v.w,v.D,v.r,v.q,v.z,v.c,v.f,v.k,v.n,v.l,v.o,v.h,fo.a,si.c,si.d,mo.a,mo.b,mo.c,ho.a,ho.b,po.a,po.b,go.a,Tn.b,yo.b,yo.d,yo.a,vo.b,ko.a,So.a,ui.a,To.a,zo.a,zn.a,Sn.a,J.a,L.a,f.a,h.a,wo.a,Fo.a,Io.a,Oo.a,Co.a,p.a,Po.a,Ho.a,B.a,xo.a,Do.a,y.a,g.a,No.a,Ao.a,en.a,$o.a,_a.a,Eo.a,k.a,li.a,Ro.a,Ga.a,Xt.a,Uo.a,O.a,Mo.a,Lo.a,Bo.a,Jo.a,Vo.a,mr.a,dr.a,z.a,T.a,ca.a,jo.a,Ki.a,Go.a,_o.a,w.a,qo.a,F.a,Ea.a,Qo.a,Yo.a,Wo.a,Ko.a,Zo.a,Xo.a,es.a,ts.a,ns.a,as.a,is.a,cs.a,rs.a,os.a,ss.a,S.a,Ha.a,I.a,ls.a,us.a,bs.a,ds.a,fs.a,ms.a,oi.a,hs.a,ps.a,gs.a,ys.a,vs.a,ks.a,Ss.a,Va.a,Ts.a,qa.a,fr.a,C.a,ke,M,Pa,kn,qt,Oa,Tt,Ut,it,ia,Ee,Kr,sr,lr,Ge,oo,uo,Zr,ri,$i,$a,Ja,Za,Ii,xc,Wi,dc,rc],[m.b,m.G,m.p,m.k,m.E,m.g,m.C,m.F,m.d,m.f,m.i,m.j,m.l,fc.a,j.a,Lt.a,zs.a,ws.a,H.a,Fs.a,Is.a]),d.zc(Ge,[V.j,V.f,V.h,V.g,V.k,m.q,m.r,m.s,m.t,m.A,m.w,m.x,m.y,m.z,m.u,m.v,v.I,v.x,v.H,v.e,v.y,v.B,v.b,v.E,v.F,v.A,v.v,v.w,v.D,v.r,v.q,v.z,v.c,v.f,v.k,v.n,v.l,v.o,v.h,fo.a,si.c,si.d,mo.a,mo.b,mo.c,ho.a,ho.b,po.a,po.b,go.a,Tn.b,yo.b,yo.d,yo.a,vo.b,ko.a,So.a,ui.a,To.a,zo.a,zn.a,Sn.a,J.a,L.a,f.a,h.a,wo.a,Fo.a,Io.a,Oo.a,Co.a,p.a,Po.a,Ho.a,B.a,xo.a,Do.a,y.a,g.a,No.a,Ao.a,en.a,$o.a,_a.a,Eo.a,k.a,li.a,Ro.a,Ga.a,Xt.a,Uo.a,O.a,Mo.a,Lo.a,Bo.a,Jo.a,Vo.a,mr.a,dr.a,z.a,T.a,ca.a,jo.a,Ki.a,Go.a,_o.a,w.a,qo.a,F.a,Ea.a,Qo.a,Yo.a,Wo.a,Ko.a,Zo.a,Xo.a,es.a,ts.a,ns.a,as.a,is.a,cs.a,rs.a,os.a,ss.a,S.a,Ha.a,I.a,ls.a,us.a,bs.a,ds.a,fs.a,ms.a,oi.a,hs.a,ps.a,gs.a,ys.a,vs.a,ks.a,Ss.a,Va.a,Ts.a,qa.a,fr.a,C.a,ke,M,Pa,kn,qt,Oa,Tt,Ut,it,ia,Ee,Kr,sr,lr,Ge,oo,uo,Zr,ri,$i,$a,Ja,Za,Ii,xc,Wi,dc,rc],[m.b,m.G,m.p,m.k,m.E,m.g,m.C,m.F,m.d,m.f,m.i,m.j,m.l,fc.a,j.a,Lt.a,zs.a,ws.a,H.a,Fs.a,Is.a])}}]);