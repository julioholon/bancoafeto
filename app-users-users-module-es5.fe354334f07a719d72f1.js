function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,a=!1,r=void 0;try{for(var o,c=e[Symbol.iterator]();!(i=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(s){a=!0,r=s}finally{try{i||null==c.return||c.return()}finally{if(a)throw r}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a,r=!0,o=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return r=e.done,e},e:function(e){o=!0,a=e},f:function(){try{r||null==i.return||i.return()}finally{if(o)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=_superPropBase(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{zrcO:function(e,t,n){"use strict";n.r(t),n.d(t,"UsersModule",(function(){return Gd}));var i=n("PCNd"),a=n("iInd"),r=n("nsXz"),o=n("ofEL"),c=n("Do6i"),s=n("MfEj"),l=n("NjAj"),u=n("MhyI"),d=n("PvCH"),b=n("8Y7J"),f=n("LqlI"),m=n("8UBS"),p=n("SVse"),g=n("HQV3"),h=n("2KYv"),v=n("n1JJ"),y=n("DAJ4"),k=n("bqp0"),S=n("wwxf"),T=n("978R"),I=n("H4pW"),C=n("yL40"),O=n("/kmK"),F=n("kmyw");function z(e,t){1&e&&b.Pb(0)}function A(e,t){if(1&e&&b.Ob(0,"user-info",8),2&e){var n=b.dc(2);b.kc("user",n.data.user)}}function w(e,t){if(1&e&&(b.Tb(0,"del"),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.agreement.name," ")}}function E(e,t){if(1&e&&b.Hc(0),2&e){var n=b.dc().$implicit;b.Jc(" ",n.agreement.name," ")}}function _(e,t){if(1&e&&(b.Tb(0,"mobile-result"),b.Tb(1,"div"),b.Tb(2,"div",9),b.Hc(3),b.ec(4,"date"),b.Sb(),b.Tb(5,"div",10),b.Fc(6,w,2,1,"del",11),b.Fc(7,E,1,1,"ng-template",null,12,b.Gc),b.Sb(),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.uc(8);b.zb(3),b.Jc(" ",b.fc(4,3,n.date)," "),b.zb(3),b.kc("ngIf",!n.accepted)("ngIfElse",i)}}function N(e,t){if(1&e&&(b.Tb(0,"th"),b.Hc(1),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.Ic(n.i18n.agreements.accepted)}}function R(e,t){if(1&e&&(b.Tb(0,"th",18),b.Hc(1),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.Jc(" ",n.i18n.general.remoteAddress,"")}}function P(e,t){if(1&e&&(b.Tb(0,"td"),b.Hc(1),b.ec(2,"boolean"),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Ic(b.fc(2,1,n.accepted))}}function D(e,t){if(1&e&&(b.Tb(0,"td",18),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.remoteAddress,"")}}function H(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",21),b.bc("click",(function(){b.wc(n);var e=b.dc().$implicit;return b.dc(3).showAgreement(e)})),b.Ob(1,"icon",22),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.general.view)}}var x=function(e){return{"cursor-pointer":e}};function L(e,t){if(1&e&&(b.Tb(0,"tr",19),b.Tb(1,"td"),b.Hc(2),b.ec(3,"dateTime"),b.Sb(),b.Tb(4,"td"),b.Hc(5),b.Sb(),b.Fc(6,P,3,3,"td",14),b.Fc(7,D,2,1,"td",15),b.Tb(8,"td",16),b.Fc(9,H,2,1,"button",20),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(3);b.kc("ngClass",b.nc(8,x,n.accepted)),b.zb(2),b.Ic(b.fc(3,6,n.date)),b.zb(3),b.Ic(n.agreement.name),b.zb(1),b.kc("ngIf",i.hasAccepted),b.zb(1),b.kc("ngIf",i.hasRemoteAddress),b.zb(2),b.kc("ngIf",n.accepted)}}function M(e,t){if(1&e&&(b.Tb(0,"table",13),b.Tb(1,"thead"),b.Tb(2,"th"),b.Hc(3),b.Sb(),b.Tb(4,"th"),b.Hc(5),b.Sb(),b.Fc(6,N,2,1,"th",14),b.Fc(7,R,2,1,"th",15),b.Ob(8,"th",16),b.Sb(),b.Tb(9,"tbody"),b.Fc(10,L,10,10,"tr",17),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(3),b.Ic(n.i18n.general.date),b.zb(2),b.Ic(n.i18n.agreements.agreement),b.zb(1),b.kc("ngIf",n.hasAccepted),b.zb(1),b.kc("ngIf",n.hasRemoteAddress),b.zb(3),b.kc("ngForOf",n.data.history)}}function U(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.Fc(1,A,1,1,"user-info",4),b.Sb(),b.Tb(2,"results-layout",5),b.Fc(3,_,9,5,"mobile-result",6),b.Fc(4,M,11,5,"table",7),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.i18n.agreements.title.history)("mobileHeading",n.i18n.agreements.mobileTitle.history)("mode",n.self?"empty":"normal"),b.zb(1),b.kc("ngIf",!n.self),b.zb(1),b.kc("results",n.data.history)("onClick",n.showAgreement)}}var $,G=(($=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).agreementsService=i,o.userHelper=a,o.modal=r,o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["user","history"]}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){this.self=this.authHelper.isSelf(e.user);var t=e.history||[];this.hasAccepted=t.findIndex((function(e){return!e.accepted}))>=0,this.hasRemoteAddress=t.findIndex((function(e){return e.remoteAddress}))>=0}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.AGREEMENTS)}},{key:"operator",get:function(){return this.userHelper.isOperator(this.data.user)}},{key:"showAgreement",get:function(){var e=this;return function(t){t.accepted&&e.modal.show(l.a,{ignoreBackdropClick:!0,class:"modal-form modal-form-large",initialState:{agreement:t.agreement,version:t.acceptedVersion}})}}}]),n}(u.a)).\u0275fac=function(e){return new(e||$)(b.Nb(b.r),b.Nb(c.e),b.Nb(s.a),b.Nb(f.b))},$.\u0275cmp=b.Hb({type:$,selectors:[["view-agreements-history"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","mode"],[3,"user",4,"ngIf"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"user"],[1,"cell-text","float-left"],[1,"cell-main","float-right"],[4,"ngIf","ngIfElse"],["accepted",""],[1,"table","table-hover"],[4,"ngIf"],["class","align-center",4,"ngIf"],[1,"actions"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"align-center"],[3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","search"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,z,1,0,"ng-container",1),b.Sb(),b.Fc(3,U,5,6,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,h.a,v.a,y.a,k.a,S.a,p.s,p.q,T.b,I.a],pipes:[p.b,C.a,O.a,F.a],encapsulation:2,changeDetection:0}),$),B=n("tAww"),J=n("ObUu"),V=n("H52G"),q=n("s7LF"),j=n("JFlR"),Q=n("UXR7"),Y=n("OTwK"),K=n("T23z");function X(e,t){if(1&e&&b.Ob(0,"user-info",9),2&e){var n=b.dc(2);b.kc("user",n.data.user)}}function W(e,t){if(1&e&&b.Ob(0,"accept-agreements",10),2&e){var n=b.dc(2);b.kc("label",n.i18n.agreements.optional)("formControl",n.optionalControl)("agreements",n.allOptional)}}function Z(e,t){1&e&&b.Pb(0)}var ee=function(e){return{$implicit:e}};function te(e,t){if(1&e&&(b.Tb(0,"label-value",11),b.Fc(1,Z,1,0,"ng-container",12),b.Sb()),2&e){var n=b.dc(3),i=b.uc(4);b.kc("label",n.i18n.agreements.optional),b.zb(1),b.kc("ngTemplateOutlet",i)("ngTemplateOutletContext",b.nc(3,ee,n.acceptedOptional))}}function ne(e,t){if(1&e&&b.Fc(0,te,2,5,"label-value",7),2&e){var n=b.dc(2);b.kc("ngIf",(null==n.acceptedOptional?null:n.acceptedOptional.length)>0)}}function ie(e,t){1&e&&b.Pb(0)}function ae(e,t){if(1&e&&(b.Tb(0,"label-value",11),b.Fc(1,ie,1,0,"ng-container",12),b.Sb()),2&e){var n=b.dc(2),i=b.uc(4);b.kc("label",n.i18n.agreements.required),b.zb(1),b.kc("ngTemplateOutlet",i)("ngTemplateOutletContext",b.nc(3,ee,n.acceptedRequired))}}function re(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"hr"),b.Hc(2),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.Jc(" ",n.i18n.agreements.noAccepted," ")}}function oe(e,t){if(1&e){var n=b.Ub();b.Tb(0,"actions"),b.Tb(1,"action-button",13),b.bc("action",(function(){return b.wc(n),b.dc(2).save()})),b.ec(2,"async"),b.Sb(),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.kc("disabled",b.fc(2,2,i.requesting$))("label",i.i18n.general.save)}}function ce(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.ec(1,"async"),b.Fc(2,X,1,1,"user-info",4),b.Fc(3,W,1,3,"accept-agreements",5),b.Fc(4,ne,1,1,"ng-template",null,6,b.Gc),b.Fc(6,ae,2,5,"label-value",7),b.Fc(7,re,3,1,"ng-container",8),b.Fc(8,oe,3,4,"actions",8),b.Sb()),2&e){var n=b.uc(5),i=b.dc();b.kc("heading",i.i18n.agreements.title.accepted)("mobileHeading",i.i18n.agreements.mobileTitle.accepted)("headingActions",b.fc(1,9,i.headingActions$)),b.zb(2),b.kc("ngIf",!i.self),b.zb(1),b.kc("ngIf",i.optionalControl)("ngIfElse",n),b.zb(3),b.kc("ngIf",(null==i.acceptedRequired?null:i.acceptedRequired.length)>0),b.zb(1),b.kc("ngIf",i.noAgreements),b.zb(1),b.kc("ngIf",i.optionalControl)}}var se=function(e){return{"mt-2":e}};function le(e,t){if(1&e&&(b.Tb(0,"div",15),b.Ob(1,"agreement-link",16),b.Sb()),2&e){var n=t.$implicit,i=t.first,a=b.dc(2);b.kc("ngClass",b.nc(3,se,!i)),b.zb(1),b.kc("agreement",n)("version",null==a.data.accepted[n.id]?null:a.data.accepted[n.id].acceptedVersion)}}function ue(e,t){1&e&&b.Fc(0,le,2,5,"div",14),2&e&&b.kc("ngForOf",t.$implicit)}var de,be=((de=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).agreementsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.agreementsService.getUserAgreements({user:this.param,fields:["-history"]}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.self=this.authHelper.isSelf(e.user);var n=Object.keys(e.accepted||{}),i=(e.agreements||[]).filter((function(e){return n.includes(e.id)}));this.allOptional=(e.agreements||[]).filter((function(e){return!e.required})),this.acceptedOptional=i.filter((function(e){return!e.required})),this.acceptedRequired=i.filter((function(e){return e.required})),e.canEdit?this.optionalControl=this.formBuilder.control(this.acceptedOptional.map((function(e){return e.id}))):this.noAgreements=0===i.length,this.noAgreements||(this.headingActions=[new B.c("history",this.i18n.general.viewHistory,(function(){return t.router.navigate(["users",t.param,"agreements","history"])}),!0)])}},{key:"save",value:function(){var e=this;Object(J.F)(this.optionalControl)&&this.addSub(this.agreementsService.acceptOptionalAgreements({agreements:this.optionalControl.value}).subscribe((function(){e.notification.snackBar(e.i18n.agreements.optionalSaved),e.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.AGREEMENTS)}}]),n}(u.a)).\u0275fac=function(e){return new(e||de)(b.Nb(b.r),b.Nb(c.e))},de.\u0275cmp=b.Hb({type:de,selectors:[["view-user-agreements"]],features:[b.wb],decls:5,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],["agreementLinks",""],[3,"heading","mobileHeading","headingActions"],[3,"user",4,"ngIf"],[3,"label","formControl","agreements",4,"ngIf","ngIfElse"],["optionalNotEditable",""],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"user"],[3,"label","formControl","agreements"],[3,"label"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"disabled","label","action"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["ignoreRequired","",3,"agreement","version"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,ce,9,11,"page-content",1),b.Sb(),b.Fc(3,ue,1,1,"ng-template",null,2,b.Gc)),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,k.a,V.a,q.v,q.k,j.a,p.A,Q.a,Y.a,p.s,p.q,K.a],pipes:[p.b],encapsulation:2,changeDetection:0}),de),fe=n("hQUc"),me=n("rCAV"),pe=n("tVPo"),ge=n("6g1M"),he=n("WYBn"),ve=n("chz4"),ye=n("JbOn"),ke=n("sifq");function Se(e,t){if(1&e&&(b.Tb(0,"mobile-result",25),b.Tb(1,"div",26),b.Hc(2),b.Sb(),b.Tb(3,"div",27),b.Hc(4),b.ec(5,"dateTime"),b.Sb(),b.Tb(6,"div",28),b.Hc(7),b.Sb(),b.Sb()),2&e){var n=t.$implicit;b.kc("avatarImage",null==n.user?null:n.user.image),b.zb(1),b.kc("tooltip",n.user.display),b.zb(1),b.Jc(" ",n.user.display,""),b.zb(2),b.Jc(" ",b.fc(5,5,n.date)," "),b.zb(3),b.Ic(n.text)}}var Te=function(e,t){return{"pb-0":e,"border-0":t}};function Ie(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"tr"),b.Tb(2,"td",32),b.ec(3,"async"),b.ec(4,"async"),b.Ob(5,"avatar",33),b.Sb(),b.Tb(6,"td"),b.Hc(7),b.Sb(),b.Tb(8,"td"),b.Hc(9),b.Sb(),b.Tb(10,"td"),b.Hc(11),b.ec(12,"dateTime"),b.Sb(),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(2),b.kc("ngClass",b.oc(12,Te,b.fc(3,6,i.layout.xxs$),b.fc(4,8,i.layout.xxs$))),b.zb(3),b.kc("image",null==n.user?null:n.user.image)("tooltip",null==n.user?null:n.user.display),b.zb(2),b.Ic(n.user.display),b.zb(2),b.Ic(n.text),b.zb(2),b.Ic(b.fc(12,10,n.date))}}function Ce(e,t){if(1&e&&(b.Tb(0,"table",29),b.Tb(1,"thead"),b.Ob(2,"th",30),b.Tb(3,"th"),b.Hc(4),b.Sb(),b.Tb(5,"th"),b.Hc(6),b.Sb(),b.Tb(7,"th"),b.Hc(8),b.Sb(),b.Sb(),b.Tb(9,"tbody"),b.Fc(10,Ie,13,15,"ng-container",31),b.ec(11,"async"),b.Sb(),b.Sb()),2&e){var n,i=b.dc(),a=null==(n=b.fc(11,4,i.results$))?null:n.results;b.zb(4),b.Ic(i.i18n.general.user),b.zb(2),b.Ic(i.i18n.userAlert.text),b.zb(2),b.Ic(i.i18n.general.date),b.zb(2),b.kc("ngForOf",a)}}var Oe,Fe=((Oe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).alertsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.data={}}},{key:"getFormControlNames",value:function(){return["types","user","beginDate","endDate"]}},{key:"toSearchParams",value:function(e){return{datePeriod:me.a.dateRangeFilter(e.beginDate,e.endDate),page:e.page,pageSize:e.pageSize,types:e.types,user:e.user}}},{key:"doSearch",value:function(e){return this.alertsService.searchUserAlerts$Response(e)}},{key:"resolveMenu",value:function(){return d.b.USER_ALERTS}}]),n}(pe.a)).\u0275fac=function(e){return new(e||Oe)(b.Nb(b.r),b.Nb(fe.a))},Oe.\u0275cmp=b.Hb({type:Oe,selectors:[["search-user-alerts"]],features:[b.wb],decls:30,vars:28,consts:[[3,"ready"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","beginDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","endDate","minDate","past5","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","types",3,"label","emptyOption"],["value","custom",3,"text"],["value","givenVeryBadRefs",3,"text"],["value","insufficientBalanceForInitialCredit",3,"text"],["value","maxDeviceActivationAttemptsReached",3,"text"],["value","maxDeviceConfirmationCheckAttemptsReached",3,"text"],["value","maxTokenActivationAttemptsReached",3,"text"],["value","maxUserLocalizationAttemptsReached",3,"text"],["value","maxVoucherRedeemAttemptsReached",3,"text"],["value","moveUserAutomaticallyFailed",3,"text"],["value","passwordDisabledByTries",3,"text"],["value","passwordTemporarilyBlocked",3,"text"],["value","receivedVeryBadRefs",3,"text"],["value","scheduledPaymentFailed",3,"text"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","rendering$","update"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarIcon","user",3,"avatarImage"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Tb(2,"page-content",1),b.Tb(3,"form",2),b.Tb(4,"div",3),b.Tb(5,"div",4),b.Ob(6,"date-field",5),b.Sb(),b.Tb(7,"div",4),b.Ob(8,"date-field",6),b.Sb(),b.Tb(9,"div",4),b.Tb(10,"single-selection-field",7),b.Ob(11,"field-option",8),b.Ob(12,"field-option",9),b.Ob(13,"field-option",10),b.Ob(14,"field-option",11),b.Ob(15,"field-option",12),b.Ob(16,"field-option",13),b.Ob(17,"field-option",14),b.Ob(18,"field-option",15),b.Ob(19,"field-option",16),b.Ob(20,"field-option",17),b.Ob(21,"field-option",18),b.Ob(22,"field-option",19),b.Ob(23,"field-option",20),b.Sb(),b.Sb(),b.Tb(24,"div",4),b.Ob(25,"user-field",21),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Tb(26,"results-layout",22),b.bc("update",(function(e){return t.update(e)})),b.ec(27,"async"),b.Fc(28,Se,8,7,"mobile-result",23),b.Fc(29,Ce,12,6,"table",24),b.Sb(),b.Sb()),2&e&&(b.kc("ready",b.fc(1,24,t.data$)),b.zb(2),b.kc("heading",t.i18n.userAlert.title)("mobileHeading",t.i18n.userAlert.mobileTitle),b.zb(1),b.kc("formGroup",t.form),b.zb(3),b.kc("label",t.i18n.general.beginDate),b.zb(2),b.kc("label",t.i18n.general.endDate),b.zb(2),b.kc("label",t.i18n.userAlert.type.title)("emptyOption",t.i18n.general.notApplied),b.zb(1),b.kc("text",t.i18n.userAlert.type.custom),b.zb(1),b.kc("text",t.i18n.userAlert.type.givenVeryBadRefs),b.zb(1),b.kc("text",t.i18n.userAlert.type.insufficientBalanceForInitialCredit),b.zb(1),b.kc("text",t.i18n.userAlert.type.maxDeviceActivationAttemptsReached),b.zb(1),b.kc("text",t.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached),b.zb(1),b.kc("text",t.i18n.userAlert.type.maxTokenActivationAttemptsReached),b.zb(1),b.kc("text",t.i18n.userAlert.type.maxUserLocalizationAttemptsReached),b.zb(1),b.kc("text",t.i18n.userAlert.type.maxVoucherRedeemAttemptsReached),b.zb(1),b.kc("text",t.i18n.userAlert.type.moveUserAutomaticallyFailed),b.zb(1),b.kc("text",t.i18n.userAlert.type.passwordDisabledByTries),b.zb(1),b.kc("text",t.i18n.userAlert.type.passwordTemporarilyBlocked),b.zb(1),b.kc("text",t.i18n.userAlert.type.receivedVeryBadRefs),b.zb(1),b.kc("text",t.i18n.userAlert.type.receivedVeryBadRefs),b.zb(2),b.kc("label",t.i18n.general.user),b.zb(1),b.kc("results",b.fc(27,26,t.results$))("rendering$",t.rendering$))},directives:[m.a,g.a,q.I,q.w,q.n,ge.a,q.v,q.l,he.a,ve.a,ye.a,h.a,v.a,y.a,S.a,T.b,p.s,p.q,ke.a],pipes:[p.b,O.a],encapsulation:2,changeDetection:0}),Oe),ze=n("XDzf"),Ae=n("x6mR"),we=n("yHfF");function Ee(e,t){if(1&e&&b.Ob(0,"boolean-field",7),2&e){var n=b.dc(2);b.kc("label",n.i18n.brokers.mainBroker)}}function _e(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"page-content",2),b.Tb(2,"form",3),b.Ob(3,"user-field",4),b.Fc(4,Ee,1,1,"boolean-field",5),b.Sb(),b.Tb(5,"actions"),b.Tb(6,"button",6),b.bc("click",(function(){return b.wc(n),b.dc().save()})),b.ec(7,"async"),b.Hc(8),b.Sb(),b.Sb(),b.Sb(),b.Qb()}if(2&e){var i=b.dc();b.zb(1),b.kc("heading",i.i18n.brokers.title.new)("mobileHeading",i.i18n.brokers.mobileTitle.new),b.zb(1),b.kc("formGroup",i.form),b.zb(1),b.kc("filters",i.userQuery)("allowContacts",!1)("label",i.i18n.brokers.broker),b.zb(1),b.kc("ngIf",i.data.brokers),b.zb(2),b.kc("disabled",b.fc(7,9,i.requesting$)),b.zb(2),b.Jc(" ",i.i18n.general.save," ")}}var Ne,Re=((Ne=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).brokeringService=i,a.form=a.formBuilder.group({}),a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.addSub(this.brokeringService.getBrokerDataForAdd({user:this.user}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){this.userQuery={roles:[ze.eb.BROKER],usersToExclude:e.brokers.map((function(e){return e.id})),groups:e.brokerGroups.map((function(e){return e.id}))},e.brokers&&this.form.setControl("mainBroker",this.formBuilder.control(!1)),this.form.setControl("broker",this.formBuilder.control(null,q.G.required))}},{key:"save",value:function(){var e=this;if(Object(J.F)(this.form),this.form.valid){var t=this.form.value;this.addSub(this.brokeringService.addBroker({broker:t.broker,user:this.user,main:t.mainBroker}).subscribe((function(){e.notification.snackBar(e.i18n.brokers.brokerAdded),e.router.navigate(["/users",e.user,"brokers"])})))}}},{key:"resolveMenu",value:function(){return this.authHelper.searchUsersMenu()}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Ne)(b.Nb(b.r),b.Nb(c.g))},Ne.\u0275cmp=b.Hb({type:Ne,selectors:[["broker-form"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],[3,"formGroup"],["formControlName","broker",3,"filters","allowContacts","label"],["formControlName","mainBroker",3,"label",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["formControlName","mainBroker",3,"label"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,_e,9,11,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,q.I,q.w,q.n,ye.a,q.v,q.l,Q.a,we.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Ne);function Pe(e,t){if(1&e&&b.Ob(0,"user-info",7),2&e){var n=b.dc(2);b.kc("user",n.data.user)}}function De(e,t){1&e&&b.Ob(0,"icon",17)}function He(e,t){if(1&e){var n=b.Ub();b.Tb(0,"a",18),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(2).setMain(t),e.stopPropagation(),e.preventDefault()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(3);b.zb(1),b.Jc("",i.i18n.brokers.setMain," ")}}function xe(e,t){if(1&e){var n=b.Ub();b.Tb(0,"mobile-result",8),b.Tb(1,"div",9),b.Tb(2,"div"),b.Tb(3,"div",10),b.Hc(4),b.Sb(),b.Tb(5,"div",11),b.Fc(6,De,1,0,"icon",12),b.Fc(7,He,2,1,"a",13),b.Sb(),b.Sb(),b.Tb(8,"div",14),b.Tb(9,"button",15),b.bc("click",(function(e){b.wc(n);var i=t.$implicit;return b.dc(2).remove(i),e.stopPropagation(),e.preventDefault()})),b.Ob(10,"icon",16),b.Sb(),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit;b.kc("avatarImage",null==i.broker?null:i.broker.image),b.zb(4),b.Jc(" ",i.broker.display," "),b.zb(2),b.kc("ngIf",i.main),b.zb(1),b.kc("ngIf",!i.main)}}function Le(e,t){1&e&&b.Ob(0,"icon",17)}function Me(e,t){if(1&e){var n=b.Ub();b.Tb(0,"a",18),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(3).setMain(t),e.stopPropagation(),e.preventDefault()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(4);b.zb(1),b.Jc("",i.i18n.brokers.setMain," ")}}var Ue=function(e,t){return{"pb-0":e,"border-0":t}};function $e(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"tr",24),b.bc("click",(function(){b.wc(n);var e=t.$implicit,i=b.dc(3);return i.router.navigate(i.path(e))})),b.Tb(2,"td",25),b.ec(3,"async"),b.ec(4,"async"),b.Ob(5,"avatar",26),b.Sb(),b.Tb(6,"td"),b.Tb(7,"a",27),b.Hc(8),b.Sb(),b.Sb(),b.Tb(9,"td",28),b.Fc(10,Le,1,0,"icon",12),b.Fc(11,Me,2,1,"a",13),b.Sb(),b.Tb(12,"td",29),b.Tb(13,"button",30),b.bc("click",(function(e){b.wc(n);var i=t.$implicit;return b.dc(3).remove(i),e.stopPropagation()})),b.Ob(14,"icon",16),b.Sb(),b.Sb(),b.Sb(),b.Qb()}if(2&e){var i=t.$implicit,a=b.dc(3);b.zb(2),b.kc("ngClass",b.oc(12,Ue,b.fc(3,8,a.layout.xxs$),b.fc(4,10,a.layout.xxs$))),b.zb(3),b.kc("image",null==i.broker?null:i.broker.image)("tooltip",null==i.broker?null:i.broker.display),b.zb(2),b.kc("routerLink",a.path(i)),b.zb(1),b.Jc(" ",i.broker.shortDisplay," "),b.zb(2),b.kc("ngIf",i.main),b.zb(1),b.kc("ngIf",!i.main),b.zb(2),b.kc("tooltip",a.i18n.general.remove)}}function Ge(e,t){if(1&e&&(b.Tb(0,"table",19),b.Tb(1,"thead"),b.Ob(2,"th",20),b.Tb(3,"th"),b.Hc(4),b.Sb(),b.Tb(5,"th",21),b.Hc(6),b.Sb(),b.Ob(7,"th",22),b.Sb(),b.Tb(8,"tbody"),b.Fc(9,$e,15,15,"ng-container",23),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(4),b.Ic(n.i18n.general.user),b.zb(2),b.Jc("",n.i18n.brokers.mainBroker," "),b.zb(3),b.kc("ngForOf",n.data.brokers)}}function Be(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"page-content",2),b.ec(2,"async"),b.Fc(3,Pe,1,1,"user-info",3),b.Sb(),b.Tb(4,"results-layout",4),b.Fc(5,xe,11,4,"mobile-result",5),b.Fc(6,Ge,10,3,"table",6),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("heading",n.i18n.brokers.title.list)("mobileHeading",n.i18n.brokers.mobileTitle.list)("headingActions",b.fc(2,7,n.headingActions$))("mode",n.self?"empty":"normal"),b.zb(2),b.kc("ngIf",!n.self),b.zb(1),b.kc("results",n.data.brokers)("toLink",n.toLink)}}var Je,Ve=((Je=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).brokeringService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param}).subscribe((function(t){e.data=t})))}},{key:"path",value:function(e){return["/users",e.broker.id,"profile"]}},{key:"onDataInitialized",value:function(e){var t=this;this.self=this.authHelper.isSelf(e.user),this.brokers=e.brokers,this.headingActions=[],e.editable&&this.headingActions.push(new B.c("registration",this.i18n.general.addNew,(function(){return t.router.navigate(["/users",t.param,"brokers","new"])}),!0)),e.history&&this.headingActions.push(new B.c("history",this.i18n.general.viewHistory,(function(){return t.router.navigate(["/users",t.param,"brokers","history"])}),!0))}},{key:"setMain",value:function(e){var t=this;this.addSub(this.brokeringService.setMainBroker({broker:e.broker.id,user:this.param}).subscribe((function(){t.reload()})))}},{key:"remove",value:function(e){var t=this;this.notification.confirm({message:this.i18n.general.removeConfirm(e.broker.display),callback:function(){return t.doRemove(e)}})}},{key:"doRemove",value:function(e){var t=this;this.addSub(this.brokeringService.removeBroker({broker:e.broker.id,user:this.param}).subscribe((function(){t.notification.snackBar(t.i18n.general.removeDone(e.broker.display)),t.reload()})))}},{key:"resolveMenu",value:function(){return this.authHelper.searchUsersMenu()}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Je)(b.Nb(b.r),b.Nb(c.g))},Je.\u0275cmp=b.Hb({type:Je,selectors:[["list-user-brokers"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],["avatarIcon","user",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],["class","d-inline-block","icon","done_outline",4,"ngIf"],["class","decorated",3,"click",4,"ngIf"],[1,"ml-auto"],[1,"btn","btn-icon",3,"click"],["icon","clear"],["icon","done_outline",1,"d-inline-block"],[1,"decorated",3,"click"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","20%",1,"text-center"],[1,"actions"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"],[3,"routerLink"],[1,"text-center"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Be,7,9,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,h.a,v.a,y.a,k.a,S.a,I.a,p.s,p.q,ke.a,T.b,a.h],pipes:[p.b],encapsulation:2,changeDetection:0}),Je),qe=n("zisa"),je=n("Dhej");function Qe(e,t){1&e&&b.Pb(0)}function Ye(e,t){if(1&e&&(b.Tb(0,"mobile-result",8),b.Tb(1,"div",9),b.Hc(2),b.Sb(),b.Tb(3,"div",10),b.Hc(4),b.ec(5,"date"),b.Sb(),b.Tb(6,"div",11),b.Hc(7),b.Sb(),b.Tb(8,"div",11),b.Hc(9),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.kc("avatarImage",null==n.broker?null:n.broker.image),b.zb(2),b.Jc(" ",n.broker.display," "),b.zb(2),b.Jc(" ",b.fc(5,7,n.date)," "),b.zb(3),b.Kc(" ",i.i18n.general.action,": ",i.showActionLabel(n)," "),b.zb(2),b.Kc(" ",i.i18n.general.performedBy,": ",n.by?n.by.shortDisplay:i.i18n.brokers.administration," ")}}var Ke=function(e,t){return{"pb-0":e,"border-0":t}};function Xe(e,t){if(1&e&&(b.Tb(0,"tr"),b.Tb(1,"td",15),b.ec(2,"async"),b.ec(3,"async"),b.Ob(4,"avatar",16),b.Sb(),b.Tb(5,"td"),b.Hc(6),b.Sb(),b.Tb(7,"td"),b.Hc(8),b.ec(9,"date"),b.Sb(),b.Tb(10,"td"),b.Hc(11),b.Sb(),b.Tb(12,"td"),b.Hc(13),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(1),b.kc("ngClass",b.oc(13,Ke,b.fc(2,7,i.layout.xxs$),b.fc(3,9,i.layout.xxs$))),b.zb(3),b.kc("image",null==n.broker?null:n.broker.image)("tooltip",null==n.broker?null:n.broker.display),b.zb(2),b.Ic(n.broker.shortDisplay),b.zb(2),b.Ic(b.fc(9,11,n.date)),b.zb(3),b.Ic(i.showActionLabel(n)),b.zb(2),b.Jc(" ",n.by?n.by.shortDisplay:i.i18n.brokers.administration," ")}}function We(e,t){if(1&e&&(b.Tb(0,"table",12),b.Tb(1,"thead"),b.Ob(2,"th",13),b.Tb(3,"th"),b.Hc(4),b.Sb(),b.Tb(5,"th"),b.Hc(6),b.Sb(),b.Tb(7,"th"),b.Hc(8),b.Sb(),b.Tb(9,"th"),b.Hc(10),b.Sb(),b.Sb(),b.Tb(11,"tbody"),b.Fc(12,Xe,14,16,"tr",14),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(4),b.Ic(n.i18n.brokers.broker),b.zb(2),b.Ic(n.i18n.general.date),b.zb(2),b.Ic(n.i18n.general.action),b.zb(2),b.Ic(n.i18n.general.performedBy),b.zb(2),b.kc("ngForOf",n.data.history)}}function Ze(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.Ob(1,"user-info",4),b.Sb(),b.Tb(2,"results-layout",5),b.Fc(3,Ye,10,9,"mobile-result",6),b.Fc(4,We,13,5,"table",7),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.i18n.brokers.title.history)("mobileHeading",n.i18n.brokers.mobileTitle.history),b.zb(1),b.kc("user",n.data.user),b.zb(1),b.kc("results",n.data.history)("onClick",n.onClick)}}var et,tt=((et=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).brokeringService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.brokeringService.getUserBrokersData({user:this.param,fields:["user","history"]}).subscribe((function(t){e.data=t})))}},{key:"showActionLabel",value:function(e){switch(e.action){case qe.a.ADD:return this.i18n.brokers.action.add;case qe.a.REMOVE:return this.i18n.brokers.action.remove;case qe.a.SET_MAIN:return this.i18n.brokers.action.setMain}}},{key:"resolveMenu",value:function(e){return this.authHelper.searchUsersMenu(e.user)}},{key:"onClick",get:function(){return function(e){return null!=e}}}]),n}(u.a)).\u0275fac=function(e){return new(e||et)(b.Nb(b.r),b.Nb(je.a))},et.\u0275cmp=b.Hb({type:et,selectors:[["view-broker-history"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results","onClick"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover",4,"resultTable"],["avatarIcon","user",3,"avatarImage"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[1,"avatar"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Qe,1,0,"ng-container",1),b.Sb(),b.Fc(3,Ze,5,5,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,k.a,h.a,v.a,y.a,S.a,p.s,p.q,ke.a,T.b],pipes:[p.b,C.a],encapsulation:2,changeDetection:0}),et),nt=n("4APx");function it(e,t){if(1&e&&b.Ob(0,"field-option",13),2&e){var n=t.$implicit;b.kc("value",n.id)("internalName",n.internalName)("id",n.id)("text",n.name)}}function at(e,t){if(1&e&&(b.Tb(0,"div",6),b.Tb(1,"multi-selection-field",11),b.Fc(2,it,1,4,"field-option",12),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.connectedUser.channel),b.zb(1),b.kc("ngForOf",n.data.channels)}}function rt(e,t){if(1&e&&b.Ob(0,"field-option",16),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",n)("text",i.showConnectedLabel(n))}}function ot(e,t){if(1&e&&(b.Tb(0,"div",6),b.Tb(1,"multi-selection-field",14),b.Fc(2,rt,1,2,"field-option",15),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.connectedUser.showConnected),b.zb(1),b.kc("ngForOf",n.data.roles)}}function ct(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",24),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(2).disconnect(t),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",25),b.Sb()}}function st(e,t){if(1&e&&(b.Tb(0,"mobile-result",17),b.Tb(1,"div",18),b.Tb(2,"div"),b.Tb(3,"div",19),b.Hc(4),b.Sb(),b.Tb(5,"div",20),b.Hc(6),b.ec(7,"dateTime"),b.Sb(),b.Tb(8,"div",21),b.Hc(9),b.Sb(),b.Sb(),b.Tb(10,"div",22),b.Fc(11,ct,2,0,"button",23),b.Sb(),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.kc("avatarImage",null==n.user?null:n.user.image),b.zb(4),b.Jc(" ",n.user.shortDisplay," "),b.zb(2),b.Jc(" ",b.fc(7,5,n.creationDate)," "),b.zb(3),b.Jc(" ",n.channel.name," "),b.zb(2),b.kc("ngIf",i.canDisconnect(n))}}function lt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",33),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(3).disconnect(t),e.stopPropagation()})),b.Ob(1,"icon",25),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.connectedUser.disconnect)}}var ut=function(e,t){return{"pb-0":e,"border-0":t}};function dt(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"tr"),b.Tb(2,"td",30),b.ec(3,"async"),b.ec(4,"async"),b.Ob(5,"avatar",31),b.Sb(),b.Tb(6,"td"),b.Hc(7),b.Sb(),b.Tb(8,"td"),b.Hc(9),b.Sb(),b.Tb(10,"td"),b.Hc(11),b.ec(12,"dateTime"),b.Sb(),b.Tb(13,"td"),b.Hc(14),b.Sb(),b.Tb(15,"td",28),b.Fc(16,lt,2,1,"button",32),b.Sb(),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(2),b.kc("ngClass",b.oc(14,ut,b.fc(3,8,i.layout.xxs$),b.fc(4,10,i.layout.xxs$))),b.zb(3),b.kc("image",null==n.user?null:n.user.image)("tooltip",null==n.user?null:n.user.display),b.zb(2),b.Ic(n.user.shortDisplay),b.zb(2),b.Ic(n.channel.name),b.zb(2),b.Ic(b.fc(12,12,n.creationDate)),b.zb(3),b.Ic(n.remoteAddress),b.zb(2),b.kc("ngIf",i.canDisconnect(n))}}function bt(e,t){if(1&e&&(b.Tb(0,"table",26),b.Tb(1,"thead"),b.Ob(2,"th",27),b.Tb(3,"th"),b.Hc(4),b.Sb(),b.Tb(5,"th"),b.Hc(6),b.Sb(),b.Tb(7,"th"),b.Hc(8),b.Sb(),b.Tb(9,"th"),b.Hc(10),b.Sb(),b.Ob(11,"th",28),b.Sb(),b.Tb(12,"tbody"),b.Fc(13,dt,17,17,"ng-container",29),b.ec(14,"async"),b.Sb(),b.Sb()),2&e){var n,i=b.dc(2),a=null==(n=b.fc(14,5,i.results$))?null:n.results;b.zb(4),b.Ic(i.i18n.general.user),b.zb(2),b.Ic(i.i18n.connectedUser.channel),b.zb(2),b.Ic(i.i18n.connectedUser.loggedInAt),b.zb(2),b.Ic(i.i18n.connectedUser.ipAddress),b.zb(3),b.kc("ngForOf",a)}}function ft(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"page-content",2),b.Tb(2,"form",3),b.Tb(3,"div",4),b.Fc(4,at,3,2,"div",5),b.Fc(5,ot,3,2,"div",5),b.Tb(6,"div",6),b.Ob(7,"user-field",7),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Tb(8,"results-layout",8),b.bc("update",(function(e){return b.wc(n),b.dc().update(e)})),b.ec(9,"async"),b.Fc(10,st,12,7,"mobile-result",9),b.Fc(11,bt,15,7,"table",10),b.Sb(),b.Qb()}if(2&e){var i=b.dc();b.zb(1),b.kc("heading",i.i18n.connectedUser.title)("mobileHeading",i.i18n.connectedUser.mobileTitle),b.zb(1),b.kc("formGroup",i.form),b.zb(2),b.kc("ngIf",(null==i.data.channels?null:i.data.channels.length)>1),b.zb(1),b.kc("ngIf",(null==i.data.roles?null:i.data.roles.length)>1),b.zb(2),b.kc("label",i.i18n.general.user),b.zb(1),b.kc("results",b.fc(9,9,i.results$))("onClick",i.onClick)("rendering$",i.rendering$)}}var mt,pt=((mt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).sessionsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.addSub(this.sessionsService.getSessionDataForSearch().subscribe((function(t){e.form.patchValue(t.query,{emitEvent:!1}),e.data=t})))}},{key:"toSearchParams",value:function(e){return e}},{key:"disconnect",value:function(e){var t=this;this.addSub(this.sessionsService.disconnectSession({sessionToken:e.sessionToken}).subscribe((function(){t.notification.snackBar(t.i18n.connectedUser.disconnected(e.user.display)),t.update()})))}},{key:"canDisconnect",value:function(e){return this.login.auth.permissions.sessions.disconnect&&this.login.auth.sessionToken!==e.sessionToken}},{key:"getFormControlNames",value:function(){return["channels","roles","user"]}},{key:"doSearch",value:function(e){return this.sessionsService.searchSessions$Response(e)}},{key:"showConnectedLabel",value:function(e){switch(e){case ze.eb.ADMINISTRATOR:return this.i18n.connectedUser.viewConnected.admin;case ze.eb.BROKER:return this.i18n.connectedUser.viewConnected.broker;case ze.eb.MEMBER:return this.i18n.connectedUser.viewConnected.member;case ze.eb.OPERATOR:return this.i18n.connectedUser.viewConnected.operator}}},{key:"resolveMenu",value:function(){return this.authHelper.searchUsersMenu()}},{key:"onClick",get:function(){return function(e){return null!=e}}}]),n}(pe.a)).\u0275fac=function(e){return new(e||mt)(b.Nb(b.r),b.Nb(c.D))},mt.\u0275cmp=b.Hb({type:mt,selectors:[["search-connected"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","formControlName","channels",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","roles",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["avatarIcon","user",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[1,"ml-auto"],["class","btn btn-icon",3,"click",4,"ngIf"],[1,"btn","btn-icon",3,"click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,ft,12,11,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,q.I,q.w,q.n,ye.a,q.v,q.l,h.a,v.a,y.a,nt.a,p.s,ve.a,S.a,I.a,p.q,ke.a,T.b],pipes:[p.b,O.a],encapsulation:2,changeDetection:0}),mt),gt=n("LvDl"),ht=n("2Vo4"),vt=n("7HWn"),yt=n("DIHi"),kt=n("YG2p"),St=n("ZJXG");function Tt(e,t){if(1&e&&b.Ob(0,"boolean-field",16),2&e){var n=b.dc(2);b.kc("label",n.i18n.document.brokerManageable)}}function It(e,t){if(1&e){var n=b.Ub();b.Tb(0,"label-value",17),b.Tb(1,"div"),b.Tb(2,"span"),b.Hc(3),b.ec(4,"async"),b.Sb(),b.Tb(5,"button",18),b.bc("click",(function(e){return b.wc(n),b.dc(2).download(),e.stopPropagation()})),b.Ob(6,"icon",19),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc(2);b.kc("label",i.i18n.document.document),b.zb(3),b.Jc(" ",b.fc(4,3,i.fileName$)," "),b.zb(2),b.kc("tooltip",i.i18n.general.download)}}function Ct(e,t){if(1&e&&(b.Rb(0,4),b.Tb(1,"label-value",5),b.Ob(2,"user-link",6),b.Sb(),b.Ob(3,"input-field",7),b.Ob(4,"textarea-field",8),b.Ob(5,"boolean-field",9),b.Ob(6,"boolean-field",10),b.Ob(7,"boolean-field",11,12),b.Fc(9,Tt,1,1,"boolean-field",13),b.Fc(10,It,7,5,"label-value",14),b.ec(11,"async"),b.Ob(12,"file-field",15),b.ec(13,"async"),b.Qb()),2&e){var n=b.uc(8),i=b.dc();b.kc("formGroup",i.form),b.zb(1),b.kc("label",i.i18n.general.user),b.zb(1),b.kc("user",i.data.user),b.zb(1),b.kc("label",i.i18n.general.name),b.zb(1),b.kc("label",i.i18n.general.description),b.zb(1),b.kc("label",i.i18n.document.enable),b.zb(1),b.kc("label",i.i18n.document.userVisible),b.zb(1),b.kc("label",i.i18n.document.brokerVisible),b.zb(2),b.kc("ngIf",n.value),b.zb(1),b.kc("ngIf",!i.create&&b.fc(11,13,i.fileName$)),b.zb(2),b.kc("required",i.create)("label",i.create||null!==b.fc(13,15,i.fileName$)?i.i18n.document.newDocument:i.i18n.document.replaceDocument)("formControl",i.fileControl)}}var Ot,Ft=((Ot=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).documentsService=i,a.fileName$=new ht.a(null),a}return _createClass(n,[{key:"isOwner",value:function(){return this.authHelper.isSelf(this.data.user)}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot;this.user=t.params.user,this.id=t.params.id,this.create=null==this.id;var i=this.create?this.documentsService.getUserDocumentDataForNew({user:this.user}):this.documentsService.getDocumentDataForEdit({id:this.id});this.addSub(i.subscribe((function(t){return e.data=t})))}},{key:"download",value:function(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(J.g))}},{key:"onDataInitialized",value:function(e){var t;_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e);var i=e.document,a=e.document;this.create||this.fileName$.next(null===(t=e.file)||void 0===t?void 0:t.name),this.fileControl=this.formBuilder.control(null,this.create?q.G.required:null),this.form=this.formBuilder.group({name:[i.name,q.G.required],description:i.description,enabled:i.enabled,userVisible:i.userVisible,brokerVisible:i.brokerVisible,brokerManageable:i.brokerManageable,version:a.version})}},{key:"asEdit",value:function(){return this.data}},{key:"asNew",value:function(){return this.data}},{key:"save",value:function(){var e=this;Object(J.F)(this.form);var t=this.fileControl.value;if((this.create||t)&&Object(J.F)(this.fileControl),this.form.valid&&this.fileControl.valid){var n=Object(gt.cloneDeep)(this.form.value);n.brokerVisible||(n.brokerManageable=!1),this.addSub(this.create?this.documentsService.createUserDocumentWithUpload({user:this.user,body:{document:n,file:t}}).subscribe((function(t){return e.notifySavedAndReload(t)})):this.fileControl.value?this.documentsService.updateDocumentWithUpload({id:this.id,body:{document:n,file:t}}).subscribe((function(){return e.notifySavedAndReload(e.id)})):this.documentsService.updateDocument({id:this.id,body:n}).subscribe((function(){return e.notifySavedAndReload(e.id)})))}}},{key:"notifySavedAndReload",value:function(e){this.notification.snackBar(this.i18n.document.savedSuccessfully),this.router.navigate(["/users","documents","edit",e])}},{key:"formControl",value:function(e){return this.form.get(e)}},{key:"resolveMenu",value:function(){return this.authHelper.searchUsersMenu()}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Ot)(b.Nb(b.r),b.Nb(c.l))},Ot.\u0275cmp=b.Hb({type:Ot,selectors:[["edit-document"]],features:[b.wb],decls:8,vars:10,consts:[[3,"ready"],[3,"heading","mobileHeading"],[3,"formGroup",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],[3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["fieldSize","full","required","","formControlName","name",3,"label"],["formControlName","description",3,"label"],["formControlName","enabled",3,"label"],["formControlName","userVisible",3,"label"],["formControlName","brokerVisible",3,"label"],["brokerVisible",""],["formControlName","brokerManageable",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],[3,"required","label","formControl"],["formControlName","brokerManageable",3,"label"],[3,"label"],[1,"btn","btn-icon","ml-2",3,"tooltip","click"],["icon","save_alt"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Tb(2,"page-content",1),b.Fc(3,Ct,14,17,"ng-container",2),b.Tb(4,"actions"),b.Tb(5,"button",3),b.bc("click",(function(){return t.save()})),b.ec(6,"async"),b.Hc(7),b.Sb(),b.Sb(),b.Sb(),b.Sb()),2&e&&(b.kc("ready",b.fc(1,6,t.data$)),b.zb(2),b.kc("heading",t.create?t.i18n.document.title.new:t.i18n.document.title.edit)("mobileHeading",t.create?t.i18n.document.mobileTitle.new:t.i18n.document.mobileTitle.edit),b.zb(1),b.kc("ngIf",t.data),b.zb(2),b.kc("disabled",b.fc(6,8,t.requesting$)),b.zb(2),b.Jc(" ",t.i18n.general.save," "))},directives:[m.a,g.a,p.t,Q.a,q.w,q.n,j.a,vt.a,yt.a,q.D,q.v,q.l,kt.a,we.a,St.a,q.k,T.b,I.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Ot);function zt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",10),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(2).download(t),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",11),b.Sb()}if(2&e){var i=b.dc(3);b.kc("tooltip",i.i18n.general.download)}}function At(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",10),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit,i=b.dc(2);return i.router.navigate(i.path(t)),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",12),b.Sb()}if(2&e){var i=b.dc(3);b.kc("tooltip",i.i18n.document.process)}}function wt(e,t){if(1&e&&(b.Tb(0,"mobile-result"),b.Tb(1,"div",6),b.Tb(2,"div"),b.Tb(3,"label-value",7),b.Hc(4),b.Sb(),b.Tb(5,"label-value",7),b.Hc(6),b.Sb(),b.Sb(),b.Tb(7,"div",8),b.Fc(8,zt,2,1,"button",9),b.Fc(9,At,2,1,"button",9),b.Sb(),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(3),b.kc("label",i.i18n.general.name),b.zb(1),b.Jc(" ",n.name," "),b.zb(1),b.kc("label",i.i18n.general.description),b.zb(1),b.Jc(" ",n.description," "),b.zb(2),b.kc("ngIf",i.isStatic(n.kind)),b.zb(1),b.kc("ngIf",!i.isStatic(n.kind))}}function Et(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",10),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(3).download(t),e.stopPropagation()})),b.Ob(1,"icon",11),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.general.download)}}function _t(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",10),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit,i=b.dc(3);return i.router.navigate(i.path(t)),e.stopPropagation()})),b.Ob(1,"icon",12),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.document.process)}}function Nt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"tr",16),b.bc("click",(function(e){b.wc(n);var i=t.$implicit,a=b.dc(3);return a.isStatic(i.kind)?a.download(i):a.router.navigate(a.path(i)),e.stopPropagation()})),b.Tb(1,"td",17),b.Hc(2),b.Sb(),b.Tb(3,"td"),b.Hc(4),b.Sb(),b.Tb(5,"td",18),b.Fc(6,Et,2,1,"button",9),b.Fc(7,_t,2,1,"button",9),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc(3);b.zb(2),b.Ic(i.name),b.zb(2),b.Ic(i.description),b.zb(2),b.kc("ngIf",a.isStatic(i.kind)),b.zb(1),b.kc("ngIf",!a.isStatic(i.kind))}}function Rt(e,t){if(1&e&&(b.Tb(0,"table",13),b.Tb(1,"thead"),b.Tb(2,"th"),b.Hc(3),b.Sb(),b.Tb(4,"th"),b.Hc(5),b.Sb(),b.Ob(6,"th",14),b.Sb(),b.Tb(7,"tbody"),b.Fc(8,Nt,8,4,"tr",15),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(3),b.Ic(n.i18n.general.name),b.zb(2),b.Ic(n.i18n.general.description),b.zb(3),b.kc("ngForOf",n.data)}}function Pt(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"page-content",2),b.ec(2,"async"),b.Tb(3,"results-layout",3),b.Fc(4,wt,10,6,"mobile-result",4),b.Fc(5,Rt,9,3,"table",5),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("mode","empty")("heading",n.i18n.document.title.list)("mobileHeading",n.i18n.document.mobileTitle.list)("headingActions",b.fc(2,5,n.headingActions$)),b.zb(2),b.kc("results",n.data)}}var Dt,Ht=((Dt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).documentsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.addSub(this.documentsService.listUserDocuments({user:me.a.SELF}).subscribe((function(t){return e.data=t})))}},{key:"isStatic",value:function(e){return e!==ze.u.DYNAMIC}},{key:"download",value:function(e){this.addSub(this.documentsService.downloadDocumentFile$Response({id:e.id}).subscribe(J.g))}},{key:"path",value:function(e){return["/users","documents","process-dynamic",e.id]}},{key:"resolveMenu",value:function(){return this.authHelper.userMenu(null,d.b.MY_DOCUMENTS)}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Dt)(b.Nb(b.r),b.Nb(c.l))},Dt.\u0275cmp=b.Hb({type:Dt,selectors:[["list-documents"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","save_alt"],["icon","edit"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Pt,6,7,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,h.a,v.a,y.a,S.a,j.a,T.b,I.a,p.s],pipes:[p.b],encapsulation:2,changeDetection:0}),Dt),xt=n("OoS4"),Lt=n("Y+zs"),Mt=n("bBjs"),Ut=n("cyUc");function $t(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"custom-field-input",6),b.Qb()),2&e){var n=t.$implicit,i=t.first,a=b.dc(2);b.zb(1),b.kc("field",n)("formControl",a.formControl(n.internalName))("focused",i)("labelPosition","auto")}}function Gt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.Fc(1,$t,2,4,"ng-container",4),b.Tb(2,"actions"),b.Tb(3,"button",5),b.bc("click",(function(){return b.wc(n),b.dc().process()})),b.Hc(4),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.data.document.name)("mobileHeading",i.data.document.name),b.zb(1),b.kc("ngForOf",i.formFields),b.zb(3),b.Jc(" ",i.i18n.general.submit," ")}}function Bt(e,t){if(1&e&&(b.Tb(0,"page-content",7),b.ec(1,"async"),b.Ob(2,"div",8),b.ec(3,"trust"),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.data.document.name)("mobileHeading",n.data.document.name)("headingActions",b.fc(1,4,n.headingActions$)),b.zb(2),b.kc("innerHTML",b.fc(3,6,n.result),b.xc)}}var Jt,Vt=((Jt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).fieldsHelper=i,r.documentsService=a,r.step$=new ht.a(null),r.result$=new ht.a(null),r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.documentId=this.route.snapshot.params.id,this.addSub(this.documentsService.getDataForDynamicDocument({id:this.documentId,user:me.a.SELF}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){this.formFields=e.formFields||[],this.form=this.fieldsHelper.customValuesFormGroup(this.formFields),this.formFields.length>0?this.step="form":this.process()}},{key:"process",value:function(){var e=this;Object(J.F)(this.form),this.form.valid&&this.addSub(this.documentsService.processDynamicDocument({id:this.documentId,user:me.a.SELF,body:{formFields:this.form.value}}).subscribe((function(t){e.result$.next(t);var n=[];n.push(e.exportHelper.printAction()),n[0].maybeRoot=!0,e.headingActions=n,e.step="preview"})))}},{key:"formControl",value:function(e){return this.form.get(e)}},{key:"resolveMenu",value:function(){return this.authHelper.userMenu(null,d.b.MY_DOCUMENTS)}},{key:"result",get:function(){return this.result$.value}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Jt)(b.Nb(b.r),b.Nb(xt.a),b.Nb(c.l))},Jt.\u0275cmp=b.Hb({type:Jt,selectors:[["process-dynamic-document"]],features:[b.wb],decls:5,vars:8,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading",4,"ngSwitchCase"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions",4,"ngSwitchCase"],[3,"heading","mobileHeading"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[3,"field","formControl","focused","labelPosition"],["printContentOnly","","last","",3,"heading","mobileHeading","headingActions"],[3,"innerHTML"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.ec(2,"async"),b.Fc(3,Gt,5,4,"page-content",1),b.Fc(4,Bt,4,8,"page-content",2),b.Sb()),2&e&&(b.kc("ready",b.fc(1,4,t.data$))("ngSwitch",b.fc(2,6,t.step$)),b.zb(3),b.kc("ngSwitchCase","form"),b.zb(1),b.kc("ngSwitchCase","preview"))},directives:[m.a,p.x,p.y,g.a,p.s,Q.a,Lt.a,q.v,q.k,Mt.a],pipes:[p.b,Ut.a],encapsulation:2,changeDetection:0}),Jt);function qt(e,t){1&e&&b.Ob(0,"div",5)}function jt(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div",5),b.Tb(2,"label-value",10),b.Ob(3,"user-link",11),b.Sb(),b.Sb(),b.Fc(4,qt,1,0,"div",12),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.data.user),b.zb(1),b.kc("ngIf",n.layout.gtsm$)}}function Qt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",18),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(2).navigateToView(t),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",19),b.Sb()}if(2&e){var i=b.dc(3);b.kc("tooltip",i.i18n.general.view)}}function Yt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",20),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(2).download(t),e.stopPropagation()})),b.Ob(1,"icon",21),b.Sb()}if(2&e){var i=b.dc(3);b.kc("tooltip",i.i18n.general.download)}}function Kt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",18),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit,i=b.dc(2);return i.router.navigate(i.process(t)),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",19),b.Sb()}if(2&e){var i=b.dc(3);b.kc("tooltip",i.i18n.document.process)}}function Xt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",20),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(2).remove(t),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",22),b.Sb()}if(2&e){var i=b.dc(3);b.kc("tooltip",i.i18n.general.remove)}}function Wt(e,t){if(1&e&&(b.Tb(0,"mobile-result"),b.Tb(1,"div",13),b.Tb(2,"div"),b.Tb(3,"label-value",14),b.Hc(4),b.Sb(),b.Tb(5,"label-value",14),b.Hc(6),b.Sb(),b.Sb(),b.Tb(7,"div",15),b.Fc(8,Qt,2,1,"button",16),b.Fc(9,Yt,2,1,"button",17),b.Fc(10,Kt,2,1,"button",16),b.Fc(11,Xt,2,1,"button",17),b.Sb(),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(3),b.kc("label",i.i18n.general.name),b.zb(1),b.Jc(" ",n.name," "),b.zb(1),b.kc("label",i.i18n.general.description),b.zb(1),b.Jc(" ",n.description," "),b.zb(2),b.kc("ngIf",i.isStatic(n.kind)),b.zb(1),b.kc("ngIf",i.isStatic(n.kind)),b.zb(1),b.kc("ngIf",!i.isStatic(n.kind)),b.zb(1),b.kc("ngIf",i.isUserKind(n))}}function Zt(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",18),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(3).download(t),e.stopPropagation()})),b.Ob(1,"icon",21),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.general.download)}}function en(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",18),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit,i=b.dc(3);return i.router.navigate(i.process(t)),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",19),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.document.process)}}function tn(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",30),b.bc("click",(function(e){b.wc(n);var t=b.dc().$implicit;return b.dc(3).remove(t),e.stopPropagation(),e.preventDefault()})),b.Ob(1,"icon",22),b.Sb()}if(2&e){var i=b.dc(4);b.kc("tooltip",i.i18n.general.remove)}}function nn(e,t){if(1&e){var n=b.Ub();b.Tb(0,"tr",26),b.bc("click",(function(e){b.wc(n);var i=t.$implicit,a=b.dc(3);return a.isStatic(i.kind)?a.navigateToView(i):a.router.navigate(a.process(i)),e.stopPropagation(),e.preventDefault()})),b.Tb(1,"td",27),b.Hc(2),b.Sb(),b.Tb(3,"td"),b.Hc(4),b.Sb(),b.Tb(5,"td",28),b.Fc(6,Zt,2,1,"button",16),b.Fc(7,en,2,1,"button",16),b.Fc(8,tn,2,1,"button",29),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc(3);b.zb(2),b.Ic(i.name),b.zb(2),b.Ic(i.description),b.zb(2),b.kc("ngIf",a.isStatic(i.kind)),b.zb(1),b.kc("ngIf",!a.isStatic(i.kind)),b.zb(1),b.kc("ngIf",a.data.canManageIndividual&&a.isUserKind(i))}}function an(e,t){if(1&e&&(b.Tb(0,"table",23),b.Tb(1,"thead"),b.Tb(2,"th"),b.Hc(3),b.Sb(),b.Tb(4,"th"),b.Hc(5),b.Sb(),b.Ob(6,"th",24),b.Sb(),b.Tb(7,"tbody"),b.Fc(8,nn,9,5,"tr",25),b.ec(9,"async"),b.Sb(),b.Sb()),2&e){var n,i=b.dc(2),a=null==(n=b.fc(9,3,i.results$))?null:n.results;b.zb(3),b.Ic(i.i18n.general.name),b.zb(2),b.Ic(i.i18n.general.description),b.zb(3),b.kc("ngForOf",a)}}function rn(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"page-content",2),b.ec(2,"async"),b.Tb(3,"form",3),b.Tb(4,"div",4),b.Fc(5,jt,5,3,"ng-container",1),b.Tb(6,"div",5),b.Ob(7,"input-field",6),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Tb(8,"results-layout",7),b.ec(9,"async"),b.Fc(10,Wt,12,8,"mobile-result",8),b.Fc(11,an,10,5,"table",9),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("heading",n.i18n.document.title.search)("mobileHeading",n.i18n.document.mobileTitle.search)("headingActions",b.fc(2,8,n.headingActions$)),b.zb(2),b.kc("formGroup",n.form),b.zb(2),b.kc("ngIf",!n.authHelper.isSelf(n.data.user)),b.zb(2),b.kc("label",n.i18n.general.keywords),b.zb(1),b.kc("results",b.fc(9,10,n.results$))("rendering$",n.rendering$)}}var on,cn=((on=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).documentsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.addSub(this.documentsService.getDocumentsDataForSearch({user:this.user}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e),this.headingActions=[new B.c("add",this.i18n.general.add,(function(){t.router.navigate(["/users",t.user,"documents","new"])}),!0)]}},{key:"doSearch",value:function(e){return this.documentsService.searchDocuments$Response(e)}},{key:"remove",value:function(e){var t=this;this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:function(){return t.doRemove(e)}})}},{key:"doRemove",value:function(e){var t=this;this.addSub(this.documentsService.deleteDocument({id:e.id}).subscribe((function(){t.notification.snackBar(t.i18n.general.removeItemDone),t.update()})))}},{key:"toSearchParams",value:function(e){return e}},{key:"getFormControlNames",value:function(){return["brokers","categories","enabled","groups","keywords","range","user"]}},{key:"isStatic",value:function(e){return e!==ze.u.DYNAMIC}},{key:"download",value:function(e){this.addSub(this.documentsService.downloadDocumentFile$Response({id:e.id}).subscribe(J.g))}},{key:"process",value:function(e){return["/users","documents","process-dynamic",e.id]}},{key:"view",value:function(e){return["/users","documents","view",e.id]}},{key:"isUserKind",value:function(e){return e.kind===ze.u.USER}},{key:"navigateToView",value:function(e){this.router.navigate(this.view(e))}},{key:"resolveMenu",value:function(){return this.authHelper.searchUsersMenu()}},{key:"toProcessLink",get:function(){var e=this;return function(t){return e.process(t)}}}]),n}(pe.a)).\u0275fac=function(e){return new(e||on)(b.Nb(b.r),b.Nb(c.l))},on.\u0275cmp=b.Hb({type:on,selectors:[["search-documents"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords","fieldSize","full",3,"label"],["resultType","list",3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon mt-2",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","edit"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],["icon","save_alt"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["width","20%"],[1,"actions","actions-multiple"],["class","btn btn-icon ml-2",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon","ml-2",3,"tooltip","click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,rn,12,12,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,q.I,q.w,q.n,yt.a,q.v,q.l,h.a,v.a,y.a,j.a,vt.a,S.a,T.b,I.a,p.s],pipes:[p.b],encapsulation:2,changeDetection:0}),on);function sn(e,t){if(1&e&&(b.Tb(0,"label-value",8),b.Ob(1,"user-link",9),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.data.user)}}function ln(e,t){if(1&e&&(b.Tb(0,"label-value",10),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.document.category),b.zb(1),b.Jc(" ",n.data.category.name," ")}}function un(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.document.userVisible),b.zb(1),b.Jc(" ",n.format.formatBoolean(n.data.userVisible)," ")}}function dn(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.document.brokerVisible),b.zb(1),b.Jc(" ",n.format.formatBoolean(n.data.brokerVisible)," ")}}function bn(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.document.brokerManageable),b.zb(1),b.Jc(" ",n.format.formatBoolean(n.data.brokerManageable)," ")}}function fn(e,t){if(1&e&&(b.Rb(0),b.Fc(1,sn,2,2,"label-value",4),b.Tb(2,"label-value",5),b.Hc(3),b.Sb(),b.Tb(4,"label-value",5),b.Hc(5),b.Sb(),b.Fc(6,ln,2,2,"label-value",6),b.Tb(7,"label-value",5),b.Hc(8),b.Sb(),b.Fc(9,un,2,2,"label-value",7),b.Fc(10,dn,2,2,"label-value",7),b.Fc(11,bn,2,2,"label-value",7),b.Tb(12,"label-value",5),b.Hc(13),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("ngIf",n.data.user),b.zb(1),b.kc("label",n.i18n.general.name),b.zb(1),b.Jc(" ",n.data.name," "),b.zb(1),b.kc("label",n.i18n.general.description),b.zb(1),b.Jc(" ",n.data.description," "),b.zb(1),b.kc("ngIf",n.data.category),b.zb(1),b.kc("label",n.i18n.document.enable),b.zb(1),b.Jc(" ",n.format.formatBoolean(n.data.enabled)," "),b.zb(1),b.kc("ngIf",n.data.userVisible),b.zb(1),b.kc("ngIf",n.data.brokerVisible),b.zb(1),b.kc("ngIf",n.data.brokerVisible),b.zb(1),b.kc("label",n.i18n.document.document),b.zb(1),b.Jc(" ",n.data.file.name," ")}}var mn,pn=((mn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).documentsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.id=this.route.snapshot.params.id,this.addSub(this.documentsService.viewDocument({id:this.id}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;if(_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e),this.dataForUiHolder.auth.role!==ze.eb.BROKER||e.brokerManageable){var i=[new B.c("edit",this.i18n.general.edit,(function(){return t.navigateToEdit()}),!0)];i.push(new B.c("clear",this.i18n.general.remove,(function(){return t.remove()}),!0)),this.headingActions=i}}},{key:"remove",value:function(){var e=this;this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:function(){return e.doRemove()}})}},{key:"doRemove",value:function(){var e=this;this.addSub(this.documentsService.deleteDocument({id:this.id}).subscribe((function(){e.notification.snackBar(e.i18n.general.removeItemDone),e.router.navigate(["/users",e.data.user.id,"documents","search"])})))}},{key:"download",value:function(){this.addSub(this.documentsService.downloadDocumentFile$Response({id:this.id}).subscribe(J.g))}},{key:"navigateToEdit",value:function(){this.router.navigate(["/users","documents","edit",this.id])}},{key:"resolveMenu",value:function(e){return e.kind===ze.u.USER&&this.authHelper.isSelf(e.user)?this.authHelper.userMenu(null,d.b.MY_DOCUMENTS):this.authHelper.searchUsersMenu()}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||mn)(b.Nb(b.r),b.Nb(c.l))},mn.\u0275cmp=b.Hb({type:mn,selectors:[["view-document"]],features:[b.wb],decls:9,vars:13,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],["ng","",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["ng","",3,"label"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Tb(2,"page-content",1),b.ec(3,"async"),b.Fc(4,fn,14,13,"ng-container",2),b.Tb(5,"actions"),b.Tb(6,"button",3),b.bc("click",(function(){return t.download()})),b.ec(7,"async"),b.Hc(8),b.Sb(),b.Sb(),b.Sb(),b.Sb()),2&e&&(b.kc("ready",b.fc(1,7,t.data$)),b.zb(2),b.kc("heading",t.i18n.document.title.view)("mobileHeading",t.i18n.document.mobileTitle.view)("headingActions",b.fc(3,9,t.headingActions$)),b.zb(2),b.kc("ngIf",t.data),b.zb(2),b.kc("disabled",b.fc(7,11,t.requesting$)),b.zb(2),b.Jc(" ",t.i18n.general.download," "))},directives:[m.a,g.a,p.t,Q.a,j.a,vt.a],pipes:[p.b],encapsulation:2,changeDetection:0}),mn);function gn(e,t){1&e&&b.Pb(0)}function hn(e,t){if(1&e&&(b.Tb(0,"div",11),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(2);b.zb(1),b.Kc(" ",i.i18n.general.performedBy,": ",n.by.display," ")}}function vn(e,t){if(1&e&&(b.Tb(0,"mobile-result",8),b.Tb(1,"div",9),b.Hc(2),b.Sb(),b.Fc(3,hn,2,2,"div",10),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.kc("date",null==n.period?null:n.period.date),b.zb(2),b.Kc(" ",i.i18n.user.group,": ",n.group?n.group.name:i.i18n.user.operatorNoGroup," "),b.zb(1),b.kc("ngIf",n.by)}}function yn(e,t){if(1&e&&(b.Tb(0,"tr"),b.Tb(1,"td"),b.Hc(2),b.ec(3,"date"),b.Sb(),b.Tb(4,"td"),b.Hc(5),b.Sb(),b.Tb(6,"td"),b.Hc(7),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(2),b.Ic(b.fc(3,3,null==n.period?null:n.period.begin)),b.zb(3),b.Jc("",n.group?n.group.name:i.i18n.user.operatorNoGroup," "),b.zb(2),b.Ic(null==n.by?null:n.by.display)}}function kn(e,t){if(1&e&&(b.Tb(0,"table",12),b.Tb(1,"thead"),b.Tb(2,"th"),b.Hc(3),b.Sb(),b.Tb(4,"th"),b.Hc(5),b.Sb(),b.Tb(6,"th"),b.Hc(7),b.Sb(),b.Sb(),b.Tb(8,"tbody"),b.Fc(9,yn,8,5,"tr",13),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(3),b.Ic(n.i18n.general.date),b.zb(2),b.Ic(n.i18n.general.status),b.zb(2),b.Ic(n.i18n.general.performedBy),b.zb(2),b.kc("ngForOf",n.data.history)}}function Sn(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.Ob(1,"user-info",4),b.Sb(),b.Tb(2,"results-layout",5),b.Fc(3,vn,4,4,"mobile-result",6),b.Fc(4,kn,10,4,"table",7),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.operator?n.i18n.groupMembership.title.historyOperator:n.i18n.groupMembership.title.historyUser)("mobileHeading",n.operator?n.i18n.groupMembership.mobileTitle.historyOperator:n.i18n.groupMembership.mobileTitle.historyUser),b.zb(1),b.kc("user",n.data.user),b.zb(1),b.kc("results",n.data.history)}}var Tn,In=((Tn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).groupMembershipService=i,r.userHelper=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["user","history"]}).subscribe((function(t){e.data=t})))}},{key:"resolveMenu",value:function(e){return this.authHelper.searchUsersMenu(e.user)}},{key:"operator",get:function(){return this.userHelper.isOperator(this.data.user)}}]),n}(u.a)).\u0275fac=function(e){return new(e||Tn)(b.Nb(b.r),b.Nb(c.n),b.Nb(s.a))},Tn.\u0275cmp=b.Hb({type:Tn,selectors:[["view-user-group-history"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,gn,1,0,"ng-container",1),b.Sb(),b.Fc(3,Sn,5,4,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,k.a,h.a,v.a,y.a,S.a,p.s],pipes:[p.b,C.a],encapsulation:2,changeDetection:0}),Tn),Cn=n("j79m");function On(e,t){if(1&e&&b.Ob(0,"field-option",11),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",i.ApiHelper.internalNameOrId(n))("id",n.id)("internalName",n.internalName)("text",n.name)}}function Fn(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Ob(1,"hr"),b.Tb(2,"form",6),b.Tb(3,"single-selection-field",7),b.Fc(4,On,1,4,"field-option",8),b.Sb(),b.Ob(5,"textarea-field",9),b.Sb(),b.Tb(6,"actions"),b.Tb(7,"button",10),b.bc("click",(function(){return b.wc(n),b.dc(2).save()})),b.Hc(8),b.Sb(),b.Sb(),b.Qb()}if(2&e){var i=b.dc(2);b.zb(2),b.kc("formGroup",i.form),b.zb(1),b.kc("label",i.i18n.groupMembership.new)("required",!i.allowEmptyGroup)("emptyOption",i.allowEmptyGroup?i.i18n.user.operatorNoGroup:null),b.zb(1),b.kc("ngForOf",i.data.possibleNewGroups),b.zb(1),b.kc("label",i.i18n.general.comments),b.zb(3),b.Ic(i.i18n.general.submit)}}function zn(e,t){if(1&e&&(b.Tb(0,"page-content",2),b.ec(1,"async"),b.Ob(2,"user-info",3),b.Tb(3,"label-value",4),b.Hc(4),b.Sb(),b.Fc(5,Fn,9,7,"ng-container",5),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.operator?n.i18n.groupMembership.title.groupOperator:n.i18n.groupMembership.title.groupUser)("mobileHeading",n.operator?n.i18n.groupMembership.mobileTitle.groupOperator:n.i18n.groupMembership.mobileTitle.groupUser)("headingActions",b.fc(1,7,n.headingActions$)),b.zb(2),b.kc("user",n.data.user),b.zb(1),b.kc("label",n.i18n.groupMembership.current),b.zb(1),b.Jc(" ",n.data.group?n.data.group.name:n.i18n.user.operatorNoGroup," "),b.zb(1),b.kc("ngIf",n.editable)}}var An,wn=((An=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).userHelper=i,r.groupMembershipService=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.groupMembershipService.getGroupMembershipData({user:this.param,fields:["-history"]}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.allowEmptyGroup=this.userHelper.isOperator(e.user)&&!!e.group,this.form=this.formBuilder.group({group:this.allowEmptyGroup?null:[null,q.G.required],comment:null}),this.headingActions=[new B.c("history",this.i18n.general.viewHistory,(function(){return t.router.navigate(["users",t.param,"group","history"])}),!0)]}},{key:"save",value:function(){var e=this;if(Object(J.F)(this.form),this.form.valid){var t,n,i=this.data.possibleNewGroups.find((function(t){return t.id===e.form.value.group}));t=this.userHelper.isOperator(this.data.user)?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,n=i?this.i18n.groupMembership.confirm({user:this.data.user.display,group:i?i.name:this.i18n.user.operatorNoGroup}):this.i18n.groupMembership.confirmAliasOperator(this.data.user.display),this.notification.confirm({title:t,message:n,callback:function(){return e.submit()}})}}},{key:"submit",value:function(){var e=this;this.addSub(this.groupMembershipService.changeGroupMembership({user:this.param,body:this.form.value}).subscribe((function(){e.notification.snackBar(e.operator?e.i18n.groupMembership.doneOperator:e.i18n.groupMembership.doneUser),e.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.searchUsersMenu(e.user)}},{key:"editable",get:function(){return!Object(J.h)(this.data.possibleNewGroups)}},{key:"operator",get:function(){return this.userHelper.isOperator(this.data.user)}}]),n}(u.a)).\u0275fac=function(e){return new(e||An)(b.Nb(b.r),b.Nb(s.a),b.Nb(Cn.a))},An.\u0275cmp=b.Hb({type:An,selectors:[["view-user-group"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","group",3,"label","required","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[1,"btn","btn-primary",3,"click"],[3,"value","id","internalName","text"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,zn,6,9,"page-content",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,k.a,j.a,q.I,q.w,q.n,he.a,q.v,q.l,q.D,p.s,kt.a,Q.a,ve.a],pipes:[p.b],encapsulation:2,changeDetection:0}),An);function En(e,t){1&e&&b.Pb(0)}function _n(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"user-info",7),b.Ob(2,"hr"),b.Qb()),2&e){var n=b.dc(2);b.zb(1),b.kc("user",n.data.user)}}function Nn(e,t){1&e&&b.Ob(0,"hr",18)}function Rn(e,t){if(1&e&&b.Ob(0,"avatar",19),2&e){var n=b.dc().$implicit;b.kc("size",64)("image",n.identityProvider.image)}}function Pn(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.ec(2,"dateTime"),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.zb(1),b.Jc(" ",i.i18n.identityProvider.connectedOn(b.fc(2,1,n.linkDate))," ")}}function Dn(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.Sb()),2&e){var n=b.dc(4);b.zb(1),b.Jc(" ",n.i18n.identityProvider.disconnected," ")}}function Hn(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.name," ")}}function xn(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.email," ")}}var Ln=function(e){return{"mb-3":e}};function Mn(e,t){if(1&e&&(b.Tb(0,"button",20),b.bc("click",(function(){return t.$implicit.onClick()})),b.Hc(1),b.Sb()),2&e){var n=t.$implicit;b.kc("ngClass",b.nc(2,Ln,!t.last)),b.zb(1),b.Jc(" ",n.label," ")}}var Un=function(e){return{"mt-0":e}};function $n(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Nn,1,0,"hr",9),b.Tb(2,"div",10),b.Tb(3,"div",11),b.Fc(4,Rn,1,2,"avatar",12),b.ec(5,"async"),b.Sb(),b.Tb(6,"div",13),b.Tb(7,"h2",14),b.Hc(8),b.Sb(),b.Tb(9,"div",15),b.Fc(10,Pn,3,3,"div",5),b.Fc(11,Dn,2,1,"div",5),b.Fc(12,Hn,2,1,"div",5),b.Fc(13,xn,2,1,"div",5),b.Sb(),b.Sb(),b.Tb(14,"div",16),b.Fc(15,Mn,2,4,"button",17),b.Sb(),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=t.first,a=b.dc(3);b.zb(1),b.kc("ngIf",!i),b.zb(3),b.kc("ngIf",b.fc(5,9,a.layout.gtxxs$)),b.zb(3),b.kc("ngClass",b.nc(11,Un,i)),b.zb(1),b.Jc(" ",n.identityProvider.name,""),b.zb(2),b.kc("ngIf",n.linkDate),b.zb(1),b.kc("ngIf","linked"!==n.status),b.zb(1),b.kc("ngIf",n.name),b.zb(1),b.kc("ngIf",n.email),b.zb(2),b.kc("ngForOf",a.actions(n))}}function Gn(e,t){if(1&e&&(b.Rb(0),b.Fc(1,$n,16,13,"ng-container",8),b.Qb()),2&e){var n=b.dc(2);b.zb(1),b.kc("ngForOf",n.data.identityProviders)}}function Bn(e,t){if(1&e&&(b.Tb(0,"page-content",4),b.Fc(1,_n,3,1,"ng-container",5),b.Fc(2,Gn,2,1,"ng-container",6),b.Sb()),2&e){var n=b.dc(),i=b.uc(6);b.kc("heading",n.title)("mobileHeading",n.mobileTitle),b.zb(1),b.kc("ngIf",n.data.user&&!n.self),b.zb(1),b.kc("ngIf",n.data.identityProviders.length>0)("ngIfElse",i)}}function Jn(e,t){if(1&e&&b.Hc(0),2&e){var n=b.dc();b.Jc(" ",n.i18n.identityProvider.noResults,"\n")}}var Vn,qn=((Vn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).identityProvidersService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.identityProvidersService.getUserIdentityProvidersListData({user:this.param}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){this.self=this.authHelper.isSelf(e.user),this.title=this.self?this.i18n.identityProvider.title.manageSelf:this.i18n.identityProvider.title.manageUser,this.mobileTitle=this.self?this.i18n.identityProvider.mobileTitle.manageSelf:this.i18n.identityProvider.mobileTitle.manageUser}},{key:"actions",value:function(e){var t=this,n=[];return e.status!==ze.yb.LINKED&&this.data.canLink&&n.push(new B.a(this.i18n.identityProvider.action.connect,(function(){t.connect(e)}))),e.status===ze.yb.LINKED&&this.data.canEdit&&n.push(new B.a(this.i18n.identityProvider.action.disconnect,(function(){t.disconnect(e)}))),n}},{key:"connect",value:function(e){var t=this;this.addSub(this.authHelper.identityProviderPopup(e.identityProvider,"link").subscribe((function(e){t.notification.snackBar(t.i18n.identityProvider.action.connectDone({name:e.name,provider:e.identityProvider.name})),t.reload()})))}},{key:"disconnect",value:function(e){var t=this;this.notification.confirm({title:this.i18n.identityProvider.action.disconnect,message:this.i18n.identityProvider.action.disconnectConfirm(e.identityProvider.name),callback:function(){return t.doDisconnect(e)}})}},{key:"doDisconnect",value:function(e){var t=this,n=e.identityProvider;this.addSub(this.identityProvidersService.deleteUserIdentityProvider({user:this.param,identityProvider:n.internalName,disable:!0}).subscribe((function(){t.notification.info(t.i18n.identityProvider.action.disconnectDone(n.name)),t.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.IDENTITY_PROVIDERS)}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Vn)(b.Nb(b.r),b.Nb(c.o))},Vn.\u0275cmp=b.Hb({type:Vn,selectors:[["user-identity-providers"]],features:[b.wb],decls:7,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["noResults",""],[3,"heading","mobileHeading"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["labelCols","2",3,"user"],[4,"ngFor","ngForOf"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-xs-3","col-md-2"],["class","ml-2 mr-5 management-icon","iconSize","64px","icon","perm_identity",3,"size","image",4,"ngIf"],[1,"col-8","col-xs-9","col-md-7"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto btn btn-primary",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px","icon","perm_identity",1,"ml-2","mr-5","management-icon",3,"size","image"],[1,"d-block","ml-auto","btn","btn-primary",3,"ngClass","click"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,En,1,0,"ng-container",1),b.Sb(),b.Fc(3,Bn,3,5,"ng-template",null,2,b.Gc),b.Fc(5,Jn,1,1,"ng-template",null,3,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,k.a,p.s,p.q,ke.a],pipes:[p.b,O.a],encapsulation:2,changeDetection:0}),Vn),jn=n("C2xC"),Qn=n("iXUt");function Yn(e,t){if(1&e&&b.Ob(0,"boolean-field",9),2&e){var n=b.dc(2);b.kc("label",n.i18n.notificationSettings.forwardMessages)("disabled",!n.data.editable)}}var Kn=function(e){return{"border-top-0":e}};function Xn(e,t){if(1&e&&(b.Tb(0,"h2",13),b.Hc(1),b.Sb()),2&e){var n=b.dc(4);b.kc("ngClass",b.nc(2,Kn,!n.data.forwardMessagesAllowed)),b.zb(1),b.Jc(" ",n.i18n.notificationSettings.payments,"")}}function Wn(e,t){if(1&e&&(b.Tb(0,"h3",14),b.Hc(1),b.Sb()),2&e){var n=b.dc(2).$implicit;b.zb(1),b.Jc(" ",n.name," ")}}function Zn(e,t){1&e&&b.Pb(0)}var ei=function(e){return{$implicit:e}};function ti(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Xn,2,4,"h2",10),b.Rb(2,4),b.Fc(3,Wn,2,1,"h3",11),b.Fc(4,Zn,1,0,"ng-container",12),b.Qb(),b.Qb()),2&e){var n=t.ngIf,i=b.dc(),a=i.first,r=i.$implicit,o=b.dc(2),c=b.uc(4);b.zb(1),b.kc("ngIf",a),b.zb(1),b.kc("formGroup",n),b.zb(1),b.kc("ngIf",!o.singleAccount),b.zb(1),b.kc("ngTemplateOutlet",c)("ngTemplateOutletContext",b.nc(5,ei,r))}}function ni(e,t){if(1&e&&(b.Rb(0),b.Fc(1,ti,5,7,"ng-container",1),b.Qb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(1),b.kc("ngIf",i.form.get("userAccounts").get(n.id))}}function ii(e,t){if(1&e&&b.Ob(0,"field-option",17),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",i.ApiHelper.internalNameOrId(n))("id",n.id)("internalName",n.internalName)("text",n.name)}}function ai(e,t){if(1&e&&(b.Tb(0,"multi-selection-field",15),b.Fc(1,ii,1,4,"field-option",16),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.notificationSettings.forwardMessages),b.zb(1),b.kc("ngForOf",n.data.messageCategories)}}var ri=function(e){return{"section-title-action":e}},oi=function(e,t){return{"mr-3":e,"mb-2":t}};function ci(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",13),b.ec(1,"async"),b.Tb(2,"button",21),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(2).enableNotifications(e,!0)})),b.ec(3,"async"),b.ec(4,"async"),b.Hc(5),b.Sb(),b.Tb(6,"button",22),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(2).enableNotifications(e,!1)})),b.Hc(7),b.Sb(),b.Sb()}if(2&e){var i=b.dc(4);b.kc("ngClass",b.nc(10,ri,b.fc(1,4,i.layout.gtsm$))),b.zb(2),b.kc("ngClass",b.oc(12,oi,!b.fc(3,6,i.layout.ltxs$),b.fc(4,8,i.layout.ltxs$))),b.zb(3),b.Jc(" ",i.i18n.notificationSettings.enableAll," "),b.zb(2),b.Jc(" ",i.i18n.notificationSettings.disableAll," ")}}function si(e,t){if(1&e&&(b.Tb(0,"h2",19),b.Tb(1,"div",20),b.Hc(2),b.Sb(),b.Fc(3,ci,8,15,"div",10),b.Sb()),2&e){var n=b.dc(),i=n.first,a=n.$implicit,r=b.dc(2);b.kc("ngClass",b.nc(3,Kn,i&&0===r.data.userAccounts.length&&0===r.data.messageCategories.length&&!r.data.forwardMessagesAllowed)),b.zb(2),b.Jc(" ",a," "),b.zb(1),b.kc("ngIf",!r.adminSettings&&r.notificationSections.get(a).length>3&&r.data.editable)}}function li(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"label-value",23),b.Ob(2,"notification-type-setting",24),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(1),b.kc("label",i.resolveNotificationLabel(n)),b.zb(1),b.kc("setting",n)("options",i.kindFieldOptionsMap.get(n.kind))("form",i.resolveControl(n.kind))("multiSelectionControl",i.kindControlsMap.get(n.kind))("disabled",!i.data.editable)}}function ui(e,t){if(1&e&&(b.Rb(0),b.Fc(1,si,4,5,"h2",18),b.Fc(2,li,3,6,"ng-container",6),b.Qb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(1),b.kc("ngIf",""!==n),b.zb(1),b.kc("ngForOf",i.notificationSections.get(n))}}var di=function(e,t){return{count:e,total:t}};function bi(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2"),b.Hc(2),b.Sb(),b.Tb(3,"label"),b.Hc(4),b.Sb(),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.Ic(n.i18n.general.sendMedium.sms),b.zb(2),b.Ic(n.i18n.notificationSettings.smsCount(b.oc(2,di,n.data.smsCountThisMonth,n.data.maxSmsPerMonth)))}}function fi(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",25),b.bc("click",(function(){return b.wc(n),b.dc(2).save()})),b.ec(1,"async"),b.Hc(2),b.Sb()}if(2&e){var i=b.dc(2);b.kc("disabled",b.fc(1,2,i.requesting$)),b.zb(2),b.Jc(" ",i.i18n.general.save," ")}}function mi(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"page-content",3),b.Tb(2,"form",4),b.Fc(3,Yn,1,2,"boolean-field",5),b.Fc(4,ni,2,1,"ng-container",6),b.Fc(5,ai,2,2,"multi-selection-field",7),b.Fc(6,ui,3,2,"ng-container",6),b.Fc(7,bi,5,5,"ng-container",1),b.Sb(),b.Tb(8,"actions"),b.Fc(9,fi,3,4,"button",8),b.Sb(),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("heading",n.i18n.notificationSettings.title)("mobileHeading",n.i18n.notificationSettings.mobileTitle),b.zb(1),b.kc("formGroup",n.form),b.zb(1),b.kc("ngIf",n.data.forwardMessagesAllowed),b.zb(1),b.kc("ngForOf",n.data.userAccounts),b.zb(1),b.kc("ngIf",n.data.messageCategories.length>0),b.zb(1),b.kc("ngForOf",n.notificationSections.keys()),b.zb(1),b.kc("ngIf",n.data.smsAllowed),b.zb(2),b.kc("ngIf",n.data.editable)}}function pi(e,t){if(1&e&&(b.Rb(0,4),b.Ob(1,"decimal-field",26),b.Ob(2,"decimal-field",27),b.Qb()),2&e){var n=t.$implicit,i=b.dc();b.kc("formGroup",i.form.get("userAccounts").get(n.id).get("paymentAmount")),b.zb(1),b.kc("label",i.i18n.notificationSettings.paymentNotificationsAbove)("scale",n.currency.decimalDigits)("prefix",n.currency.prefix)("suffix",n.currency.suffix)("disabled",!i.data.editable)("emptyLabel",i.i18n.general.notSet),b.zb(1),b.kc("label",i.i18n.notificationSettings.paymentNotificationsBelow)("scale",n.currency.decimalDigits)("prefix",n.currency.prefix)("suffix",n.currency.suffix)("disabled",!i.data.editable)("emptyLabel",i.i18n.general.notSet)}}var gi,hi=((gi=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).notificationSettingsService=i,a.notificationSections=new Map,a.kindControlsMap=new Map,a.kindFieldOptionsMap=new Map,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.addSub(this.notificationSettingsService.getNotificationSettingsDataForEdit({user:this.user}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;if(this.adminSettings=e.role===ze.eb.ADMINISTRATOR,this.form=this.formBuilder.group({version:e.settings.version}),this.adminSettings){if(!this.hasSettings(e))return void this.notification.info(this.i18n.notificationSettings.notAvailableSettings);this.notificationSections.set("",e.settings.notifications),this.form.addControl("forwardMessageCategories",this.formBuilder.control(e.settings.forwardMessageCategories))}e.forwardMessagesAllowed&&this.form.setControl("forwardMessages",this.formBuilder.control(e.settings.forwardMessages));var n,i=[],a=this.formBuilder.array([]),r=_createForOfIteratorHelper(e.settings.notifications);try{var o=function(){var e=n.value,r=t.formBuilder.group({internal:e.internal,kind:e.kind,sms:void 0===e.sms?null:e.sms,email:void 0===e.email?null:e.email});if(t.addSub(r.controls.internal.valueChanges.subscribe((function(){t.updateControls(r)}))),t.updateControls(r),a.push(r),i.push(e.kind),!t.adminSettings){var o=t.resolveSection(e.kind),c=t.notificationSections.get(o);c?c.push(e):t.notificationSections.set(o,[e])}};for(r.s();!(n=r.n()).done;)o()}catch(k){r.e(k)}finally{r.f()}if(i.length>0){var c,s=_createForOfIteratorHelper(i);try{for(s.s();!(c=s.n()).done;){var l,u,d,b=c.value,f=_slicedToArray(this.resolveOptions(b,e),3);l=f[0],u=f[1],d=f[2];var m=this.formBuilder.control(u);this.kindControlsMap.set(b,m),this.form.setControl(d,m),this.kindFieldOptionsMap.set(b,l)}}catch(k){s.e(k)}finally{s.f()}}if(this.form.setControl("notifications",a),!Object(J.h)(e.userAccounts)){this.singleAccount=1===e.userAccounts.length;var p,g=this.formBuilder.group({}),h=_createForOfIteratorHelper(e.userAccounts);try{for(h.s();!(p=h.n()).done;){var v=p.value,y=(e.settings.userAccounts[this.ApiHelper.internalNameOrId(v)]||{}).paymentAmount||{};g.setControl(v.id,this.formBuilder.group({paymentAmount:this.formBuilder.group({min:y.min,max:y.max})}))}}catch(k){h.e(k)}finally{h.f()}this.form.setControl("userAccounts",g)}}},{key:"updateControls",value:function(e){e.controls.internal.value?(e.controls.sms&&e.controls.sms.enable(),e.controls.email&&e.controls.email.enable()):(e.controls.sms&&e.controls.sms.disable(),e.controls.email&&e.controls.email.disable())}},{key:"save",value:function(){var e=this,t=this.notificationSettingsService.saveNotificationSettings({user:this.user,body:this.form.value});this.addSub(t.subscribe((function(){e.reload(),e.notification.snackBar(e.i18n.notificationSettings.saved)})))}},{key:"hasSettings",value:function(e){return!(Object(J.h)(e.settings.notifications)||this.adminSettings&&Object(J.h)(e.messageCategories))}},{key:"resolveSection",value:function(e){return e.startsWith("account")?this.i18n.notificationSettings.accounts:e.startsWith("personal")?this.i18n.notificationSettings.personal:e.startsWith("buyer")?this.i18n.notificationSettings.marketplaceAsBuyer:e.startsWith("seller")?this.i18n.notificationSettings.marketplaceAsSeller:e.startsWith("reference")||e.startsWith("feedback")?this.i18n.notificationSettings.feedbackAndReferences:""}},{key:"resolveMenu",value:function(){return this.adminSettings||this.user===this.ApiHelper.SELF?d.b.NOTIFICATIONS_SETTINGS:this.authHelper.searchUsersMenu()}},{key:"resolveControl",value:function(e){var t,n=_createForOfIteratorHelper(this.form.controls.notifications.controls);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.controls.kind.value===e)return i}}catch(a){n.e(a)}finally{n.f()}return null}},{key:"enableNotifications",value:function(e,t){var n,i=_createForOfIteratorHelper(this.notificationSections.get(e));try{for(i.s();!(n=i.n()).done;){var a=n.value;this.resolveControl(a.kind).controls.internal.setValue(t)}}catch(r){i.e(r)}finally{i.f()}}},{key:"resolveNotificationLabel",value:function(e){switch(e.kind){case ze.J.ADMIN_AD_PENDING_AUTHORIZATION:return this.i18n.notification.admin.adPendingAuthorization;case ze.J.ADMIN_APPLICATION_ERROR:return this.i18n.notification.admin.applicationErrors;case ze.J.ADMIN_EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.admin.externalPaymentExpired;case ze.J.ADMIN_EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.admin.externalPaymentPerformedFailed;case ze.J.ADMIN_GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.generatedVouchersAboutToExpire;case ze.J.ADMIN_GENERATED_VOUCHERS_EXPIRED:return this.i18n.notification.admin.generatedVouchersExpired;case ze.J.ADMIN_NETWORK_CREATED:return this.i18n.notification.admin.networkCreated;case ze.J.ADMIN_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.admin.paymentAwaitingAuthorization;case ze.J.ADMIN_PAYMENT_PERFORMED:return this.i18n.notification.admin.paymentPerformed;case ze.J.ADMIN_SYSTEM_ALERT:return this.i18n.notification.admin.systemAlert;case ze.J.ADMIN_USER_ALERT:return this.i18n.notification.admin.userAlert;case ze.J.ADMIN_USER_IMPORT_REGISTRATION:return"";case ze.J.ADMIN_USER_REGISTRATION:return this.i18n.notification.admin.userRegistration;case ze.J.ADMIN_VOUCHER_BUYING_ABOUT_TO_EXPIRE:return this.i18n.notification.admin.voucherBuyingAboutToExpire;case ze.J.ACCOUNT_ALL_NON_SMS_PERFORMED_PAYMENTS:return this.i18n.notification.user.account.allNonSmsPerformedPayments;case ze.J.ACCOUNT_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.authorizedPaymentCanceled;case ze.J.ACCOUNT_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.authorizedPaymentDenied;case ze.J.ACCOUNT_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.authorizedPaymentExpired;case ze.J.ACCOUNT_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.authorizedPaymentSucceeded;case ze.J.ACCOUNT_BOUGHT_VOUCHERS_ABOUT_TO_EXPIRE:return this.i18n.notification.user.account.boughtVouchersAboutToExpire;case ze.J.ACCOUNT_BOUGHT_VOUCHERS_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.boughtVouchersExpirationDateChanged;case ze.J.ACCOUNT_BOUGHT_VOUCHERS_EXPIRED:return this.i18n.notification.user.account.boughtVouchersExpired;case ze.J.ACCOUNT_EXTERNAL_PAYMENT_EXPIRED:return this.i18n.notification.user.account.externalPaymentExpired;case ze.J.ACCOUNT_EXTERNAL_PAYMENT_PERFORMED_FAILED:return this.i18n.notification.user.account.externalPaymentPerformedFailed;case ze.J.ACCOUNT_EXTERNAL_PAYMENT_RECEIVED_FAILED:return this.i18n.notification.user.account.externalPaymentReceivedFailed;case ze.J.ACCOUNT_INCOMING_RECURRING_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingRecurringPaymentCanceled;case ze.J.ACCOUNT_INCOMING_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingRecurringPaymentFailed;case ze.J.ACCOUNT_INCOMING_RECURRING_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingRecurringPaymentReceived;case ze.J.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_CANCELED:return this.i18n.notification.user.account.incomingScheduledPaymentCanceled;case ze.J.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.incomingScheduledPaymentFailed;case ze.J.ACCOUNT_INCOMING_SCHEDULED_PAYMENT_RECEIVED:return this.i18n.notification.user.account.incomingScheduledPaymentReceived;case ze.J.ACCOUNT_LIMIT_CHANGE:return this.i18n.notification.user.account.limitChange;case ze.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_APPROVED_STILL_PENDING:return this.i18n.notification.user.account.operator.authorizedPaymentApprovedStillPending;case ze.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_CANCELED:return this.i18n.notification.user.account.operator.authorizedPaymentCanceled;case ze.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_DENIED:return this.i18n.notification.user.account.operator.authorizedPaymentDenied;case ze.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_EXPIRED:return this.i18n.notification.user.account.operator.authorizedPaymentExpired;case ze.J.ACCOUNT_OPERATOR_AUTHORIZED_PAYMENT_SUCCEEDED:return this.i18n.notification.user.account.operator.authorizedPaymentSucceeded;case ze.J.ACCOUNT_OPERATOR_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.operator.paymentAwaitingAuthorization;case ze.J.ACCOUNT_PAYMENT_AWAITING_AUTHORIZATION:return this.i18n.notification.user.account.paymentAwaitingAuthorization;case ze.J.ACCOUNT_PAYMENT_RECEIVED:return this.i18n.notification.user.account.paymentReceived;case ze.J.ACCOUNT_PAYMENT_REQUEST_CANCELED:return this.i18n.notification.user.account.paymentRequestCanceled;case ze.J.ACCOUNT_PAYMENT_REQUEST_DENIED:return this.i18n.notification.user.account.paymentRequestDenied;case ze.J.ACCOUNT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.paymentRequestExpirationDateChanged;case ze.J.ACCOUNT_PAYMENT_REQUEST_EXPIRED:return this.i18n.notification.user.account.paymentRequestExpired;case ze.J.ACCOUNT_PAYMENT_REQUEST_PROCESSED:return this.i18n.notification.user.account.paymentRequestProcessed;case ze.J.ACCOUNT_PAYMENT_REQUEST_RECEIVED:return this.i18n.notification.user.account.paymentRequestReceived;case ze.J.ACCOUNT_RECURRING_PAYMENT_FAILED:return this.i18n.notification.user.account.recurringPaymentFailed;case ze.J.ACCOUNT_RECURRING_PAYMENT_OCCURRENCE_PROCESSED:return this.i18n.notification.user.account.recurringPaymentOcurrenceProcessed;case ze.J.ACCOUNT_SCHEDULED_PAYMENT_FAILED:return this.i18n.notification.user.account.scheduledPaymentFailed;case ze.J.ACCOUNT_SCHEDULED_PAYMENT_INSTALLMENT_PROCESSED:return this.i18n.notification.user.account.scheduledPaymentInstallmentProcessed;case ze.J.ACCOUNT_SCHEDULED_PAYMENT_REQUEST_FAILED:return this.i18n.notification.user.account.scheduledPaymentRequestFailed;case ze.J.ACCOUNT_SENT_PAYMENT_REQUEST_EXPIRATION_DATE_CHANGED:return this.i18n.notification.user.account.sentPaymentRequestExpirationDateChanged;case ze.J.ACCOUNT_SMS_PERFORMED_PAYMENT:return this.i18n.notification.user.account.smsPerformedPayment;case ze.J.ACCOUNT_TICKET_WEBHOOK_FAILED:return this.i18n.notification.user.account.ticketWebhookFailed;case ze.J.BROKERING_AD_PENDING_AUTHORIZATION:return this.i18n.notification.user.brokering.adPendingAuthorization;case ze.J.BROKERING_MEMBER_ASSIGNED:return this.i18n.notification.user.brokering.memberAssigned;case ze.J.BROKERING_MEMBER_UNASSIGNED:return this.i18n.notification.user.brokering.memberUnassigned;case ze.J.BUYER_AD_INTEREST_NOTIFICATION:return this.i18n.notification.user.buyer.adInterestNotification;case ze.J.BUYER_AD_QUESTION_ANSWERED:return this.i18n.notification.user.buyer.adQuestionAnswered;case ze.J.BUYER_ORDER_CANCELED:return this.i18n.notification.user.buyer.orderCanceled;case ze.J.BUYER_ORDER_PAYMENT_CANCELED:return this.i18n.notification.user.buyer.orderPaymentCanceled;case ze.J.BUYER_ORDER_PAYMENT_DENIED:return this.i18n.notification.user.buyer.orderPaymentDenied;case ze.J.BUYER_ORDER_PAYMENT_EXPIRED:return this.i18n.notification.user.buyer.orderPaymentExpired;case ze.J.BUYER_ORDER_PENDING:return this.i18n.notification.user.buyer.orderPending;case ze.J.BUYER_ORDER_PENDING_AUTHORIZATION:return this.i18n.notification.user.buyer.orderPendingAuthorization;case ze.J.BUYER_ORDER_PENDING_DELIVERY_DATA:return this.i18n.notification.user.buyer.orderPendingDeliveryData;case ze.J.BUYER_ORDER_PROCESSED_BY_SELLER:return this.i18n.notification.user.buyer.orderProcessedBySeller;case ze.J.BUYER_ORDER_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.orderRejectedBySeller;case ze.J.BUYER_SALE_PENDING:return this.i18n.notification.user.buyer.buyerSalePending;case ze.J.BUYER_SALE_REJECTED_BY_SELLER:return this.i18n.notification.user.buyer.buyerSaleRejectedBySeller;case ze.J.FEEDBACK_CHANGED:return this.i18n.notification.user.feedback.changed;case ze.J.FEEDBACK_CREATED:return this.i18n.notification.user.feedback.created;case ze.J.FEEDBACK_EXPIRATION_REMINDER:return this.i18n.notification.user.feedback.expirationReminder;case ze.J.FEEDBACK_OPTIONAL:return this.i18n.notification.user.feedback.optional;case ze.J.FEEDBACK_REPLY_CREATED:return this.i18n.notification.user.feedback.replyCreated;case ze.J.FEEDBACK_REQUIRED:return this.i18n.notification.user.feedback.required;case ze.J.PERSONAL_BROKER_ASSIGNED:return this.i18n.notification.user.personal.brokerAssigned;case ze.J.PERSONAL_BROKER_UNASSIGNED:return this.i18n.notification.user.personal.brokerUnassigned;case ze.J.PERSONAL_MAX_SMS_PER_MONTH_REACHED:return this.i18n.notification.user.personal.maxSmsPerMonthReached;case ze.J.PERSONAL_NEW_TOKEN:return this.i18n.notification.user.personal.newToken;case ze.J.PERSONAL_NEW_TOKEN_PENDING_ACTIVATION:return this.i18n.notification.user.personal.newTokenPendingActivation;case ze.J.PERSONAL_PASSWORD_STATUS_CHANGED:return this.i18n.notification.user.personal.passwordStatusChanged;case ze.J.PERSONAL_TOKEN_STATUS_CHANGED:return this.i18n.notification.user.personal.tokenStatusChanged;case ze.J.PERSONAL_USER_STATUS_CHANGED:return this.i18n.notification.user.personal.userStatusChanged;case ze.J.REFERENCE_CHANGED:return this.i18n.notification.user.reference.changed;case ze.J.REFERENCE_CREATED:return this.i18n.notification.user.reference.created;case ze.J.SELLER_AD_AUTHORIZED:return this.i18n.notification.user.seller.adAuthorized;case ze.J.SELLER_AD_EXPIRED:return this.i18n.notification.user.seller.adExpired;case ze.J.SELLER_AD_LOW_STOCK:return this.i18n.notification.user.seller.adLowStock;case ze.J.SELLER_AD_OUT_OF_STOCK:return this.i18n.notification.user.seller.adOutOfStock;case ze.J.SELLER_AD_QUESTION_CREATED:return this.i18n.notification.user.seller.adQuestionCreated;case ze.J.SELLER_AD_REJECTED:return this.i18n.notification.user.seller.adRejected;case ze.J.SELLER_ORDER_CANCELED:return this.i18n.notification.user.seller.orderCanceled;case ze.J.SELLER_ORDER_CREATED:return this.i18n.notification.user.seller.orderCreated;case ze.J.SELLER_ORDER_PAYMENT_CANCELED:return this.i18n.notification.user.seller.orderPaymentCanceled;case ze.J.SELLER_ORDER_PAYMENT_DENIED:return this.i18n.notification.user.seller.orderPaymentDenied;case ze.J.SELLER_ORDER_PAYMENT_EXPIRED:return this.i18n.notification.user.seller.orderPaymentExpired;case ze.J.SELLER_ORDER_PENDING_AUTHORIZATION:return this.i18n.notification.user.seller.orderPendingAuthorization;case ze.J.SELLER_ORDER_PENDING_DELIVERY_DATA:return this.i18n.notification.user.seller.orderPendingDeliveryData;case ze.J.SELLER_ORDER_PROCESSED_BY_BUYER:return this.i18n.notification.user.seller.orderProcessedByBuyer;case ze.J.SELLER_ORDER_REJECTED_BY_BUYER:return this.i18n.notification.user.seller.orderRejectedByBuyer;case ze.J.SELLER_SALE_PROCESSED_BY_BUYER:return this.i18n.notification.user.seller.saleProcessedByBuyer}return""}},{key:"resolveOptions",value:function(e,t){var n,i,a,r,o,c=this;switch(e){case ze.J.ADMIN_EXTERNAL_PAYMENT_EXPIRED:n=t.externalPayments,i=t.settings.externalPaymentsExpired,r="externalPaymentsExpired";break;case ze.J.ADMIN_EXTERNAL_PAYMENT_PERFORMED_FAILED:n=t.externalPayments,i=t.settings.externalPaymentsFailed,r="externalPaymentsFailed";break;case ze.J.ADMIN_GENERATED_VOUCHERS_ABOUT_TO_EXPIRE:case ze.J.ADMIN_GENERATED_VOUCHERS_EXPIRED:n=t.voucherConfigurations,i=t.settings.voucherConfigurations,r="voucherConfigurations";break;case ze.J.ADMIN_VOUCHER_BUYING_ABOUT_TO_EXPIRE:n=t.voucherConfigurations,i=t.settings.voucherConfigurationsBuying,r="voucherConfigurationsBuying";break;case ze.J.ADMIN_PAYMENT_AWAITING_AUTHORIZATION:n=t.authorizablePayments,i=t.settings.authorizablePayments,r="authorizablePayments";break;case ze.J.ADMIN_PAYMENT_PERFORMED:n=t.payments,i=t.settings.payments,r="payments";break;case ze.J.ADMIN_USER_REGISTRATION:n=t.userGroups,i=t.settings.userGroups,r="userGroups";break;case ze.J.ADMIN_SYSTEM_ALERT:a=Object.values(ze.lb),i=t.settings.systemAlerts,r="systemAlert";break;case ze.J.ADMIN_USER_ALERT:a=Object.values(ze.xb),i=t.settings.userAlerts,r="userAlert"}return n?o=n.map((function(e){return{id:e.id,internalName:e.internalName,value:c.ApiHelper.internalNameOrId(e),text:e.name}})):a&&(o=a.map((function(e){return{value:e,text:c.resolveAlertLabel(e)}}))),[o,i,r]}},{key:"resolveAlertLabel",value:function(e){switch(e){case ze.lb.ACCOUNT_FEE_CHARGED_NO_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedNoFailures;case ze.lb.ACCOUNT_FEE_CHARGED_WITH_FAILURES:return this.i18n.systemAlert.type.accountFeeChargedWithFailures;case ze.lb.APPLICATION_RESTARTED:return this.i18n.systemAlert.type.applicationRestarted;case ze.lb.CUSTOM:return this.i18n.systemAlert.type.custom;case ze.lb.MAX_GLOBAL_SMS_REACHED:return this.i18n.systemAlert.type.maxGlobalSmsReached;case ze.lb.MAX_INCORRECT_LOGIN_ATTEMPTS:return this.i18n.systemAlert.type.maxIncorrectLoginAttempts;case ze.xb.CUSTOM:return this.i18n.userAlert.type.custom;case ze.xb.GIVEN_VERY_BAD_REFS:return this.i18n.userAlert.type.givenVeryBadRefs;case ze.xb.INSUFFICIENT_BALANCE_FOR_INITIAL_CREDIT:return this.i18n.userAlert.type.insufficientBalanceForInitialCredit;case ze.xb.MAX_DEVICE_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceActivationAttemptsReached;case ze.xb.MAX_DEVICE_CONFIRMATION_CHECK_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxDeviceConfirmationCheckAttemptsReached;case ze.xb.MAX_TOKEN_ACTIVATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxTokenActivationAttemptsReached;case ze.xb.MAX_USER_LOCALIZATION_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxUserLocalizationAttemptsReached;case ze.xb.MAX_VOUCHER_REDEEM_ATTEMPTS_REACHED:return this.i18n.userAlert.type.maxVoucherRedeemAttemptsReached;case ze.xb.MOVE_USER_AUTOMATICALLY_FAILED:return this.i18n.userAlert.type.moveUserAutomaticallyFailed;case ze.xb.PASSWORD_DISABLED_BY_TRIES:return this.i18n.userAlert.type.passwordDisabledByTries;case ze.xb.PASSWORD_TEMPORARILY_BLOCKED:return this.i18n.userAlert.type.passwordTemporarilyBlocked;case ze.xb.RECEIVED_VERY_BAD_REFS:return this.i18n.userAlert.type.receivedVeryBadRefs;case ze.xb.SCHEDULED_PAYMENT_FAILED:return this.i18n.userAlert.type.scheduledPaymentFailed}return""}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||gi)(b.Nb(b.r),b.Nb(c.s))},gi.\u0275cmp=b.Hb({type:gi,selectors:[["notification-settings-form"]],features:[b.wb],decls:5,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],[3,"heading","mobileHeading"],[3,"formGroup"],["formControlName","forwardMessages",3,"label","disabled",4,"ngIf"],[4,"ngFor","ngForOf"],["formControlName","forwardMessageCategories",3,"label",4,"ngIf"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],["formControlName","forwardMessages",3,"label","disabled"],[3,"ngClass",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass"],[1,"mt-3","mb-0"],["formControlName","forwardMessageCategories",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["class","d-flex flex-column flex-xs-row justify-content-between",3,"ngClass",4,"ngIf"],[1,"d-flex","flex-column","flex-xs-row","justify-content-between",3,"ngClass"],[1,"mb-2","mb-xs-0"],[1,"btn","btn-outline-primary",3,"ngClass","click"],[1,"btn","btn-outline-primary",3,"click"],["kind","field",3,"label"],[3,"setting","options","form","multiSelectionControl","disabled"],[1,"btn","btn-primary",3,"disabled","click"],["formControlName","min",3,"label","scale","prefix","suffix","disabled","emptyLabel"],["formControlName","max",3,"label","scale","prefix","suffix","disabled","emptyLabel"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,mi,10,9,"ng-container",1),b.Sb(),b.Fc(3,pi,3,13,"ng-template",null,2,b.Gc)),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,q.I,q.w,q.n,p.s,Q.a,we.a,q.v,q.l,p.A,p.q,nt.a,ve.a,j.a,jn.a,Qn.a],pipes:[p.b],encapsulation:2,changeDetection:0}),gi);function vi(e,t){if(1&e&&(b.Tb(0,"div",7),b.Tb(1,"label-value",8),b.Ob(2,"user-link",9),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.data.user)}}function yi(e,t){if(1&e&&(b.Tb(0,"mobile-result"),b.Tb(1,"div",10),b.Hc(2),b.Sb(),b.Sb()),2&e){var n=t.$implicit;b.zb(2),b.Ic(n.name)}}function ki(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"tr",13),b.bc("click",(function(){b.wc(n);var e=t.$implicit,i=b.dc(3);return i.router.navigate(i.path(e))})),b.Tb(2,"td"),b.Tb(3,"a",14),b.Hc(4),b.Sb(),b.Sb(),b.Tb(5,"td",15),b.Tb(6,"button",16),b.bc("click",(function(e){b.wc(n);var i=t.$implicit;return b.dc(3).remove(i),e.stopPropagation()})),b.Ob(7,"icon",17),b.Sb(),b.Sb(),b.Sb(),b.Qb()}if(2&e){var i=t.$implicit,a=b.dc(3);b.zb(3),b.kc("routerLink",a.path(i)),b.zb(1),b.Jc(" ",i.name," "),b.zb(2),b.kc("tooltip",a.i18n.general.removeTooltip(i.name))}}function Si(e,t){if(1&e&&(b.Tb(0,"table",11),b.Tb(1,"tbody"),b.Fc(2,ki,8,3,"ng-container",12),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(2),b.kc("ngForOf",n.data.operatorGroups)}}function Ti(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"page-content",2),b.ec(2,"async"),b.Fc(3,vi,3,2,"div",3),b.Sb(),b.Tb(4,"results-layout",4),b.Fc(5,yi,3,1,"mobile-result",5),b.Fc(6,Si,3,1,"table",6),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("mode",n.self?"empty":"filters")("heading",n.i18n.operatorGroup.title.list)("mobileHeading",n.i18n.operatorGroup.mobileTitle.list)("headingActions",b.fc(2,7,n.headingActions$)),b.zb(2),b.kc("ngIf",!n.self),b.zb(1),b.kc("results",n.data.operatorGroups)("toLink",n.toLink)}}var Ii,Ci=((Ii=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).operatorGroupsService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorGroupsService.getUserOperatorGroupsListData({user:this.param}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.groups=e.operatorGroups,e.canCreate&&(this.headingActions=[new B.c("add",this.i18n.general.addNew,(function(){t.router.navigate(["/users",t.param,"operator-groups","new"])}),!0)])}},{key:"path",value:function(e){return["/users","operator-groups",e.id]}},{key:"remove",value:function(e){var t=this;this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:function(){return t.doRemove(e)}})}},{key:"doRemove",value:function(e){var t=this;this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:e.id}).subscribe((function(){t.notification.snackBar(t.i18n.general.removeDone(e.name)),t.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.OPERATOR_GROUPS)}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Ii)(b.Nb(b.r),b.Nb(c.v))},Ii.\u0275cmp=b.Hb({type:Ii,selectors:[["list-operator-groups"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"mode","heading","mobileHeading","headingActions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"cell-main"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[3,"click"],[3,"routerLink"],[1,"actions"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Ti,7,9,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,h.a,v.a,y.a,j.a,vt.a,S.a,p.s,a.h,T.b,I.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Ii),Oi=n("vHbw");function Fi(e,t){if(1&e&&(b.Tb(0,"label-value",16),b.Ob(1,"user-link",17),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.data.user)}}function zi(e,t){1&e&&b.Pb(0)}function Ai(e,t){if(1&e&&(b.Rb(0),b.Fc(1,zi,1,0,"ng-container",19),b.Qb()),2&e){b.dc(3);var n=b.uc(6);b.zb(1),b.kc("ngTemplateOutlet",n)}}function wi(e,t){if(1&e&&(b.Tb(0,"h3",9),b.Hc(1),b.Sb()),2&e){var n=b.dc(2).$implicit;b.zb(1),b.Jc(" ",n.name," ")}}function Ei(e,t){1&e&&b.Pb(0)}var _i=function(e){return{$implicit:e}};function Ni(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Ei,1,0,"ng-container",22),b.Qb()),2&e){var n=b.dc(2).$implicit;b.dc(3);var i=b.uc(4);b.zb(1),b.kc("ngTemplateOutlet",i)("ngTemplateOutletContext",b.nc(2,_i,n))}}function Ri(e,t){if(1&e&&(b.Rb(0),b.Rb(1,5),b.Fc(2,wi,2,1,"h3",20),b.Ob(3,"single-selection-field",21),b.Fc(4,Ni,2,4,"ng-container",1),b.Qb(),b.Qb()),2&e){var n=t.ngIf,i=b.dc(4);b.zb(1),b.kc("formGroup",n),b.zb(1),b.kc("ngIf",!i.singleAccount),b.zb(1),b.kc("label",i.i18n.operatorGroup.accountAccess)("fieldOptions",i.accountAccessOptions),b.zb(1),b.kc("ngIf","none"!==n.value.access)}}function Pi(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Ri,5,5,"ng-container",1),b.Qb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(1),b.kc("ngIf",i.form.get("accounts").get(n.id))}}function Di(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",9),b.Hc(2),b.ec(3,"async"),b.Sb(),b.Fc(4,Ai,2,1,"ng-container",1),b.Fc(5,Pi,2,1,"ng-container",18),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.Jc("",b.fc(3,3,n.layout.ltsm$)?n.i18n.operatorGroup.mobileTitle.accountAccess:n.i18n.operatorGroup.title.accountAccess," "),b.zb(2),b.kc("ngIf",!n.singleAccount),b.zb(1),b.kc("ngForOf",n.data.accountTypes)}}function Hi(e,t){if(1&e&&b.Ob(0,"boolean-field",23),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.notifications)}}function xi(e,t){if(1&e&&b.Ob(0,"boolean-field",24),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.viewAdvertisements)}}function Li(e,t){if(1&e&&b.Ob(0,"field-option",27),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",i.ApiHelper.internalNameOrId(n))("id",n.id)("internalName",n.internalName)("text",n.name)}}function Mi(e,t){if(1&e&&(b.Tb(0,"multi-selection-field",25),b.Fc(1,Li,1,4,"field-option",26),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.runOperations),b.zb(1),b.kc("ngForOf",n.data.operations)}}function Ui(e,t){if(1&e&&b.Ob(0,"boolean-field",28),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.brokering)}}function $i(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"page-content",4),b.ec(2,"async"),b.Tb(3,"form",5),b.Fc(4,Fi,2,2,"label-value",6),b.Ob(5,"input-field",7),b.Ob(6,"textarea-field",8),b.Fc(7,Di,6,5,"ng-container",1),b.Tb(8,"h2",9),b.Hc(9),b.ec(10,"async"),b.Sb(),b.Ob(11,"boolean-field",10),b.Fc(12,Hi,1,1,"boolean-field",11),b.Fc(13,xi,1,1,"boolean-field",12),b.Fc(14,Mi,2,2,"multi-selection-field",13),b.Fc(15,Ui,1,1,"boolean-field",14),b.Sb(),b.Tb(16,"actions"),b.Tb(17,"button",15),b.bc("click",(function(){return b.wc(n),b.dc().save()})),b.ec(18,"async"),b.Hc(19),b.Sb(),b.Sb(),b.Sb(),b.Qb()}if(2&e){var i=b.dc();b.zb(1),b.kc("heading",i.create?i.i18n.operatorGroup.title.new:i.i18n.operatorGroup.title.edit)("mobileHeading",i.create?i.i18n.operatorGroup.mobileTitle.new:i.i18n.operatorGroup.mobileTitle.edit)("headingActions",b.fc(2,16,i.headingActions$)),b.zb(2),b.kc("formGroup",i.form),b.zb(1),b.kc("ngIf",!i.self),b.zb(1),b.kc("label",i.i18n.general.name),b.zb(1),b.kc("label",i.i18n.general.description),b.zb(1),b.kc("ngIf",(null==i.data.accountTypes?null:i.data.accountTypes.length)>0),b.zb(2),b.Jc("",b.fc(10,18,i.layout.ltsm$)?i.i18n.operatorGroup.mobileTitle.permissions:i.i18n.operatorGroup.title.permissions," "),b.zb(2),b.kc("label",i.i18n.operatorGroup.editOwnProfile),b.zb(1),b.kc("ngIf",i.data.canHaveNotifications),b.zb(1),b.kc("ngIf",i.data.canViewAdvertisements),b.zb(1),b.kc("ngIf",(null==i.data.operations?null:i.data.operations.length)>0),b.zb(1),b.kc("ngIf",i.data.broker),b.zb(2),b.kc("disabled",b.fc(18,20,i.requesting$)),b.zb(2),b.Jc(" ",i.i18n.general.save," ")}}function Gi(e,t){1&e&&b.Pb(0)}function Bi(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Gi,1,0,"ng-container",19),b.Qb()),2&e){b.dc(2);var n=b.uc(6);b.zb(1),b.kc("ngTemplateOutlet",n)}}function Ji(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"hr",36),b.Tb(2,"h4",37),b.Hc(3),b.Sb(),b.Qb()),2&e){var n=b.dc().$implicit;b.zb(3),b.Ic(n.name)}}function Vi(e,t){if(1&e&&(b.Rb(0,5),b.Fc(1,Ji,4,1,"ng-container",1),b.Ob(2,"boolean-field",32),b.Ob(3,"boolean-field",33),b.Ob(4,"decimal-field",34),b.Ob(5,"boolean-field",35),b.Qb()),2&e){var n,i=t.$implicit,a=b.dc().$implicit,r=b.dc(),o=(null==(n=r.paymentTypes(a))?null:n.length)>1;b.kc("formGroup",r.form.get("payments").get(i.id)),b.zb(1),b.kc("ngIf",o),b.zb(1),b.kc("label",r.i18n.operatorGroup.performPayments),b.zb(1),b.kc("label",r.i18n.operatorGroup.performPaymentsRequiresAuthorization),b.zb(1),b.kc("label",r.i18n.operatorGroup.performPaymentsMaxAmountPerDay)("scale",i.currency.decimalDigits)("prefix",i.currency.prefix)("suffix",i.currency.suffix),b.zb(1),b.kc("label",r.i18n.operatorGroup.authorizePayments)}}function qi(e,t){if(1&e&&(b.Rb(0,5),b.Ob(1,"decimal-field",29),b.Ob(2,"decimal-field",30),b.Qb(),b.Fc(3,Bi,2,1,"ng-container",1),b.Fc(4,Vi,6,9,"ng-container",31)),2&e){var n=t.$implicit,i=b.dc();b.kc("formGroup",i.form.get("accounts").get(n.id).get("notificationAmount")),b.zb(1),b.kc("label",i.i18n.operatorGroup.paymentNotificationsAbove)("scale",n.currency.decimalDigits)("prefix",n.currency.prefix)("suffix",n.currency.suffix),b.zb(1),b.kc("label",i.i18n.operatorGroup.paymentNotificationsBelow)("scale",n.currency.decimalDigits)("prefix",n.currency.prefix)("suffix",n.currency.suffix),b.zb(1),b.kc("ngIf",i.singleAccount),b.zb(1),b.kc("ngForOf",i.paymentTypes(n))}}function ji(e,t){if(1&e&&b.Ob(0,"boolean-field",40),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.chargebackPayments)}}function Qi(e,t){if(1&e&&(b.Rb(0,5),b.Fc(1,ji,1,1,"boolean-field",38),b.Ob(2,"multiple-users-field",39),b.Qb()),2&e){var n=b.dc();b.kc("formGroup",n.form),b.zb(1),b.kc("ngIf",n.data.canChargebackPayments),b.zb(1),b.kc("label",n.i18n.operatorGroup.restrictPaymentsToUsers)("preselectedUsers",n.restrictPaymentsToUsers)}}var Yi,Ki=((Yi=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).userHelper=i,r.operatorGroupsService=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.id=this.route.snapshot.params.id,this.user=this.route.snapshot.params.user,this.create=null!=this.user;var t=this.create?this.operatorGroupsService.getOperatorGroupDataForNew({user:this.user}):this.operatorGroupsService.getOperatorGroupDataForEdit({id:this.id});this.addSub(t.subscribe((function(t){e.data=t})));var i=Object(J.i)(ze.P);this.accountAccessOptions=i.map((function(t){return{value:t,text:e.userHelper.operatorGroupAccountAccess(t)}}))}},{key:"onDataInitialized",value:function(e){this.self=this.authHelper.isSelf(e.user);var t=e.operatorGroup;if(this.form=this.formBuilder.group({name:[t.name,q.G.required],description:t.description}),!Object(J.h)(e.accountTypes)){this.singleAccount=1===e.accountTypes.length;var n,i=this.formBuilder.group({}),a=_createForOfIteratorHelper(e.accountTypes);try{for(a.s();!(n=a.n()).done;){var r=n.value,o=t.accounts[r.id]||t.accounts[r.internalName]||{},c=o.notificationAmount||{};i.setControl(r.id,this.formBuilder.group({access:[o.access||ze.P.NONE,q.G.required],notificationAmount:this.formBuilder.group({min:c.min,max:c.max})}))}}catch(f){a.e(f)}finally{a.f()}this.form.setControl("accounts",i)}if(!Object(J.h)(e.paymentTypes)){var s,l=this.formBuilder.group({}),u=_createForOfIteratorHelper(e.paymentTypes);try{for(u.s();!(s=u.n()).done;){var d=s.value,b=t.payments[d.id]||t.payments[d.internalName]||{};l.setControl(d.id,this.formBuilder.group({perform:b.perform,maxAmountPerDay:b.maxAmountPerDay,requiresAuthorization:b.requiresAuthorization,authorize:b.authorize}))}}catch(f){u.e(f)}finally{u.f()}this.form.setControl("payments",l)}this.form.addControl("editOwnProfile",new q.j(t.editOwnProfile)),this.form.addControl("restrictPaymentsToUsers",new q.j(t.restrictPaymentsToUsers)),e.canHaveNotifications&&this.form.addControl("notifications",new q.j(t.notifications)),e.canChargebackPayments&&this.form.addControl("chargebackPayments",new q.j(t.chargebackPayments)),e.canViewAdvertisements&&this.form.addControl("viewAdvertisements",new q.j(t.viewAdvertisements)),e.broker&&this.form.addControl("brokering",new q.j(t.brokering)),Object(J.h)(e.operations)||this.form.addControl("operations",new q.j(t.operations)),t.version&&this.form.addControl("version",new q.j(t.version))}},{key:"paymentTypes",value:function(e){return(this.data.paymentTypes||[]).filter((function(t){return t.from.id===e.id}))}},{key:"save",value:function(){var e=this;if(Object(J.F)(this.form),this.form.valid){var t=this.form.value,n=this.create?this.operatorGroupsService.createOperatorGroup({user:this.user,body:t}):this.operatorGroupsService.updateOperatorGroup({id:this.id,body:t});this.addSub(n.subscribe((function(t){e.notification.snackBar(e.create?e.i18n.operatorGroup.created:e.i18n.operatorGroup.saved),e.router.navigate(["/users","operator-groups",t||e.id])})))}}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.OPERATOR_GROUPS)}},{key:"restrictPaymentsToUsers",get:function(){return this.data.restrictPaymentsToUsers}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Yi)(b.Nb(b.r),b.Nb(s.a),b.Nb(c.v))},Yi.\u0275cmp=b.Hb({type:Yi,selectors:[["operator-group-form"]],features:[b.wb],decls:7,vars:4,consts:[[3,"ready"],[4,"ngIf"],["accountDetails",""],["generalAccounts",""],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["mode","fieldView",3,"label",4,"ngIf"],["formControlName","name","required","",3,"label"],["formControlName","description",3,"label"],[1,"mt-3","mb-0"],["formControlName","editOwnProfile",3,"label"],["formControlName","notifications",3,"label",4,"ngIf"],["formControlName","viewAdvertisements",3,"label",4,"ngIf"],["formControlName","operations",3,"label",4,"ngIf"],["formControlName","brokering",3,"label",4,"ngIf"],[1,"btn","btn-primary","btn-main",3,"disabled","click"],["mode","fieldView",3,"label"],[3,"user"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],["class","mt-3 mb-0",4,"ngIf"],["formControlName","access","required","",3,"label","fieldOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","notifications",3,"label"],["formControlName","viewAdvertisements",3,"label"],["formControlName","operations",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","brokering",3,"label"],["formControlName","min",3,"label","scale","prefix","suffix"],["formControlName","max",3,"label","scale","prefix","suffix"],[3,"formGroup",4,"ngFor","ngForOf"],["formControlName","perform",3,"label"],["formControlName","requiresAuthorization",3,"label"],["formControlName","maxAmountPerDay",3,"label","scale","prefix","suffix"],["formControlName","authorize",3,"label"],[1,"inner-separator"],[1,"mt-3","mb-2"],["formControlName","chargebackPayments",3,"label",4,"ngIf"],["formControlName","restrictPaymentsToUsers",3,"label","preselectedUsers"],["formControlName","chargebackPayments",3,"label"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,$i,20,22,"ng-container",1),b.Sb(),b.Fc(3,qi,5,11,"ng-template",null,2,b.Gc),b.Fc(5,Qi,3,4,"ng-template",null,3,b.Gc)),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,q.I,q.w,q.n,yt.a,q.v,q.l,q.D,kt.a,we.a,Q.a,j.a,vt.a,p.s,p.A,he.a,nt.a,ve.a,Qn.a,Oi.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Yi),Xi=n("I9hm");function Wi(e,t){if(1&e&&(b.Tb(0,"label-value",9),b.Ob(1,"user-link",10),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.group.user)}}function Zi(e,t){if(1&e&&b.Ob(0,"label-value",11),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.description)("value",n.group.description)}}function ea(e,t){if(1&e&&(b.Tb(0,"h3",12),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.accountType.name," ")}}function ta(e,t){if(1&e&&(b.Rb(0),b.Hc(1),b.Qb()),2&e){var n=b.dc(6);b.zb(1),b.Ic(n.i18n.operatorGroup.performPaymentsRequiresAuthorizationView)}}function na(e,t){if(1&e&&(b.Rb(0),b.Hc(1),b.ec(2,"currency"),b.Qb()),2&e){var n=b.dc().$implicit,i=b.dc(5);b.zb(1),b.Ic(i.i18n.operatorGroup.performPaymentsMaxAmountPerDayView(b.gc(2,1,n.maxAmountPerDay,n.paymentType.currency)))}}function ia(e,t){1&e&&b.Ob(0,"br")}function aa(e,t){if(1&e&&(b.Rb(0),b.Hc(1),b.Fc(2,ta,2,1,"ng-container",1),b.Fc(3,na,3,4,"ng-container",1),b.Fc(4,ia,1,0,"br",1),b.Qb()),2&e){var n=t.$implicit,i=t.last;b.zb(1),b.Jc(" ",n.paymentType.name,""),b.zb(1),b.kc("ngIf",n.requiresAuthorization),b.zb(1),b.kc("ngIf",n.maxAmountPerDay),b.zb(1),b.kc("ngIf",!i)}}function ra(e,t){if(1&e&&(b.Tb(0,"label-value",14),b.Fc(1,aa,5,4,"ng-container",13),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("label",i.i18n.operatorGroup.performPayments),b.zb(1),b.kc("ngForOf",i.paymentsByAccount[n.accountType.id])}}function oa(e,t){1&e&&(b.Rb(0),b.Hc(1,", "),b.Qb())}function ca(e,t){if(1&e&&(b.Rb(0),b.Hc(1),b.Fc(2,oa,2,0,"ng-container",1),b.Qb()),2&e){var n=t.$implicit,i=t.last;b.zb(1),b.Jc(" ",n.name,""),b.zb(1),b.kc("ngIf",!i)}}function sa(e,t){if(1&e&&(b.Tb(0,"label-value",14),b.Fc(1,ca,3,2,"ng-container",13),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("label",i.i18n.operatorGroup.authorizePayments),b.zb(1),b.kc("ngForOf",i.authorizeByAccount[n.accountType.id])}}var la=function(e,t){return{min:e,max:t}};function ua(e,t){if(1&e&&(b.Ob(0,"label-value",4),b.ec(1,"currency"),b.ec(2,"currency")),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("label",i.i18n.operatorGroup.paymentNotifications)("value",i.format.formatRange(b.oc(8,la,b.gc(1,2,n.notificationAmount.min,n.accountType.currency),b.gc(2,5,n.notificationAmount.max,n.accountType.currency))))}}function da(e,t){if(1&e&&(b.Rb(0),b.Fc(1,ea,2,1,"h3",6),b.Ob(2,"label-value",4),b.Fc(3,ra,2,2,"label-value",8),b.Fc(4,sa,2,2,"label-value",8),b.Fc(5,ua,3,11,"label-value",7),b.Qb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(1),b.kc("ngIf",!i.singleAccount),b.zb(1),b.kc("label",i.i18n.operatorGroup.accountAccess)("value",i.userHelper.operatorGroupAccountAccess(n.access)),b.zb(1),b.kc("ngIf",(null==i.paymentsByAccount[n.accountType.id]?null:i.paymentsByAccount[n.accountType.id].length)>0),b.zb(1),b.kc("ngIf",(null==i.authorizeByAccount[n.accountType.id]?null:i.authorizeByAccount[n.accountType.id].length)>0),b.zb(1),b.kc("ngIf",(null==n.notificationAmount?null:n.notificationAmount.min)||(null==n.notificationAmount?null:n.notificationAmount.max))}}function ba(e,t){if(1&e&&(b.Tb(0,"h3",12),b.Hc(1),b.ec(2,"async"),b.Sb()),2&e){var n=b.dc(4);b.zb(1),b.Jc(" ",b.fc(2,1,n.layout.ltsm$)?n.i18n.operatorGroup.mobileTitle.generalAccount:n.i18n.operatorGroup.title.generalAccount," ")}}function fa(e,t){if(1&e&&b.Ob(0,"label-value",4),2&e){var n=b.dc(4);b.kc("label",n.i18n.operatorGroup.chargebackPayments)("value",n.i18n.general.yes)}}function ma(e,t){1&e&&(b.Rb(0),b.Hc(1,", "),b.Qb())}function pa(e,t){if(1&e&&(b.Rb(0),b.Hc(1),b.Fc(2,ma,2,0,"ng-container",1),b.Qb()),2&e){var n=t.$implicit,i=t.last;b.zb(1),b.Jc(" ",n.display,""),b.zb(1),b.kc("ngIf",!i)}}function ga(e,t){if(1&e&&(b.Tb(0,"label-value",14),b.Fc(1,pa,3,2,"ng-container",13),b.Sb()),2&e){var n=b.dc(4);b.kc("label",n.i18n.operatorGroup.restrictPaymentsToUsers),b.zb(1),b.kc("ngForOf",n.group.restrictPaymentsToUsers)}}function ha(e,t){if(1&e&&(b.Rb(0),b.Fc(1,ba,3,3,"h3",6),b.Fc(2,fa,1,2,"label-value",7),b.Fc(3,ga,2,2,"label-value",8),b.Qb()),2&e){var n=b.dc(3);b.zb(1),b.kc("ngIf",!n.singleAccount),b.zb(1),b.kc("ngIf",n.group.chargebackPayments),b.zb(1),b.kc("ngIf",(null==n.group.restrictPaymentsToUsers?null:n.group.restrictPaymentsToUsers.length)>0)}}function va(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",12),b.Hc(2),b.ec(3,"async"),b.Sb(),b.Fc(4,da,6,6,"ng-container",13),b.Fc(5,ha,4,3,"ng-container",1),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.Jc("",b.fc(3,3,n.layout.ltsm$)?n.i18n.operatorGroup.mobileTitle.accountAccess:n.i18n.operatorGroup.title.accountAccess," "),b.zb(2),b.kc("ngForOf",n.visibleAccounts),b.zb(1),b.kc("ngIf",(null==n.group.restrictPaymentsToUsers?null:n.group.restrictPaymentsToUsers.length)>0||n.group.chargebackPayments)}}function ya(e,t){if(1&e&&(b.Tb(0,"h2",12),b.Hc(1),b.ec(2,"async"),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.Jc("",b.fc(2,1,n.layout.ltsm$)?n.i18n.operatorGroup.mobileTitle.permissions:n.i18n.operatorGroup.title.permissions," ")}}function ka(e,t){if(1&e&&b.Ob(0,"label-value",4),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.editOwnProfile)("value",n.i18n.general.yes)}}function Sa(e,t){if(1&e&&b.Ob(0,"label-value",4),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.notifications)("value",n.i18n.general.yes)}}function Ta(e,t){if(1&e&&b.Ob(0,"label-value",4),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.viewAdvertisements)("value",n.i18n.general.yes)}}function Ia(e,t){1&e&&(b.Rb(0),b.Hc(1,", "),b.Qb())}function Ca(e,t){if(1&e&&(b.Rb(0),b.Hc(1),b.Fc(2,Ia,2,0,"ng-container",1),b.Qb()),2&e){var n=t.$implicit,i=t.last;b.zb(1),b.Ic(n.name),b.zb(1),b.kc("ngIf",!i)}}function Oa(e,t){if(1&e&&(b.Tb(0,"label-value",14),b.Fc(1,Ca,3,2,"ng-container",13),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.runOperations),b.zb(1),b.kc("ngForOf",n.group.operations)}}function Fa(e,t){if(1&e&&b.Ob(0,"label-value",4),2&e){var n=b.dc(2);b.kc("label",n.i18n.operatorGroup.brokering)("value",n.i18n.general.yes)}}function za(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"page-content",2),b.ec(2,"async"),b.Fc(3,Wi,2,2,"label-value",3),b.Ob(4,"label-value",4),b.Fc(5,Zi,1,2,"label-value",5),b.Fc(6,va,6,5,"ng-container",1),b.Fc(7,ya,3,3,"h2",6),b.Fc(8,ka,1,2,"label-value",7),b.Fc(9,Sa,1,2,"label-value",7),b.Fc(10,Ta,1,2,"label-value",7),b.Fc(11,Oa,2,2,"label-value",8),b.Fc(12,Fa,1,2,"label-value",7),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("heading",n.i18n.operatorGroup.title.view)("mobileHeading",n.i18n.operatorGroup.mobileTitle.view)("headingActions",b.fc(2,14,n.headingActions$)),b.zb(2),b.kc("ngIf",!n.self),b.zb(1),b.kc("label",n.i18n.general.name)("value",n.group.name),b.zb(1),b.kc("ngIf",n.group.description),b.zb(1),b.kc("ngIf",(null==n.visibleAccounts?null:n.visibleAccounts.length)>0),b.zb(1),b.kc("ngIf",n.group.editOwnProfile||n.group.notifications||n.group.viewAdvertisements||n.group.brokering||(null==n.group.operations?null:n.group.operations.length)>0),b.zb(1),b.kc("ngIf",n.group.editOwnProfile),b.zb(1),b.kc("ngIf",n.group.notifications),b.zb(1),b.kc("ngIf",n.group.viewAdvertisements),b.zb(1),b.kc("ngIf",(null==n.group.operations?null:n.group.operations.length)>0),b.zb(1),b.kc("ngIf",n.group.brokering)}}var Aa,wa=((Aa=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).userHelper=i,r.operatorGroupsService=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.id=this.route.snapshot.params.id,this.addSub(this.operatorGroupsService.viewOperatorGroup({id:this.id}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.self=this.authHelper.isSelf(e.user);var n=e.accounts||[];this.visibleAccounts=n.filter((function(e){return e.access!==ze.P.NONE})),this.singleAccount=1===n.length,this.paymentsByAccount={},this.authorizeByAccount={};var i,a=e.payments||[],r=_createForOfIteratorHelper(this.visibleAccounts);try{var o=function(){var e=i.value;t.paymentsByAccount[e.accountType.id]=a.filter((function(t){return t.perform&&t.paymentType.from.id===e.accountType.id})),t.authorizeByAccount[e.accountType.id]=a.filter((function(t){return t.authorize&&t.paymentType.from.id===e.accountType.id})).map((function(e){return e.paymentType}))};for(r.s();!(i=r.n()).done;)o()}catch(s){r.e(s)}finally{r.f()}if(e.canEdit){var c=[new B.c("edit",this.i18n.general.edit,(function(){t.router.navigateByUrl(t.router.url+"/edit")}),!0)];this.layout.ltsm&&c.push(new B.c("clear",this.i18n.general.remove,(function(){return t.remove()}))),this.headingActions=c}}},{key:"remove",value:function(){var e=this;this.notification.confirm({message:this.i18n.general.removeConfirm(this.group.name),callback:function(){return e.doRemove()}})}},{key:"doRemove",value:function(){var e=this;this.addSub(this.operatorGroupsService.deleteOperatorGroup({id:this.id}).subscribe((function(){e.notification.snackBar(e.i18n.general.removeDone(e.group.name)),e.router.navigate(["users",e.authHelper.orSelf(e.group.user),"operator-groups"])})))}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.OPERATOR_GROUPS)}},{key:"group",get:function(){return this.data}}]),n}(u.a)).\u0275fac=function(e){return new(e||Aa)(b.Nb(b.r),b.Nb(s.a),b.Nb(c.v))},Aa.\u0275cmp=b.Hb({type:Aa,selectors:[["view-operator-group"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],["valueFormat","break",3,"label","value",4,"ngIf"],["class","mt-3 mb-0",4,"ngIf"],[3,"label","value",4,"ngIf"],[3,"label",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"],["valueFormat","break",3,"label","value"],[1,"mt-3","mb-0"],[4,"ngFor","ngForOf"],[3,"label"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,za,13,16,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,j.a,vt.a,p.s],pipes:[p.b,Xi.a],encapsulation:2,changeDetection:0}),Aa);function Ea(e,t){if(1&e&&(b.Tb(0,"label-value",15),b.Ob(1,"user-link",16),b.Sb()),2&e){var n=b.dc(3);b.kc("label",n.i18n.user.operatorOwner),b.zb(1),b.kc("user",n.data.user)}}function _a(e,t){if(1&e&&b.Ob(0,"field-option",19),2&e){var n=t.$implicit,i=b.dc(4);b.kc("value",i.ApiHelper.internalNameOrId(n))("id",n.id)("internalName",n.internalName)("text",n.name)}}function Na(e,t){if(1&e&&(b.Tb(0,"single-selection-field",17),b.Fc(1,_a,1,4,"field-option",18),b.Sb()),2&e){var n=b.dc(3);b.kc("label",n.i18n.user.group)("emptyOption",n.i18n.user.operatorNoGroup),b.zb(1),b.kc("ngForOf",n.data.groups)}}function Ra(e,t){if(1&e&&b.Ob(0,"input-field",20),2&e){var n=b.dc(3);b.kc("label",n.i18n.user.name)}}function Pa(e,t){if(1&e&&b.Ob(0,"input-field",21),2&e){var n=b.dc(3);b.kc("label",n.i18n.user.username)}}function Da(e,t){if(1&e&&b.Ob(0,"input-field",24),2&e){var n=b.dc(4);b.kc("label",n.i18n.user.email)("required",n.data.emailRequired)}}function Ha(e,t){if(1&e&&b.Ob(0,"boolean-field",25),2&e){var n=b.dc(4);b.kc("label",n.i18n.user.registration.skipActivationEmail)}}function xa(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Da,1,2,"input-field",22),b.Fc(2,Ha,1,1,"boolean-field",23),b.Qb()),2&e){var n=b.dc(3);b.zb(1),b.kc("ngIf",n.canEdit("email")),b.zb(1),b.kc("ngIf",n.data.allowSetSendActivationEmail)}}function La(e,t){if(1&e&&b.Ob(0,"custom-field-input",28),2&e){var n=b.dc().$implicit;b.kc("field",n)("formControlName",n.internalName)}}function Ma(e,t){if(1&e&&(b.Rb(0,26),b.Fc(1,La,1,2,"custom-field-input",27),b.Qb()),2&e){var n=t.$implicit,i=b.dc(3);b.kc("formGroup",i.form.get("customValues")),b.zb(1),b.kc("ngIf",i.canEdit(n))}}function Ua(e,t){if(1&e&&(b.Rb(0,26),b.Ob(1,"input-field",29),b.Qb()),2&e){var n=b.dc(3);b.kc("formGroup",n.mobileForm),b.zb(1),b.kc("label",n.i18n.phone.mobile)("required","required"===n.mobileAvailability)("placeholder",n.data.phoneConfiguration.mobileExample)}}function $a(e,t){if(1&e&&b.Ob(0,"input-field",31),2&e){var n=b.dc(4);b.kc("label",n.i18n.phone.extension)}}function Ga(e,t){if(1&e&&(b.Rb(0,26),b.Ob(1,"input-field",29),b.Fc(2,$a,1,1,"input-field",30),b.Qb()),2&e){var n=b.dc(3);b.kc("formGroup",n.landLineForm),b.zb(1),b.kc("label",n.i18n.phone.landLine)("required","required"===n.data.phoneConfiguration.landLineAvailability)("placeholder",n.data.phoneConfiguration.landLineExample),b.zb(1),b.kc("ngIf",n.data.phoneConfiguration.extensionEnabled)}}function Ba(e,t){if(1&e&&(b.Tb(0,"div",34),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Ic(n.description)}}function Ja(e,t){if(1&e&&b.Ob(0,"boolean-field",35),2&e){var n=b.dc(4);b.kc("label",n.i18n.user.registration.passwordAssign)}}function Va(e,t){if(1&e&&b.Ob(0,"boolean-field",39),2&e){var n=b.dc(5);b.kc("label",n.i18n.user.registration.passwordForceChange)}}function qa(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"input-field",36),b.Ob(2,"input-field",37),b.Fc(3,Va,1,1,"boolean-field",38),b.Qb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.zb(1),b.kc("label",n.name),b.zb(1),b.kc("label",i.i18n.user.passwordConfirmation(n.name)),b.zb(1),b.kc("ngIf",n.canForceChange)}}function ja(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2"),b.Hc(2),b.Sb(),b.Rb(3,26),b.Fc(4,Ba,2,1,"div",32),b.Fc(5,Ja,1,1,"boolean-field",33),b.Fc(6,qa,4,3,"ng-container",10),b.Qb(),b.Qb()),2&e){var n=t.$implicit,i=t.index,a=b.dc(3);b.zb(2),b.Ic(n.name),b.zb(1),b.kc("formGroup",a.passwordForms[i]),b.zb(1),b.kc("ngIf",n.description),b.zb(1),b.kc("ngIf",a.login.user),b.zb(1),b.kc("ngIf",a.passwordForms[i].get("defined").value)}}function Qa(e,t){if(1&e){var n=b.Ub();b.Tb(0,"form",5),b.Fc(1,Ea,2,2,"label-value",6),b.Fc(2,Na,2,3,"single-selection-field",7),b.Fc(3,Ra,1,1,"input-field",8),b.Fc(4,Pa,1,1,"input-field",9),b.Fc(5,xa,3,2,"ng-container",10),b.Fc(6,Ma,2,2,"ng-container",11),b.Fc(7,Ua,2,4,"ng-container",12),b.Fc(8,Ga,3,5,"ng-container",12),b.Fc(9,ja,7,5,"ng-container",13),b.Tb(10,"actions"),b.Tb(11,"button",14),b.bc("click",(function(){return b.wc(n),b.dc(2).register()})),b.Hc(12),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc(2);b.kc("formGroup",i.form),b.zb(1),b.kc("ngIf",!i.self),b.zb(1),b.kc("ngIf",i.data.groups.length>0),b.zb(1),b.kc("ngIf",i.canEdit("name")),b.zb(1),b.kc("ngIf",i.canEdit("username")),b.zb(1),b.kc("ngIf",i.canEdit("email")),b.zb(1),b.kc("ngForOf",i.data.customFields),b.zb(1),b.kc("ngIf","disabled"!==i.mobileAvailability),b.zb(1),b.kc("ngIf","disabled"!==i.landLineAvailability),b.zb(1),b.kc("ngForOf",i.data.passwordTypes),b.zb(3),b.Jc(" ",i.i18n.general.submit," ")}}function Ya(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.Fc(1,Qa,13,11,"form",4),b.ec(2,"async"),b.Sb()),2&e){var n=b.dc(),i=b.uc(4);b.kc("heading",n.i18n.user.title.operatorRegistration)("mobileHeading",n.i18n.user.mobileTitle.operatorRegistration),b.zb(1),b.kc("ngIf",null==b.fc(2,4,n.result$))("ngIfElse",i)}}function Ka(e,t){if(1&e){var n=b.Ub();b.Ob(0,"p",40),b.ec(1,"trust"),b.Tb(2,"actions",41),b.Tb(3,"button",14),b.bc("click",(function(){return b.wc(n),b.dc().reload()})),b.Hc(4),b.Sb(),b.Tb(5,"button",14),b.bc("click",(function(){return b.wc(n),b.dc().viewProfile()})),b.Hc(6),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("innerHTML",b.fc(1,3,i.doneMessageHtml),b.xc),b.zb(4),b.Jc(" ",i.i18n.user.operatorRegistrationAddAnother," "),b.zb(2),b.Jc(" ",i.i18n.user.registration.viewProfile," ")}}var Xa,Wa=((Xa=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).userHelper=i,r.operatorsService=a,r.result$=new ht.a(null),r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user||this.ApiHelper.SELF,this.self=this.authHelper.isSelf(this.user),this.addSub(this.operatorsService.getOperatorDataForNew({user:this.user}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t;this.form=this.formBuilder.group({group:null}),t=_slicedToArray(this.userHelper.setupRegistrationForm(this.form,e),2),this.mobileForm=t[0],this.landLineForm=t[1],this.passwordForms=this.userHelper.passwordRegistrationForms(e),this.editableFields=this.userHelper.fieldNamesByAction(e,"edit")}},{key:"canEdit",value:function(e){return this.editableFields.has(this.fieldHelper.fieldName(e))}},{key:"register",value:function(){var e=this,t=Object(J.d)(this.form);this.mobileForm&&t.setControl("mobile",this.mobileForm),this.landLineForm&&t.setControl("landLine",this.landLineForm),t.setControl("passwords",new q.g(this.passwordForms)),Object(J.F)(t)&&this.addSub(this.operatorsService.registerOperator({user:this.user,body:t.value}).subscribe((function(t){return e.result$.next(t)})))}},{key:"viewProfile",value:function(){var e=this.result$.value;e&&this.router.navigate(["users",e.user.id,"profile"])}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.MY_OPERATORS)}},{key:"mobileAvailability",get:function(){return this.data.phoneConfiguration.mobileAvailability}},{key:"landLineAvailability",get:function(){return this.data.phoneConfiguration.landLineAvailability}},{key:"doneMessageHtml",get:function(){var e=this.result$.value;if(!e)return null;var t=e.user.display;switch(e.status){case ze.Db.ACTIVE:return this.i18n.user.operatorRegistrationActive(t);case ze.Db.INACTIVE:return this.i18n.user.operatorRegistrationInactive(t);case ze.Db.EMAIL_VALIDATION:return this.i18n.user.operatorRegistrationPending(t)}}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Xa)(b.Nb(b.r),b.Nb(s.a),b.Nb(c.w))},Xa.\u0275cmp=b.Hb({type:Xa,selectors:[["operator-registration"]],features:[b.wb],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading",4,"ngIf"],["done",""],["last","",3,"heading","mobileHeading"],["autocomplete","off",3,"formGroup",4,"ngIf","ngIfElse"],["autocomplete","off",3,"formGroup"],[3,"label",4,"ngIf"],["formControlName","group",3,"label","emptyOption",4,"ngIf"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[3,"label"],[3,"user"],["formControlName","group",3,"label","emptyOption"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["formControlName","email",3,"label","required",4,"ngIf"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["formControlName","email",3,"label","required"],["formControlName","skipActivationEmail",3,"label"],[3,"formGroup"],[3,"field","formControlName",4,"ngIf"],[3,"field","formControlName"],["formControlName","number",3,"label","required","placeholder"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],[3,"innerHTML"],["forceRow",""]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Ya,3,6,"page-content",1),b.Fc(3,Ka,7,5,"ng-template",null,2,b.Gc),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,q.I,q.w,q.n,p.s,Q.a,j.a,vt.a,he.a,q.v,q.l,ve.a,yt.a,q.D,we.a,Lt.a],pipes:[p.b,Ut.a],encapsulation:2,changeDetection:0}),Xa),Za=n("yFKC"),er=n("75v4"),tr=n("qCwG"),nr=(n("Ky6R"),n("T9y1")),ir=n("RRWt"),ar=n("5Wk5"),rr=n("pgV1"),or=n("wezA"),cr=function(e,t){return{"cell-main":e,"cell-text":t}};function sr(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div",8),b.Ob(2,"format-field-value",9),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=t.first,a=b.dc().$implicit,r=b.dc();b.zb(1),b.kc("ngClass",b.oc(6,cr,i,!i)),b.zb(1),b.kc("fields",r.data.customFields)("plainText",!0)("fieldName",n)("object",r.user(a))("customValues",r.customValues(a))}}function lr(e,t){if(1&e&&(b.Tb(0,"div",10),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc();b.zb(1),b.Jc(" ",i.operatorGroup(n)," ")}}function ur(e,t){if(1&e&&(b.Tb(0,"mobile-result",5),b.Fc(1,sr,3,9,"ng-container",6),b.Fc(2,lr,2,1,"div",7),b.Sb()),2&e){var n=t.$implicit,i=b.dc();b.kc("avatarImage",i.user(n).image)("avatarIcon","operator"===i.resultKind?null:"user"),b.zb(1),b.kc("ngForOf",i.fieldsInTile),b.zb(1),b.kc("ngIf","operator"===i.resultKind)}}function dr(e,t){1&e&&b.Ob(0,"th",15)}function br(e,t){if(1&e&&(b.Tb(0,"th"),b.Hc(1),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(1),b.Ic(i.fieldName(n))}}function fr(e,t){if(1&e&&(b.Tb(0,"th"),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.Ic(n.i18n.user.group)}}function mr(e,t){if(1&e&&(b.Tb(0,"td",15),b.Ob(1,"avatar",17),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(2);b.zb(1),b.kc("image",i.user(n).image)}}function pr(e,t){if(1&e&&(b.Tb(0,"td"),b.Ob(1,"format-field-value",9),b.Sb()),2&e){var n=t.$implicit,i=b.dc().$implicit,a=b.dc(2);b.zb(1),b.kc("fields",a.data.customFields)("plainText",!0)("fieldName",n)("object",a.user(i))("customValues",a.customValues(i))}}function gr(e,t){if(1&e&&(b.Tb(0,"td"),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(2);b.zb(1),b.Ic(i.operatorGroup(n))}}function hr(e,t){if(1&e){var n=b.Ub();b.Tb(0,"tr",16),b.bc("click",(function(){b.wc(n);var e=t.$implicit,i=b.dc(2);return i.canViewProfile?i.router.navigate(i.path(e)):null})),b.Fc(1,mr,2,1,"td",12),b.Fc(2,pr,2,5,"td",6),b.Fc(3,gr,2,1,"td",13),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.kc("ngIf","operator"!==i.resultKind),b.zb(1),b.kc("ngForOf",i.fieldsInList),b.zb(1),b.kc("ngIf","operator"===i.resultKind)}}var vr=function(e){return{"cursor-pointer":e}};function yr(e,t){if(1&e&&(b.Tb(0,"table",11),b.Tb(1,"thead"),b.Fc(2,dr,1,0,"th",12),b.Fc(3,br,2,1,"th",6),b.Fc(4,fr,2,1,"th",13),b.Sb(),b.Tb(5,"tbody"),b.Fc(6,hr,4,3,"tr",14),b.Sb(),b.Sb()),2&e){var n=b.dc();b.kc("ngClass",b.nc(5,vr,n.canViewProfile)),b.zb(2),b.kc("ngIf","operator"!==n.resultKind),b.zb(1),b.kc("ngForOf",n.fieldsInList),b.zb(1),b.kc("ngIf","operator"===n.resultKind),b.zb(2),b.kc("ngForOf",null==n.results?null:n.results.results)}}function kr(e,t){if(1&e&&(b.Tb(0,"div",8),b.Tb(1,"format-field-value",20),b.Hc(2," \xa0 "),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=t.first,a=b.dc().$implicit,r=b.dc();b.kc("ngClass",i?"card-title":"card-text"),b.zb(1),b.kc("fields",r.data.customFields)("fieldName",n)("object",r.user(a))("customValues",r.customValues(a))}}function Sr(e,t){if(1&e&&(b.Tb(0,"tiled-result",18),b.Fc(1,kr,3,5,"div",19),b.Sb()),2&e){var n=t.$implicit,i=b.dc();b.kc("image",i.user(n).image),b.zb(1),b.kc("ngForOf",i.fieldsInTile)}}var Tr=function(e,t){return{"font-weight-bold":e,"mb-2":t}};function Ir(e,t){if(1&e&&(b.Tb(0,"div",8),b.Ob(1,"format-field-value",9),b.Sb()),2&e){var n=t.$implicit,i=t.first,a=t.last,r=b.dc().$implicit,o=b.dc();b.kc("ngClass",b.oc(6,Tr,i,a)),b.zb(1),b.kc("fields",o.data.customFields)("plainText",!0)("fieldName",n)("object",o.user(r))("customValues",o.customValues(r))}}function Cr(e,t){if(1&e&&(b.Tb(0,"map-result",21),b.Fc(1,Ir,2,9,"div",19),b.Sb()),2&e){var n=t.$implicit,i=t.address,a=b.dc();b.kc("image",a.user(n).image)("address",i),b.zb(1),b.kc("ngForOf",a.fieldsInTile)}}var Or,Fr=((Or=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).clazz="flex-grow-1 d-flex",i.resultKind="user",i.update=new b.n,i}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.canViewProfile=!0===(((this.dataForUiHolder.dataForUi.auth||{}).permissions||{}).users||{}).viewProfile}},{key:"user",value:function(e){return"contact"===this.resultKind?e.contact:e}},{key:"operatorGroup",value:function(e){if("operator"===this.resultKind){var t=e.group;return t?t.name:this.i18n.user.operatorNoGroup}return null}},{key:"displayFunction",value:function(){var e=this;return function(t){var n=e.user(t);if(n.display)return n.display;var i=n,a=e.fieldsInList[0];return i.hasOwnProperty(a)?i[a]:(i.customValues||{})[a]}}},{key:"customValues",value:function(e){return null==e?null:e.customValues}},{key:"address",value:function(e){return"contact"===this.resultKind?null:e.address}},{key:"fieldName",value:function(e){return"operator"===this.resultKind&&"display"===e?this.i18n.general.operator:this.fieldHelper.fieldDisplay(e,this.data.customFields)}},{key:"path",value:function(e){var t=this.user(e);return this.authHelper.isSelf(t)?["/users",this.ApiHelper.SELF,"profile"]:"operator"===this.resultKind?["/users","operators",t.id]:this.canViewProfile?"contact"===this.resultKind?["/users","contacts",t.id]:["/users",t.id,"profile"]:null}},{key:"data",set:function(e){this._data=e;var t=(e||{}).fieldsInList||[];this.fieldsInList=t.slice(0,Math.min(t.length,7)),this.fieldsInTile=t.slice(0,Math.min(t.length,2)),this.showTableHeader=this.fieldsInList.length>1},get:function(){return this._data}},{key:"toLink",get:function(){var e=this;return function(t){return e.path(t)}}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Or)(b.Nb(b.r))},Or.\u0275cmp=b.Hb({type:Or,selectors:[["users-results"]],hostVars:2,hostBindings:function(e,t){2&e&&b.Bb(t.clazz)},inputs:{resultType:"resultType",rendering$:"rendering$",referencePoint:"referencePoint",data:"data",results:"results",resultKind:"resultKind"},outputs:{update:"update"},features:[b.wb],decls:5,vars:7,consts:[[3,"results","rendering$","resultType","toAddress","referencePoint","toMarkerTitle","toLink","update"],[3,"avatarImage","avatarIcon",4,"mobileResult"],["class","table table-hover",3,"ngClass",4,"resultTable"],["icon","user","zoom","",3,"image",4,"resultTile"],[3,"image","address",4,"resultInfoWindow"],[3,"avatarImage","avatarIcon"],[4,"ngFor","ngForOf"],["class","cell-text",4,"ngIf"],[3,"ngClass"],[3,"fields","plainText","fieldName","object","customValues"],[1,"cell-text"],[1,"table","table-hover",3,"ngClass"],["class","avatar",4,"ngIf"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"avatar"],[3,"click"],[3,"image"],["icon","user","zoom","",3,"image"],[3,"ngClass",4,"ngFor","ngForOf"],["plainText","",1,"d-block","text-truncate",3,"fields","fieldName","object","customValues"],[3,"image","address"]],template:function(e,t){1&e&&(b.Tb(0,"results-layout",0),b.bc("update",(function(e){return t.update.emit(e)})),b.Fc(1,ur,3,4,"mobile-result",1),b.Fc(2,yr,7,7,"table",2),b.Fc(3,Sr,2,2,"tiled-result",3),b.Fc(4,Cr,2,3,"map-result",4),b.Sb()),2&e&&b.kc("results",t.results)("rendering$",t.rendering$)("resultType",t.resultType)("toAddress",t.address)("referencePoint",t.referencePoint)("toMarkerTitle",t.displayFunction())("toLink",t.canViewProfile?t.toLink:null)},directives:[h.a,v.a,y.a,nr.a,ir.a,S.a,p.s,p.t,p.q,ar.a,ke.a,rr.a,or.a],encapsulation:2,changeDetection:0}),Or);function zr(e,t){1&e&&b.Pb(0)}function Ar(e,t){if(1&e&&(b.Tb(0,"div",9),b.Tb(1,"label-value",10),b.Ob(2,"user-link",11),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.data.user)}}function wr(e,t){if(1&e&&b.Ob(0,"field-option",14),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",i.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)}}function Er(e,t){if(1&e&&(b.Tb(0,"div",9),b.Tb(1,"multi-selection-field",12),b.Fc(2,wr,1,4,"field-option",13),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.user.groupFilter),b.zb(1),b.kc("ngForOf",n.data.groups)}}function _r(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div",9),b.Ob(2,"multi-selection-field",15),b.Sb(),b.Tb(3,"div",9),b.Ob(4,"date-field",16),b.Sb(),b.Tb(5,"div",9),b.Ob(6,"date-field",17),b.Sb(),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.kc("label",n.i18n.general.status)("fieldOptions",n.statusOptions),b.zb(2),b.kc("label",n.i18n.user.creationBegin),b.zb(2),b.kc("label",n.i18n.user.creationEnd)}}function Nr(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"form",4),b.Tb(3,"div",5),b.Fc(4,Ar,3,2,"div",6),b.Fc(5,Er,3,2,"div",6),b.Fc(6,_r,7,4,"ng-container",7),b.ec(7,"async"),b.Sb(),b.Sb(),b.Sb(),b.Tb(8,"users-results",8),b.bc("update",(function(e){return b.wc(n),b.dc().update(e)})),b.ec(9,"async"),b.ec(10,"async"),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.self?i.i18n.user.title.myOperators:i.i18n.user.title.userOperators)("mobileHeading",i.self?i.i18n.user.mobileTitle.myOperators:i.i18n.user.mobileTitle.userOperators)("headingActions",b.fc(1,11,i.headingActions$)),b.zb(2),b.kc("formGroup",i.form),b.zb(2),b.kc("ngIf",!i.self),b.zb(1),b.kc("ngIf",(null==i.data.groups?null:i.data.groups.length)>1),b.zb(1),b.kc("ngIf",b.fc(7,13,i.layout.gtxxs$)),b.zb(2),b.kc("results",b.fc(9,15,i.results$))("rendering$",i.rendering$)("data",b.fc(10,17,i.data$))("resultKind","operator")}}var Rr,Pr=((Rr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).operatorsService=i,r.userHelper=a,r.ResultType=er.a,r.empty=J.h,r}return _createClass(n,[{key:"getFormControlNames",value:function(){return["operatorGroups","statuses","creationBegin","creationEnd"]}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user||me.a.SELF,this.self=this.authHelper.isSelf(this.param),this.addSub(this.operatorsService.getUserOperatorsDataForSearch({user:this.param}).subscribe((function(t){e.statusOptions=e.userHelper.statusOptions(),!e.self&&t.canCreateNew&&(e.headingActions=[new B.c("registration",e.i18n.general.addNew,(function(){e.router.navigate(["/users",e.param,"operators","registration"])}),!0)]),e.data=t})))}},{key:"onDataInitialized",value:function(e){_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e),Object(J.h)(e.fieldsInList)&&(e.fieldsInList=["display"])}},{key:"toSearchParams",value:function(e){var t=e;return t.user=this.param,t.creationPeriod=me.a.rangeFilter(e.creationBegin,e.creationEnd),delete e.customValues,t}},{key:"doSearch",value:function(e){return this.operatorsService.searchUserOperators$Response(e)}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.MY_OPERATORS)}}]),n}(pe.a)).\u0275fac=function(e){return new(e||Rr)(b.Nb(b.r),b.Nb(Za.a),b.Nb(s.a))},Rr.\u0275cmp=b.Hb({type:Rr,selectors:[["search-user-operators"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-bottom-0",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["resultType","list",3,"results","rendering$","data","resultKind","update"],[1,"col-12","col-md-6"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["labelPosition","side","formControlName","operatorGroups",3,"label"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","statuses",3,"label","fieldOptions"],["labelPosition","side","formControlName","creationBegin","fieldSize","full",3,"label"],["labelPosition","side","formControlName","creationEnd","fieldSize","full",3,"label"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,zr,1,0,"ng-container",1),b.Sb(),b.Fc(3,Nr,11,19,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,q.I,q.w,q.n,Fr,j.a,vt.a,nt.a,q.v,q.l,p.s,ve.a,ge.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Rr);function Dr(e,t){if(1&e&&b.Ob(0,"input-field",7),2&e){var n=b.dc();b.kc("label",n.i18n.password.oldPassword)}}var Hr,xr=function(e){var t=e.value;if(e.touched&&null!=t&&""!==t){var n=e.parent;if((null==n.get("newPassword")?"":n.get("newPassword").value)!==t)return{passwordsMatch:!0}}return null},Lr=((Hr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).modalRef=i,r.passwordsService=a,r.done=new b.n,r}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.self=this.authHelper.isSelf(this.user),this.form=this.formBuilder.group({newPassword:[null,q.G.required],newPasswordConfirmation:[null,q.G.compose([q.G.required,xr])]}),this.requireOld&&this.form.setControl("oldPassword",this.formBuilder.control(null,q.G.required))}},{key:"submit",value:function(){var e=this;if(Object(J.F)(this.form)){var t=this.form.value;t.checkConfirmation=!0,this.addSub(this.passwordsService.changePassword({user:this.param,type:this.type.id,body:t}).subscribe((function(){e.done.emit(),e.modalRef.hide()})))}}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Hr)(b.Nb(b.r),b.Nb(f.a),b.Nb(c.y))},Hr.\u0275cmp=b.Hb({type:Hr,selectors:[["change-password-dialog"]],inputs:{param:"param",user:"user",type:"type",requireOld:"requireOld"},outputs:{done:"done"},features:[b.wb],decls:12,vars:10,consts:[[3,"formGroup"],["required","","focused","","formControlName","oldPassword","type","password",3,"label",4,"ngIf"],["required","","formControlName","newPassword","type","password",3,"label"],["required","","formControlName","newPasswordConfirmation","type","password",3,"label"],["forceRow",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-outline-primary",3,"click"],["required","","focused","","formControlName","oldPassword","type","password",3,"label"]],template:function(e,t){1&e&&(b.Tb(0,"h1"),b.Hc(1),b.Sb(),b.Tb(2,"form",0),b.Fc(3,Dr,1,1,"input-field",1),b.Ob(4,"input-field",2),b.Ob(5,"input-field",3),b.Sb(),b.Tb(6,"actions",4),b.Tb(7,"button",5),b.bc("click",(function(){return t.submit()})),b.ec(8,"async"),b.Hc(9),b.Sb(),b.Tb(10,"button",6),b.bc("click",(function(){return t.modalRef.hide()})),b.Hc(11),b.Sb(),b.Sb()),2&e&&(b.zb(1),b.Jc(" ",t.self?t.i18n.password.title.changeSelf:t.i18n.password.title.changeUser,"\n"),b.zb(1),b.kc("formGroup",t.form),b.zb(1),b.kc("ngIf",t.requireOld),b.zb(1),b.kc("label",t.i18n.password.newPassword),b.zb(1),b.kc("label",t.i18n.password.passwordConfirmation),b.zb(2),b.kc("disabled",b.fc(8,8,t.requesting$)),b.zb(2),b.Jc(" ",t.i18n.general.submit," "),b.zb(2),b.Jc(" ",t.i18n.general.cancel," "))},directives:[q.I,q.w,q.n,p.t,yt.a,q.D,q.v,q.l,Q.a,Mt.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Hr),Mr=n("CNMR");function Ur(e,t){1&e&&b.Pb(0)}function $r(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"user-info",7),b.Ob(2,"hr"),b.Qb()),2&e){var n=b.dc(2);b.zb(1),b.kc("user",n.data.user)}}function Gr(e,t){1&e&&b.Ob(0,"hr",17)}function Br(e,t){1&e&&b.Ob(0,"avatar",18),2&e&&b.kc("size",64)}var Jr=function(e){return{"mt-0":e}};function Vr(e,t){if(1&e&&(b.Tb(0,"h2",19),b.Hc(1),b.Sb()),2&e){var n=b.dc(),i=n.$implicit;b.kc("ngClass",b.nc(2,Jr,n.first)),b.zb(1),b.Jc(" ",i.type.name,"")}}function qr(e,t){if(1&e&&(b.Tb(0,"div",20),b.Hc(1),b.ec(2,"dateTime"),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(2);b.zb(1),b.Jc(" ",i.i18n.password.statusSince(b.fc(2,1,n.date))," ")}}var jr=function(e){return{"mb-3":e}};function Qr(e,t){if(1&e&&(b.Tb(0,"button",21),b.bc("click",(function(){return t.$implicit.onClick()})),b.Hc(1),b.Sb()),2&e){var n=t.$implicit;b.kc("ngClass",b.nc(2,jr,!t.last)),b.zb(1),b.Jc(" ",n.label," ")}}function Yr(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Gr,1,0,"hr",8),b.Tb(2,"div",9),b.Tb(3,"div",10),b.Fc(4,Br,1,1,"avatar",11),b.ec(5,"async"),b.Sb(),b.Tb(6,"div",12),b.Fc(7,Vr,2,4,"h2",13),b.Tb(8,"div"),b.Hc(9),b.Sb(),b.Fc(10,qr,3,3,"div",14),b.Sb(),b.Tb(11,"div",15),b.Fc(12,Qr,2,4,"button",16),b.Sb(),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=t.first,a=b.dc(2);b.zb(1),b.kc("ngIf",!i),b.zb(3),b.kc("ngIf",b.fc(5,6,a.layout.gtxxs$)),b.zb(3),b.kc("ngIf",a.multiple),b.zb(2),b.Ic(a.status(n)),b.zb(1),b.kc("ngIf",n.date),b.zb(2),b.kc("ngForOf",a.actions(n))}}function Kr(e,t){if(1&e&&b.Ob(0,"field-option",29),2&e){var n=t.$implicit;b.kc("value",n.internalName)("text",n.name)}}function Xr(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",22),b.Tb(1,"alert",23),b.Hc(2),b.Sb(),b.Tb(3,"form",24),b.Tb(4,"single-selection-field",25),b.Fc(5,Kr,1,2,"field-option",26),b.Sb(),b.Ob(6,"input-field",27),b.Sb(),b.Tb(7,"actions"),b.Tb(8,"button",28),b.bc("click",(function(){return b.wc(n),b.dc(2).setSecurityAnswer()})),b.Hc(9),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc(2);b.kc("heading",i.i18n.password.title.securityAnswer)("mobileHeading",i.i18n.password.mobileTitle.securityAnswer),b.zb(2),b.Ic(i.i18n.securityQuestion.message),b.zb(1),b.kc("formGroup",i.securityAnswer),b.zb(1),b.kc("label",i.i18n.securityQuestion.question),b.zb(1),b.kc("ngForOf",i.data.dataForSetSecurityAnswer.securityQuestions),b.zb(1),b.kc("label",i.i18n.securityQuestion.answer),b.zb(3),b.Jc(" ",i.i18n.general.save," ")}}function Wr(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.Fc(1,$r,3,1,"ng-container",4),b.Fc(2,Yr,13,8,"ng-container",5),b.Sb(),b.Fc(3,Xr,10,8,"page-content",6)),2&e){var n=b.dc();b.kc("heading",n.title)("mobileHeading",n.mobileTitle)("last",!(null!=n.data&&n.data.dataForSetSecurityAnswer)),b.zb(1),b.kc("ngIf",n.data.user&&!n.self),b.zb(1),b.kc("ngForOf",n.data.passwords),b.zb(1),b.kc("ngIf",null==n.data?null:n.data.dataForSetSecurityAnswer)}}var Zr,eo,to=((Zr=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).modal=i,r.passwordsService=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.passwordsService.getUserPasswordsListData({user:this.param}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){this.self=this.authHelper.isSelf(e.user),this.multiple=e.passwords.length>1,this.self?(this.title=this.multiple?this.i18n.password.title.manageMultipleSelf:this.i18n.password.title.manageSingleSelf,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleSelf:this.i18n.password.mobileTitle.manageSingleSelf):(this.title=this.multiple?this.i18n.password.title.manageMultipleUser:this.i18n.password.title.manageSingleUser,this.mobileTitle=this.multiple?this.i18n.password.mobileTitle.manageMultipleUser:this.i18n.password.mobileTitle.manageSingleUser),e.dataForSetSecurityAnswer&&(this.securityAnswer=this.formBuilder.group({securityQuestion:[null,q.G.required],securityAnswer:[null,q.G.required]}))}},{key:"actions",value:function(e){var t=this,n=[],i=e.permissions||{};return i.change&&n.push(new B.a(this.i18n.password.action.change,(function(){t.change(e)}))),i.changeGenerated&&n.push(new B.a(this.i18n.password.action.change,(function(){t.changeGenerated(e)}))),i.unblock&&n.push(new B.a(this.i18n.password.action.unblock,(function(){t.unblock(e)}))),i.generate&&n.push(new B.a(this.i18n.password.action.activate,(function(){t.generate(e)}))),i.enable&&n.push(new B.a(this.i18n.password.action.enable,(function(){t.enable(e)}))),i.disable&&n.push(new B.a(this.i18n.password.action.disable,(function(){t.disable(e)}))),n}},{key:"setSecurityAnswer",value:function(){var e=this;Object(J.F)(this.securityAnswer),this.securityAnswer.valid&&this.addSub(this.passwordsService.setSecurityAnswer({body:this.securityAnswer.value}).subscribe((function(){e.notification.snackBar(e.i18n.securityQuestion.set),e.reload()})))}},{key:"status",value:function(e){switch(e.status){case ze.T.ACTIVE:return this.i18n.password.status.active;case ze.T.DISABLED:return this.i18n.password.status.disabled;case ze.T.EXPIRED:return this.i18n.password.status.expired;case ze.T.INDEFINITELY_BLOCKED:return this.i18n.password.status.indefinitelyBlocked;case ze.T.NEVER_CREATED:return this.i18n.password.status.neverCreated;case ze.T.PENDING:return this.i18n.password.status.pending;case ze.T.RESET:return this.i18n.password.status.reset;case ze.T.TEMPORARILY_BLOCKED:return this.i18n.password.status.temporarilyBlocked}}},{key:"change",value:function(e){var t=this,n=this.modal.show(Lr,{class:"modal-form",initialState:{param:this.param,type:e.type,user:this.data.user,requireOld:e.requireOldPasswordForChange}});this.addSub(n.content.done.subscribe((function(){t.notification.snackBar(t.i18n.password.action.changeDone(e.type.name)),t.reload()})))}},{key:"generate",value:function(e){var t=this;this.notification.confirm({title:this.i18n.password.action.activate,message:this.i18n.password.action.activateConfirm(e.type.name),callback:function(){return t.doGenerate(e)}})}},{key:"doGenerate",value:function(e){var t=this;this.addSub(this.passwordsService.generatePassword({type:e.type.id}).subscribe((function(n){t.notification.info(t.i18n.password.action.changeGeneratedDone({type:e.type.name,value:n})),t.reload()})))}},{key:"createDeviceConfirmation",value:function(e){return function(){return{type:ze.s.GENERATE_PASSWORD,passwordType:e.type.id}}}},{key:"changeGenerated",value:function(e){var t=this;this.notification.confirm({title:this.i18n.password.action.change,message:this.i18n.password.action.changeGeneratedConfirm(e.type.name),createDeviceConfirmation:this.createDeviceConfirmation(e),passwordInput:this.data.confirmationPasswordInput,callback:function(n){return t.doChangeGenerated(e,n.confirmationPassword)}})}},{key:"doChangeGenerated",value:function(e,t){var n=this;this.addSub(this.passwordsService.changeGenerated({type:e.type.id,confirmationPassword:t}).subscribe((function(t){n.notification.info(n.i18n.password.action.changeGeneratedDone({type:e.type.name,value:t})),n.reload()})))}},{key:"unblock",value:function(e){var t=this;this.notification.confirm({title:this.i18n.password.action.unblock,message:this.i18n.password.action.unblockConfirm(e.type.name),callback:function(){return t.doUnblock(e)}})}},{key:"doUnblock",value:function(e){var t=this;this.addSub(this.passwordsService.unblockPassword({user:this.param,type:e.type.id}).subscribe((function(){t.notification.snackBar(t.i18n.password.action.unblockDone(e.type.name)),t.reload()})))}},{key:"enable",value:function(e){var t=this;this.notification.confirm({title:this.i18n.password.action.enable,message:this.i18n.password.action.enableConfirm(e.type.name),callback:function(){return t.doEnable(e)}})}},{key:"doEnable",value:function(e){var t=this;this.addSub(this.passwordsService.enablePassword({user:this.param,type:e.type.id}).subscribe((function(){t.notification.snackBar(t.i18n.password.action.enableDone(e.type.name)),t.reload()})))}},{key:"disable",value:function(e){var t=this;this.notification.confirm({title:this.i18n.password.action.disable,message:this.i18n.password.action.disableConfirm(e.type.name),callback:function(){return t.doDisable(e)}})}},{key:"doDisable",value:function(e){var t=this;this.addSub(this.passwordsService.disablePassword({user:this.param,type:e.type.id}).subscribe((function(){t.notification.snackBar(t.i18n.password.action.disableDone(e.type.name)),t.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.PASSWORDS)}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Zr)(b.Nb(b.r),b.Nb(f.b),b.Nb(c.y))},Zr.\u0275cmp=b.Hb({type:Zr,selectors:[["manage-passwords"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading","last"],[4,"ngIf"],[4,"ngFor","ngForOf"],["hideBack","","last","",3,"heading","mobileHeading",4,"ngIf"],["labelCols","2",3,"user"],["class","mt-4",4,"ngIf"],[1,"row","no-gutters"],[1,"col-4","col-md-2"],["class","ml-2 mr-5 management-icon","iconSize","64px","icon","vpn_key",3,"size",4,"ngIf"],[1,"col-8","col-md-7"],["class","border-0 mb-3",3,"ngClass",4,"ngIf"],["class","mt-2",4,"ngIf"],[1,"col-12","col-md-3","mt-3","mt-md-0"],["class","d-block ml-auto btn btn-primary",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"mt-4"],["iconSize","64px","icon","vpn_key",1,"ml-2","mr-5","management-icon",3,"size"],[1,"border-0","mb-3",3,"ngClass"],[1,"mt-2"],[1,"d-block","ml-auto","btn","btn-primary",3,"ngClass","click"],["hideBack","","last","",3,"heading","mobileHeading"],["type","info"],[3,"formGroup"],["formControlName","securityQuestion","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label"],[1,"btn","btn-primary",3,"click"],[3,"value","text"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Ur,1,0,"ng-container",1),b.Sb(),b.Fc(3,Wr,4,6,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,p.s,k.a,ke.a,p.q,Mr.a,q.I,q.w,q.n,he.a,q.v,q.l,q.D,yt.a,Q.a,ve.a],pipes:[p.b,O.a],styles:["[_nghost-%COMP%]     avatar icon{color:#adb5bd}body.dark   [_nghost-%COMP%]     avatar icon{color:#6c757d}"],changeDetection:0}),Zr),no=n("txia"),io=n("9d5G"),ao=n("bER3"),ro=["codeField"],oo=((eo=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).modalRef=i,r.phonesService=a,r.verified=new b.n,r.message$=new ht.a(""),r.disabled=!1,r.code=r.formBuilder.control(null,q.G.required),r}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.message=this.i18n.phone.verify.message}},{key:"sendCode",value:function(){var e=this;this.addSub(this.phonesService.sendPhoneVerificationCode({id:this.phone.id}).subscribe((function(t){e.message=e.i18n.phone.verify.done(t),e.code.setValue(null),e.codeField.focus()})))}},{key:"verify",value:function(){var e=this;Object(J.F)(this.code)&&this.addSub(this.phonesService.verifyPhone({id:this.phone.id,code:this.code.value}).subscribe((function(t){switch(t){case ze.l.CODE_NOT_SENT:case ze.l.EXPIRED:e.notification.error(e.i18n.phone.error.verify.expired);break;case ze.l.FAILED:e.notification.error(e.i18n.phone.error.verify.invalid);break;case ze.l.MAX_ATTEMPTS_REACHED:e.notification.error(e.i18n.phone.error.verify.maxAttempts);break;case ze.l.SUCCESS:e.disabled=!0,e.verified.emit(!0)}})))}},{key:"message",set:function(e){this.message$.next(e)}}]),n}(tr.a)).\u0275fac=function(e){return new(e||eo)(b.Nb(b.r),b.Nb(f.a),b.Nb(c.A))},eo.\u0275cmp=b.Hb({type:eo,selectors:[["verify-phone"]],viewQuery:function(e,t){var n;1&e&&b.Cc(ro,!0),2&e&&b.tc(n=b.cc())&&(t.codeField=n.first)},inputs:{phone:"phone"},outputs:{verified:"verified"},features:[b.wb],decls:21,vars:12,consts:[[1,"row"],[1,"col-3","col-form-label"],["for","smsCode"],[1,"col-6"],["id","smsCode","fieldSize","4","type","number","focused","",3,"formControl"],["codeField",""],[1,"col-3"],[1,"btn","btn-primary","d-block","w-100",3,"click"],[1,"mt-3","pb-1"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"h1"),b.Hc(1),b.Sb(),b.Tb(2,"div",0),b.Tb(3,"div",1),b.Tb(4,"label",2),b.Hc(5),b.Sb(),b.Sb(),b.Tb(6,"div",3),b.Ob(7,"input-field",4,5),b.Sb(),b.Tb(9,"div",6),b.Tb(10,"button",7),b.bc("click",(function(){return t.sendCode()})),b.Hc(11),b.Sb(),b.Sb(),b.Sb(),b.Tb(12,"div",8),b.Hc(13),b.ec(14,"async"),b.Sb(),b.Tb(15,"actions"),b.Tb(16,"button",9),b.bc("click",(function(){return t.verify()})),b.ec(17,"async"),b.Hc(18),b.Sb(),b.Tb(19,"button",10),b.bc("click",(function(){return t.modalRef.hide()})),b.Hc(20),b.Sb(),b.Sb()),2&e&&(b.zb(1),b.Jc(" ",t.i18n.phone.verify.title(t.phone.number),"\n"),b.zb(4),b.Jc(" ",t.i18n.phone.verify.code," "),b.zb(2),b.kc("formControl",t.code),b.zb(4),b.Jc(" ",t.i18n.phone.verify.send," "),b.zb(2),b.Ic(b.fc(14,8,t.message$)),b.zb(3),b.kc("disabled",b.fc(17,10,t.requesting$)),b.zb(2),b.Jc(" ",t.i18n.general.confirm," "),b.zb(2),b.Jc(" ",t.i18n.general.cancel," "))},directives:[yt.a,Mt.a,q.v,q.k,Q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),eo),co=n("IzEk"),so=n("SxV6"),lo=n("pz1b"),uo=n("pBnU"),bo=n("m98c"),fo=n("sYqu"),mo=n("f0aj"),po=n("FE24"),go=n("z332"),ho=n("oj/z");function vo(e,t){if(1&e&&b.Ob(0,"avatar",21),2&e){var n=b.dc(4);b.kc("image",n.images[0])("roundBorders",!1)}}function yo(e,t){if(1&e&&(b.Tb(0,"div",22),b.Hc(1),b.Sb()),2&e){var n=b.dc(4);b.zb(1),b.Jc(" ",n.i18n.user.noImage," ")}}function ko(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(5).removeAllImages()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(5);b.zb(1),b.Jc(" ",i.i18n.field.image.remove," ")}}function So(e,t){if(1&e){var n=b.Ub();b.Tb(0,"actions",23),b.Tb(1,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(),b.uc(7).perform()})),b.Hc(2),b.Sb(),b.Fc(3,ko,2,1,"button",25),b.Sb()}if(2&e){var i=b.dc(4);b.zb(2),b.Jc(" ",i.i18n.field.image.upload," "),b.zb(1),b.kc("ngIf",i.images.length>0)}}function To(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"h2",14),b.Hc(2),b.Sb(),b.Tb(3,"div",15),b.Fc(4,vo,1,2,"avatar",16),b.Fc(5,yo,2,1,"div",17),b.Sb(),b.Tb(6,"image-upload",18,19),b.bc("uploadDone",(function(e){return b.wc(n),b.dc(3).onUploadDone(e)})),b.Sb(),b.Fc(8,So,4,2,"actions",20),b.ec(9,"async"),b.Qb()}if(2&e){var i=b.uc(7),a=b.dc(3);b.zb(2),b.Jc(" ",a.i18n.user.title.image," "),b.zb(2),b.kc("ngIf",a.images.length>0),b.zb(1),b.kc("ngIf",0===a.images.length),b.zb(1),b.kc("owner",a.param),b.zb(2),b.kc("ngIf",a.canEdit("image")&&!1===b.fc(9,5,i.uploading$))}}function Io(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(),b.uc(11).perform()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(4);b.zb(1),b.Jc(" ",i.i18n.field.image.upload," ")}}function Co(e,t){if(1&e&&(b.Tb(0,"div",33),b.Ob(1,"avatar",34),b.Sb()),2&e){var n=t.$implicit,i=b.dc(4);b.zb(1),b.kc("image",n)("roundBorders",!1)("additionalImages",i.images)}}function Oo(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div",35),b.Hc(2),b.Sb(),b.Qb()),2&e){var n=b.dc(4);b.zb(2),b.Jc(" ",n.i18n.user.noImages," ")}}function Fo(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",36),b.Tb(1,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(4).manageImages()})),b.Hc(2),b.Sb(),b.Sb()}if(2&e){var i=b.dc(4);b.zb(2),b.Jc(" ",i.i18n.field.image.manage," ")}}function zo(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"h2",26),b.Tb(2,"div",27),b.Hc(3),b.Sb(),b.Fc(4,Io,2,1,"button",25),b.ec(5,"async"),b.Sb(),b.Tb(6,"div",28),b.Fc(7,Co,2,3,"div",29),b.Fc(8,Oo,3,1,"ng-container",4),b.Sb(),b.Fc(9,Fo,3,1,"div",30),b.Tb(10,"image-upload",31,32),b.bc("uploadDone",(function(e){return b.wc(n),b.dc(3).onUploadDone(e)})),b.Sb(),b.Qb()}if(2&e){var i=b.uc(11),a=b.dc(3);b.zb(3),b.Jc(" ",a.i18n.user.title.images," "),b.zb(1),b.kc("ngIf",a.canUploadImages&&!1===b.fc(5,7,i.uploading$)),b.zb(3),b.kc("ngForOf",a.images),b.zb(1),b.kc("ngIf",0===a.images.length),b.zb(1),b.kc("ngIf",a.canEdit("image")&&a.images.length>0),b.zb(1),b.kc("owner",a.param)("max",a.data.imageConfiguration.maxImages)}}function Ao(e,t){if(1&e&&(b.Rb(0),b.Fc(1,To,10,7,"ng-container",4),b.Fc(2,zo,12,9,"ng-container",4),b.Qb()),2&e){var n=b.dc(2);b.zb(1),b.kc("ngIf","single"===n.imagesAvailability),b.zb(1),b.kc("ngIf","multiple"===n.imagesAvailability)}}function wo(e,t){if(1&e&&(b.Tb(0,"label-value",37),b.Ob(1,"user-link",38),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.operatorOwner),b.zb(1),b.kc("user",n.data.userConfiguration.details.user)}}function Eo(e,t){if(1&e&&b.Ob(0,"input-field",39),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.name)("required",n.canEdit("name"))}}function _o(e,t){if(1&e&&b.Ob(0,"input-field",40),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.username)("required",n.canEdit("username"))}}function No(e,t){if(1&e&&b.Ob(0,"field-privacy",44),2&e){var n=b.dc(3);b.kc("control",n.user.get("hiddenFields"))}}function Ro(e,t){if(1&e&&(b.Tb(0,"label-value",41),b.Ob(1,"input-field",42),b.Fc(2,No,1,1,"field-privacy",43),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.email)("kind",n.canEdit("email")?"field":"fieldView")("ignoreExtraCell",!n.canManagePrivacy("email")),b.zb(1),b.kc("required",n.canEdit("email"))}}function Po(e,t){if(1&e&&(b.Tb(0,"label-value",37),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.emailPending),b.zb(1),b.Jc(" ",n.data.userConfiguration.emailPendingValidation," ")}}function Do(e,t){if(1&e&&b.Ob(0,"custom-field-input",50),2&e){var n=b.dc(2).$implicit,i=b.dc(2);b.kc("field",n)("formControlName",n.internalName)("binaryValues",i.data.userConfiguration.binaryValues)}}function Ho(e,t){if(1&e&&b.Ob(0,"format-field-value",51),2&e){var n=b.dc(2).$implicit,i=b.dc(2);b.kc("fieldValue",i.fieldValue(n))}}function xo(e,t){if(1&e&&b.Ob(0,"field-privacy",52),2&e){var n=b.dc(2).$implicit,i=b.dc(2);b.kc("field",n.internalName)("control",i.user.get("hiddenFields"))}}function Lo(e,t){if(1&e&&(b.Tb(0,"label-value",46),b.Fc(1,Do,1,3,"custom-field-input",47),b.Fc(2,Ho,1,1,"ng-template",null,48,b.Gc),b.Fc(4,xo,1,2,"field-privacy",49),b.Sb()),2&e){var n=b.uc(3),i=b.dc().$implicit,a=b.dc(2);b.kc("label",i.name)("kind",a.canEdit(i)?"field":"fieldView")("labelPosition","boolean"===i.type?"sideForced":"auto")("ignoreExtraCell",!a.canManagePrivacy(i))("fieldSize",a.fieldSize(i))("required",i.required),b.zb(1),b.kc("ngIf",a.canEdit(i))("ngIfElse",n)}}function Mo(e,t){if(1&e&&(b.Rb(0,6),b.Fc(1,Lo,5,8,"label-value",45),b.Qb()),2&e){var n=t.$implicit,i=b.dc(2);b.kc("formGroup",i.user.get("customValues")),b.zb(1),b.kc("ngIf",i.canEdit(n)||!i.isEmpty(n))}}function Uo(e,t){if(1&e&&b.Ob(0,"input-field",57),2&e){var n=b.dc(3);b.kc("placeholder",n.data.phoneConfiguration.mobileExample)}}function $o(e,t){if(1&e&&b.Hc(0),2&e){var n=b.dc(3);b.Jc(" ",n.singleMobile.get("number").value," ")}}function Go(e,t){if(1&e&&b.Ob(0,"field-privacy",58),2&e){var n=b.dc(3);b.kc("control",n.singleMobile.get("hidden"))}}function Bo(e,t){if(1&e&&b.Ob(0,"boolean-field",61),2&e){var n=b.dc(4);b.kc("label",n.i18n.phone.verified)("formControl",n.singleMobile.get("verified"))}}function Jo(e,t){if(1&e&&(b.Tb(0,"label-value",37),b.Hc(1),b.Sb()),2&e){var n=b.dc(4);b.kc("label",n.i18n.phone.verified),b.zb(1),b.Jc(" ",n.format.formatBoolean(n.singleMobile.get("verified").value)," ")}}function Vo(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Bo,1,2,"boolean-field",59),b.Fc(2,Jo,2,2,"ng-template",null,60,b.Gc),b.Qb()),2&e){var n=b.uc(3),i=b.dc(3);b.zb(1),b.kc("ngIf",i.canEdit("phone"))("ngIfElse",n)}}function qo(e,t){if(1&e){var n=b.Ub();b.Tb(0,"boolean-field",64),b.bc("click",(function(e){return b.wc(n),b.dc(4).maybeVerify(e)})),b.Sb()}if(2&e){var i=b.dc(4);b.kc("label",i.i18n.phone.enabledSms)("formControl",i.singleMobile.get("enabledForSms"))}}function jo(e,t){if(1&e&&(b.Tb(0,"label-value",37),b.Hc(1),b.Sb()),2&e){var n=b.dc(4);b.kc("label",n.i18n.phone.enabledSms),b.zb(1),b.Jc(" ",n.format.formatBoolean(n.singleMobile.get("enabledForSms").value)," ")}}function Qo(e,t){if(1&e&&(b.Rb(0),b.Fc(1,qo,1,2,"boolean-field",62),b.Fc(2,jo,2,2,"ng-template",null,63,b.Gc),b.Qb()),2&e){var n=b.uc(3),i=b.dc(3);b.zb(1),b.kc("ngIf",i.canEdit("phone"))("ngIfElse",n)}}function Yo(e,t){if(1&e&&(b.Rb(0,6),b.Tb(1,"label-value",53),b.Fc(2,Uo,1,1,"input-field",54),b.Fc(3,$o,1,1,"ng-template",null,55,b.Gc),b.Fc(5,Go,1,1,"field-privacy",56),b.Sb(),b.Fc(6,Vo,4,2,"ng-container",4),b.Fc(7,Qo,4,2,"ng-container",4),b.Qb()),2&e){var n=b.uc(4),i=b.dc(2);b.kc("formGroup",i.singleMobile),b.zb(1),b.kc("label",i.i18n.phone.mobile)("required","required"===i.data.phoneConfiguration.mobileAvailability)("ignoreExtraCell",!i.canManagePrivacy("phone")),b.zb(1),b.kc("ngIf",i.canEdit("phone"))("ngIfElse",n),b.zb(4),b.kc("ngIf",i.phoneHasSms(i.singleMobileManage)),b.zb(1),b.kc("ngIf",i.showEnableForSms(i.singleMobile))}}function Ko(e,t){if(1&e&&b.Ob(0,"input-field",57),2&e){var n=b.dc(3);b.kc("placeholder",n.data.phoneConfiguration.landLineExample)}}function Xo(e,t){if(1&e&&b.Hc(0),2&e){var n=b.dc(3);b.Jc(" ",n.singleLandLine.get("number").value," ")}}function Wo(e,t){if(1&e&&b.Ob(0,"field-privacy",58),2&e){var n=b.dc(3);b.kc("control",n.singleLandLine.get("hidden"))}}function Zo(e,t){if(1&e&&b.Ob(0,"input-field",66),2&e){var n=b.dc(4);b.kc("label",n.i18n.phone.extension)}}function ec(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Zo,1,1,"input-field",65),b.Qb()),2&e){var n=t.ngIf;b.zb(1),b.kc("ngIf",!n.disabled||n.value)}}function tc(e,t){if(1&e&&(b.Rb(0,6),b.Tb(1,"label-value",53),b.Fc(2,Ko,1,1,"input-field",54),b.Fc(3,Xo,1,1,"ng-template",null,55,b.Gc),b.Fc(5,Wo,1,1,"field-privacy",56),b.Sb(),b.Fc(6,ec,2,1,"ng-container",4),b.Qb()),2&e){var n=b.uc(4),i=b.dc(2);b.kc("formGroup",i.singleLandLine),b.zb(1),b.kc("label",i.i18n.phone.landLine)("required","required"===i.data.phoneConfiguration.landLineAvailability)("ignoreExtraCell",!i.canManagePrivacy("address")),b.zb(1),b.kc("ngIf",i.canEdit("phone"))("ngIfElse",n),b.zb(4),b.kc("ngIf",i.data.phoneConfiguration.extensionEnabled&&i.singleLandLine.get("extension"))}}function nc(e,t){if(1&e&&b.Ob(0,"boolean-field",69),2&e){var n=b.dc(3);b.kc("formControl",n.defineSingleAddress)("label",n.i18n.user.addressDefine)}}function ic(e,t){if(1&e){var n=b.Ub();b.Tb(0,"static-map",75),b.bc("imageLoaded",(function(){b.wc(n);var e=b.dc(5);return e.mapShown(e.singleAddress)})),b.Sb()}if(2&e){var i=b.dc(5);b.kc("address",i.singleAddress.value)}}function ac(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(6);return e.locateAddress(e.singleAddress)})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(6);b.zb(1),b.Jc(" ",i.i18n.general.mapView," ")}}function rc(e,t){if(1&e&&(b.Fc(0,ac,2,1,"button",76),b.ec(1,"async")),2&e){var n=b.dc(5),i=b.uc(4);b.kc("ngIf",!1===b.fc(1,2,n.singleAddress.locating$))("ngIfElse",i)}}function oc(e,t){if(1&e&&(b.Tb(0,"label-value",72),b.Fc(1,ic,1,1,"static-map",73),b.Fc(2,rc,2,4,"ng-template",null,74,b.Gc),b.Sb()),2&e){var n=b.uc(3),i=b.dc(4);b.kc("label",i.i18n.general.map),b.zb(1),b.kc("ngIf",null!=i.singleAddress.get("location").value.latitude)("ngIfElse",n)}}function cc(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"address-form",70),b.Fc(2,oc,4,3,"label-value",71),b.Qb()),2&e){var n=b.dc(3);b.zb(1),b.kc("addressForm",n.singleAddress)("configuration",n.data.addressConfiguration)("managePrivacy",n.data.addressConfiguration.managePrivacy)("binaryValues",n.data.addressBinaryValues[null==n.data.addresses[0]?null:n.data.addresses[0].id]),b.zb(1),b.kc("ngIf",n.maps.enabled)}}function sc(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",67),b.Hc(2),b.Sb(),b.Fc(3,nc,1,2,"boolean-field",68),b.Fc(4,cc,3,5,"ng-container",4),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.Ic(n.i18n.address.address),b.zb(1),b.kc("ngIf",n.canEdit("address")&&"required"!==n.data.addressConfiguration.availability),b.zb(1),b.kc("ngIf",n.defineSingleAddress.value)}}function lc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",84,85),b.Tb(2,"button",86),b.bc("click",(function(){return b.wc(n),b.dc(4).addLandLine()})),b.Hc(3),b.Sb(),b.Tb(4,"button",86),b.bc("click",(function(){return b.wc(n),b.dc(4).addMobile()})),b.Hc(5),b.Sb(),b.Sb()}if(2&e){var i=b.dc(4);b.zb(3),b.Jc(" ",i.i18n.user.phoneAddLandLine," "),b.zb(2),b.Jc(" ",i.i18n.user.phoneAddMobile," ")}}function uc(e,t){if(1&e&&(b.Tb(0,"div",81),b.Tb(1,"button",82),b.Hc(2),b.Sb(),b.Fc(3,lc,6,2,"div",83),b.Sb()),2&e){var n=b.dc(3);b.zb(2),b.Jc(" ",n.i18n.user.phoneAdd," ")}}function dc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",87),b.Tb(1,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(3).addLandLine()})),b.Hc(2),b.Sb(),b.Sb()}if(2&e){var i=b.dc(3);b.zb(2),b.Jc(" ",i.i18n.user.phoneAddLandLine," ")}}function bc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",87),b.Tb(1,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(3).addMobile()})),b.Hc(2),b.Sb(),b.Sb()}if(2&e){var i=b.dc(3);b.zb(2),b.Jc(" ",i.i18n.user.phoneAddMobile," ")}}function fc(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.Jc(" ",n.i18n.user.phoneNone," ")}}function mc(e,t){if(1&e&&b.Ob(0,"input-field",66),2&e){var n=b.dc(5);b.kc("label",n.i18n.phone.extension)}}function pc(e,t){if(1&e&&(b.Rb(0),b.Fc(1,mc,1,1,"input-field",65),b.Qb()),2&e){var n=t.ngIf;b.zb(1),b.kc("ngIf",!n.disabled||n.value)}}function gc(e,t){if(1&e&&b.Ob(0,"boolean-field",92),2&e){var n=b.dc(5);b.kc("label",n.i18n.phone.verified)}}function hc(e,t){if(1&e&&(b.Tb(0,"label-value",37),b.Hc(1),b.Sb()),2&e){var n=b.dc(2).$implicit,i=b.dc(3);b.kc("label",i.i18n.phone.verified),b.zb(1),b.Jc(" ",i.format.formatBoolean(n.verified)," ")}}function vc(e,t){if(1&e&&(b.Rb(0),b.Fc(1,gc,1,1,"boolean-field",91),b.Fc(2,hc,2,2,"ng-template",null,60,b.Gc),b.Qb()),2&e){var n=b.uc(3),i=b.dc(4);b.zb(1),b.kc("ngIf",i.canEdit("phone"))("ngIfElse",n)}}function yc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"boolean-field",94),b.bc("click",(function(e){b.wc(n);var t=b.dc(2).$implicit;return b.dc(3).maybeVerify(e,t.id)})),b.Sb()}if(2&e){var i=b.dc(5);b.kc("label",i.i18n.phone.enabledSms)}}function kc(e,t){if(1&e&&(b.Tb(0,"label-value",37),b.Hc(1),b.Sb()),2&e){var n=b.dc(2).$implicit,i=b.dc(3);b.kc("label",i.i18n.phone.enabledSms),b.zb(1),b.Jc(" ",i.format.formatBoolean(n.enabledForSms)," ")}}function Sc(e,t){if(1&e&&(b.Rb(0),b.Fc(1,yc,1,1,"boolean-field",93),b.Fc(2,kc,2,2,"ng-template",null,63,b.Gc),b.Qb()),2&e){var n=b.uc(3),i=b.dc(4);b.zb(1),b.kc("ngIf",i.canEdit("phone"))("ngIfElse",n)}}function Tc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(3).removePhone(e)})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(5);b.zb(1),b.Jc(" ",i.i18n.user.phoneRemove," ")}}function Ic(e,t){if(1&e&&(b.Tb(0,"label-value",72),b.Tb(1,"div",95),b.Ob(2,"field-privacy",96),b.Fc(3,Tc,2,1,"button",97),b.ec(4,"async"),b.Sb(),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("label",i.i18n.field.privacy.name),b.zb(2),b.kc("control",n.form.get("hidden")),b.zb(1),b.kc("ngIf",i.editableFields.has("phone")&&b.fc(4,3,i.layout.gtxxs$))}}function Cc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(3).removePhone(e)})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(5);b.zb(1),b.Jc(" ",i.i18n.user.phoneRemove," ")}}var Oc=function(e){return{"mt-3":e}};function Fc(e,t){if(1&e&&(b.Tb(0,"div",98),b.Fc(1,Cc,2,1,"button",97),b.Sb()),2&e){var n=b.dc(4);b.kc("ngClass",b.nc(2,Oc,!n.data.phoneConfiguration.managePrivacy)),b.zb(1),b.kc("ngIf",n.editableFields.has("phone"))}}function zc(e,t){1&e&&b.Ob(0,"hr")}function Ac(e,t){if(1&e&&(b.Rb(0,6),b.Ob(1,"input-field",88),b.Ob(2,"input-field",89),b.Fc(3,pc,2,1,"ng-container",4),b.Fc(4,vc,4,2,"ng-container",4),b.Fc(5,Sc,4,2,"ng-container",4),b.Fc(6,Ic,5,5,"label-value",71),b.Fc(7,Fc,2,4,"div",90),b.ec(8,"async"),b.Fc(9,zc,1,0,"hr",4),b.Qb()),2&e){var n=t.$implicit,i=t.last,a=b.dc(3);b.kc("formGroup",n.form),b.zb(1),b.kc("id","phone_name"+n.idSuffix)("label",a.phoneNameLabel(n)),b.zb(1),b.kc("id","phone_number"+n.idSuffix)("label",a.phoneNumberLabel(n))("placeholder",a.phoneExample(n)),b.zb(1),b.kc("ngIf",a.hasExtension(n)&&n.form.get("extension")),b.zb(1),b.kc("ngIf","mobile"===n.kind&&a.phoneHasSms(n.form)),b.zb(1),b.kc("ngIf","mobile"===n.kind&&a.showEnableForSms(n.form)),b.zb(1),b.kc("ngIf",a.canManagePrivacy("phone")),b.zb(1),b.kc("ngIf",b.fc(8,12,a.layout.xxs$)||!a.data.phoneConfiguration.managePrivacy),b.zb(2),b.kc("ngIf",!i)}}function wc(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",78),b.Tb(2,"div",27),b.Hc(3),b.Sb(),b.Fc(4,uc,4,1,"div",79),b.Fc(5,dc,3,1,"div",80),b.Fc(6,bc,3,1,"div",80),b.Sb(),b.Fc(7,fc,2,1,"div",4),b.Fc(8,Ac,10,14,"ng-container",11),b.Qb()),2&e){var n=b.dc(2);b.zb(3),b.Jc(" ",n.i18n.user.title.phones," "),b.zb(1),b.kc("ngIf",n.canCreateLandLine&&n.canCreateMobile),b.zb(1),b.kc("ngIf",n.canCreateLandLine&&!n.canCreateMobile),b.zb(1),b.kc("ngIf",!n.canCreateLandLine&&n.canCreateMobile),b.zb(1),b.kc("ngIf",0==n.phones.length),b.zb(1),b.kc("ngForOf",n.phones)}}function Ec(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(3).addAddress()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(3);b.zb(1),b.Jc(" ",i.i18n.user.addressAdd," ")}}function _c(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.Jc(" ",n.i18n.user.addressNone," ")}}function Nc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(3).removeAddress(e)})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(5);b.zb(1),b.Jc(" ",i.i18n.user.addressRemove," ")}}function Rc(e,t){if(1&e&&(b.Tb(0,"label-value",72),b.Tb(1,"div",95),b.Ob(2,"field-privacy",96),b.Fc(3,Nc,2,1,"button",97),b.ec(4,"async"),b.Sb(),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("label",i.i18n.field.privacy.name),b.zb(2),b.kc("control",n.form.get("hidden")),b.zb(1),b.kc("ngIf",i.editableFields.has("address")&&!i.maps.enabled&&b.fc(4,3,i.layout.gtxxs$))}}function Pc(e,t){1&e&&b.Pb(0)}function Dc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"label-value",102),b.Tb(1,"static-map",75),b.bc("imageLoaded",(function(){b.wc(n);var e=b.dc().$implicit;return b.dc(3).mapShown(e.form)})),b.Sb(),b.Fc(2,Pc,1,0,"ng-container",103),b.ec(3,"async"),b.Sb()}if(2&e){var i=b.dc().$implicit,a=b.dc(3),r=b.uc(4);b.kc("label",a.i18n.general.map),b.zb(1),b.kc("address",i.form.value),b.zb(1),b.kc("ngIf",b.fc(3,4,i.form.locating$))("ngIfThen",r)}}function Hc(e,t){1&e&&b.Ob(0,"div",108)}function xc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(3).removeAddress(e)})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(5);b.zb(1),b.Jc(" ",i.i18n.user.addressRemove," ")}}function Lc(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Ob(1,"div",109),b.Tb(2,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(3).locateAddress(e.form)})),b.Hc(3),b.Sb(),b.Qb()}if(2&e){var i=b.dc(5);b.zb(3),b.Jc(" ",i.i18n.general.mapView," ")}}function Mc(e,t){if(1&e&&(b.Tb(0,"div",104),b.Fc(1,Hc,1,0,"div",105),b.ec(2,"async"),b.Tb(3,"div",106),b.Tb(4,"actions",107),b.Fc(5,xc,2,1,"button",97),b.Fc(6,Lc,4,1,"ng-container",4),b.ec(7,"async"),b.Sb(),b.Sb(),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.zb(1),b.kc("ngIf",b.fc(2,3,i.layout.gtxs$)),b.zb(4),b.kc("ngIf",i.editableFields.has("address")),b.zb(1),b.kc("ngIf",null==n.form.get("location").value.latitude&&!1===b.fc(7,5,n.form.locating$))}}function Uc(e,t){1&e&&b.Ob(0,"hr")}function $c(e,t){if(1&e&&(b.Rb(0,6),b.Ob(1,"input-field",88),b.Ob(2,"address-form",99),b.Fc(3,Rc,5,5,"label-value",71),b.Fc(4,Dc,4,6,"label-value",100),b.ec(5,"async"),b.Fc(6,Mc,8,7,"div",101),b.ec(7,"async"),b.Fc(8,Uc,1,0,"hr",4),b.Qb()),2&e){var n=t.$implicit,i=t.last,a=b.dc(3);b.kc("formGroup",n.form),b.zb(1),b.kc("id","address_name"+n.idSuffix)("label",a.i18n.general.name),b.zb(1),b.kc("addressForm",n.form)("ignoreContactFields",1===a.addresses.length)("configuration",a.data.addressConfiguration)("idSuffix",n.idSuffix)("managePrivacy",!1)("binaryValues",a.data.addressBinaryValues[n.id]),b.zb(1),b.kc("ngIf",a.canManagePrivacy("address")),b.zb(1),b.kc("ngIf",a.maps.enabled&&(null!=n.form.get("location").value.latitude||b.fc(5,13,n.form.locating$))),b.zb(2),b.kc("ngIf",a.maps.enabled||b.fc(7,15,a.layout.xxs$)||!a.data.addressConfiguration.managePrivacy),b.zb(2),b.kc("ngIf",!i)}}function Gc(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",78),b.Tb(2,"div",27),b.Hc(3),b.Sb(),b.Tb(4,"div",87),b.Fc(5,Ec,2,1,"button",25),b.Sb(),b.Sb(),b.Fc(6,_c,2,1,"div",4),b.Fc(7,$c,9,17,"ng-container",11),b.Qb()),2&e){var n=b.dc(2);b.zb(3),b.Jc(" ",n.i18n.user.title.addresses," "),b.zb(2),b.kc("ngIf",n.canCreateAddress),b.zb(1),b.kc("ngIf",0==n.data.addresses.length),b.zb(1),b.kc("ngForOf",n.addresses)}}function Bc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",24),b.bc("click",(function(){return b.wc(n),b.dc(3).addContactInfo()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(3);b.zb(1),b.Jc(" ",i.i18n.user.contactInfoAdd," ")}}function Jc(e,t){if(1&e&&(b.Tb(0,"div"),b.Hc(1),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.Jc(" ",n.i18n.user.contactInfoNone," ")}}function Vc(e,t){if(1&e&&b.Ob(0,"input-field",118),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("id","contact-info_landLineExtension"+n.idSuffix)("label",i.i18n.phone.extension)}}function qc(e,t){if(1&e&&b.Ob(0,"field-option",120),2&e){var n=b.dc().$implicit;b.kc("value",n.id)("text",n.name)}}function jc(e,t){if(1&e&&(b.Rb(0),b.Fc(1,qc,1,2,"field-option",119),b.Qb()),2&e){var n=t.$implicit;b.zb(1),b.kc("ngIf",n.id)}}function Qc(e,t){if(1&e&&(b.Rb(0,6),b.Ob(1,"custom-field-input",121),b.Qb()),2&e){var n=t.$implicit,i=b.dc().$implicit,a=b.dc(3);b.kc("formGroup",i.form.get("customValues")),b.zb(1),b.kc("field",n)("formControlName",n.internalName)("binaryValues",a.data.contactInfoBinaryValues[i.id])}}function Yc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc(2).$implicit;return b.dc(3).removeContactInfo(e)})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(5);b.zb(1),b.Jc(" ",i.i18n.user.contactInfoRemove," ")}}function Kc(e,t){if(1&e&&(b.Tb(0,"label-value",72),b.Tb(1,"div",95),b.Ob(2,"field-privacy",96),b.Fc(3,Yc,2,1,"button",97),b.ec(4,"async"),b.Sb(),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(3);b.kc("label",i.i18n.field.privacy.name),b.zb(2),b.kc("control",n.form.get("hidden")),b.zb(1),b.kc("ngIf",b.fc(4,3,i.layout.gtxxs$))}}function Xc(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",36),b.Tb(1,"button",77),b.bc("click",(function(){b.wc(n);var e=b.dc().$implicit;return b.dc(3).removeContactInfo(e)})),b.Hc(2),b.Sb(),b.Sb()}if(2&e){var i=b.dc(4);b.zb(2),b.Jc(" ",i.i18n.user.contactInfoRemove," ")}}function Wc(e,t){1&e&&b.Ob(0,"hr")}function Zc(e,t){if(1&e&&(b.Rb(0,6),b.Ob(1,"images-field",110),b.Ob(2,"input-field",111),b.Ob(3,"input-field",112),b.Ob(4,"input-field",113),b.Ob(5,"input-field",114),b.Fc(6,Vc,1,2,"input-field",115),b.Tb(7,"single-selection-field",116),b.Fc(8,jc,2,1,"ng-container",117),b.Sb(),b.Fc(9,Qc,2,4,"ng-container",11),b.Fc(10,Kc,5,5,"label-value",71),b.Fc(11,Xc,3,1,"div",30),b.ec(12,"async"),b.Fc(13,Wc,1,0,"hr",4),b.Qb()),2&e){var n=t.$implicit,i=t.last,a=b.dc(3);b.kc("formGroup",n.form),b.zb(1),b.kc("label",a.i18n.general.image)("initialImages",null==a.data.contactInfoBinaryValues[n.id]?null:a.data.contactInfoBinaryValues[n.id].image),b.zb(1),b.kc("id","contact-info_name"+n.idSuffix)("label",a.i18n.general.name),b.zb(1),b.kc("id","contact-info_email"+n.idSuffix)("label",a.i18n.user.email),b.zb(1),b.kc("id","contact-info_mobilePhone"+n.idSuffix)("label",a.i18n.phone.mobile),b.zb(1),b.kc("id","contact-info_landLinePhone"+n.idSuffix)("label",a.i18n.phone.landLine),b.zb(1),b.kc("ngIf",a.data.phoneConfiguration.extensionEnabled),b.zb(1),b.kc("id","contact-info_address"+n.idSuffix)("label",a.i18n.address.address),b.zb(1),b.kc("ngForOf",a.data.addresses),b.zb(1),b.kc("ngForOf",a.data.contactInfoConfiguration.customFields),b.zb(1),b.kc("ngIf",a.canManagePrivacy("contactInfo")),b.zb(1),b.kc("ngIf",b.fc(12,19,a.layout.xxs$)||!a.data.contactInfoConfiguration.managePrivacy),b.zb(2),b.kc("ngIf",!i)}}function es(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",78),b.Tb(2,"div",27),b.Hc(3),b.Sb(),b.Tb(4,"div",87),b.Fc(5,Bc,2,1,"button",25),b.Sb(),b.Sb(),b.Fc(6,Jc,2,1,"div",4),b.Fc(7,Zc,14,21,"ng-container",11),b.Qb()),2&e){var n=b.dc(2);b.zb(3),b.Jc(" ",n.i18n.user.title.contactInfos," "),b.zb(2),b.kc("ngIf",n.canCreateContactInfo),b.zb(1),b.kc("ngIf",0==n.contactInfos.length),b.zb(1),b.kc("ngForOf",n.contactInfos)}}function ts(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Fc(2,Ao,3,2,"ng-container",4),b.Tb(3,"h2",5),b.Hc(4),b.Sb(),b.Rb(5,6),b.Fc(6,wo,2,2,"label-value",7),b.Fc(7,Eo,1,2,"input-field",8),b.Fc(8,_o,1,2,"input-field",9),b.Fc(9,Ro,3,4,"label-value",10),b.Fc(10,Po,2,2,"label-value",7),b.Qb(),b.Fc(11,Mo,2,2,"ng-container",11),b.Fc(12,Yo,8,8,"ng-container",12),b.Fc(13,tc,7,7,"ng-container",12),b.Fc(14,sc,5,3,"ng-container",4),b.Fc(15,wc,9,6,"ng-container",4),b.Fc(16,Gc,8,4,"ng-container",4),b.Fc(17,es,8,4,"ng-container",4),b.Tb(18,"actions"),b.Tb(19,"button",13),b.bc("click",(function(){return b.wc(n),b.dc().saveOrConfirm()})),b.ec(20,"async"),b.Hc(21),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.i18n.user.title.editProfile)("mobileHeading",i.i18n.user.mobileTitle.editProfile)("headingActions",b.fc(1,21,i.headingActions$)),b.zb(2),b.kc("ngIf","disabled"!==i.imagesAvailability),b.zb(1),b.kc("ngClass","disabled"===i.imagesAvailability?"border-0 mt-2 mt-md-0":null),b.zb(1),b.Jc(" ",i.i18n.user.title.fields," "),b.zb(1),b.kc("formGroup",i.user),b.zb(1),b.kc("ngIf",i.operatorOfManagedUser),b.zb(1),b.kc("ngIf",i.hasField("name")),b.zb(1),b.kc("ngIf",i.hasField("username")),b.zb(1),b.kc("ngIf",i.hasField("email")),b.zb(1),b.kc("ngIf",i.hasField("email")&&i.data.userConfiguration.emailPendingValidation),b.zb(1),b.kc("ngForOf",null==i.data.userConfiguration?null:i.data.userConfiguration.customFields),b.zb(1),b.kc("ngIf",i.singleMobile),b.zb(1),b.kc("ngIf",i.singleLandLine),b.zb(1),b.kc("ngIf",i.singleAddress),b.zb(1),b.kc("ngIf","multiple"===i.landLineAvailability||"multiple"===i.mobileAvailability),b.zb(1),b.kc("ngIf","multiple"===i.addressAvailability),b.zb(1),b.kc("ngIf","disabled"!==i.contactInfoAvailability),b.zb(2),b.kc("disabled",b.fc(20,23,i.requesting$)),b.zb(2),b.Jc(" ",i.i18n.general.save," ")}}function ns(e,t){1&e&&b.Ob(0,"spinner")}var is,as=["name","username","email"],rs=0,os=((is=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r,o,c,s){var l;return _classCallCheck(this,n),(l=t.call(this,e)).usersService=i,l.imagesService=a,l.phonesService=r,l.addressHelper=o,l.modal=c,l.changeDetector=s,l.ConfirmationMode=io.a,l.ready$=new ht.a(!1),l.confirmationMode$=new ht.a(null),l.createLandLinePhones=[],l.modifyLandLinePhones=[],l.createMobilePhones=[],l.modifyMobilePhones=[],l.createAddresses=[],l.modifyAddresses=[],l.createContactInfos=[],l.modifyContactInfos=[],l}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user||me.a.SELF,this.createDeviceConfirmation=function(){return{type:ze.s.EDIT_PROFILE}},this.headingActions=[new B.c("search",this.i18n.general.view,(function(){return e.router.navigate(["users",e.param,"profile"])}),!0)],this.addSub(this.usersService.getDataForEditFullProfile({user:this.param}).subscribe((function(t){e.data=t;var n=t.userConfiguration.role,i=t.userConfiguration.details,a=e.authHelper.isSelf(i);e.byManager=!e.authHelper.isSelfOrOwner(i),e.operatorOfManagedUser="operator"===n&&!e.authHelper.isSelf(i.user),a&&e.login.user$.next({id:e.login.user.id,display:t.userConfiguration.details.display,image:Object(J.h)(t.images)?null:t.images[0]}),e.initialize(t),e.canConfirm=e.authHelper.canConfirm(t.confirmationPasswordInput),e.canConfirm||(e.notification.warning(e.authHelper.getConfirmationMessage(t.confirmationPasswordInput)),e.router.navigate(["users","profile"])),e.ready$.next(!0)})))}},{key:"locateControl",value:function(e){return Object(J.t)(this,e)}},{key:"hasField",value:function(e){return this.enabledFields.has(e)}},{key:"isRequired",value:function(e){if(!this.canEdit(e))return!1;if("name"===e||"username"===e)return!0;if("email"===e)return this.data.userConfiguration.emailRequired;var t=this.userCustomFields.get(e);return t&&t.required}},{key:"fieldName",value:function(e){return"string"==typeof e?e:e.internalName}},{key:"isEmpty",value:function(e){var t=this.fieldName(e);if("string"==typeof e)return Object(J.h)(this.user.get(t).value);var n=this.user.get("customValues");return!n||Object(J.h)(n.get(t).value)}},{key:"canEdit",value:function(e){return this.editableFields.has(this.fieldName(e))}},{key:"canManagePrivacy",value:function(e){if(!this.data.userConfiguration.enablePrivacy)return!1;switch(e){case"phone":return this.data.phoneConfiguration.managePrivacy;case"address":return this.data.addressConfiguration.managePrivacy;case"contactInfo":return this.data.contactInfoConfiguration.managePrivacy;default:return this.managePrivacyFields.has(this.fieldName(e))}}},{key:"getAvailability",value:function(e){return null==e||e<=0?"disabled":1===e?"single":"multiple"}},{key:"saveOrConfirm",value:function(){var e=this;this.data.confirmationPasswordInput?this.notification.confirm({title:this.i18n.user.title.confirmation,passwordInput:this.data.confirmationPasswordInput,createDeviceConfirmation:this.createDeviceConfirmation,callback:function(t){e.save(t.confirmationPassword)}}):this.save()}},{key:"save",value:function(e){var t=this,n=new q.m({user:this.user,createLandLinePhones:new q.g(this.createLandLinePhones),modifyLandLinePhones:new q.g(this.modifyLandLinePhones),createMobilePhones:new q.g(this.createMobilePhones),modifyMobilePhones:new q.g(this.modifyMobilePhones),createAddresses:new q.g(this.createAddresses),modifyAddresses:new q.g(this.modifyAddresses),createContactInfos:new q.g(this.createContactInfos),modifyContactInfos:new q.g(this.modifyContactInfos)});!e&&this.confirmationPassword&&(n.setControl("confirmationPassword",this.confirmationPassword),e=this.confirmationPassword.value),Object(J.F)(n)&&this.addSub(this.usersService.saveUserFullProfile({user:this.param,confirmationPassword:e,body:this.editForSubmit()}).subscribe((function(){t.notification.snackBar(t.i18n.user.profileSaved),t.reload(),Object(J.y)()})))}},{key:"editForSubmit",value:function(){var e={user:Object(J.s)(this.user)?this.user.value:null,createLandLinePhones:this.createLandLinePhones.map((function(e){return e.value})),modifyLandLinePhones:this.modifyLandLinePhones.map((function(e){return e.value})),createMobilePhones:this.createMobilePhones.map((function(e){return e.value})),modifyMobilePhones:this.modifyMobilePhones.map((function(e){return e.value})),removePhones:this.removedPhones,createAddresses:this.createAddresses.map((function(e){return e.value})),modifyAddresses:this.modifyAddresses.map((function(e){return e.value})),removeAddresses:this.removedAddresses,createContactInfos:this.createContactInfos.map((function(e){return e.value})),modifyContactInfos:this.modifyContactInfos.map((function(e){return e.value})),removeContactInfos:this.removedContactInfos};if("single"===this.mobileAvailability){var t=this.singleMobile.value,n=t.id;n?Object(J.h)(t.number)?e.removePhones.push(n):Object(J.s)(this.singleMobile)&&(e.modifyMobilePhones=[t]):Object(J.h)(t.number)||(e.createMobilePhones=[t])}if("single"===this.landLineAvailability){var i=this.singleLandLine.value,a=i.id;a?Object(J.h)(i.number)?e.removePhones.push(a):Object(J.s)(this.singleLandLine)&&(e.modifyLandLinePhones=[i]):Object(J.h)(i.number)||(e.createLandLinePhones=[i])}if("single"===this.addressAvailability){var r=this.singleAddress.value,o=r.id,c=this.defineSingleAddress.value;o?c?Object(J.s)(this.singleAddress)&&(e.modifyAddresses=[r]):e.removeAddresses.push(o):c&&(e.createAddresses=[r])}return e}},{key:"initialize",value:function(e){var t=this;this.userCustomFields=new Map,this.enabledFields=new Set,this.editableFields=new Set,this.managePrivacyFields=new Set,this.removedPhones=[],this.removedAddresses=[],this.removedContactInfos=[],e.contactInfoConfiguration&&e.contactInfoConfiguration.availability!==ze.i.DISABLED&&(e.addressConfiguration.contactInfoEnabled=!0,e.addressConfiguration.contactInfoFields=e.contactInfoConfiguration.customFields);var n=e.userConfiguration.profileFieldActions,i=function(e){if(!n.hasOwnProperty(e))return"continue";t.enabledFields.add(e);var i=n[e];i.edit&&t.editableFields.add(e),i.managePrivacy&&t.managePrivacyFields.add(e);var a=t.data.userConfiguration.customFields.find((function(t){return t.internalName===e}));a&&t.userCustomFields.set(e,a)};for(var a in n)i(a);this.user=this.buildUserForm(),e.confirmationPasswordInput&&(this.confirmationPassword=this.formBuilder.control("",q.G.required)),this.images=this.data.images.slice(),this.phones=[],"single"===this.mobileAvailability?(this.singleMobileManage=Object(J.h)(e.mobilePhones)?e.phoneConfiguration.mobilePhone:e.mobilePhones[0],this.singleMobile=this.buildMobileForm(this.singleMobileManage)):(e.mobilePhones||[]).forEach((function(e){var n=t.buildMobileForm(e);"multiple"===t.mobileAvailability&&(t.phones.push(e),t.addSub(n.valueChanges.subscribe((function(){t.modifyMobilePhones.includes(n)||t.modifyMobilePhones.push(n)}))))})),"single"===this.landLineAvailability?(this.singleLandLineManage=Object(J.h)(e.landLinePhones)?e.phoneConfiguration.landLinePhone:e.landLinePhones[0],this.singleLandLine=this.buildLandLineForm(this.singleLandLineManage)):(e.landLinePhones||[]).forEach((function(e){var n=t.buildLandLineForm(e);"multiple"===t.landLineAvailability&&(t.phones.push(e),t.addSub(n.valueChanges.subscribe((function(){t.modifyLandLinePhones.includes(n)||t.modifyLandLinePhones.push(n)}))))})),"single"===this.addressAvailability?(this.defineSingleAddress=this.formBuilder.control(!Object(J.h)(e.addresses)||"required"===e.addressConfiguration.availability),this.singleAddressManage=Object(J.h)(e.addresses)?e.addressConfiguration.address:e.addresses[0],this.singleAddress=this.buildAddressForm(this.singleAddressManage)):((e.addresses||[]).forEach((function(e){var n=t.buildAddressForm(e);"multiple"===t.addressAvailability&&t.addSub(n.valueChanges.subscribe((function(){t.modifyAddresses.includes(n)||t.modifyAddresses.push(n)})))})),this.addresses=(e.addresses||[]).slice()),(e.contactInfos||[]).forEach((function(e){var n=t.buildContactInfoForm(e);t.addSub(n.valueChanges.subscribe((function(){t.modifyContactInfos.includes(n)||t.modifyContactInfos.push(n)})))})),this.contactInfos=(e.contactInfos||[]).slice()}},{key:"buildUserForm",value:function(){var e,t=this,n=this.data.userConfiguration,i=this.data.user,a=this.formBuilder.group({version:i.version,hiddenFields:[i.hiddenFields||[]]}),r=_createForOfIteratorHelper(as);try{for(r.s();!(e=r.n()).done;){var o=e.value;this.hasField(o)?a.setControl(o,this.formBuilder.control({value:i[o],disabled:!this.canEdit(o)},this.isRequired(o)?q.G.required:null)):a.removeControl(o)}}catch(c){r.e(c)}finally{r.f()}return a.setControl("customValues",this.fieldHelper.customValuesFormGroup(n.customFields,{currentValues:i.customValues,disabledProvider:function(e){return!t.canEdit(e.internalName)}})),a}},{key:"stampDataAndInitForm",value:function(e,t){e.idSuffix="_".concat(e.id||rs++),e.form=t,t.locating$=new ht.a(!1),t.patchValue(e)}},{key:"buildLandLineForm",value:function(e){e.kind=ze.X.LAND_LINE;var t=this.data.phoneConfiguration,n=this.buildPhoneForm(1===t.maxLandLines,t.landLineAvailability===ze.i.REQUIRED);if(t.extensionEnabled){var i=this.formBuilder.control(null);this.editableFields.has("phone")||i.disable(),n.setControl("extension",i)}return this.stampDataAndInitForm(e,n),n}},{key:"buildMobileForm",value:function(e){e.kind=ze.X.MOBILE;var t=this.data.phoneConfiguration,n=this.buildPhoneForm(1===t.maxMobiles,t.mobileAvailability===ze.i.REQUIRED);return t.smsEnabled&&(n.setControl("verified",this.formBuilder.control(e.verified)),n.setControl("enabledForSms",this.formBuilder.control(e.enabledForSms))),this.stampDataAndInitForm(e,n),n}},{key:"buildPhoneForm",value:function(e,t){var n=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,q.G.required],number:[null,!e||t?q.G.required:null]});return this.editableFields.has("phone")||n.disable(),n}},{key:"buildAddressForm",value:function(e){var t=this,n=this.data.addressConfiguration,i=this.addressHelper.addressFormGroup(n);this.stampDataAndInitForm(e,i);var a,r=_createForOfIteratorHelper(n.enabledFields);try{var o=function(){var n=a.value,r=e[n]||null;t.addSub(i.get(n).valueChanges.subscribe((function(e){r!==e&&i.get("location").patchValue({latitude:null,longitude:null}),r=e})))};for(r.s();!(a=r.n()).done;)o()}catch(c){r.e(c)}finally{r.f()}return this.editableFields.has("address")||i.disable(),i}},{key:"buildContactInfoForm",value:function(e){var t=this.data.contactInfoConfiguration,n=this.formBuilder.group({id:null,version:null,hidden:null,name:[null,q.G.required],image:null,email:null,mobilePhone:null,landLinePhone:null,landLineExtension:null,address:null});return n.setControl("customValues",this.fieldHelper.customValuesFormGroup(t.customFields)),this.stampDataAndInitForm(e,n),n}},{key:"phoneNameLabel",value:function(e){return e.kind===ze.X.LAND_LINE?this.i18n.phone.nameLandLine:this.i18n.phone.nameMobile}},{key:"phoneExample",value:function(e){return e.kind===ze.X.LAND_LINE?this.data.phoneConfiguration.landLineExample:this.data.phoneConfiguration.mobileExample}},{key:"phoneNumberLabel",value:function(e){return e.kind===ze.X.LAND_LINE?this.i18n.phone.numberLandLine:this.i18n.phone.numberMobile}},{key:"phoneHasSms",value:function(e){return!!this.data.phoneConfiguration.smsEnabled&&e.id&&e.kind===ze.X.MOBILE&&e.number===e.form.value.number}},{key:"hasExtension",value:function(e){return this.data.phoneConfiguration.extensionEnabled&&e.kind===ze.X.LAND_LINE}},{key:"addMobile",value:function(){var e=Object(gt.cloneDeep)(this.data.phoneConfiguration.mobilePhone);e.name="",this.createMobilePhones.push(this.buildMobileForm(e)),this.phones=[e].concat(_toConsumableArray(this.phones)),this.setFocus("phone_name",e)}},{key:"addLandLine",value:function(){var e=Object(gt.cloneDeep)(this.data.phoneConfiguration.landLinePhone);e.name="",this.createLandLinePhones.push(this.buildLandLineForm(e)),this.phones=[e].concat(_toConsumableArray(this.phones)),this.setFocus("phone_name",e)}},{key:"addAddress",value:function(){var e=Object(gt.cloneDeep)(this.data.addressConfiguration.address);e.name="",this.createAddresses.push(this.buildAddressForm(e)),this.addresses=[e].concat(_toConsumableArray(this.addresses)),this.setFocus("address_name",e)}},{key:"addContactInfo",value:function(){var e=Object(gt.cloneDeep)(this.data.contactInfoConfiguration.contactInfo);this.createContactInfos.push(this.buildContactInfoForm(e)),this.contactInfos=[e].concat(_toConsumableArray(this.contactInfos)),this.setFocus("contact-info_name",e)}},{key:"removePhone",value:function(e){this.phones=this.phones.filter((function(t){return t!==e}));var t=e.id;if(t)this.removedPhones.push(t);else{var n=e.form;this.createMobilePhones=this.createMobilePhones.filter((function(e){return e!==n})),this.createLandLinePhones=this.createLandLinePhones.filter((function(e){return e!==n}))}}},{key:"removeAddress",value:function(e){this.addresses=this.addresses.filter((function(t){return t!==e}));var t=e.id;if(t)this.removedAddresses.push(t);else{var n=e.form;this.createAddresses=this.createAddresses.filter((function(e){return e!==n}))}}},{key:"removeContactInfo",value:function(e){this.contactInfos=this.contactInfos.filter((function(t){return t!==e}));var t=e.id;if(t)this.removedContactInfos.push(t);else{var n=e.form;this.createContactInfos=this.createContactInfos.filter((function(e){return e!==n}))}}},{key:"setFocus",value:function(e,t){var n=e+t.idSuffix;setTimeout((function(){return document.getElementById(n).focus()}),10)}},{key:"showEnableForSms",value:function(e){return!!this.data.phoneConfiguration.smsEnabled&&(!this.byManager||e.value.verified)}},{key:"maybeVerify",value:function(e,t){if(!this.byManager){var n;if(null==(n=this.singleMobile?this.singleMobileManage:this.phones.find((function(e){return e.id===t}))))throw new Error("Mobile phone not found: ".concat(t));n.verified||(this.verify(n),e.preventDefault(),e.stopPropagation())}}},{key:"verify",value:function(e){var t=this,n=this.modal.show(oo,{class:"modal-form",initialState:{phone:e}});this.addSub(n.content.verified.pipe(Object(co.a)(1)).subscribe((function(i){i&&t.phonesService.getPhoneDataForEdit({id:e.id,fields:["phone"]}).subscribe((function(i){var a=i.phone;a.id=e.id,a.enabledForSms=!0;var r=t.buildMobileForm(a);r.markAsTouched();var o=(t.phones||[]).findIndex((function(t){return t.id===e.id}));if(o>=0){var c=t.phones.slice();c[o]=a,t.phones=c;var s=t.modifyMobilePhones.findIndex((function(t){return t.value.id===e.id})),l=t.modifyMobilePhones.slice();s>=0?l[s]=r:l.push(r),t.modifyMobilePhones=l}t.singleMobile&&(t.singleMobile=r),n.hide(),t.changeDetector.detectChanges()}))})))}},{key:"onUploadDone",value:function(e){this.images=[].concat(_toConsumableArray(this.images),_toConsumableArray(e)),this.changeDetector.detectChanges()}},{key:"manageImages",value:function(){var e=this,t=this.modal.show(ao.a,{class:"modal-form",initialState:{images:this.images}});t.content.result.pipe(Object(so.a)()).subscribe((function(n){if(!Object(J.h)(n.removedImages)){var i,a=_createForOfIteratorHelper(n.removedImages);try{for(a.s();!(i=a.n()).done;){var r=i.value;e.addSub(e.imagesService.deleteImage({idOrKey:r}).subscribe())}}catch(o){a.e(o)}finally{a.f()}e.images=e.images.filter((function(e){return!n.removedImages.includes(e.id)}))}!Object(J.h)(n.order)&&(e.images=n.order.map((function(t){return e.images.find((function(e){return e.id===t}))})),e.addSub(e.imagesService.reorderProfileImages({ids:n.order,user:e.param}).subscribe())),t.hide()}))}},{key:"removeAllImages",value:function(){var e,t=_createForOfIteratorHelper(this.images||[]);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.addSub(this.imagesService.deleteImage({idOrKey:n.id}).subscribe())}}catch(i){t.e(i)}finally{t.f()}this.images=[],this.changeDetector.detectChanges()}},{key:"fieldSize",value:function(e){return this.fieldHelper.fieldSize(e)}},{key:"locateAddress",value:function(e){var t=this,n=e.value;e.locating$.next(!0),this.addSub(this.maps.geocode(n).subscribe((function(n){e.patchValue({location:n}),t.changeDetector.detectChanges()}),(function(){return t.mapShown(e)})))}},{key:"mapShown",value:function(e){e.locating$.next(!1),this.changeDetector.detectChanges()}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.userConfiguration.details,d.b.EDIT_MY_PROFILE)}},{key:"fieldValue",value:function(e){var t=this.user.get("customValues").get(e.internalName).value;return this.fieldHelper.asFieldValue(e,t,this.data.userConfiguration.binaryValues)}},{key:"landLineAvailability",get:function(){return this.getAvailability((this.data.phoneConfiguration||{}).maxLandLines)}},{key:"mobileAvailability",get:function(){return this.getAvailability((this.data.phoneConfiguration||{}).maxMobiles)}},{key:"addressAvailability",get:function(){return this.getAvailability((this.data.addressConfiguration||{}).maxAddresses)}},{key:"contactInfoAvailability",get:function(){return this.getAvailability((this.data.contactInfoConfiguration||{}).maxContactInfos)}},{key:"imagesAvailability",get:function(){return this.getAvailability((this.data.imageConfiguration||{}).maxImages)}},{key:"canCreateLandLine",get:function(){if("multiple"!==this.landLineAvailability||!this.editableFields.has("phone"))return!1;var e=this.data.phoneConfiguration.maxLandLines;return this.phones.filter((function(e){return e.kind===ze.X.LAND_LINE})).length<e}},{key:"canCreateMobile",get:function(){if("multiple"!==this.mobileAvailability||!this.editableFields.has("phone"))return!1;var e=this.data.phoneConfiguration.maxMobiles;return this.phones.filter((function(e){return e.kind===ze.X.MOBILE})).length<e}},{key:"canCreateAddress",get:function(){return!("multiple"!==this.addressAvailability||!this.editableFields.has("address"))&&this.addresses.length<this.data.addressConfiguration.maxAddresses}},{key:"canCreateContactInfo",get:function(){return"multiple"===this.contactInfoAvailability&&this.contactInfos.length<this.data.contactInfoConfiguration.maxContactInfos}},{key:"canUploadImages",get:function(){return this.images.length<this.data.imageConfiguration.maxImages}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||is)(b.Nb(b.r),b.Nb(c.K),b.Nb(c.p),b.Nb(c.A),b.Nb(no.a),b.Nb(f.b),b.Nb(b.h))},is.\u0275cmp=b.Hb({type:is,selectors:[["edit-profile"]],features:[b.wb],decls:5,vars:4,consts:[[3,"ready"],["last","",3,"heading","mobileHeading","headingActions",4,"ngIf"],["locatingSpinner",""],["last","",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"mt-4","mb-2",3,"ngClass"],[3,"formGroup"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","name",3,"label","required",4,"ngIf"],["formControlName","username",3,"label","required",4,"ngIf"],[3,"label","kind","ignoreExtraCell",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],[3,"formGroup",4,"ngIf"],[1,"btn","btn-primary","btn-main",3,"disabled","click"],[1,"mb-3","border-0","mt-2","mt-md-0"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge","useLightbox","",3,"image","roundBorders",4,"ngIf"],["class","my-3",4,"ngIf"],["containerClass","mt-3","target","profile",3,"owner","uploadDone"],["singleUpload",""],["class","mt-3","forceRow","",4,"ngIf"],["size","huge","useLightbox","",3,"image","roundBorders"],[1,"my-3"],["forceRow","",1,"mt-3"],[1,"btn","btn-outline-primary",3,"click"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"border-0","d-flex","mb-3","flex-column","flex-xs-row","justify-content-between","mt-2","mt-md-0"],[1,"mb-2","mb-xs-0"],[1,"row","no-gutters"],["class","col-12 col-xs-6 col-sm-4 col-md-3 d-flex justify-content-center justify-content-center",4,"ngFor","ngForOf"],["class","d-flex justify-content-end",4,"ngIf"],["target","profile",3,"owner","max","uploadDone"],["multiUpload",""],[1,"col-12","col-xs-6","col-sm-4","col-md-3","d-flex","justify-content-center","justify-content-center"],["size","huge","useLightbox","",1,"mb-1","mb-xs-3",3,"image","roundBorders","additionalImages"],[1,"col-12"],[1,"d-flex","justify-content-end"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","name",3,"label","required"],["formControlName","username",3,"label","required"],[3,"label","kind","ignoreExtraCell"],["formControlName","email",3,"required"],["field","email",3,"control",4,"extraCell"],["field","email",3,"control"],[3,"label","kind","labelPosition","ignoreExtraCell","fieldSize","required",4,"ngIf"],[3,"label","kind","labelPosition","ignoreExtraCell","fieldSize","required"],["hideLabel","",3,"field","formControlName","binaryValues",4,"ngIf","ngIfElse"],["plainFieldValue",""],[3,"field","control",4,"extraCell"],["hideLabel","",3,"field","formControlName","binaryValues"],[3,"fieldValue"],[3,"field","control"],["kind","field","fieldSize","small",3,"label","required","ignoreExtraCell"],["formControlName","number",3,"placeholder",4,"ngIf","ngIfElse"],["plainPhoneNumber",""],[3,"control",4,"extraCell"],["formControlName","number",3,"placeholder"],[3,"control"],[3,"label","formControl",4,"ngIf","ngIfElse"],["plainVerified",""],[3,"label","formControl"],[3,"label","formControl","click",4,"ngIf","ngIfElse"],["plainSms",""],[3,"label","formControl","click"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],[1,"mb-2"],[3,"formControl","label",4,"ngIf"],[3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy","binaryValues"],["kind","field",3,"label",4,"ngIf"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"],["class","btn btn-outline-primary","type","button",3,"click",4,"ngIf","ngIfElse"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"mt-4","mb-2","d-flex","flex-column","flex-xs-row","justify-content-between"],["class","section-title-action","dropdown","",4,"ngIf"],["class","section-title-action",4,"ngIf"],["dropdown","",1,"section-title-action"],["dropdownToggle","","type","button","type","button","aria-controls","newPhoneDropDown",1,"btn","btn-outline-primary","dropdown-toggle"],["class","dropdown-menu dropdown-menu-right","role","listbox","id","newPhoneDropDown",4,"dropdownMenu"],["role","listbox","id","newPhoneDropDown",1,"dropdown-menu","dropdown-menu-right"],["dropDownMenu",""],[1,"dropdown-item",3,"click"],[1,"section-title-action"],["formControlName","name","required","",3,"id","label"],["type","tel","formControlName","number","required","",3,"id","label","placeholder"],["class","d-flex justify-content-end",3,"ngClass",4,"ngIf"],["formControlName","verified",3,"label",4,"ngIf","ngIfElse"],["formControlName","verified",3,"label"],["formControlName","enabledForSms",3,"label","click",4,"ngIf","ngIfElse"],["formControlName","enabledForSms",3,"label","click"],[1,"d-flex","w-100","justify-content-between"],["justifyStart","",3,"control"],["class","btn btn-outline-primary","type","button",3,"click",4,"ngIf"],[1,"d-flex","justify-content-end",3,"ngClass"],["idPrefix","address_",3,"addressForm","ignoreContactFields","configuration","idSuffix","managePrivacy","binaryValues"],["kind","field","class","pb-0",3,"label",4,"ngIf"],["class","row mt-3 no-gutters",4,"ngIf"],["kind","field",1,"pb-0",3,"label"],[4,"ngIf","ngIfThen"],[1,"row","mt-3","no-gutters"],["class","col-4",4,"ngIf"],[1,"col-12","col-sm-8"],["forceRow","",1,"mt-0"],[1,"col-4"],[1,"flex-grow-1"],["formControlName","image","target","contactInfo","separator","@","avatarSize","xlarge",3,"label","initialImages"],["formControlName","name",3,"id","label"],["formControlName","email",3,"id","label"],["formControlName","mobilePhone",3,"id","label"],["formControlName","landLinePhone",3,"id","label"],["formControlName","landLineExtension",3,"id","label",4,"ngIf"],["formControlName","address",3,"id","label"],[4,"ngFor","ngForOf"],["formControlName","landLineExtension",3,"id","label"],[3,"value","text",4,"ngIf"],[3,"value","text"],[3,"field","formControlName","binaryValues"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,ts,22,25,"page-content",1),b.Sb(),b.Fc(3,ns,1,0,"ng-template",null,2,b.Gc)),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,p.q,q.w,q.n,p.s,Q.a,lo.a,ke.a,j.a,vt.a,yt.a,q.v,q.l,q.D,uo.a,bo.a,Lt.a,ar.a,we.a,q.k,fo.a,mo.a,po.a,po.d,po.b,go.a,he.a,ve.a,ho.a],pipes:[p.b],encapsulation:2,changeDetection:0}),is),cs=n("cvAk");function ss(e,t){if(1&e){var n=b.Ub();b.Tb(0,"actions",4),b.Tb(1,"button",5),b.bc("click",(function(){return b.wc(n),b.dc(2).goToLogin()})),b.Hc(2),b.Sb(),b.Sb()}if(2&e){var i=b.dc(2);b.zb(2),b.Jc(" ",i.i18n.menu.login," ")}}function ls(e,t){if(1&e&&(b.Tb(0,"page-content"),b.Tb(1,"notification",2),b.Hc(2),b.Sb(),b.Fc(3,ss,3,1,"actions",3),b.ec(4,"async"),b.Sb()),2&e){var n=b.dc();b.zb(1),b.kc("allowClose",!1),b.zb(1),b.Jc(" ",n.i18n.user.newEmailConfirmed," "),b.zb(1),b.kc("ngIf",null==b.fc(4,3,n.login.user$))}}var us,ds=((us=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).validationService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.addSub(this.validationService.validateEmailChange(this.route.snapshot.params.key).subscribe((function(){e.login.user?(e.login.logout(),e.notification.info(e.i18n.user.newEmailConfirmed)):e.data=""})))}},{key:"goToLogin",value:function(){this.login.goToLoginPage("")}},{key:"resolveMenu",value:function(){return this.authHelper.homeMenu()}},{key:"userId",get:function(){return this.data}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||us)(b.Nb(b.r),b.Nb(c.L))},us.\u0275cmp=b.Hb({type:us,selectors:[["validate-email-change"]],features:[b.wb],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],[4,"ngIf"],[3,"allowClose"],["ngClass","mt-3","forceRow","",4,"ngIf"],["ngClass","mt-3","forceRow",""],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,ls,5,5,"page-content",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,cs.a,Q.a,p.q],pipes:[p.b],encapsulation:2,changeDetection:0}),us),bs=n("TV7p"),fs=n("mwYl"),ms=n("LRne"),ps=n("PqYM"),gs=n("eIep"),hs=n("lJxs"),vs=n("wR2l");function ys(e,t){if(1&e&&(b.Tb(0,"div",6),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.name,"")}}var ks=function(e){return{"ml-3":e}};function Ss(e,t){if(1&e&&(b.Tb(0,"div",7),b.Ob(1,"input",8),b.Tb(2,"label",9),b.Tb(3,"div",10),b.Hc(4),b.Sb(),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc().$implicit,a=b.dc(2);b.kc("ngClass",b.nc(6,ks,i)),b.zb(1),b.kc("formControl",a.control)("id","group_"+n.id)("value",n.id),b.zb(1),b.kc("for","group_"+n.id),b.zb(2),b.Jc(" ",n.name," ")}}function Ts(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div"),b.Fc(2,ys,2,1,"div",4),b.Fc(3,Ss,5,8,"div",5),b.Sb(),b.Qb()),2&e){var n=t.$implicit,i=b.dc(2);b.zb(2),b.kc("ngIf",n),b.zb(1),b.kc("ngForOf",i.groupsForSet(n))}}function Is(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div",2),b.Hc(2),b.Sb(),b.Fc(3,Ts,4,2,"ng-container",3),b.Qb()),2&e){var n=b.dc();b.zb(2),b.Ic(n.i18n.user.registration.groupManager),b.zb(1),b.kc("ngForOf",n.groupSets)}}function Cs(e,t){if(1&e&&b.Ob(0,"field-option",15),2&e){var n=t.$implicit;b.kc("value",n.id)("text",n.name)}}function Os(e,t){if(1&e&&(b.Tb(0,"radio-group-field",13),b.Fc(1,Cs,1,2,"field-option",14),b.Sb()),2&e){var n=b.dc(2);b.kc("formControl",n.control),b.zb(1),b.kc("ngForOf",n.groups)}}function Fs(e,t){if(1&e&&(b.Tb(0,"div",21),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc(" ",n.description," ")}}function zs(e,t){if(1&e&&(b.Tb(0,"div",17),b.Tb(1,"div",18),b.Tb(2,"div",19),b.Ob(3,"input",8),b.Tb(4,"label",9),b.Tb(5,"div",10),b.Hc(6),b.Fc(7,Fs,2,1,"div",20),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(3),b.kc("formControl",i.control)("id","group_"+n.id)("value",n.id),b.zb(1),b.kc("for","group_"+n.id),b.zb(2),b.Jc(" ",n.name," "),b.zb(1),b.kc("ngIf",n.description)}}function As(e,t){if(1&e&&b.Fc(0,zs,8,6,"div",16),2&e){var n=b.dc(2);b.kc("ngForOf",n.groups)}}function ws(e,t){if(1&e&&(b.Tb(0,"div",2),b.Hc(1),b.Sb(),b.Fc(2,Os,2,2,"radio-group-field",11),b.Fc(3,As,1,1,"ng-template",null,12,b.Gc)),2&e){var n=b.uc(4),i=b.dc();b.zb(1),b.Ic(i.i18n.user.registration.groupPublic),b.zb(1),b.kc("ngIf",i.singleLine)("ngIfElse",n)}}var Es,_s=((Es=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.singleLine=this.groups.length<=3&&0===this.groups.filter((function(e){return e.description})).length}},{key:"groupsForSet",value:function(e){return this.groups.filter(null==e?function(e){return null==e.groupSet}:function(t){return t.groupSet===e.id})}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Es)(b.Nb(b.r))},Es.\u0275cmp=b.Hb({type:Es,selectors:[["registration-step-group"]],inputs:{groupSets:"groupSets",groups:"groups",control:"control"},features:[b.wb],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["asGuest",""],[1,"mb-3"],[4,"ngFor","ngForOf"],["class","mt-3 mb-2","font-weight-bold","",4,"ngIf"],["class","custom-control custom-radio mb-1",3,"ngClass",4,"ngFor","ngForOf"],["font-weight-bold","",1,"mt-3","mb-2"],[1,"custom-control","custom-radio","mb-1",3,"ngClass"],["type","radio",1,"custom-control-input",3,"formControl","id","value"],[1,"custom-control-label",3,"for"],[1,"ml-1"],[3,"formControl",4,"ngIf","ngIfElse"],["multiLine",""],[3,"formControl"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["class","row mb-2",4,"ngFor","ngForOf"],[1,"row","mb-2"],[1,"col-12","col-6","col-sm-8"],[1,"custom-control","custom-radio"],["class","text-muted mt-1 mb-3",4,"ngIf"],[1,"text-muted","mt-1","mb-3"]],template:function(e,t){if(1&e&&(b.Fc(0,Is,4,2,"ng-container",0),b.Fc(1,ws,5,3,"ng-template",null,1,b.Gc)),2&e){var n=b.uc(2);b.kc("ngIf",t.login.user)("ngIfElse",n)}},directives:[p.t,p.s,p.q,q.A,q.e,q.v,q.k,vs.a,ve.a],encapsulation:2,changeDetection:0}),Es);function Ns(e,t){if(1&e&&b.Ob(0,"img",8),2&e){var n=b.dc().$implicit;b.kc("src",n.image.url,b.yc)("alt",n.name)}}var Rs=function(e,t,n){return{border:e,background:t,color:n}};function Ps(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",5),b.bc("click",(function(){b.wc(n);var e=t.$implicit;return b.dc().registerWith(e)})),b.Fc(1,Ns,1,2,"img",6),b.Ob(2,"span",7),b.ec(3,"trust"),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc();b.kc("ngStyle",b.pc(5,Rs,"1px solid "+i.borderColor,i.backgroundColor,i.textColor)),b.zb(1),b.kc("ngIf",i.image),b.zb(1),b.kc("innerHTML",b.fc(3,3,a.i18n.identityProvider.login(i.name)),b.xc)}}var Ds,Hs=((Ds=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).continue=new b.n,i}return _createClass(n,[{key:"registerWith",value:function(e){this.continue.emit(e)}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Ds)(b.Nb(b.r))},Ds.\u0275cmp=b.Hb({type:Ds,selectors:[["registration-step-idp"]],inputs:{identityProviders:"identityProviders"},outputs:{continue:"continue"},features:[b.wb],decls:9,vars:10,consts:[[1,"text-center"],["type","button","class","identity-provider",3,"ngStyle","click",4,"ngFor","ngForOf"],[1,"text-center","my-3"],[1,"mx-auto",3,"disabled","label","action"],[1,"text-muted","text-justify","my-3",3,"innerHTML"],["type","button",1,"identity-provider",3,"ngStyle","click"],["class","aria-hidden",3,"src","alt",4,"ngIf"],[3,"innerHTML"],[1,"aria-hidden",3,"src","alt"]],template:function(e,t){1&e&&(b.Tb(0,"div",0),b.Hc(1),b.Sb(),b.Fc(2,Ps,4,9,"button",1),b.Tb(3,"div",2),b.Hc(4),b.Sb(),b.Tb(5,"action-button",3),b.bc("action",(function(){return t.registerWith(null)})),b.ec(6,"async"),b.Sb(),b.Ob(7,"div",4),b.ec(8,"trust")),2&e&&(b.zb(1),b.Ic(t.i18n.identityProvider.registration),b.zb(1),b.kc("ngForOf",t.identityProviders),b.zb(2),b.Ic(t.i18n.identityProvider.registrationOr),b.zb(1),b.kc("disabled",b.fc(6,6,t.requesting$))("label",t.i18n.identityProvider.registrationFillForm),b.zb(2),b.kc("innerHTML",b.fc(8,8,t.i18n.identityProvider.registrationDisclaimer(t.format.appTitleSmall)),b.xc))},directives:[p.s,Y.a,p.w,p.t],pipes:[p.b,Ut.a],styles:[".button[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{display:block!important;width:100%}@media (min-width:576px){.button[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{width:18rem;margin-left:auto;margin-right:auto}}"],changeDetection:0}),Ds),xs=n("HDdC");function Ls(e,t){if(1&e&&b.Ob(0,"avatar",17),2&e){var n=b.dc(2);b.kc("image",n.image)}}function Ms(e,t){if(1&e&&b.Hc(0),2&e){var n=b.dc(2);b.Jc(" ",n.i18n.user.noImage," ")}}function Us(e,t){if(1&e){var n=b.Ub();b.Tb(0,"action-button",21),b.bc("action",(function(){return b.wc(n),b.dc(3).removeImage()})),b.ec(1,"async"),b.Sb()}if(2&e){var i=b.dc(3);b.kc("disabled",b.fc(1,2,i.requesting$))("label",i.i18n.field.image.remove)}}function $s(e,t){if(1&e){var n=b.Ub();b.Tb(0,"div",18),b.Tb(1,"action-button",19),b.bc("action",(function(){return b.wc(n),b.dc(),b.uc(11).perform()})),b.ec(2,"async"),b.Sb(),b.Fc(3,Us,2,4,"action-button",20),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.kc("disabled",b.fc(2,3,i.requesting$))("label",i.i18n.field.image.upload),b.zb(2),b.kc("ngIf",i.image)}}function Gs(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Tb(1,"h2",7),b.Hc(2),b.Sb(),b.Tb(3,"div",8),b.Tb(4,"div",9),b.Tb(5,"div",10),b.Fc(6,Ls,1,1,"avatar",11),b.ec(7,"async"),b.Fc(8,Ms,1,1,"ng-template",null,12,b.Gc),b.Sb(),b.Tb(10,"image-upload",13,14),b.bc("uploadDone",(function(e){return b.wc(n),b.dc().onUploadDone(e[0])})),b.Sb(),b.Sb(),b.Fc(12,$s,4,5,"div",15),b.ec(13,"async"),b.Sb(),b.Tb(14,"h2",16),b.Hc(15),b.Sb(),b.Qb()}if(2&e){var i=b.uc(9),a=b.uc(11),r=b.dc();b.zb(2),b.Ic(r.i18n.user.title.image),b.zb(4),b.kc("ngIf",b.fc(7,5,r.image$))("ngIfElse",i),b.zb(6),b.kc("ngIf",!1===b.fc(13,7,a.uploading$)),b.zb(3),b.Ic(r.i18n.user.title.fields)}}function Bs(e,t){if(1&e&&b.Ob(0,"input-field",22),2&e){var n=b.dc();b.kc("label",n.i18n.user.name)}}function Js(e,t){if(1&e&&b.Ob(0,"input-field",23),2&e){var n=b.dc();b.kc("label",n.i18n.user.username)}}function Vs(e,t){if(1&e&&b.Ob(0,"field-privacy",28),2&e){var n=b.dc(2);b.kc("control",n.form.get("hiddenFields"))}}function qs(e,t){if(1&e&&b.Ob(0,"boolean-field",29),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.registration.skipActivationEmail)}}function js(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"label-value",24),b.Ob(2,"input-field",25),b.Fc(3,Vs,1,1,"field-privacy",26),b.Sb(),b.Fc(4,qs,1,1,"boolean-field",27),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("label",n.i18n.user.email)("ignoreExtraCell",!n.canManagePrivacy("email"))("required",n.data.emailRequired),b.zb(1),b.kc("required",n.data.emailRequired),b.zb(2),b.kc("ngIf",n.data.allowSetSendActivationEmail)}}function Qs(e,t){if(1&e&&b.Ob(0,"field-privacy",34),2&e){var n=b.dc(2).$implicit,i=b.dc();b.kc("field",n.internalName)("control",i.form.get("hiddenFields"))}}function Ys(e,t){if(1&e){var n=b.Ub();b.Tb(0,"label-value",31),b.Tb(1,"custom-field-input",32),b.bc("imagesUploaded",(function(e){return b.wc(n),b.dc(2).customImagesUploaded.emit(e)}))("filesUploaded",(function(e){return b.wc(n),b.dc(2).customFilesUploaded.emit(e)})),b.Sb(),b.Fc(2,Qs,1,2,"field-privacy",33),b.Sb()}if(2&e){var i=b.dc().$implicit,a=b.dc();b.kc("label",i.name)("ignoreExtraCell",!a.canManagePrivacy(i))("fieldSize",i.size)("required",i.required),b.zb(1),b.kc("field",i)("formControlName",i.internalName)}}function Ks(e,t){if(1&e&&(b.Rb(0,1),b.Fc(1,Ys,3,6,"label-value",30),b.Qb()),2&e){var n=t.$implicit,i=b.dc();b.kc("formGroup",i.form.get("customValues")),b.zb(1),b.kc("ngIf",i.canEdit(n))}}function Xs(e,t){if(1&e&&b.Ob(0,"field-privacy",38),2&e){var n=b.dc(2);b.kc("control",n.mobileForm.get("hidden"))}}function Ws(e,t){if(1&e&&(b.Tb(0,"label-value",35),b.Ob(1,"input-field",36),b.Fc(2,Xs,1,1,"field-privacy",37),b.Sb()),2&e){var n=b.dc();b.kc("label",n.i18n.phone.mobile)("required","required"===n.mobileAvailability)("formGroup",n.mobileForm),b.zb(1),b.kc("placeholder",n.data.phoneConfiguration.mobileExample)}}function Zs(e,t){if(1&e&&b.Ob(0,"field-privacy",38),2&e){var n=b.dc(2);b.kc("control",n.landLineForm.get("hidden"))}}function el(e,t){if(1&e&&b.Ob(0,"input-field",41),2&e){var n=b.dc(2);b.kc("label",n.i18n.phone.extension)}}function tl(e,t){if(1&e&&(b.Rb(0,1),b.Tb(1,"label-value",39),b.Ob(2,"input-field",36),b.Fc(3,Zs,1,1,"field-privacy",37),b.Sb(),b.Fc(4,el,1,1,"input-field",40),b.Qb()),2&e){var n=b.dc();b.kc("formGroup",n.landLineForm),b.zb(1),b.kc("label",n.i18n.phone.landLine)("required","required"===n.data.phoneConfiguration.landLineAvailability),b.zb(1),b.kc("placeholder",n.data.phoneConfiguration.landLineExample),b.zb(2),b.kc("ngIf",n.data.phoneConfiguration.extensionEnabled)}}function nl(e,t){if(1&e&&b.Ob(0,"boolean-field",45),2&e){var n=b.dc(2);b.kc("formControl",n.defineAddress)("label",n.i18n.user.addressDefine)}}function il(e,t){if(1&e&&b.Ob(0,"address-form",46),2&e){var n=b.dc(2);b.kc("addressForm",n.addressForm)("configuration",n.data.addressConfiguration)("managePrivacy",n.data.addressConfiguration.managePrivacy)}}function al(e,t){if(1&e){var n=b.Ub();b.Tb(0,"static-map",50),b.bc("imageLoaded",(function(){return b.wc(n),b.dc(3).mapShown()})),b.Sb()}if(2&e){var i=b.dc(3);b.kc("address",i.addressForm.value)}}function rl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"action-button",21),b.bc("action",(function(){return b.wc(n),b.dc(4).locateAddress()})),b.ec(1,"async"),b.Sb()}if(2&e){var i=b.dc(4);b.kc("disabled",b.fc(1,2,i.locatingAddress$))("label",i.i18n.general.mapView)}}function ol(e,t){if(1&e&&b.Fc(0,rl,2,4,"action-button",20),2&e){var n=b.dc(3);b.kc("ngIf",n.image)}}function cl(e,t){if(1&e&&(b.Tb(0,"label-value",47),b.Fc(1,al,1,1,"static-map",48),b.Fc(2,ol,1,1,"ng-template",null,49,b.Gc),b.Sb()),2&e){var n=b.uc(3),i=b.dc(2);b.kc("label",i.i18n.general.map),b.zb(1),b.kc("ngIf",null!=i.addressForm.get("location").value.latitude)("ngIfElse",n)}}function sl(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2",16),b.Hc(2),b.Sb(),b.Fc(3,nl,1,2,"boolean-field",42),b.Fc(4,il,1,3,"address-form",43),b.Fc(5,cl,4,3,"label-value",44),b.Qb()),2&e){var n=b.dc();b.zb(2),b.Ic(n.i18n.address.address),b.zb(1),b.kc("ngIf","required"!==n.data.addressConfiguration.availability),b.zb(1),b.kc("ngIf",n.defineAddress.value),b.zb(1),b.kc("ngIf",n.defineAddress.value&&n.maps.enabled)}}var ll,ul=((ll=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).userHelper=i,o.imagesService=a,o.changeDetector=r,o.imageUploaded=new b.n,o.imageRemoved=new b.n,o.customImagesUploaded=new b.n,o.customFilesUploaded=new b.n,o.image$=new ht.a(null),o.location$=new ht.a(null),o.locatingAddress$=new ht.a(!1),o}return _createClass(n,[{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.editableFields=this.userHelper.fieldNamesByAction(this.data,"edit"),this.managePrivacyFields=this.userHelper.fieldNamesByAction(this.data,"managePrivacy")}},{key:"onUploadDone",value:function(e){var t=this;this.addSub(this.doRemoveImage().subscribe((function(){t.image=e,t.imageUploaded.emit(t.image),t.changeDetector.detectChanges()})))}},{key:"removeImage",value:function(){this.addSub(this.doRemoveImage().subscribe())}},{key:"doRemoveImage",value:function(){var e=this;if(this.image){var t=this.image;return this.errorHandler.requestWithCustomErrorHandler((function(){return new xs.a((function(n){e.imagesService.deleteImage({idOrKey:e.image.id}).subscribe((function(){e.imageRemoved.emit(e.image),e.image=null,e.changeDetector.detectChanges(),n.next(t)}))}))}))}return Object(ms.a)(null)}},{key:"canEdit",value:function(e){return this.editableFields.has(this.fieldHelper.fieldName(e))}},{key:"canManagePrivacy",value:function(e){return this.managePrivacyFields.has(this.fieldHelper.fieldName(e))}},{key:"locateAddress",value:function(){var e=this,t=this.addressForm.value;this.locatingAddress$.next(!0),this.addSub(this.maps.geocode(t).subscribe((function(t){e.addressForm.patchValue({location:t}),e.changeDetector.detectChanges()}),(function(){return e.mapShown()})))}},{key:"mapShown",value:function(){this.locatingAddress$.next(!1),this.changeDetector.detectChanges()}},{key:"image",get:function(){return this.image$.value},set:function(e){this.image$.next(e)}},{key:"location",get:function(){return this.location$.value},set:function(e){this.location$.next(e)}},{key:"mobileAvailability",get:function(){return this.data.phoneConfiguration.mobileAvailability}},{key:"landLineAvailability",get:function(){return this.data.phoneConfiguration.landLineAvailability}},{key:"addressAvailability",get:function(){return this.data.addressConfiguration.availability}},{key:"imageAvailability",get:function(){return this.data.imageConfiguration.availability}}]),n}(tr.a)).\u0275fac=function(e){return new(e||ll)(b.Nb(b.r),b.Nb(s.a),b.Nb(c.p),b.Nb(b.h))},ll.\u0275cmp=b.Hb({type:ll,selectors:[["registration-step-fields"]],inputs:{data:"data",form:"form",mobileForm:"mobileForm",landLineForm:"landLineForm",addressForm:"addressForm",defineAddress:"defineAddress",image:"image"},outputs:{imageUploaded:"imageUploaded",imageRemoved:"imageRemoved",customImagesUploaded:"customImagesUploaded",customFilesUploaded:"customFilesUploaded"},features:[b.wb],decls:9,vars:9,consts:[[4,"ngIf"],[3,"formGroup"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","username","required","",3,"label",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],["kind","field",3,"label","required","formGroup",4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"border-0"],[1,"row"],[1,"col-12","col-sm-4"],[1,"d-flex","justify-content-center","justify-content-sm-start"],["size","huge","useLightbox","",3,"image",4,"ngIf","ngIfElse"],["noImage",""],["containerClass","mt-3","target","userRegistration","keepUrls","",3,"uploadDone"],["upload",""],["class","col-12 col-sm-8 mt-3 mt-sm-0 d-flex justify-content-between justify-content-sm-end align-items-end",4,"ngIf"],[1,"mt-4"],["size","huge","useLightbox","",3,"image"],[1,"col-12","col-sm-8","mt-3","mt-sm-0","d-flex","justify-content-between","justify-content-sm-end","align-items-end"],["outline","",3,"disabled","label","action"],["class","ml-3","outline","",3,"disabled","label","action",4,"ngIf"],["outline","",1,"ml-3",3,"disabled","label","action"],["formControlName","name","required","",3,"label"],["formControlName","username","required","",3,"label"],["kind","field",3,"label","ignoreExtraCell","required"],["formControlName","email",3,"required"],["field","email",3,"control",4,"extraCell"],["formControlName","skipActivationEmail",3,"label",4,"ngIf"],["field","email",3,"control"],["formControlName","skipActivationEmail",3,"label"],["kind","field",3,"label","ignoreExtraCell","fieldSize","required",4,"ngIf"],["kind","field",3,"label","ignoreExtraCell","fieldSize","required"],["hideLabel","",3,"field","formControlName","imagesUploaded","filesUploaded"],[3,"field","control",4,"extraCell"],[3,"field","control"],["kind","field",3,"label","required","formGroup"],["formControlName","number",3,"placeholder"],[3,"control",4,"extraCell"],[3,"control"],["kind","field",3,"label","required"],["formControlName","extension","fieldSize","tiny",3,"label",4,"ngIf"],["formControlName","extension","fieldSize","tiny",3,"label"],[3,"formControl","label",4,"ngIf"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy",4,"ngIf"],["kind","field",3,"label",4,"ngIf"],[3,"formControl","label"],["ignoreContactFields","",3,"addressForm","configuration","managePrivacy"],["kind","field",3,"label"],[3,"address","imageLoaded",4,"ngIf","ngIfElse"],["viewMap",""],[3,"address","imageLoaded"]],template:function(e,t){1&e&&(b.Fc(0,Gs,16,9,"ng-container",0),b.Rb(1,1),b.Fc(2,Bs,1,1,"input-field",2),b.Fc(3,Js,1,1,"input-field",3),b.Fc(4,js,5,5,"ng-container",0),b.Qb(),b.Fc(5,Ks,2,2,"ng-container",4),b.Fc(6,Ws,3,4,"label-value",5),b.Fc(7,tl,5,5,"ng-container",6),b.Fc(8,sl,6,4,"ng-container",0)),2&e&&(b.kc("ngIf","disabled"!==t.imageAvailability),b.zb(1),b.kc("formGroup",t.form),b.zb(1),b.kc("ngIf",t.canEdit("name")),b.zb(1),b.kc("ngIf",t.canEdit("username")),b.zb(1),b.kc("ngIf",t.canEdit("email")),b.zb(1),b.kc("ngForOf",t.data.customFields),b.zb(1),b.kc("ngIf","disabled"!==t.mobileAvailability),b.zb(1),b.kc("ngIf","disabled"!==t.landLineAvailability),b.zb(1),b.kc("ngIf","disabled"!==t.addressAvailability))},directives:[p.t,q.w,q.n,p.s,lo.a,ke.a,Y.a,yt.a,q.v,q.l,q.D,j.a,uo.a,bo.a,we.a,Lt.a,q.k,fo.a,mo.a],pipes:[p.b],encapsulation:2,changeDetection:0}),ll),dl=n("7qm1"),bl=n("g9Ug"),fl=["securityAnswer"];function ml(e,t){if(1&e&&(b.Tb(0,"div",10),b.Ob(1,"avatar",11),b.Sb()),2&e){var n=b.dc();b.zb(1),b.kc("image",n.image)}}function pl(e,t){if(1&e&&(b.Tb(0,"div",12),b.Ob(1,"avatar",13),b.Sb()),2&e){var n=b.dc();b.zb(1),b.kc("size",n.image?200:128)("image",n.image)}}function gl(e,t){if(1&e&&b.Ob(0,"label-value",14),2&e){var n=b.dc();b.kc("label",n.i18n.user.group)("value",n.group.name)}}function hl(e,t){if(1&e&&b.Ob(0,"label-value",14),2&e){var n=b.dc();b.kc("label",n.i18n.user.name)("value",n.name)}}function vl(e,t){if(1&e&&b.Ob(0,"label-value",14),2&e){var n=b.dc();b.kc("label",n.i18n.user.username)("value",n.username)}}function yl(e,t){if(1&e&&b.Ob(0,"label-value",14),2&e){var n=b.dc();b.kc("label",n.i18n.user.email)("value",n.email)}}function kl(e,t){if(1&e&&(b.Tb(0,"label-value",15),b.Ob(1,"format-field-value",16),b.Sb()),2&e){var n=t.$implicit,i=b.dc();b.kc("label",n.name),b.zb(1),b.kc("fields",i.customFields)("fieldName",n.internalName)("object",i.user)("images",i.customImages)("files",i.customFiles)}}function Sl(e,t){if(1&e&&b.Ob(0,"label-value",14),2&e){var n=b.dc();b.kc("label",n.i18n.phone.mobile)("value",n.mobile)}}function Tl(e,t){if(1&e&&b.Ob(0,"label-value",14),2&e){var n=b.dc();b.kc("label",n.i18n.user.phoneAddLandLine)("value",n.landLine)}}function Il(e,t){if(1&e&&(b.Tb(0,"label-value",15),b.Ob(1,"address-details",17),b.Sb()),2&e){var n=b.dc();b.kc("label",n.i18n.address.address),b.zb(1),b.kc("address",n.address)}}function Cl(e,t){if(1&e&&(b.Tb(0,"div",20),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Ic(n.description)}}function Ol(e,t){if(1&e&&b.Ob(0,"boolean-field",21),2&e){var n=b.dc(2);b.kc("label",n.i18n.user.registration.passwordAssign)}}function Fl(e,t){if(1&e&&b.Ob(0,"boolean-field",25),2&e){var n=b.dc(3);b.kc("label",n.i18n.user.registration.passwordForceChange)}}function zl(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"input-field",22),b.Ob(2,"input-field",23),b.Fc(3,Fl,1,1,"boolean-field",24),b.Qb()),2&e){var n=b.dc().$implicit,i=b.dc();b.zb(1),b.kc("label",n.name),b.zb(1),b.kc("label",i.i18n.user.passwordConfirmation(n.name)),b.zb(1),b.kc("ngIf",n.canForceChange)}}function Al(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2"),b.Hc(2),b.Sb(),b.Rb(3,7),b.Fc(4,Cl,2,1,"div",18),b.Fc(5,Ol,1,1,"boolean-field",19),b.Fc(6,zl,4,3,"ng-container",9),b.Qb(),b.Qb()),2&e){var n=t.$implicit,i=t.index,a=b.dc();b.zb(2),b.Ic(n.name),b.zb(1),b.kc("formGroup",a.passwordForm(i)),b.zb(1),b.kc("ngIf",n.description),b.zb(1),b.kc("ngIf",a.login.user),b.zb(1),b.kc("ngIf",a.passwordForm(i).get("defined").value)}}function wl(e,t){if(1&e&&b.Ob(0,"field-option",32),2&e){var n=t.$implicit;b.kc("value",n.internalName)("text",n.name)}}function El(e,t){if(1&e&&b.Ob(0,"input-field",33,34),2&e){var n=b.dc(3);b.kc("label",n.i18n.securityQuestion.answer)}}function _l(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"h2"),b.Hc(2),b.Sb(),b.Tb(3,"div",20),b.Hc(4),b.Sb(),b.Tb(5,"single-selection-field",29),b.Fc(6,wl,1,2,"field-option",30),b.Sb(),b.Fc(7,El,2,1,"input-field",31),b.ec(8,"async"),b.Qb()),2&e){var n=b.dc(2);b.zb(2),b.Ic(n.i18n.securityQuestion.question),b.zb(2),b.Jc(" ",n.i18n.user.securityQuestionMessage," "),b.zb(1),b.kc("label",n.i18n.securityQuestion.question)("emptyOption",n.i18n.user.securityQuestionEmpty),b.zb(1),b.kc("ngForOf",n.data.securityQuestions),b.zb(1),b.kc("ngIf",!n.empty(b.fc(8,6,n.form.get("securityQuestion").valueChanges)))}}function Nl(e,t){if(1&e&&(b.Tb(0,"h2"),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.Jc(" ",n.i18n.user.title.registrationConfirmation," ")}}function Rl(e,t){if(1&e&&(b.Tb(0,"div",35),b.Tb(1,"div",36),b.Hc(2),b.Sb(),b.Tb(3,"div",36),b.Ob(4,"captcha",37),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(2),b.Ic(n.i18n.user.captcha),b.zb(2),b.kc("form",n.form.get("captcha"))}}function Pl(e,t){if(1&e&&(b.Tb(0,"div",38),b.Tb(1,"div",36),b.Hc(2),b.Sb(),b.Ob(3,"accept-agreements",39),b.Sb()),2&e){var n=b.dc(2);b.zb(2),b.Ic(n.i18n.pendingAgreements.preface),b.zb(1),b.kc("agreements",n.data.agreements)}}function Dl(e,t){if(1&e&&(b.Rb(0),b.Fc(1,_l,9,8,"ng-container",9),b.Fc(2,Nl,2,1,"h2",9),b.Tb(3,"div",26),b.Fc(4,Rl,5,2,"div",27),b.Fc(5,Pl,4,2,"div",28),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("ngIf",(null==n.data.securityQuestions?null:n.data.securityQuestions.length)>0),b.zb(1),b.kc("ngIf",(null==n.data.agreements?null:n.data.agreements.length)>0||null!=n.data.captchaType),b.zb(2),b.kc("ngIf",null!=n.data.captchaType),b.zb(1),b.kc("ngIf",(null==n.data.agreements?null:n.data.agreements.length)>0)}}var Hl,xl=((Hl=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var i;return _classCallCheck(this,n),(i=t.call(this,e)).empty=J.h,i.focusSecurityAnswer=!1,i}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;if(_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),Object(J.h)(this.data.securityQuestions)||this.addSub(this.form.get("securityQuestion").valueChanges.subscribe((function(t){e.focusSecurityAnswer=!Object(J.a)(t)}))),!Object(J.h)(this.data.agreements)){var t=this.data.agreements.map((function(){return!1}));this.agreementsControl=this.formBuilder.array(t),this.addSub(this.agreementsControl.valueChanges.subscribe((function(t){var n=t.length===t.filter((function(e){return e})).length;e.form.patchValue({acceptAgreement:n})})))}}},{key:"ngAfterViewChecked",value:function(){this.focusSecurityAnswer&&(this.securityAnswer.forEach((function(e){return Object(J.j)(e)})),this.focusSecurityAnswer=!1)}},{key:"passwordForm",value:function(e){return this.form.get("passwords").controls[e]}},{key:"group",get:function(){var e=this,t=this.dataForUiHolder.dataForUi.publicRegistrationGroups||[];return 1===t.length?null:t.find((function(t){return t.id===e.user.group}))}},{key:"name",get:function(){return(this.user.name||"").trim()}},{key:"username",get:function(){return(this.user.username||"").trim()}},{key:"email",get:function(){return(this.user.email||"").trim()}},{key:"mobile",get:function(){var e=this.user.mobilePhones||[];return Object(J.h)(e)?null:(e[0].number||"").trim()}},{key:"landLine",get:function(){var e=this.user.landLinePhones||[],t=Object(J.h)(e)?null:(e[0].number||"").trim();if(Object(J.h)(t))return"";var n=Object(J.h)(e)?null:(e[0].extension||"").trim();return""===n?t:this.i18n.phone.numberExtensionValue({number:t,extension:n})}},{key:"address",get:function(){var e=this.user.addresses||[];return Object(J.h)(e)?null:e[0]}},{key:"customFields",get:function(){var e=this;return this.data.customFields.filter((function(t){return!Object(J.a)(e.user.customValues[t.internalName])}))}},{key:"autocompletePasswords",get:function(){return(this.login.auth||{}).role?"off":"on"}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Hl)(b.Nb(b.r))},Hl.\u0275cmp=b.Hb({type:Hl,selectors:[["registration-step-confirm"]],viewQuery:function(e,t){var n;1&e&&b.Lc(fl,!0),2&e&&b.tc(n=b.cc())&&(t.securityAnswer=n)},inputs:{data:"data",form:"form",user:"user",image:"image",customImages:"customImages",customFiles:"customFiles"},features:[b.wb],decls:17,vars:17,consts:[["class","image d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4 mb-3",4,"ngIf"],[1,"flex-grow-1","mb-ls"],[3,"label","value",4,"ngIf"],["valueFormat","component",3,"label",4,"ngFor","ngForOf"],["valueFormat","component",3,"label",4,"ngIf"],[3,"formGroup"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"image","d-flex","justify-content-center","mt-2","mb-4"],["size","160","imageSize","200","useLightbox","",3,"image"],[1,"image","ml-4","mb-3"],["iconSize","128px","useLightbox","",3,"size","image"],[3,"label","value"],["valueFormat","component",3,"label"],[3,"fields","fieldName","object","images","files"],[3,"address"],["class","mb-2",4,"ngIf"],["formControlName","defined",3,"label",4,"ngIf"],[1,"mb-2"],["formControlName","defined",3,"label"],["required","","formControlName","value","type","password","autocomplete","new-password",3,"label"],["required","","formControlName","confirmationValue","type","password","autocomplete","new-password",3,"label"],["formControlName","forceChange",3,"label",4,"ngIf"],["formControlName","forceChange",3,"label"],[1,"row","no-gutters"],["class","col-12 col-sm-6 col-md-5",4,"ngIf"],["class","col-12 col-sm-6 col-md-7",4,"ngIf"],["formControlName","securityQuestion",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","securityAnswer","required","",3,"label",4,"ngIf"],[3,"value","text"],["formControlName","securityAnswer","required","",3,"label"],["securityAnswer",""],[1,"col-12","col-sm-6","col-md-5"],[1,"mb-3"],[3,"form"],[1,"col-12","col-sm-6","col-md-7"],["formControlName","acceptAgreements",3,"agreements"]],template:function(e,t){1&e&&(b.Fc(0,ml,2,1,"div",0),b.ec(1,"async"),b.Tb(2,"div",1),b.Fc(3,pl,2,2,"div",2),b.ec(4,"async"),b.Tb(5,"div",3),b.Fc(6,gl,1,2,"label-value",4),b.Fc(7,hl,1,2,"label-value",4),b.Fc(8,vl,1,2,"label-value",4),b.Fc(9,yl,1,2,"label-value",4),b.Fc(10,kl,2,6,"label-value",5),b.Fc(11,Sl,1,2,"label-value",4),b.Fc(12,Tl,1,2,"label-value",4),b.Fc(13,Il,2,2,"label-value",6),b.Sb(),b.Sb(),b.Tb(14,"form",7),b.Fc(15,Al,7,5,"ng-container",8),b.Fc(16,Dl,6,4,"ng-container",9),b.Sb()),2&e&&(b.kc("ngIf",t.image&&b.fc(1,13,t.layout.ltsm$)),b.zb(3),b.kc("ngIf",t.image&&b.fc(4,15,t.layout.gtxs$)),b.zb(3),b.kc("ngIf",t.group),b.zb(1),b.kc("ngIf",!t.empty(t.name)),b.zb(1),b.kc("ngIf",!t.empty(t.username)),b.zb(1),b.kc("ngIf",!t.empty(t.email)),b.zb(1),b.kc("ngForOf",t.customFields),b.zb(1),b.kc("ngIf",!t.empty(t.mobile)),b.zb(1),b.kc("ngIf",!t.empty(t.landLine)),b.zb(1),b.kc("ngIf",t.address),b.zb(1),b.kc("formGroup",t.form),b.zb(1),b.kc("ngForOf",t.data.passwordTypes),b.zb(1),b.kc("ngIf",!t.login.user))},directives:[p.t,p.s,q.I,q.w,q.n,ke.a,j.a,ar.a,dl.a,we.a,q.v,q.l,yt.a,q.D,he.a,ve.a,bl.a,V.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Hl);function Ll(e,t){if(1&e&&(b.Rb(0),b.Ob(1,"p",0),b.ec(2,"trust"),b.Tb(3,"p"),b.Hc(4),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("innerHTML",b.fc(2,2,n.principalsHtml),b.xc),b.zb(3),b.Ic(n.passwordsMessage)}}var Ml,Ul=((Ml=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"messageHtml",get:function(){var e=!!this.login.user,t=this.result.user.display;switch(this.result.status){case ze.Db.ACTIVE:return e?this.i18n.user.registration.activeManager(t):this.i18n.user.registration.activePublic;case ze.Db.INACTIVE:return e?this.i18n.user.registration.inactiveManager(t):this.i18n.user.registration.inactivePublic;case ze.Db.EMAIL_VALIDATION:return e?this.i18n.user.registration.pendingManager(t):this.i18n.user.registration.pendingPublic}}},{key:"principalsHtml",get:function(){var e=this.result.principals;if(null==e||0===e.length)return"";if(1===e.length){var t=e[0];return this.i18n.user.registration.principalSingle({principal:t.type.name,value:t.value,channels:t.channels.map((function(e){return e.name})).join(", ")})}var n=[];n.push(this.i18n.user.registration.principalMultiplePreface),n.push("<ul>");var i,a=_createForOfIteratorHelper(e);try{for(a.s();!(i=a.n()).done;){var r=i.value;n.push("<li>"),n.push(this.i18n.user.registration.principalMultipleItem({principal:r.type.name,value:r.value,channels:r.channels.map((function(e){return e.name})).join(", ")})),n.push("</li>")}}catch(o){a.e(o)}finally{a.f()}return n.push("</ul>"),n.join("")}},{key:"passwordsMessage",get:function(){var e=this.result.generatedPasswords;return Object(J.h)(e)?this.i18n.user.registration.generatedPasswordsNone:1===e.length?this.i18n.user.registration.generatedPasswordsSingle(e[0].name):this.i18n.user.registration.generatedPasswordsMultiple(e.map((function(e){return e.name})).join(", "))}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Ml)(b.Nb(b.r))},Ml.\u0275cmp=b.Hb({type:Ml,selectors:[["registration-step-done"]],inputs:{result:"result"},features:[b.wb],decls:3,vars:4,consts:[[3,"innerHTML"],[4,"ngIf"]],template:function(e,t){1&e&&(b.Ob(0,"p",0),b.ec(1,"trust"),b.Fc(2,Ll,5,4,"ng-container",1)),2&e&&(b.kc("innerHTML",b.fc(1,2,t.messageHtml),b.xc),b.zb(2),b.kc("ngIf",null==t.login.user&&"active"==t.result.status))},directives:[p.t],pipes:[Ut.a],encapsulation:2,changeDetection:0}),Ml);function $l(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"div",4),b.Ob(3,"registration-step-group",5),b.Sb(),b.Tb(4,"actions",6),b.Tb(5,"action-button",7),b.bc("action",(function(){return b.wc(n),b.dc().showIdentityProviders()})),b.ec(6,"async"),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.i18n.user.title.registration)("mobileHeading",i.i18n.user.mobileTitle.registration)("mode",b.fc(1,8,i.layout.ltsm$)?"fullHeight":"normal"),b.zb(3),b.kc("groupSets",i.groupSets)("groups",i.groups)("control",i.group),b.zb(2),b.kc("disabled",b.fc(6,10,i.requesting$))("label",i.i18n.general.next)}}function Gl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",10),b.bc("click",(function(){return b.wc(n),b.dc(2).backToGroup()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.Jc(" ",i.i18n.general.previous," ")}}function Bl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"div",4),b.Tb(3,"registration-step-idp",8),b.bc("continue",(function(e){return b.wc(n),b.dc().continueWithProvider(e)})),b.Sb(),b.Sb(),b.Tb(4,"actions",6),b.Ob(5,"span"),b.Fc(6,Gl,2,1,"button",9),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.i18n.user.title.registration)("mobileHeading",i.i18n.user.mobileTitle.registration)("mode",b.fc(1,5,i.layout.ltsm$)?"fullHeight":"normal"),b.zb(3),b.kc("identityProviders",i.data.identityProviders),b.zb(3),b.kc("ngIf",i.groups.length>1)}}function Jl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",10),b.bc("click",(function(){return b.wc(n),b.dc(2).backToIdentityProviders()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.Jc(" ",i.i18n.general.previous," ")}}function Vl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"div",4),b.Tb(3,"registration-step-fields",11),b.bc("imageUploaded",(function(e){return b.wc(n),b.dc().image=e}))("imageRemoved",(function(){return b.wc(n),b.dc().image=null}))("customImagesUploaded",(function(e){return b.wc(n),b.dc().addCustomImages(e)}))("customFilesUploaded",(function(e){return b.wc(n),b.dc().addCustomFiles(e)})),b.Sb(),b.Sb(),b.Tb(4,"actions",6),b.Tb(5,"action-button",7),b.bc("action",(function(){return b.wc(n),b.dc().showConfirm()})),b.ec(6,"async"),b.Sb(),b.Fc(7,Jl,2,1,"button",9),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.i18n.user.title.registration)("mobileHeading",i.i18n.user.mobileTitle.registration)("mode",b.fc(1,13,i.layout.ltsm$)?"fullHeight":"normal"),b.zb(3),b.kc("data",i.data)("form",i.form)("mobileForm",i.mobileForm)("landLineForm",i.landLineForm)("defineAddress",i.defineAddress)("addressForm",i.addressForm)("image",i.image),b.zb(2),b.kc("disabled",b.fc(6,15,i.requesting$))("label",i.i18n.general.next),b.zb(2),b.kc("ngIf",i.groups.length>1||(null==i.data.identityProviders?null:i.data.identityProviders.length)>0)}}function ql(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"div",4),b.Ob(3,"registration-step-confirm",12),b.Sb(),b.Tb(4,"actions",6),b.Tb(5,"action-button",7),b.bc("action",(function(){return b.wc(n),b.dc().register()})),b.ec(6,"async"),b.Sb(),b.Tb(7,"button",10),b.bc("click",(function(){return b.wc(n),b.dc().backToFields()})),b.Hc(8),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.i18n.user.title.registrationConfirmation)("mobileHeading",i.i18n.user.mobileTitle.registrationConfirmation)("mode",b.fc(1,12,i.layout.ltsm$)?"fullHeight":"normal"),b.zb(3),b.kc("data",i.data)("form",i.confirmForm)("user",i.userNew)("image",i.image)("customImages",i.customImages)("customFiles",i.customFiles),b.zb(2),b.kc("disabled",b.fc(6,14,i.requesting$))("label",i.i18n.general.submit),b.zb(3),b.Jc(" ",i.i18n.general.previous," ")}}function jl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",15),b.bc("click",(function(){return b.wc(n),b.dc(2).reload()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.Jc(" ",i.i18n.user.registration.registerAnotherUser," ")}}function Ql(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",15),b.bc("click",(function(){return b.wc(n),b.dc(2).viewProfile()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.Jc(" ",i.i18n.user.registration.viewProfile," ")}}function Yl(e,t){if(1&e){var n=b.Ub();b.Tb(0,"button",15),b.bc("click",(function(){return b.wc(n),b.dc(2).goToLogin()})),b.Hc(1),b.Sb()}if(2&e){var i=b.dc(2);b.zb(1),b.Jc(" ",i.i18n.menu.login," ")}}function Kl(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"div",4),b.Ob(3,"registration-step-done",13),b.ec(4,"async"),b.Sb(),b.Tb(5,"actions",6),b.Fc(6,jl,2,1,"button",14),b.Fc(7,Ql,2,1,"button",14),b.Fc(8,Yl,2,1,"button",14),b.Sb(),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.i18n.user.title.registrationDone)("mobileHeading",n.i18n.user.mobileTitle.registrationDone)("mode",b.fc(1,7,n.layout.ltsm$)?"fullHeight":"normal"),b.zb(3),b.kc("result",b.fc(4,9,n.result$)),b.zb(3),b.kc("ngIf",n.login.user),b.zb(1),b.kc("ngIf",n.login.user),b.zb(1),b.kc("ngIf",!n.login.user)}}function Xl(e,t){1&e&&(b.Tb(0,"page-content"),b.Ob(1,"spinner"),b.Sb())}var Wl,Zl=function(e){if(e.touched){var t=e.parent,n=null==t.get("securityQuestion")?"":t.get("securityQuestion").value,i=e.value;if(null!=n&&""!==n&&(null==i||""===i))return{required:!0}}return null},eu=((Wl=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r,o,c){var s;return _classCallCheck(this,n),(s=t.call(this,e)).usersService=i,s.userHelper=a,s.imagesService=r,s.addressHelper=o,s.nextRequestState=c,s.steps=["group","idp","fields","confirm","done"],s.customImages=[],s.customFiles=[],s.asyncValidatorsEnabled=!1,s.step$=new ht.a(null),s.result$=new ht.a(null),s}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this);var t=(this.login.auth||{}).role;null==t?this.initializeGroups(this.dataForUiHolder.dataForUi.publicRegistrationGroups):this.addSub(this.usersService.getUserDataForSearch({broker:t===ze.eb.BROKER?me.a.SELF:null,fields:["groupsForRegistration"]}).subscribe((function(t){e.groupSets=t.groupsForRegistration.filter((function(e){return e.kind===ze.A.GROUP_SET})),t.groupsForRegistration.find((function(e){return e.kind!==ze.A.GROUP_SET&&null==e.groupSet}))&&e.groupSets.unshift(null),e.initializeGroups(t.groupsForRegistration.filter((function(e){return e.kind!==ze.A.GROUP_SET})))})))}},{key:"initializeGroups",value:function(e){null==this.groups&&(this.groups=e,Object(J.h)(this.groups)?this.router.navigateByUrl("/"):(this.group=new q.j(e[0].id,q.G.required),1===e.length?(this.steps=this.steps.filter((function(e){return"group"!==e})),this.showIdentityProviders()):this.step="group"))}},{key:"ngOnDestroy",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this),this.image&&(URL.revokeObjectURL(this.image.url),this.errorHandler.requestWithCustomErrorHandler((function(){e.addSub(e.imagesService.deleteImage({idOrKey:e.image.id}).subscribe())})))}},{key:"showIdentityProviders",value:function(){var e=this;this.addSub(this.usersService.getUserDataForNew({group:this.group.value,fields:["-agreements.content"]}).subscribe((function(t){e.data=t,Object(J.h)(t.identityProviders)?e.showFields():e.step="idp"})))}},{key:"continueWithProvider",value:function(e){var t=this;e?this.authHelper.identityProviderPopup(e,"register",this.group.value).pipe(Object(so.a)()).subscribe((function(e){switch(e.status){case ze.B.REGISTRATION_DONE:t.nextRequestState.replaceSession(e.sessionToken).pipe(Object(so.a)()).subscribe((function(){Object(J.B)(!0),t.dataForUiHolder.initialize().subscribe((function(e){Object(J.B)(!1),me.a.isRestrictedAccess(e)||t.router.navigateByUrl("")}))}));break;case ze.B.REGISTRATION_DATA:t.identityProviderRequestId=e.requestId,t.data.captchaType=null;var n=t.data.user;if(e.name&&(n.name=e.name),e.username&&(n.username=e.username),e.email&&(n.email=e.email),e.mobilePhone&&(n.mobilePhones=[{number:e.mobilePhone}]),e.landLinePhone&&(n.landLinePhones=[{number:e.landLinePhone,extension:e.landLineExtension}]),e.customValues){n.customValues||(n.customValues={});for(var i=0,a=Object.keys(e.customValues);i<a.length;i++){var r=a[i];n.customValues[r]=e.customValues[r]}}e.image&&(n.images=[e.image.id],t.image=e.image),t.showFields();break;default:t.notification.error(e.errorMessage||t.i18n.error.general)}})):this.showFields()}},{key:"showFields",value:function(){this.prepareForms(this.data),Object(J.k)()}},{key:"backToGroup",value:function(){this.form=null,this.data=null,this.step="group"}},{key:"backToIdentityProviders",value:function(){this.data&&!Object(J.h)(this.data.identityProviders)?this.step="idp":this.backToGroup()}},{key:"backToFields",value:function(){this.confirmForm=null,this.step="fields"}},{key:"prepareForms",value:function(e){var t,n=this;this.form=this.formBuilder.group({group:this.group.value,hiddenFields:[e.user.hiddenFields||[]]}),t=_slicedToArray(this.userHelper.setupRegistrationForm(this.form,e,(function(e){return n.serverSideValidator(e)})),2),this.mobileForm=t[0],this.landLineForm=t[1];var i=e.addressConfiguration,a=i.availability;if(a!==ze.i.DISABLED){this.defineAddress=this.formBuilder.control(a===ze.i.REQUIRED),this.addressForm=this.addressHelper.addressFormGroup(i);var r=e.addressConfiguration.address;this.addressForm.patchValue(r);var o,c=_createForOfIteratorHelper(i.enabledFields);try{var s=function(){var e=o.value,t=r[e]||null;n.addSub(n.addressForm.get(e).valueChanges.subscribe((function(e){t!==e&&n.addressForm.get("location").patchValue({latitude:null,longitude:null}),t=e})))};for(c.s();!(o=c.n()).done;)s()}catch(l){c.e(l)}finally{c.f()}}else this.addressForm=null,this.defineAddress=null;this.data=e,this.step="fields"}},{key:"serverSideValidator",value:function(e){var t=this;return this.login.user?null:function(n){if(!t.asyncValidatorsEnabled)return Object(ms.a)(null);var i=n.value;return Object(J.h)(i)||!n.dirty?Object(ms.a)(null):(i instanceof Array&&(i=i.join("|")),Object(ps.a)(me.a.DEBOUNCE_TIME).pipe(Object(gs.a)((function(){return t.usersService.validateUserRegistrationField({group:t.group.value,field:e,value:i})})),Object(hs.a)((function(e){return e?{message:e}:null}))))}}},{key:"showConfirm",value:function(){var e=this,t=new q.m({user:this.form});this.mobileForm&&t.setControl("mobile",this.mobileForm),this.landLineForm&&t.setControl("landLine",this.landLineForm),this.addressForm&&this.defineAddress.value&&t.setControl("address",this.addressForm),this.asyncValidatorsEnabled=!0;var n=Object(J.F)(t,!0);this.addSub(Object(J.u)(n).subscribe((function(t){e.asyncValidatorsEnabled=!1,t?e.doShowConfirm():Object(J.l)()})))}},{key:"doShowConfirm",value:function(){var e=this.data;this.confirmForm=this.formBuilder.group({});var t=this.userHelper.passwordRegistrationForms(e);this.confirmForm.setControl("passwords",this.formBuilder.array(t)),Object(J.h)(e.securityQuestions)||(this.confirmForm.setControl("securityQuestion",this.formBuilder.control("")),this.confirmForm.setControl("securityAnswer",this.formBuilder.control("",Zl))),Object(J.h)(e.agreements)||this.confirmForm.setControl("acceptAgreements",this.formBuilder.control([])),null!=e.captchaType&&this.confirmForm.setControl("captcha",this.authHelper.captchaFormGroup()),this.step="confirm",Object(J.y)()}},{key:"register",value:function(){var e=this,t=Object(J.F)(this.confirmForm,!0);this.addSub(Object(J.u)(t).subscribe((function(t){t?e.addSub(e.usersService.createUser({body:e.userNew}).subscribe((function(t){e.result=t,e.image=null,e.step="done"}))):Object(J.l)()})))}},{key:"goToLogin",value:function(){this.login.goToLoginPage("")}},{key:"viewProfile",value:function(){var e=this.result;e&&this.router.navigate(["users",e.user.id,"profile"])}},{key:"addCustomImages",value:function(e){this.customImages=[].concat(_toConsumableArray(this.customImages),_toConsumableArray(e))}},{key:"addCustomFiles",value:function(e){this.customFiles=[].concat(_toConsumableArray(this.customFiles),_toConsumableArray(e))}},{key:"resolveMenu",value:function(){switch(this.dataForUiHolder.role){case ze.eb.ADMINISTRATOR:return d.b.ADMIN_REGISTRATION;case ze.eb.BROKER:return d.b.BROKER_REGISTRATION;default:return d.b.PUBLIC_REGISTRATION}}},{key:"step",get:function(){return this.step$.value},set:function(e){this.step$.next(e)}},{key:"result",get:function(){return this.result$.value},set:function(e){this.result$.next(e)}},{key:"userNew",get:function(){var e=this.form.value;e.identityProviderRequestId=this.identityProviderRequestId;var t=(this.mobileForm||{}).value,n=(this.landLineForm||{}).value,i=(this.addressForm||{}).value;return this.image&&(e.images=[this.image.id]),t&&!Object(J.a)(t.number)&&(e.mobilePhones=[t]),n&&!Object(J.a)(n.number)&&(e.landLinePhones=[n]),i&&this.defineAddress.value&&(e.addresses=[i]),Object(J.e)(this.confirmForm.value,e),e}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||Wl)(b.Nb(b.r),b.Nb(c.K),b.Nb(s.a),b.Nb(c.p),b.Nb(no.a),b.Nb(fs.a))},Wl.\u0275cmp=b.Hb({type:Wl,selectors:[["user-registration"]],features:[b.wb],decls:9,vars:11,consts:[["size","large",3,"ready","ngSwitch"],["last","",3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchDefault"],["last","",3,"heading","mobileHeading","mode"],[1,"flex-grow-1"],[3,"groupSets","groups","control"],["forceRow",""],[3,"disabled","label","action"],[3,"identityProviders","continue"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary",3,"click"],[3,"data","form","mobileForm","landLineForm","defineAddress","addressForm","image","imageUploaded","imageRemoved","customImagesUploaded","customFilesUploaded"],[3,"data","form","user","image","customImages","customFiles"],[3,"result"],["class","btn btn-primary",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.ec(2,"async"),b.Fc(3,$l,7,12,"page-content",1),b.Fc(4,Bl,7,7,"page-content",1),b.Fc(5,Vl,8,17,"page-content",1),b.Fc(6,ql,9,16,"page-content",1),b.Fc(7,Kl,9,11,"page-content",1),b.Fc(8,Xl,2,0,"page-content",2),b.Sb()),2&e&&(b.kc("ready",b.fc(1,7,t.step$))("ngSwitch",b.fc(2,9,t.step$)),b.zb(3),b.kc("ngSwitchCase","group"),b.zb(1),b.kc("ngSwitchCase","idp"),b.zb(1),b.kc("ngSwitchCase","fields"),b.zb(1),b.kc("ngSwitchCase","confirm"),b.zb(1),b.kc("ngSwitchCase","done"))},directives:[m.a,p.x,p.y,p.z,g.a,_s,Q.a,Y.a,Hs,p.t,ul,xl,Ul,ho.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Wl);function tu(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content"),b.Ob(1,"registration-step-done",2),b.Tb(2,"actions"),b.Tb(3,"button",3),b.bc("click",(function(){return b.wc(n),b.dc().goToLogin()})),b.Hc(4),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=b.dc();b.zb(1),b.kc("result",i.result),b.zb(3),b.Jc(" ",i.i18n.menu.login," ")}}var nu,iu,au=((nu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i){var a;return _classCallCheck(this,n),(a=t.call(this,e)).validationService=i,a}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.addSub(this.validationService.validateUserRegistration({key:this.route.snapshot.params.key}).subscribe((function(t){e.data=t})))}},{key:"goToLogin",value:function(){this.login.goToLoginPage("")}},{key:"resolveMenu",value:function(){return this.authHelper.homeMenu()}},{key:"result",get:function(){return this.data}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||nu)(b.Nb(b.r),b.Nb(c.L))},nu.\u0275cmp=b.Hb({type:nu,selectors:[["validate-registration"]],features:[b.wb],decls:3,vars:4,consts:[["size","medium","hideMenu","",3,"ready"],[4,"ngIf"],[3,"result"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,tu,5,2,"page-content",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,Ul,Q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),nu),ru=["field"],ou=function(){return{excludeContacts:!0}},cu=((iu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).modalRef=i,r.contactsService=a,r.done=new b.n,r.control=new q.j(null,q.G.required),r}return _createClass(n,[{key:"addContact",value:function(){var e=this;if(Object(J.F)(this.control),this.control.valid){var t=this.field.selection;this.addSub(this.contactsService.createContact({user:me.a.SELF,body:{contact:this.control.value}}).subscribe((function(){e.done.emit(t),e.modalRef.hide()})))}}}]),n}(tr.a)).\u0275fac=function(e){return new(e||iu)(b.Nb(b.r),b.Nb(f.a),b.Nb(c.i))},iu.\u0275cmp=b.Hb({type:iu,selectors:[["add-contact-dialog"]],viewQuery:function(e,t){var n;1&e&&b.Cc(ru,!0),2&e&&b.tc(n=b.cc())&&(t.field=n.first)},outputs:{done:"done"},features:[b.wb],decls:10,vars:12,consts:[["focused","",3,"filters","allowContacts","allowPrincipal","formControl","label"],["field",""],["forceRow",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-outline-primary",3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"h1"),b.Hc(1),b.Sb(),b.Ob(2,"user-field",0,1),b.Tb(4,"actions",2),b.Tb(5,"button",3),b.bc("click",(function(){return t.addContact()})),b.ec(6,"async"),b.Hc(7),b.Sb(),b.Tb(8,"button",4),b.bc("click",(function(){return t.modalRef.hide()})),b.Hc(9),b.Sb(),b.Sb()),2&e&&(b.zb(1),b.Ic(t.i18n.user.title.addContact),b.zb(1),b.kc("filters",b.mc(11,ou))("allowContacts",!1)("allowPrincipal",!1)("formControl",t.control)("label",t.i18n.user.contact),b.zb(3),b.kc("disabled",b.fc(6,9,t.requesting$)),b.zb(2),b.Jc(" ",t.i18n.general.submit," "),b.zb(2),b.Jc(" ",t.i18n.general.cancel," "))},directives:[ye.a,Mt.a,q.v,q.k,Q.a],pipes:[p.b],encapsulation:2,changeDetection:0}),iu),su=n("PzFp"),lu=["usersResults"];function uu(e,t){1&e&&b.Pb(0)}var du=function(e){return{"d-none":e}};function bu(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.ec(2,"async"),b.Tb(3,"div",4),b.Ob(4,"result-type-field",5),b.ec(5,"async"),b.Sb(),b.Sb(),b.Tb(6,"users-results",6,7),b.bc("update",(function(e){return b.wc(n),b.dc().update(e)})),b.ec(8,"async"),b.ec(9,"async"),b.ec(10,"async"),b.ec(11,"async"),b.Sb()}if(2&e){var i=b.dc();b.kc("ngClass",b.nc(25,du,b.fc(1,11,i.layout.xxs$)))("heading",i.i18n.user.title.contactList)("mobileHeading",i.i18n.user.mobileTitle.contactList)("headingActions",b.fc(2,13,i.headingActions$)),b.zb(4),b.kc("formControl",i.resultTypeControl)("allowedResultTypes",b.fc(5,15,i.allowedResultTypes$)),b.zb(2),b.kc("ngClass",b.nc(27,du,b.fc(8,17,i.rendering$)))("results",b.fc(9,19,i.results$))("rendering$",i.rendering$)("data",b.fc(10,21,i.data$))("resultType",b.fc(11,23,i.resultType$))}}var fu,mu=((fu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).modal=i,r.contactsService=a,r.ResultType=er.a,r}return _createClass(n,[{key:"getFormControlNames",value:function(){return["user","keywords"]}},{key:"getInitialResultType",value:function(){return this.layout.xxs?er.a.LIST:er.a.TILES}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.allowedResultTypes=[er.a.TILES,er.a.LIST],this.stateManager.cache("data",this.contactsService.getContactListDataForSearch({user:me.a.SELF})).subscribe((function(t){e.data=t}))}},{key:"toSearchParams",value:function(e){return e.user=me.a.SELF,e}},{key:"doSearch",value:function(e){return this.contactsService.searchContactList$Response(e)}},{key:"onDataInitialized",value:function(e){var t=this;_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e);var i=(e.fieldsInList||[]).slice();i.includes("display")||(i.unshift("display"),e.fieldsInList=i),(((this.login.auth||{}).permissions||{}).users||{}).search&&(this.headingActions=[new B.c("add",this.i18n.general.addNew,(function(){return t.addNew()}),!0)])}},{key:"addNew",value:function(){var e=this,t=this.modal.show(cu,{class:"modal-form"});this.addSub(t.content.done.subscribe((function(t){e.notification.snackBar(e.i18n.user.profile.addContactDone(t.display)),e.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.userMenu(e.user,d.b.CONTACTS)}}]),n}(pe.a)).\u0275fac=function(e){return new(e||fu)(b.Nb(b.r),b.Nb(f.b),b.Nb(c.i))},fu.\u0275cmp=b.Hb({type:fu,selectors:[["contact-list"]],viewQuery:function(e,t){var n;1&e&&b.Lc(lu,!0),2&e&&b.tc(n=b.cc())&&(t.usersResults=n.first)},features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"ngClass","heading","mobileHeading","headingActions"],[1,"filters-row"],[3,"formControl","allowedResultTypes"],["resultKind","contact",3,"ngClass","results","rendering$","data","resultType","update"],["usersResults",""]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,uu,1,0,"ng-container",1),b.Sb(),b.Fc(3,bu,12,29,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,p.q,su.a,q.v,q.k,Fr],pipes:[p.b],encapsulation:2,changeDetection:0}),fu),pu=n("z3FF"),gu=n("fe3a"),hu=n("uao2");function vu(e,t){1&e&&b.Pb(0)}function yu(e,t){if(1&e&&(b.Tb(0,"div",14),b.Tb(1,"label-value",15),b.Ob(2,"user-link",16),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",n.broker)}}function ku(e,t){1&e&&b.Ob(0,"div",17)}function Su(e,t){if(1&e&&(b.Tb(0,"div",14),b.Ob(1,"input-field",18),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.general.keywords)}}function Tu(e,t){if(1&e&&b.Ob(0,"field-option",21),2&e){var n=t.$implicit,i=b.dc(4);b.kc("value",i.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function Iu(e,t){if(1&e&&(b.Tb(0,"div",14),b.Tb(1,"multi-selection-field",19),b.Fc(2,Tu,1,5,"field-option",20),b.Sb(),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.kc("label",n.i18n.user.groupFilter),b.zb(1),b.kc("ngForOf",n.data.groups)}}function Cu(e,t){if(1&e&&(b.Tb(0,"div",14),b.Ob(1,"max-distance-field",22),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.kc("data",n.data.searchByDistanceData)("label",n.i18n.general.distanceFilter)}}function Ou(e,t){if(1&e&&(b.Tb(0,"div",14),b.Ob(1,"basic-profile-field-filter",24),b.Sb()),2&e){var n=t.$implicit,i=b.dc(4);b.zb(1),b.kc("field",n)("formControl",i.form.get("profileFields").get(n.field))}}function Fu(e,t){if(1&e&&(b.Tb(0,"div",14),b.Ob(1,"custom-field-filter",24),b.Sb()),2&e){var n=t.$implicit,i=b.dc(4);b.zb(1),b.kc("field",n)("formControl",i.form.get("profileFields").get(n.internalName))}}function zu(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Ou,2,2,"div",23),b.Fc(2,Fu,2,2,"div",23),b.Qb()),2&e){var n=b.dc(3);b.zb(1),b.kc("ngForOf",n.data.basicFields),b.zb(1),b.kc("ngForOf",n.customFieldsInSearch)}}function Au(e,t){if(1&e&&(b.Rb(0),b.Fc(1,Iu,3,2,"div",6),b.Fc(2,Cu,2,2,"div",6),b.Fc(3,zu,3,2,"ng-container",8),b.ec(4,"async"),b.Qb()),2&e){var n=b.dc(2);b.zb(1),b.kc("ngIf",(null==n.data.groups?null:n.data.groups.length)>1),b.zb(1),b.kc("ngIf",n.data.searchByDistanceData),b.zb(1),b.kc("ngIf",b.fc(4,3,n.moreFilters$))}}function wu(e,t){if(1&e&&(b.Tb(0,"div",25),b.Tb(1,"single-selection-field",26),b.Ob(2,"field-option",27),b.Ob(3,"field-option",28),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("formControl",n.form.get("orderBy"))("display",n.i18n.general.orderBy)("emptyOption",n.i18n.general.orderByRelevance),b.zb(1),b.kc("text",n.i18n.user.orderBy.alphabeticallyAsc),b.zb(1),b.kc("text",n.i18n.user.orderBy.alphabeticallyDesc)}}function Eu(e,t){if(1&e){var n=b.Ub();b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"form",4),b.Tb(3,"div",5),b.Fc(4,yu,3,2,"div",6),b.Fc(5,ku,1,0,"div",7),b.ec(6,"async"),b.Fc(7,Su,2,1,"div",6),b.Fc(8,Au,5,5,"ng-container",8),b.ec(9,"async"),b.Sb(),b.Sb(),b.Tb(10,"div",9),b.Tb(11,"div",10),b.Ob(12,"result-type-field",11),b.ec(13,"async"),b.Sb(),b.Fc(14,wu,4,5,"div",12),b.ec(15,"async"),b.ec(16,"async"),b.Sb(),b.Sb(),b.Tb(17,"users-results",13),b.bc("update",(function(e){return b.wc(n),b.dc().update(e)})),b.ec(18,"async"),b.ec(19,"async"),b.ec(20,"async"),b.ec(21,"async"),b.Sb()}if(2&e){var i=b.dc();b.kc("heading",i.heading)("mobileHeading",i.mobileHeading)("headingActions",b.fc(1,16,i.headingActions$)),b.zb(2),b.kc("formGroup",i.form),b.zb(2),b.kc("ngIf",!i.self&&i.broker),b.zb(1),b.kc("ngIf",b.fc(6,18,i.layout.gtsm$)&&!i.self&&i.broker),b.zb(2),b.kc("ngIf",i.data.allowKeywords),b.zb(1),b.kc("ngIf",b.fc(9,20,i.layout.gtxxs$)),b.zb(4),b.kc("allowedResultTypes",b.fc(13,22,i.allowedResultTypes$))("formControl",i.resultTypeControl),b.zb(2),b.kc("ngIf",b.fc(15,24,i.layout.gtxxs$)&&"map"!==b.fc(16,26,i.resultType$)),b.zb(3),b.kc("results",b.fc(18,28,i.results$))("rendering$",i.rendering$)("data",b.fc(19,30,i.data$))("resultType",b.fc(20,32,i.resultType$))("referencePoint",(b.fc(21,34,i.form.valueChanges)||i.form.value).distanceFilter)}}var _u,Nu=function(e){return e[e.Public=0]="Public",e[e.Member=1]="Member",e[e.Admin=2]="Admin",e[e.Broker=3]="Broker",e}({}),Ru=((_u=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).usersService=i,r.countriesResolve=a,r.ResultType=er.a,r.UserSearchKind=Nu,r.empty=J.h,r}return _createClass(n,[{key:"getFormControlNames",value:function(){return["keywords","groups","customValues","distanceFilter","orderBy"]}},{key:"getInitialResultType",value:function(){var e=this.layout.getBreakpointConfiguration("defaultUsersResultType");return e&&this.allowedResultTypes.includes(e)?e:this.layout.xxs?er.a.LIST:er.a.TILES}},{key:"ngOnInit",value:function(){_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user||me.a.SELF,this.self=this.authHelper.isSelf(this.param);var e=this.login.auth,t=null==e?null:e.role,i=this.router.url;i.includes("search")?this.kind=null==t?Nu.Public:t===ze.eb.ADMINISTRATOR?Nu.Admin:Nu.Member:i.includes("brokerings")&&(this.kind=Nu.Broker),this.manager=[Nu.Admin,Nu.Broker].includes(this.kind);var a=[Nu.Public,Nu.Member].includes(this.kind);a?(this.heading=this.i18n.user.title.directory,this.mobileHeading=this.i18n.user.mobileTitle.directory):this.kind===Nu.Broker?this.self?(this.heading=this.i18n.user.title.myBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.myBrokerings):(this.heading=this.i18n.user.title.userBrokerings,this.mobileHeading=this.i18n.user.mobileTitle.userBrokerings):this.kind===Nu.Admin&&(this.heading=this.i18n.user.title.search,this.mobileHeading=this.i18n.user.mobileTitle.search);var r=((e||{}).permissions||{}).users||{};if(this.canSearch=this.kind===Nu.Broker||!!r.search,this.canViewMap=a&&r.map,this.canSearch||this.canViewMap){var o=[];this.canSearch&&(o.push(er.a.TILES),o.push(er.a.LIST)),(this.canViewMap||this.manager)&&o.push(er.a.MAP),this.allowedResultTypes=o,this.countries$=this.countriesResolve.data,this.resultType=this.getInitialResultType(),this.onResultTypeChanged(this.resultType,null)}else this.errorHandler.handleForbiddenError({})}},{key:"shouldUpdateOnResultTypeChange",value:function(){return!1}},{key:"onResultTypeChanged",value:function(e,t){var n=this,i=e===er.a.MAP;(i!==(t===er.a.MAP)||null==t)&&(this.data=null,this.resetPage());var a=function(e){Object(J.h)(e.fieldsInList)&&(e.fieldsInList=["display"]),n.doIgnoringUpdate((function(){n.customFieldsInSearch=e.customFields.filter((function(t){return e.fieldsInSearch.includes(t.internalName)})),n.form.setControl("profileFields",n.fieldHelper.profileFieldsForSearchFormGroup(e.basicFields,n.customFieldsInSearch)),!n.broker&&e.broker&&(n.broker=e.broker),n.data=e,n.headingActions=[].concat(_toConsumableArray(Object(J.h)(e.fieldsInSearch)?[]:[n.moreFiltersAction]),_toConsumableArray(n.exportHelper.headingActions(n.data.exportFormats,(function(e){return n.usersService.exportUsers$Response(Object.assign({format:e.internalName},n.toSearchParams(n.form.value)))}))))}))};null==this.data&&(this.rendering=!0,i&&!this.manager?this.stateManager.cache("dataForMap",this.usersService.getDataForMapDirectory()).subscribe(a):this.stateManager.cache("dataForSearch",this.usersService.getUserDataForSearch({fromMenu:!0,broker:this.kind===Nu.Broker?this.param:null})).subscribe(a))}},{key:"toSearchParams",value:function(e){var t=Object.assign({},e);this.kind===Nu.Broker&&(t.brokers=[this.param]),t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields);var n=e.distanceFilter;n&&(t.maxDistance=n.maxDistance,t.latitude=n.latitude,t.longitude=n.longitude);var i=this.resultType===er.a.MAP;return t.fromMenu=this.kind!==Nu.Broker,i&&(t.pageSize=99999,t.addressResult=ze.wb.ALL),t}},{key:"doSearch",value:function(e){return this.resultType!==er.a.MAP||this.manager?this.usersService.searchUsers$Response(e):this.usersService.searchMapDirectory$Response(e)}},{key:"resolveMenu",value:function(){switch(this.kind){case Nu.Broker:return d.b.MY_BROKERED_USERS;case Nu.Public:return d.b.PUBLIC_DIRECTORY;default:return d.b.SEARCH_USERS}}}]),n}(pe.a)).\u0275fac=function(e){return new(e||_u)(b.Nb(b.r),b.Nb(c.K),b.Nb(r.a))},_u.\u0275cmp=b.Hb({type:_u,selectors:[["search-users"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],["class","col-md-6",4,"ngIf"],[4,"ngIf"],[1,"row","filters-row"],[1,"col-12","col-xs-7","col-md-9"],[3,"allowedResultTypes","formControl"],["class","col-12 col-xs-5 col-md-3",4,"ngIf"],[3,"results","rendering$","data","resultType","referencePoint","update"],[1,"col-12","col-md-6"],["labelPosition","side",3,"label"],[3,"user"],[1,"col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side",3,"field","formControl"],[1,"col-12","col-xs-5","col-md-3"],[3,"formControl","display","emptyOption"],["value","alphabeticallyAsc",3,"text"],["value","alphabeticallyDesc",3,"text"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,vu,1,0,"ng-container",1),b.Sb(),b.Fc(3,Eu,22,36,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,q.I,q.w,q.n,su.a,q.v,q.k,Fr,j.a,vt.a,yt.a,q.l,nt.a,p.s,ve.a,pu.a,gu.a,hu.a,he.a],pipes:[p.b],encapsulation:2,changeDetection:0}),_u),Pu=n("XS/k");function Du(e,t){1&e&&b.Pb(0)}function Hu(e,t){if(1&e&&(b.Tb(0,"div",11),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(2);b.zb(1),b.Kc(" ",i.i18n.general.performedBy,": ",n.by.display," ")}}function xu(e,t){if(1&e&&(b.Tb(0,"mobile-result",8),b.Tb(1,"div",9),b.Hc(2),b.Sb(),b.Fc(3,Hu,2,2,"div",10),b.Sb()),2&e){var n=t.$implicit,i=b.dc(2);b.kc("date",null==n.period?null:n.period.date),b.zb(2),b.Kc(" ",i.i18n.general.status,": ",i.userHelper.userStatus(n.status)," "),b.zb(1),b.kc("ngIf",n.by)}}function Lu(e,t){if(1&e&&(b.Tb(0,"tr"),b.Tb(1,"td"),b.Hc(2),b.ec(3,"date"),b.Sb(),b.Tb(4,"td"),b.Hc(5),b.Sb(),b.Tb(6,"td"),b.Hc(7),b.Sb(),b.Sb()),2&e){var n=t.$implicit,i=b.dc(3);b.zb(2),b.Ic(b.fc(3,3,null==n.period?null:n.period.begin)),b.zb(3),b.Ic(i.userHelper.userStatus(n.status)),b.zb(2),b.Ic(null==n.by?null:n.by.display)}}function Mu(e,t){if(1&e&&(b.Tb(0,"table",12),b.Tb(1,"thead"),b.Tb(2,"th"),b.Hc(3),b.Sb(),b.Tb(4,"th"),b.Hc(5),b.Sb(),b.Tb(6,"th"),b.Hc(7),b.Sb(),b.Sb(),b.Tb(8,"tbody"),b.Fc(9,Lu,8,5,"tr",13),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(3),b.Ic(n.i18n.general.date),b.zb(2),b.Ic(n.i18n.general.status),b.zb(2),b.Ic(n.i18n.general.performedBy),b.zb(2),b.kc("ngForOf",n.data.history)}}function Uu(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.Ob(1,"user-info",4),b.Sb(),b.Tb(2,"results-layout",5),b.Fc(3,xu,4,4,"mobile-result",6),b.Fc(4,Mu,10,4,"table",7),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.operator?n.i18n.userStatus.title.historyOperator:n.i18n.userStatus.title.historyUser)("mobileHeading",n.operator?n.i18n.userStatus.mobileTitle.historyOperator:n.i18n.userStatus.mobileTitle.historyUser),b.zb(1),b.kc("user",n.data.user),b.zb(1),b.kc("results",n.data.history)}}var $u,Gu=(($u=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).userStatusService=i,r.userHelper=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["user","history"]}).subscribe((function(t){e.data=t})))}},{key:"resolveMenu",value:function(e){return this.authHelper.searchUsersMenu(e.user)}},{key:"operator",get:function(){return this.userHelper.isOperator(this.data.user)}}]),n}(u.a)).\u0275fac=function(e){return new(e||$u)(b.Nb(b.r),b.Nb(Pu.a),b.Nb(s.a))},$u.\u0275cmp=b.Hb({type:$u,selectors:[["view-user-status-history"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"user"],[3,"results"],[3,"date",4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"date"],[1,"cell-main"],["class","cell-text",4,"ngIf"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Du,1,0,"ng-container",1),b.Sb(),b.Fc(3,Uu,5,4,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,k.a,h.a,v.a,y.a,S.a,p.s],pipes:[p.b,C.a],encapsulation:2,changeDetection:0}),$u);function Bu(e,t){if(1&e&&b.Ob(0,"field-option",11),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",n)("text",i.userHelper.userStatus(n))}}function Ju(e,t){if(1&e){var n=b.Ub();b.Rb(0),b.Ob(1,"hr"),b.Tb(2,"form",6),b.Tb(3,"single-selection-field",7),b.Fc(4,Bu,1,2,"field-option",8),b.Sb(),b.Ob(5,"textarea-field",9),b.Sb(),b.Tb(6,"actions"),b.Tb(7,"button",10),b.bc("click",(function(){return b.wc(n),b.dc(2).save()})),b.Hc(8),b.Sb(),b.Sb(),b.Qb()}if(2&e){var i=b.dc(2);b.zb(2),b.kc("formGroup",i.form),b.zb(1),b.kc("label",i.i18n.userStatus.new),b.zb(1),b.kc("ngForOf",i.data.possibleNewStatuses),b.zb(1),b.kc("label",i.i18n.general.comments),b.zb(3),b.Ic(i.i18n.general.submit)}}function Vu(e,t){if(1&e&&(b.Tb(0,"page-content",2),b.ec(1,"async"),b.Ob(2,"user-info",3),b.Tb(3,"label-value",4),b.Hc(4),b.Sb(),b.Fc(5,Ju,9,5,"ng-container",5),b.Sb()),2&e){var n=b.dc();b.kc("heading",n.operator?n.i18n.userStatus.title.statusOperator:n.i18n.userStatus.title.statusUser)("mobileHeading",n.operator?n.i18n.userStatus.mobileTitle.statusOperator:n.i18n.userStatus.mobileTitle.statusUser)("headingActions",b.fc(1,7,n.headingActions$)),b.zb(2),b.kc("user",n.data.user),b.zb(1),b.kc("label",n.i18n.userStatus.current),b.zb(1),b.Jc(" ",n.userHelper.userStatus(n.data.status)," "),b.zb(1),b.kc("ngIf",n.editable)}}var qu,ju=((qu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a){var r;return _classCallCheck(this,n),(r=t.call(this,e)).userStatusService=i,r.userHelper=a,r}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.user,this.addSub(this.userStatusService.getUserStatus({user:this.param,fields:["-history"]}).subscribe((function(t){e.data=t}))),this.form=this.formBuilder.group({status:[null,q.G.required],comment:null}),this.headingActions=[new B.c("history",this.i18n.general.viewHistory,(function(){return e.router.navigate(["users",e.param,"status","history"])}),!0)]}},{key:"save",value:function(){var e=this;if(Object(J.F)(this.form),this.form.valid){var t,n,i=this.form.value.status,a=this.data.user,r=this.userHelper.isOperator(a);switch(i){case ze.Fb.ACTIVE:t=this.i18n.userStatus.confirm.active(a.display);break;case ze.Fb.BLOCKED:t=this.i18n.userStatus.confirm.blocked(a.display);break;case ze.Fb.DISABLED:t=this.i18n.userStatus.confirm.disabled(a.display);break;case ze.Fb.REMOVED:t=this.i18n.userStatus.confirm.removed(a.display);break;case ze.Fb.PURGED:t=this.i18n.userStatus.confirm.purged(a.display)}n=r?this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeOperator:this.i18n.userStatus.title.changeOperator:this.layout.ltsm?this.i18n.userStatus.mobileTitle.changeUser:this.i18n.userStatus.title.changeUser,this.notification.confirm({title:n,message:t,callback:function(){return e.submit(i)}})}}},{key:"submit",value:function(e){var t=this,n=this.data.user.display;this.addSub(this.userStatusService.changeUserStatus({user:this.param,body:this.form.value}).subscribe((function(){var i;switch(e){case ze.Fb.ACTIVE:i=t.i18n.userStatus.done.active(n);break;case ze.Fb.BLOCKED:i=t.i18n.userStatus.done.blocked(n);break;case ze.Fb.DISABLED:i=t.i18n.userStatus.done.disabled(n);break;case ze.Fb.REMOVED:i=t.i18n.userStatus.done.removed(n);break;case ze.Fb.PURGED:i=t.i18n.userStatus.done.purged(n)}t.notification.snackBar(i),t.reload()})))}},{key:"resolveMenu",value:function(e){return this.authHelper.searchUsersMenu(e.user)}},{key:"editable",get:function(){return!Object(J.h)(this.data.possibleNewStatuses)}},{key:"operator",get:function(){return this.userHelper.isOperator(this.data.user)}}]),n}(u.a)).\u0275fac=function(e){return new(e||qu)(b.Nb(b.r),b.Nb(Pu.a),b.Nb(s.a))},qu.\u0275cmp=b.Hb({type:qu,selectors:[["view-user-status"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading","headingActions",4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"user"],[3,"label"],[4,"ngIf"],[3,"formGroup"],["formControlName","status","required","",3,"label"],[3,"value","text",4,"ngFor","ngForOf"],["formControlName","comment",3,"label"],[1,"btn","btn-primary",3,"click"],[3,"value","text"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,Vu,6,9,"page-content",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,k.a,j.a,q.I,q.w,q.n,he.a,q.v,q.l,q.D,p.s,kt.a,Q.a,ve.a],pipes:[p.b],encapsulation:2,changeDetection:0}),qu),Qu=n("Aw04");function Yu(e,t){if(1&e&&(b.Tb(0,"label-value",10),b.Hc(1),b.Sb()),2&e){var n=b.dc();b.kc("label",n.i18n.general.user),b.zb(1),b.Jc(" ",n.user.display," ")}}function Ku(e,t){if(1&e&&b.Ob(0,"user-field",11),2&e){var n=b.dc();b.kc("label",n.i18n.general.user)}}function Xu(e,t){if(1&e&&b.Ob(0,"field-option",14),2&e){var n=t.$implicit;b.kc("value",n.id)("text",n.name)}}function Wu(e,t){if(1&e&&(b.Tb(0,"single-selection-field",12),b.Fc(1,Xu,1,2,"field-option",13),b.ec(2,"async"),b.Sb()),2&e){var n=b.dc();b.kc("label",n.i18n.general.operator)("emptyOption",n.i18n.general.notSet),b.zb(1),b.kc("ngForOf",b.fc(2,3,n.operators$))}}function Zu(e,t){if(1&e&&b.Ob(0,"boolean-field",15),2&e){var n=b.dc();b.kc("label",n.i18n.token.action.activate)}}function ed(e,t){1&e&&b.Hc(0,"\xa0")}var td,nd=((td=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).modalRef=i,o.tokensService=a,o.operatorsService=r,o.operators$=new ht.a(null),o.canActivate$=new ht.a(!!o.user),o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.form=this.formBuilder.group({user:this.user?this.user.id:null,operator:null,value:[null,q.G.required],activateNow:!1}),this.user||this.form.get("user").valueChanges.subscribe((function(){return e.fillOperatorsField()}))}},{key:"fillOperatorsField",value:function(){var e=this,t=this.form.get("user").value;t?(this.canActivate$.next(!0),this.operatorsService.searchUserOperators$Response({user:t,skipTotalCount:!0,pageSize:9999999}).subscribe((function(t){var n;t.ok&&(null===(n=t.body)||void 0===n?void 0:n.length)>0?e.operators$.next(t.body):e.operators$.next(null)}))):(this.canActivate$.next(!1),this.operators$.next(null))}},{key:"submit",value:function(){var e=this;if(Object(J.F)(this.form),this.form.valid){var t=Object(gt.cloneDeep)(this.form.value);t.operator&&(t.user=t.operator,delete t.operator),this.tokensService.createToken({type:this.type.id,body:t}).subscribe((function(){e.notification.snackBar(e.i18n.token.action.done.created),e.updateAction()})),this.modalRef.hide()}}}]),n}(tr.a)).\u0275fac=function(e){return new(e||td)(b.Nb(b.r),b.Nb(f.a),b.Nb(c.G),b.Nb(c.w))},td.\u0275cmp=b.Hb({type:td,selectors:[["create-token"]],inputs:{type:"type",user:"user",required:"required",updateAction:"updateAction"},features:[b.wb],decls:16,vars:18,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],["formControlName","user",3,"label",4,"ngIf"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["required","","formControlName","value",3,"mask","label","placeholder"],["formControlName","activateNow",3,"label",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["kind","fieldView","labelPosition","side",3,"label"],["formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"],["formControlName","activateNow",3,"label"]],template:function(e,t){if(1&e&&(b.Tb(0,"h1"),b.Hc(1),b.Sb(),b.Tb(2,"form",0),b.Fc(3,Yu,2,2,"label-value",1),b.Fc(4,Ku,1,1,"user-field",2),b.Fc(5,Wu,3,5,"single-selection-field",3),b.ec(6,"async"),b.Ob(7,"input-field",4),b.Fc(8,Zu,1,1,"boolean-field",5),b.ec(9,"async"),b.Tb(10,"actions",6),b.Tb(11,"action-button",7),b.bc("action",(function(){return t.submit()})),b.ec(12,"async"),b.Sb(),b.Fc(13,ed,1,0,"ng-template",null,8,b.Gc),b.Tb(15,"action-button",9),b.bc("action",(function(){return t.modalRef.hide()})),b.Sb(),b.Sb(),b.Sb()),2&e){var n,i=(null==(n=b.fc(6,12,t.operators$))?null:n.length)>0;b.zb(1),b.Ic(t.i18n.token.title.new(t.type.name)),b.zb(1),b.kc("formGroup",t.form),b.zb(1),b.kc("ngIf",t.user),b.zb(1),b.kc("ngIf",!t.user),b.zb(1),b.kc("ngIf",i),b.zb(2),b.kc("mask",t.type.mask)("label",t.i18n.token.value)("placeholder",t.type.mask?t.type.mask:""),b.zb(1),b.kc("ngIf",b.fc(9,14,t.canActivate$)),b.zb(3),b.kc("label",t.i18n.general.submit)("disabled",b.fc(12,16,t.requesting$)),b.zb(4),b.kc("label",t.i18n.general.cancel)}},directives:[q.I,q.w,q.n,p.t,yt.a,q.D,q.v,q.l,Qu.a,Q.a,Y.a,j.a,ye.a,he.a,p.s,ve.a,we.a],pipes:[p.b],encapsulation:2,changeDetection:0}),td);function id(e,t){if(1&e&&b.Ob(0,"user-info",7),2&e){var n=b.dc(2);b.kc("user",n.data.user)}}function ad(e,t){if(1&e&&(b.Tb(0,"label-value",10),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit,i=b.dc(2);b.kc("label",i.i18n.general.operator),b.zb(1),b.Jc(" ",null!=n.user&&n.user.user?n.user.display:""," ")}}function rd(e,t){if(1&e){var n=b.Ub();b.Tb(0,"mobile-result"),b.Tb(1,"div",8),b.Tb(2,"div"),b.Fc(3,ad,2,2,"label-value",9),b.Tb(4,"label-value",10),b.Hc(5),b.Sb(),b.Tb(6,"label-value",10),b.Hc(7),b.ec(8,"date"),b.Sb(),b.Tb(9,"label-value",10),b.Hc(10),b.ec(11,"date"),b.Sb(),b.Tb(12,"label-value",10),b.Hc(13),b.ec(14,"date"),b.Sb(),b.Tb(15,"label-value",10),b.Hc(16),b.Sb(),b.Sb(),b.Tb(17,"div",11),b.Tb(18,"button",12),b.bc("click",(function(e){b.wc(n);var i=t.$implicit,a=b.dc(2);return a.router.navigate(a.view(i)),e.stopPropagation(),e.preventDefault()})),b.Ob(19,"icon",13),b.Sb(),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc(2);b.zb(3),b.kc("ngIf",!a.self),b.zb(1),b.kc("label",a.isNfc()?a.i18n.token.label:a.i18n.token.value),b.zb(1),b.Jc(" ",i.value," "),b.zb(1),b.kc("label",a.i18n.token.creationDate),b.zb(1),b.Jc(" ",b.fc(8,12,i.creationDate)," "),b.zb(2),b.kc("label",a.i18n.token.activationDate),b.zb(1),b.Jc(" ",b.fc(11,14,i.activationDate)," "),b.zb(2),b.kc("label",a.i18n.token.expiryDate),b.zb(1),b.Jc(" ",b.fc(14,16,i.expiryDate)," "),b.zb(2),b.kc("label",a.i18n.general.status),b.zb(1),b.Jc(" ",a.statusDisplay(i.status)," "),b.zb(2),b.kc("tooltip",a.i18n.general.view)}}function od(e,t){if(1&e&&(b.Tb(0,"th"),b.Hc(1),b.Sb()),2&e){var n=b.dc(3);b.zb(1),b.Ic(n.i18n.general.operator)}}function cd(e,t){if(1&e&&(b.Tb(0,"td"),b.Hc(1),b.Sb()),2&e){var n=b.dc().$implicit;b.zb(1),b.Jc("",null!=n.user&&n.user.user?n.user.display:""," ")}}function sd(e,t){if(1&e){var n=b.Ub();b.Tb(0,"tr",16),b.bc("click",(function(e){b.wc(n);var i=t.$implicit,a=b.dc(3);return a.router.navigate(a.view(i)),e.stopPropagation(),e.preventDefault()})),b.Fc(1,cd,2,1,"td",1),b.Tb(2,"td"),b.Hc(3),b.Sb(),b.Tb(4,"td"),b.Hc(5),b.ec(6,"date"),b.Sb(),b.Tb(7,"td"),b.Hc(8),b.ec(9,"date"),b.Sb(),b.Tb(10,"td"),b.Hc(11),b.ec(12,"date"),b.Sb(),b.Tb(13,"td"),b.Hc(14),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc(3);b.zb(1),b.kc("ngIf",!a.self),b.zb(2),b.Ic(i.value),b.zb(2),b.Ic(b.fc(6,6,i.creationDate)),b.zb(3),b.Ic(b.fc(9,8,i.activationDate)),b.zb(3),b.Ic(b.fc(12,10,i.expiryDate)),b.zb(3),b.Ic(a.statusDisplay(i.status))}}function ld(e,t){if(1&e&&(b.Tb(0,"table",14),b.Tb(1,"thead"),b.Fc(2,od,2,1,"th",1),b.Tb(3,"th"),b.Hc(4),b.Sb(),b.Tb(5,"th"),b.Hc(6),b.Sb(),b.Tb(7,"th"),b.Hc(8),b.Sb(),b.Tb(9,"th"),b.Hc(10),b.Sb(),b.Tb(11,"th"),b.Hc(12),b.Sb(),b.Sb(),b.Tb(13,"tbody"),b.Fc(14,sd,15,12,"tr",15),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(2),b.kc("ngIf",!n.self),b.zb(2),b.Ic(n.isNfc()?n.i18n.token.label:n.i18n.token.value),b.zb(2),b.Ic(n.i18n.token.creationDate),b.zb(2),b.Ic(n.i18n.token.activationDate),b.zb(2),b.Ic(n.i18n.token.expiryDate),b.zb(2),b.Ic(n.i18n.general.status),b.zb(2),b.kc("ngForOf",n.data.tokens)}}function ud(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"page-content",2),b.ec(2,"async"),b.Fc(3,id,1,1,"user-info",3),b.Sb(),b.Tb(4,"results-layout",4),b.Fc(5,rd,20,18,"mobile-result",5),b.Fc(6,ld,15,7,"table",6),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(1),b.kc("heading",null==n.data?null:n.data.type.pluralName)("mobileHeading",null==n.data?null:n.data.type.pluralName)("headingActions",b.fc(2,6,n.headingActions$))("mode",n.self?"empty":"normal"),b.zb(2),b.kc("ngIf",!n.self),b.zb(1),b.kc("results",n.data.tokens)}}var dd,bd=((dd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).modal=i,o.userHelper=a,o.tokenService=r,o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.user=this.route.snapshot.params.user,this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getUserTokens({user:this.user,type:this.type}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e),this.self=this.authHelper.isSelf(e.user),this.canCreate()&&e.type.physicalType!==ze.Y.NFC_TAG&&(this.headingActions=[new B.c("add",this.i18n.general.add,(function(){t.modal.show(nd,{class:"modal-form",initialState:{type:e.type,user:e.user,required:!0,updateAction:function(){return t.reload()}}})}),!0)]),this.canActivate()&&(this.headingActions=[new B.c("how_to_reg",this.i18n.token.action.activate,(function(){t.notification.confirm({title:t.i18n.token.action.changeExpiry,customFields:[{internalName:"value",name:t.i18n.token.value,type:ze.p.STRING,pattern:e.type.mask,required:!0}],callback:function(e){return t.tokenService.activateToken({user:t.user,type:t.type,body:e.customValues.value}).subscribe((function(){t.notification.snackBar(t.i18n.token.action.done.expiryChanged),t.reload()}))}})}),!0)])}},{key:"isNfc",value:function(){return this.data.type.physicalType===ze.Y.NFC_TAG}},{key:"canCreate",value:function(){var e,t=this;return!this.self&&(null===(e=this.dataForUiHolder.auth.permissions.tokens.user.find((function(e){return e.type.id===t.type})))||void 0===e?void 0:e.create)}},{key:"canActivate",value:function(){var e,t=this;return!!this.self&&(null===(e=this.dataForUiHolder.auth.permissions.tokens.my.find((function(e){return e.type.id===t.type})))||void 0===e?void 0:e.activate)}},{key:"statusDisplay",value:function(e){return this.userHelper.tokenStatus(e)}},{key:"view",value:function(e){return["/users","tokens","view",e.id]}},{key:"resolveMenu",value:function(e){return this.authHelper.isSelf(e.user)?new d.a(d.b.MY_TOKENS,{tokenType:e.type}):e.user.user&&this.authHelper.isSelf(e.user.user)?d.b.MY_OPERATORS:this.dataForUiHolder.role===ze.eb.BROKER?d.b.MY_BROKERED_USERS:d.b.SEARCH_USERS}}]),n}(Ae.a)).\u0275fac=function(e){return new(e||dd)(b.Nb(b.r),b.Nb(f.b),b.Nb(s.a),b.Nb(c.G))},dd.\u0275cmp=b.Hb({type:dd,selectors:[["list-token"]],features:[b.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],["labelPosition","above",3,"label",4,"ngIf"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","search"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,ud,7,8,"ng-container",1),b.Sb()),2&e&&(b.kc("ready",b.fc(1,2,t.data$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,p.t,g.a,h.a,v.a,y.a,k.a,S.a,j.a,T.b,I.a,p.s],pipes:[p.b,C.a],encapsulation:2,changeDetection:0}),dd);function fd(e,t){1&e&&b.Pb(0)}function md(e,t){if(1&e&&b.Ob(0,"field-option",20),2&e){var n=t.$implicit,i=b.dc(3);b.kc("value",i.ApiHelper.internalNameOrId(n))("internalName",n.internalName)("id",n.id)("text",n.name)("parent",n.groupSet)}}function pd(e,t){if(1&e&&(b.Tb(0,"div",6),b.Tb(1,"multi-selection-field",18),b.Fc(2,md,1,5,"field-option",19),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(1),b.kc("label",n.i18n.user.groupFilter),b.zb(1),b.kc("ngForOf",n.data.groups)}}function gd(e,t){if(1&e){var n=b.Ub();b.Tb(0,"mobile-result"),b.Tb(1,"div",21),b.Tb(2,"div"),b.Tb(3,"label-value",22),b.Hc(4),b.Sb(),b.Tb(5,"label-value",22),b.Hc(6),b.Sb(),b.Tb(7,"label-value",22),b.Hc(8),b.ec(9,"date"),b.Sb(),b.Tb(10,"label-value",22),b.Hc(11),b.ec(12,"date"),b.Sb(),b.Tb(13,"label-value",22),b.Hc(14),b.ec(15,"date"),b.Sb(),b.Tb(16,"label-value",22),b.Hc(17),b.Sb(),b.Sb(),b.Tb(18,"div",23),b.Tb(19,"button",24),b.bc("click",(function(e){b.wc(n);var i=t.$implicit,a=b.dc(2);return a.router.navigate(a.view(i)),e.stopPropagation(),e.preventDefault()})),b.Ob(20,"icon",25),b.Sb(),b.Sb(),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc(2);b.zb(3),b.kc("label",a.i18n.general.user),b.zb(1),b.Jc(" ",i.user?i.user.display:a.i18n.token.unassigned," "),b.zb(1),b.kc("label",a.isNfc()?a.i18n.token.label:a.i18n.token.value),b.zb(1),b.Jc(" ",i.value," "),b.zb(1),b.kc("label",a.i18n.token.creationDate),b.zb(1),b.Jc(" ",b.fc(9,13,i.creationDate)," "),b.zb(2),b.kc("label",a.i18n.token.activationDate),b.zb(1),b.Jc(" ",b.fc(12,15,i.activationDate)," "),b.zb(2),b.kc("label",a.i18n.token.expiryDate),b.zb(1),b.Jc(" ",b.fc(15,17,i.expiryDate)," "),b.zb(2),b.kc("label",a.i18n.general.status),b.zb(1),b.Jc(" ",a.statusDisplay(i.status)," "),b.zb(2),b.kc("tooltip",a.i18n.general.view)}}function hd(e,t){if(1&e){var n=b.Ub();b.Tb(0,"tr",28),b.bc("click",(function(e){b.wc(n);var i=t.$implicit,a=b.dc(3);return a.router.navigate(a.view(i)),e.stopPropagation(),e.preventDefault()})),b.Tb(1,"td"),b.Hc(2),b.Sb(),b.Tb(3,"td"),b.Hc(4),b.Sb(),b.Tb(5,"td"),b.Hc(6),b.ec(7,"date"),b.Sb(),b.Tb(8,"td"),b.Hc(9),b.ec(10,"date"),b.Sb(),b.Tb(11,"td"),b.Hc(12),b.ec(13,"date"),b.Sb(),b.Tb(14,"td"),b.Hc(15),b.Sb(),b.Sb()}if(2&e){var i=t.$implicit,a=b.dc(3);b.zb(2),b.Ic(i.user?i.user.display:a.i18n.token.unassigned),b.zb(2),b.Ic(i.value),b.zb(2),b.Ic(b.fc(7,6,i.creationDate)),b.zb(3),b.Ic(b.fc(10,8,i.activationDate)),b.zb(3),b.Ic(b.fc(13,10,i.expiryDate)),b.zb(3),b.Ic(a.statusDisplay(i.status))}}function vd(e,t){if(1&e&&(b.Tb(0,"table",26),b.Tb(1,"thead"),b.Tb(2,"th"),b.Hc(3),b.Sb(),b.Tb(4,"th"),b.Hc(5),b.Sb(),b.Tb(6,"th"),b.Hc(7),b.Sb(),b.Tb(8,"th"),b.Hc(9),b.Sb(),b.Tb(10,"th"),b.Hc(11),b.Sb(),b.Tb(12,"th"),b.Hc(13),b.Sb(),b.Sb(),b.Tb(14,"tbody"),b.Fc(15,hd,16,12,"tr",27),b.ec(16,"async"),b.Sb(),b.Sb()),2&e){var n,i=b.dc(2),a=null==(n=b.fc(16,7,i.results$))?null:n.results;b.zb(3),b.Ic(i.i18n.general.user),b.zb(2),b.Ic(i.isNfc()?i.i18n.token.label:i.i18n.token.value),b.zb(2),b.Ic(i.i18n.token.creationDate),b.zb(2),b.Ic(i.i18n.token.activationDate),b.zb(2),b.Ic(i.i18n.token.expiryDate),b.zb(2),b.Ic(i.i18n.general.status),b.zb(2),b.kc("ngForOf",a)}}function yd(e,t){if(1&e&&(b.Tb(0,"page-content",3),b.ec(1,"async"),b.Tb(2,"form",4),b.Tb(3,"div",5),b.Tb(4,"div",6),b.Ob(5,"user-field",7),b.Sb(),b.Ob(6,"div",8),b.Tb(7,"div",6),b.Ob(8,"date-field",9),b.Sb(),b.Tb(9,"div",6),b.Ob(10,"date-field",10),b.Sb(),b.Ob(11,"div",8),b.Tb(12,"div",6),b.Ob(13,"date-field",11),b.Sb(),b.Tb(14,"div",6),b.Ob(15,"date-field",12),b.Sb(),b.Sb(),b.Tb(16,"div",6),b.Ob(17,"multi-selection-field",13),b.Sb(),b.Fc(18,pd,3,2,"div",14),b.Sb(),b.Sb(),b.Tb(19,"results-layout",15),b.ec(20,"async"),b.Fc(21,gd,21,19,"mobile-result",16),b.Fc(22,vd,17,9,"table",17),b.Sb()),2&e){var n=b.dc();b.kc("heading",null==n.data?null:n.data.type.pluralName)("mobileHeading",null==n.data?null:n.data.type.pluralName)("headingActions",b.fc(1,15,n.headingActions$)),b.zb(2),b.kc("formGroup",n.form),b.zb(3),b.kc("label",n.i18n.general.user),b.zb(3),b.kc("label",n.i18n.token.activationBeginDate),b.zb(2),b.kc("label",n.i18n.token.activationEndDate),b.zb(3),b.kc("label",n.i18n.token.expiryBeginDate),b.zb(2),b.kc("label",n.i18n.token.expiryEndDate),b.zb(2),b.kc("emptyLabel",n.i18n.general.notApplied)("label",n.i18n.general.status)("fieldOptions",n.statusOptions),b.zb(1),b.kc("ngIf",(null==n.data.groups?null:n.data.groups.length)>1),b.zb(1),b.kc("results",b.fc(20,17,n.results$))("rendering$",n.rendering$)}}var kd,Sd=((kd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).userHelper=i,o.modal=a,o.tokenService=r,o}return _createClass(n,[{key:"getFormControlNames",value:function(){return["user","statuses","groups","activationBeginDate","activationEndDate","expiryBeginDate","expiryEndDate"]}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.type=this.route.snapshot.params.type,this.addSub(this.tokenService.getGeneralTokensDataForSearch({type:this.type}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;_get(_getPrototypeOf(n.prototype),"onDataInitialized",this).call(this,e),e.type.physicalType!==ze.Y.NFC_TAG&&(this.headingActions=[new B.c("add",this.i18n.general.add,(function(){t.modal.show(nd,{class:"modal-form",initialState:{type:e.type,updateAction:function(){return t.reload()}}})}),!0)])}},{key:"doSearch",value:function(e){return this.tokenService.searchGeneralTokens$Response(e)}},{key:"toSearchParams",value:function(e){var t=e;return t.type=this.type,t.activationPeriod=me.a.dateRangeFilter(e.activationBeginDate,e.activationEndDate),t.expiryPeriod=me.a.dateRangeFilter(e.expiryBeginDate,e.expiryEndDate),t}},{key:"statusDisplay",value:function(e){return this.userHelper.tokenStatus(e)}},{key:"isNfc",value:function(){return this.data.type.physicalType===ze.Y.NFC_TAG}},{key:"view",value:function(e){return["/users","tokens","view",e.id]}},{key:"resolveMenu",value:function(e){return new d.a(d.b.USER_TOKENS,{tokenType:e.type})}},{key:"statusOptions",get:function(){var e=this;return Object.values(ze.ob).map((function(t){return{value:t,text:e.statusDisplay(t)}}))}}]),n}(pe.a)).\u0275fac=function(e){return new(e||kd)(b.Nb(b.r),b.Nb(s.a),b.Nb(f.b),b.Nb(c.G))},kd.\u0275cmp=b.Hb({type:kd,selectors:[["search-token"]],features:[b.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","user",3,"label"],[1,"w-100"],["labelPosition","side","formControlName","activationBeginDate","minDate","past100","maxDate","today","fieldSize","full",3,"label"],["labelPosition","side","formControlName","activationEndDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expiryBeginDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","expiryEndDate","minDate","past100","fieldSize","full",3,"label"],["labelPosition","side","formControlName","statuses",3,"emptyLabel","label","fieldOptions"],["class","col-12 col-md-6",4,"ngIf"],[3,"results","rendering$"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],[1,"d-flex"],["labelPosition","above",3,"label"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","search"],[1,"table","table-hover","cursor-pointer"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){if(1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Fc(2,fd,1,0,"ng-container",1),b.Sb(),b.Fc(3,yd,23,19,"ng-template",null,2,b.Gc)),2&e){var n=b.uc(4);b.kc("ready",b.fc(1,3,t.data$)),b.zb(2),b.kc("ngIf",t.data)("ngIfThen",n)}},directives:[m.a,p.t,g.a,q.I,q.w,q.n,ye.a,q.v,q.l,ge.a,nt.a,h.a,v.a,y.a,p.s,ve.a,S.a,j.a,T.b,I.a],pipes:[p.b,C.a],encapsulation:2,changeDetection:0}),kd);function Td(e,t){if(1&e&&b.Ob(0,"field-option",9),2&e){var n=t.$implicit;b.kc("value",n.id)("text",n.display)}}function Id(e,t){if(1&e&&(b.Tb(0,"single-selection-field",7),b.Fc(1,Td,1,2,"field-option",8),b.ec(2,"async"),b.Sb()),2&e){var n=b.dc();b.kc("label",n.i18n.general.operator)("emptyOption",n.i18n.general.notSet),b.zb(1),b.kc("ngForOf",b.fc(2,3,n.operators$))}}function Cd(e,t){1&e&&b.Hc(0,"\xa0")}var Od,Fd=((Od=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).modalRef=i,o.tokensService=a,o.operatorsService=r,o.operators$=new ht.a(null),o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.form=this.formBuilder.group({user:[null,q.G.required],operator:null}),this.form.get("user").valueChanges.subscribe((function(t){return e.fillOperatorsField(t)}))}},{key:"fillOperatorsField",value:function(e){var t=this;this.operatorsService.searchUserOperators$Response({user:e.id,skipTotalCount:!0,pageSize:999999}).subscribe((function(e){t.operators$.next(e.ok?e.body:null)}))}},{key:"submit",value:function(){var e=this;if(Object(J.F)(this.form),this.form.valid){var t=Object(gt.cloneDeep)(this.form.value);this.tokensService.assignToken({id:this.token,user:t.operator?t.operator:t.user}).subscribe((function(){e.notification.snackBar(e.i18n.token.action.done.assigned),e.updateAction()})),this.modalRef.hide()}}}]),n}(tr.a)).\u0275fac=function(e){return new(e||Od)(b.Nb(b.r),b.Nb(f.a),b.Nb(c.G),b.Nb(c.w))},Od.\u0275cmp=b.Hb({type:Od,selectors:[["assign-token"]],inputs:{token:"token",updateAction:"updateAction"},features:[b.wb],decls:12,vars:11,consts:[[1,"d-flex","flex-grow-1","flex-column",3,"formGroup"],["required","","formControlName","user",3,"label"],["formControlName","operator",3,"label","emptyOption",4,"ngIf"],["forceRow",""],[3,"label","disabled","action"],["blank",""],["outline","",3,"label","action"],["formControlName","operator",3,"label","emptyOption"],[3,"value","text",4,"ngFor","ngForOf"],[3,"value","text"]],template:function(e,t){if(1&e&&(b.Tb(0,"h1"),b.Hc(1),b.Sb(),b.Tb(2,"form",0),b.Ob(3,"user-field",1),b.Fc(4,Id,3,5,"single-selection-field",2),b.ec(5,"async"),b.Tb(6,"actions",3),b.Tb(7,"action-button",4),b.bc("action",(function(){return t.submit()})),b.ec(8,"async"),b.Sb(),b.Fc(9,Cd,1,0,"ng-template",null,5,b.Gc),b.Tb(11,"action-button",6),b.bc("action",(function(){return t.modalRef.hide()})),b.Sb(),b.Sb(),b.Sb()),2&e){var n,i=(null==(n=b.fc(5,7,t.operators$))?null:n.length)>0;b.zb(1),b.Ic(t.i18n.token.title.assign),b.zb(1),b.kc("formGroup",t.form),b.zb(1),b.kc("label",t.i18n.general.user),b.zb(1),b.kc("ngIf",i),b.zb(3),b.kc("label",t.i18n.general.submit)("disabled",b.fc(8,9,t.requesting$)),b.zb(4),b.kc("label",t.i18n.general.cancel)}},directives:[q.I,q.w,q.n,ye.a,q.D,q.v,q.l,p.t,Q.a,Y.a,he.a,p.s,ve.a],pipes:[p.b],encapsulation:2,changeDetection:0}),Od);function zd(e,t){if(1&e&&(b.Tb(0,"label-value",7),b.Ob(1,"user-link",8),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.user),b.zb(1),b.kc("user",null!=n.data.user&&n.data.user.user?n.data.user.user:n.data.user)}}function Ad(e,t){if(1&e&&(b.Tb(0,"label-value",7),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.operator),b.zb(1),b.Jc(" ",n.data.user.display," ")}}function wd(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.ec(2,"date"),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.creationDate),b.zb(1),b.Jc(" ",b.fc(2,2,n.data.creationDate)," ")}}function Ed(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.ec(2,"date"),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.document.category),b.zb(1),b.Jc(" ",b.fc(2,2,n.data.activationDate)," ")}}function _d(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.general.status),b.zb(1),b.Jc(" ",n.statusDisplay(n.data.status)," ")}}function Nd(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.ec(2,"date"),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.token.activationDeadline),b.zb(1),b.Jc(" ",n.data.activationDeadline?b.fc(2,2,n.data.activationDeadline):n.i18n.token.noDeadline," ")}}function Rd(e,t){if(1&e&&(b.Tb(0,"label-value",5),b.Hc(1),b.ec(2,"date"),b.Sb()),2&e){var n=b.dc(2);b.kc("label",n.i18n.token.expiryDate),b.zb(1),b.Jc(" ",n.data.expiryDate?b.fc(2,2,n.data.expiryDate):n.i18n.token.noExpiryDate," ")}}function Pd(e,t){1&e&&(b.Ob(0,"img",12),b.ec(1,"trust")),2&e&&b.kc("src",b.gc(1,1,t.ngIf,"url"),b.yc)}function Dd(e,t){if(1&e&&(b.Tb(0,"div"),b.Ob(1,"hr",9),b.Tb(2,"div",10),b.Fc(3,Pd,2,4,"img",11),b.ec(4,"async"),b.Sb(),b.Sb()),2&e){var n=b.dc(2);b.zb(3),b.kc("ngIf",b.fc(4,1,n.qrCodeUrl$))}}function Hd(e,t){if(1&e&&(b.Rb(0),b.Tb(1,"div",3),b.Fc(2,zd,2,2,"label-value",4),b.Fc(3,Ad,2,2,"label-value",4),b.Tb(4,"label-value",5),b.Hc(5),b.Sb(),b.Fc(6,wd,3,4,"label-value",6),b.Fc(7,Ed,3,4,"label-value",6),b.Fc(8,_d,2,2,"label-value",6),b.Fc(9,Nd,3,4,"label-value",6),b.Fc(10,Rd,3,4,"label-value",6),b.Fc(11,Dd,5,3,"div",2),b.Sb(),b.Qb()),2&e){var n=b.dc();b.zb(2),b.kc("ngIf",n.showUser()),b.zb(1),b.kc("ngIf",null==n.data.user?null:n.data.user.user),b.zb(1),b.kc("label",n.valueLabel()),b.zb(1),b.Jc(" ",n.data.value," "),b.zb(1),b.kc("ngIf",n.data.creationDate),b.zb(1),b.kc("ngIf",n.data.activationDate),b.zb(1),b.kc("ngIf",n.data.status),b.zb(1),b.kc("ngIf",n.showDeadLine()),b.zb(1),b.kc("ngIf",n.showExpiryDate()),b.zb(1),b.kc("ngIf",n.isQrCode(n.data))}}var xd,Ld,Md,Ud=[{path:"",children:[{path:"search",component:Ru},{path:"brokerings",component:Ru,canActivate:[o.a]},{path:":user/brokerings",component:Ru,canActivate:[o.a]},{path:":user/brokers",component:Ve,canActivate:[o.a]},{path:":user/brokers/history",component:tt,canActivate:[o.a]},{path:":user/brokers/new",component:Re,canActivate:[o.a]},{path:":user/profile",component:bs.b,resolve:{countries:r.a}},{path:":user/profile/edit",component:os,canActivate:[o.a],resolve:{countries:r.a}},{path:"operators",component:Pr,canActivate:[o.a]},{path:":user/operators",component:Pr,canActivate:[o.a]},{path:":user/operators/registration",component:Wa,canActivate:[o.a]},{path:"operators/:user",component:bs.b,canActivate:[o.a]},{path:"operators/:user/edit",component:os,canActivate:[o.a]},{path:":user/status",component:ju,canActivate:[o.a]},{path:":user/status/history",component:Gu,canActivate:[o.a]},{path:":user/group",component:wn,canActivate:[o.a]},{path:":user/group/history",component:In,canActivate:[o.a]},{path:":user/agreements",component:be,canActivate:[o.a]},{path:":user/agreements/history",component:G,canActivate:[o.a]},{path:"operator-groups",component:Ci,canActivate:[o.a]},{path:":user/operator-groups",component:Ci,canActivate:[o.a]},{path:":user/operator-groups/new",component:Ki,canActivate:[o.a]},{path:"operator-groups/:id",component:wa,canActivate:[o.a]},{path:"operator-groups/:id/edit",component:Ki,canActivate:[o.a]},{path:"contacts",component:mu,canActivate:[o.a]},{path:"contacts/:user",component:bs.b,canActivate:[o.a],resolve:{countries:r.a}},{path:":user/passwords",component:to,canActivate:[o.a]},{path:":user/identity-providers",component:qn,canActivate:[o.a]},{path:"registration",component:eu,resolve:{countries:r.a}},{path:"validate-registration/:key",component:au},{path:"connected",component:pt},{path:"alerts",component:Fe},{path:"validate-email-change/:key",component:ds},{path:":user/notification-settings",component:hi,canActivate:[o.a]},{path:"documents",component:Ht,canActivate:[o.a]},{path:":user/documents/search",component:cn,canActivate:[o.a]},{path:"documents/edit/:id",component:Ft,canActivate:[o.a]},{path:"documents/view/:id",component:pn,canActivate:[o.a]},{path:":user/documents/new",component:Ft,canActivate:[o.a]},{path:"documents/process-dynamic/:id",component:Vt,canActivate:[o.a]},{path:":user/tokens/:type",component:bd,canActivate:[o.a]},{path:"tokens/search/:type",component:Sd,canActivate:[o.a]},{path:"tokens/view/:id",component:(xd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,a,r){var o;return _classCallCheck(this,n),(o=t.call(this,e)).userHelper=i,o.modal=a,o.tokenService=r,o.qrCodeUrl$=new ht.a(null),o}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"ngOnInit",this).call(this),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.tokenService.viewToken({id:this.id}).subscribe((function(t){return e.data=t})))}},{key:"isQrCode",value:function(e){return e.type.physicalType===ze.Y.QR_CODE}},{key:"onDataInitialized",value:function(e){var t=this;this.isQrCode(e)&&this.getTokenQrCodeUrl();var n=[];e.assign&&n.push(new B.c("account_box",this.i18n.token.action.assign,(function(){e.status===ze.ob.UNASSIGNED&&t.modal.show(Fd,{class:"modal-form",initialState:{token:t.id,updateAction:function(){return t.reload()}}})}))),e.setActivationDeadline&&n.push(new B.c("calendar_today",this.i18n.token.action.changeDeadline,(function(){t.notification.confirm({title:t.i18n.token.action.changeDeadline,customFields:[{internalName:"deadline",name:t.i18n.token.activationDeadline,type:ze.p.DATE,required:!0}],callback:function(e){return t.tokenService.setTokenActivationDeadline({id:t.id,date:e.customValues.deadline}).subscribe((function(){return t.notifyDoneAndReload(t.i18n.token.action.done.deadlineChanged)}))}})}))),e.setExpiryDate&&n.push(new B.c("calendar_today",this.i18n.token.action.changeExpiry,(function(){t.notification.confirm({title:t.i18n.token.action.changeExpiry,customFields:[{internalName:"expiry",name:t.i18n.token.expiryDate,type:ze.p.DATE,required:!0}],callback:function(e){return t.tokenService.setTokenExpiryDate({id:t.id,date:e.customValues.expiry}).subscribe((function(){return t.notifyDoneAndReload(t.i18n.token.action.done.expiryChanged)}))}})}))),e.block&&n.push(new B.c("lock",this.i18n.token.action.block,(function(){t.tokenService.blockToken({id:t.id}).subscribe((function(){return t.notifyDoneAndReload(t.i18n.token.action.done.blocked)}))}))),e.unblock&&n.push(new B.c("lock_open",this.i18n.token.action.unblock,(function(){t.tokenService.unblockToken({id:t.id}).subscribe((function(){return t.notifyDoneAndReload(t.i18n.token.action.done.unblocked)}))}))),e.activate&&n.push(new B.c("how_to_reg",this.i18n.token.action.activate,(function(){t.tokenService.activatePendingToken({id:t.id}).subscribe((function(){return t.notifyDoneAndReload(t.i18n.token.action.done.activated)}))}))),e.cancel&&n.push(new B.c("cancel",this.i18n.token.action.cancel,(function(){t.notification.confirm({title:t.i18n.token.action.cancel,message:t.i18n.token.action.message.cancel,callback:function(){return t.tokenService.cancelToken({id:t.id}).subscribe((function(){return t.notifyDoneAndReload(t.i18n.token.action.done.canceled)}))}})}))),this.headingActions=n}},{key:"notifyDoneAndReload",value:function(e){this.notification.snackBar(e),this.reload()}},{key:"getTokenQrCodeUrl",value:function(){var e=this;this.addSub(this.tokenService.getTokenQrCode({id:this.id,size:ze.D.MEDIUM}).subscribe((function(t){return e.qrCodeUrl$.next(URL.createObjectURL(t))})))}},{key:"statusDisplay",value:function(e){return this.userHelper.tokenStatus(e)}},{key:"showUser",value:function(){var e;return!(this.authHelper.isSelf(this.data.user)||(null===(e=this.data.user)||void 0===e?void 0:e.user)&&this.authHelper.isSelf(this.data.user.user))}},{key:"valueLabel",value:function(){return this.data.type.physicalType===ze.Y.NFC_TAG?this.i18n.token.label:this.i18n.token.value}},{key:"showDeadLine",value:function(){return this.data.status===ze.ob.ACTIVATION_EXPIRED||this.data.status===ze.ob.PENDING}},{key:"showExpiryDate",value:function(){return[ze.ob.ACTIVE,ze.ob.BLOCKED,ze.ob.CANCELED,ze.ob.EXPIRED].includes(this.data.status)}},{key:"resolveMenu",value:function(e){return this.dataForUiHolder.role===ze.eb.ADMINISTRATOR?new d.a(d.b.USER_TOKENS,{tokenType:e.type}):this.authHelper.isSelf(e.user)?new d.a(d.b.MY_TOKENS,{tokenType:e.type}):e.user.user&&this.authHelper.isSelf(e.user.user)?d.b.MY_OPERATORS:this.dataForUiHolder.role===ze.eb.BROKER?d.b.MY_BROKERED_USERS:d.b.SEARCH_USERS}}]),n}(u.a),xd.\u0275fac=function(e){return new(e||xd)(b.Nb(b.r),b.Nb(s.a),b.Nb(f.b),b.Nb(c.G))},xd.\u0275cmp=b.Hb({type:xd,selectors:[["view-token"]],features:[b.wb],decls:5,vars:9,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],["kind","fieldView","labelPosition","side",3,"label",4,"ngIf"],[3,"label"],[3,"label",4,"ngIf"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],[1,"mt-3"],[1,"qr-container","image","d-flex","justify-content-center","mb-4","align-self-center"],["alt","QR-code","class","mw-100",3,"src",4,"ngIf"],["alt","QR-code",1,"mw-100",3,"src"]],template:function(e,t){1&e&&(b.Tb(0,"page-layout",0),b.ec(1,"async"),b.Tb(2,"page-content",1),b.ec(3,"async"),b.Fc(4,Hd,12,10,"ng-container",2),b.Sb(),b.Sb()),2&e&&(b.kc("ready",b.fc(1,5,t.data$)),b.zb(2),b.kc("heading",t.i18n.token.title.view(null==t.data?null:t.data.type.name))("mobileHeading",t.i18n.token.mobileTitle.view(null==t.data?null:t.data.type.name))("headingActions",b.fc(3,7,t.headingActions$)),b.zb(2),b.kc("ngIf",t.data))},directives:[m.a,g.a,p.t,j.a,vt.a],pipes:[p.b,C.a,Ut.a],encapsulation:2,changeDetection:0}),xd),canActivate:[o.a]}]}],$d=((Md=function e(){_classCallCheck(this,e)}).\u0275mod=b.Lb({type:Md}),Md.\u0275inj=b.Kb({factory:function(e){return new(e||Md)},imports:[[a.i.forChild(Ud)],a.i]}),Md),Gd=((Ld=function e(){_classCallCheck(this,e)}).\u0275mod=b.Lb({type:Ld}),Ld.\u0275inj=b.Kb({factory:function(e){return new(e||Ld)},imports:[[$d,i.a]]}),Ld)}}]);