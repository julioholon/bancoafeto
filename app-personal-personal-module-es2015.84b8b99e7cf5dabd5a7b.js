(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{SRLV:function(t,e,i){"use strict";i.r(e),i.d(e,"PersonalModule",(function(){return M}));var s=i("iInd"),n=i("ofEL"),r=i("Do6i"),a=i("tAww"),o=i("rCAV"),l=i("tVPo"),c=i("PvCH"),u=i("cp0P"),h=i("SxV6"),b=i("8Y7J"),d=i("8UBS"),p=i("HQV3"),g=i("s7LF"),m=i("yHfF"),f=i("2KYv"),T=i("n1JJ"),S=i("DAJ4"),v=i("wwxf"),y=i("978R"),w=i("SVse"),I=i("sifq"),F=i("H4pW"),C=i("/kmK");function k(t,e){if(1&t&&(b.Tb(0,"mobile-result",8),b.Tb(1,"div",9),b.Hc(2),b.Sb(),b.Tb(3,"div",10),b.Hc(4),b.ec(5,"dateTime"),b.Sb(),b.Sb()),2&t){const t=e.$implicit;b.kc("avatarImage",null==t.relatedUser?null:t.relatedUser.image),b.zb(1),b.kc("tooltip",t.message),b.zb(1),b.Ic(t.subject),b.zb(1),b.kc("tooltip",t.message),b.zb(1),b.Jc(" ",b.fc(5,5,t.date)," ")}}const R=function(t){return{"font-weight-bold":t}},A=function(t,e){return{"pb-0":t,"border-0":e}};function O(t,e){if(1&t){const t=b.Ub();b.Rb(0),b.Tb(1,"tr",15),b.bc("click",(function(){b.wc(t);const i=e.$implicit;return b.dc(2).rowClick(i)})),b.Tb(2,"td",16),b.ec(3,"async"),b.ec(4,"async"),b.Ob(5,"avatar",17),b.Sb(),b.Tb(6,"td"),b.Hc(7),b.ec(8,"dateTime"),b.Sb(),b.Tb(9,"td"),b.Hc(10),b.Sb(),b.Tb(11,"td",13),b.Tb(12,"button",18),b.bc("click",(function(i){b.wc(t);const s=e.$implicit;return b.dc(2).remove(s),i.stopPropagation()})),b.Ob(13,"icon",19),b.Sb(),b.Sb(),b.Sb(),b.Qb()}if(2&t){const t=e.$implicit,i=b.dc(2);b.zb(1),b.kc("ngClass",b.nc(13,R,!t.read)),b.zb(1),b.kc("ngClass",b.oc(15,A,b.fc(3,7,i.layout.xxs$),b.fc(4,9,i.layout.xxs$))),b.zb(3),b.kc("image",null==t.relatedUser?null:t.relatedUser.image)("tooltip",null==t.relatedUser?null:t.relatedUser.display),b.zb(2),b.Ic(b.fc(8,11,t.date)),b.zb(3),b.Ic(t.message),b.zb(2),b.kc("tooltip",i.i18n.notification.actions.remove)}}function $(t,e){if(1&t&&(b.Tb(0,"table",11),b.Tb(1,"thead"),b.Ob(2,"th",12),b.Tb(3,"th"),b.Hc(4),b.Sb(),b.Tb(5,"th"),b.Hc(6),b.Sb(),b.Ob(7,"th",13),b.Sb(),b.Tb(8,"tbody"),b.Fc(9,O,14,18,"ng-container",14),b.ec(10,"async"),b.Sb(),b.Sb()),2&t){const t=b.dc();var i;const e=null==(i=b.fc(10,3,t.results$))?null:i.results;b.zb(4),b.Ic(t.i18n.general.date),b.zb(2),b.Ic(t.i18n.notification.message),b.zb(3),b.kc("ngForOf",e)}}let x=(()=>{class t extends l.a{constructor(t,e){super(t),this.notificationsService=e}ngOnInit(){super.ngOnInit(),this.addSub(this.notification.notificationsStatus$.subscribe(()=>this.update())),this.data={},this.addSub(this.notificationsService.markAsViewed().pipe(Object(h.a)()).subscribe(()=>{const t=this.notification.notificationsStatus$,e=Object.assign({},t.value);e.lastViewDate=this.dataForUiHolder.now().toISOString(),e.newNotifications=0,t.next(e)})),this.addSub(this.results$.subscribe(t=>{const e=[],i=(t?t.results:null)||[];i.filter(t=>!t.read).length>0&&e.push(new a.c("done_all",this.i18n.notification.actions.markAllRead,()=>this.markAllRead())),i.length>0&&e.push(new a.c("clear",this.i18n.notification.actions.removeAll,()=>this.removeAll())),this.headingActions=e}))}rowClick(t){this.addSub(this.notificationsService.markNotificationsAsRead({ids:[t.id]}).subscribe());const e=this.path(t);e&&this.router.navigateByUrl(e)}remove(t){this.addSub(this.notificationsService.deleteNotification({id:t.id}).subscribe(()=>this.update()))}path(t){const e=o.a.notificationData(t);return e?e.path:null}markAllRead(){this.addSub(this.notificationsService.markNotificationsAsRead({ids:this.ids}).subscribe(()=>this.update()))}removeAll(){const t=[];for(const e of this.ids)t.push(this.notificationsService.deleteNotification({id:e}));this.addSub(Object(u.a)(t).pipe(Object(h.a)()).subscribe(()=>this.update()))}get ids(){return this.results&&this.results.results?this.results.results.map(t=>t.id):[]}getFormControlNames(){return["onlyUnread"]}toSearchParams(t){return t}doSearch(t){return this.notificationsService.searchNotifications$Response(t)}get onClick(){return t=>this.rowClick(t)}resolveMenu(){return c.b.NOTIFICATIONS}}return t.\u0275fac=function(e){return new(e||t)(b.Nb(b.r),b.Nb(r.t))},t.\u0275cmp=b.Hb({type:t,selectors:[["search-notifications"]],features:[b.wb],decls:11,vars:12,consts:[["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","sideForced","formControlName","onlyUnread",3,"label"],["resultType","list",3,"results","onClick","rendering$","update"],["avatarIcon","notifications_none",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarIcon","notifications_none",3,"avatarImage"],[1,"cell-main",3,"tooltip"],[1,"cell-cell-date",3,"tooltip"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[1,"actions"],[4,"ngFor","ngForOf"],[3,"ngClass","click"],[1,"avatar",3,"ngClass"],["icon","notifications_none",3,"image","tooltip"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"]],template:function(t,e){1&t&&(b.Tb(0,"page-layout"),b.Tb(1,"page-content",0),b.ec(2,"async"),b.Tb(3,"form",1),b.Tb(4,"div",2),b.Tb(5,"div",3),b.Ob(6,"boolean-field",4),b.Sb(),b.Sb(),b.Sb(),b.Sb(),b.Tb(7,"results-layout",5),b.bc("update",(function(t){return e.update(t)})),b.ec(8,"async"),b.Fc(9,k,6,7,"mobile-result",6),b.Fc(10,$,11,5,"table",7),b.Sb(),b.Sb()),2&t&&(b.zb(1),b.kc("heading",e.i18n.notification.title)("mobileHeading",e.i18n.notification.mobileTitle)("headingActions",b.fc(2,8,e.headingActions$)),b.zb(2),b.kc("formGroup",e.form),b.zb(3),b.kc("label",e.i18n.notification.onlyUnread),b.zb(1),b.kc("results",b.fc(8,10,e.results$))("onClick",e.onClick)("rendering$",e.rendering$))},directives:[d.a,p.a,g.I,g.w,g.n,m.a,g.v,g.l,f.a,T.a,S.a,v.a,y.b,w.s,w.q,I.a,F.a],pipes:[w.b,C.a],encapsulation:2,changeDetection:0}),t})();var z=i("x6mR"),N=i("wR2l"),L=i("chz4");const U=[{path:"",children:[{path:"notifications",component:x,canActivate:[n.a],data:{menu:c.b.NOTIFICATIONS}},{path:"settings",component:(()=>{class t extends z.a{constructor(t){super(t)}ngOnInit(){super.ngOnInit(),this.darkThemeControl=new g.j(this.layout.darkTheme),this.addSub(this.darkThemeControl.valueChanges.subscribe(t=>{this.layout.darkTheme=t}))}resolveMenu(){return c.b.SETTINGS}}return t.\u0275fac=function(e){return new(e||t)(b.Nb(b.r))},t.\u0275cmp=b.Hb({type:t,selectors:[["manage-settings"]],features:[b.wb],decls:5,vars:8,consts:[["last","",3,"heading","mobileHeading"],[3,"label","formControl"],[3,"value","text"]],template:function(t,e){1&t&&(b.Tb(0,"page-layout"),b.Tb(1,"page-content",0),b.Tb(2,"radio-group-field",1),b.Ob(3,"field-option",2),b.Ob(4,"field-option",2),b.Sb(),b.Sb(),b.Sb()),2&t&&(b.zb(1),b.kc("heading",e.i18n.setting.title)("mobileHeading",e.i18n.setting.mobileTitle),b.zb(1),b.kc("label",e.i18n.setting.theme)("formControl",e.darkThemeControl),b.zb(1),b.kc("value",!1)("text",e.i18n.setting.themeLight),b.zb(1),b.kc("value",!0)("text",e.i18n.setting.themeDark))},directives:[d.a,p.a,N.a,g.v,g.k,L.a],encapsulation:2,changeDetection:0}),t})(),canActivate:[n.a],data:{menu:c.b.SETTINGS}}]}];let V=(()=>{class t{}return t.\u0275mod=b.Lb({type:t}),t.\u0275inj=b.Kb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(U)],s.i]}),t})();var E=i("PCNd");let M=(()=>{class t{}return t.\u0275mod=b.Lb({type:t}),t.\u0275inj=b.Kb({factory:function(e){return new(e||t)},imports:[[V,E.a]]}),t})()},tVPo:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var s=i("s7LF"),n=i("mwYl"),r=i("tAww"),a=i("rCAV"),o=i("x6mR"),l=i("Ky6R"),c=i("75v4"),u=i("LvDl"),h=i("2Vo4"),b=i("Kj3r"),d=i("8Y7J");let p=(()=>{class t extends o.a{constructor(t){super(t),this.ResultType=c.a,this.resultType$=new h.a(null),this.resultTypeControl=new s.j(null),this.results$=new h.a(null),this.allowedResultTypes$=new h.a([c.a.LIST]),this.rendering$=new h.a(!1),this.moreFilters$=new h.a(!1),this.ignoreNextUpdate=!1,this.nextRequestState=t.get(n.a);const e={page:0};e.resultType=this.getInitialResultType();for(const i of this.getFormControlNames()||[])e[i]=null;this.form=this.formBuilder.group(e)}getInitialFormValue(t){return t.query||{}}onDataInitialized(t){this.form.patchValue(this.getInitialFormValue(t)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe(t=>{const e=this.previousResultType;this.previousResultType=t,this.resultType$.next(t),this.shouldUpdateOnResultTypeChange(t,e)&&this.update(),null!=e&&e===t||(this.rendering=!0,this.stateManager.set("resultType",t),this.onResultTypeChanged(t,e))})),setTimeout(()=>{this.addSub(this.form.valueChanges.pipe(Object(b.a)(a.a.DEBOUNCE_TIME)).subscribe(t=>{this.shouldUpdateOnChange(t)&&this.update(),this.previousValue=t}),!0),this.previousResultType!==c.a.CATEGORIES&&this.update()},1)}shouldUpdateOnResultTypeChange(t,e){return t!==c.a.CATEGORIES&&([c.a.LIST,c.a.TILES].includes(e)!==[c.a.LIST,c.a.TILES].includes(t)||e===c.a.MAP!=(t===c.a.MAP))}shouldUpdateOnChange(t){return!Object(u.isEqual)(this.previousValue,t)}get results(){return this.results$.value}set results(t){this.results$.next(t)}get rendering(){return this.rendering$.value}set rendering(t){this.rendering$.next(t)}get allowedResultTypes(){return this.allowedResultTypes$.value}set allowedResultTypes(t){this.allowedResultTypes$.next(t)}get moreFilters(){return this.moreFilters$.value}set moreFilters(t){this.moreFilters$.next(t)}get pageData(){const t=this.form.value;return{page:t.page,pageSize:t.pageSize}}set pageData(t){this.form.patchValue(t)}get resultType(){return this.resultTypeControl.value}set resultType(t){null==t&&(t=this.getInitialResultType()),this.resultTypeControl.setValue(t)}ngOnInit(){super.ngOnInit(),this.resultType=this.getInitialResultType()}get moreFiltersAction(){return this._moreFiltersAction||(this._moreFiltersAction=new r.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),()=>{this.moreFilters=!this.moreFilters,this._moreFiltersAction.icon=this.moreFilters?this.showLessFiltersIcon():this.showMoreFiltersIcon(),this._moreFiltersAction.label=this.moreFilters?this.showLessFiltersLabel():this.showMoreFiltersLabel()},!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}showMoreFiltersLabel(){return this.i18n.general.showMoreFilters}showLessFiltersLabel(){return this.i18n.general.showLessFilters}showMoreFiltersIcon(){return"filter_list"}showLessFiltersIcon(){return"filter_list"}onResultTypeChanged(t,e){}getInitialResultType(){return c.a.LIST}update(t){if(this.ignoreNextUpdate)return;t&&(this.form.patchValue(t,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;const e=this.form.value;e.pageSize=this.layout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(e)).subscribe(t=>{this.resultType===c.a.CATEGORIES&&(this.resultType=this.allowedResultTypes.find(t=>t!==c.a.CATEGORIES)),this.results=l.a.from(t)}))}resetPage(t=!1){this.form.patchValue({page:0},{emitEvent:t})}doIgnoringUpdate(t){this.ignoreNextUpdate=!0;try{t()}finally{this.ignoreNextUpdate=!1}}}return t.\u0275fac=function(e){return new(e||t)(d.Nb(d.r))},t.\u0275dir=d.Ib({type:t,features:[d.wb]}),t})()}}]);