(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{h2Vq:function(e,t,i){"use strict";i.r(t),i.d(t,"MarketplaceModule",(function(){return Sc}));var a=i("iInd"),n=i("s7LF"),r=i("Do6i"),c=i("x6mR"),s=i("ObUu"),o=i("PvCH"),l=i("8Y7J"),d=i("8UBS"),b=i("SVse"),u=i("HQV3"),m=i("JFlR"),f=i("7HWn"),h=i("sifq"),p=i("YG2p"),g=i("UXR7"),v=i("/kmK");function y(e,t){if(1&e&&(l.Tb(0,"div",11),l.Ob(1,"avatar",12),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("roundBorders",!1)("zoom",!1)("image",e.data.advertisement.image)}}function k(e,t){if(1&e&&(l.Tb(0,"div",13),l.Ob(1,"avatar",12),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("roundBorders",!1)("zoom",!1)("image",e.data.advertisement.image)}}function S(e,t){if(1&e&&l.Ob(0,"textarea-field",14),2&e){const e=l.dc(2);l.kc("formControl",e.answer)}}function T(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.data.answer," ")}}function z(e,t){if(1&e){const e=l.Ub();l.Tb(0,"actions"),l.Tb(1,"button",15),l.bc("click",(function(){return l.wc(e),l.dc(2).submit()})),l.ec(2,"async"),l.Hc(3),l.Sb(),l.Sb()}if(2&e){const e=l.dc(2);l.zb(1),l.kc("disabled",l.fc(2,2,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.general.submit," ")}}const I=function(e){return{"pt-1":e}};function O(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.Fc(2,y,2,3,"div",3),l.ec(3,"async"),l.Tb(4,"div",4),l.Fc(5,k,2,3,"div",5),l.ec(6,"async"),l.Tb(7,"div",6),l.Tb(8,"label-value",7),l.Hc(9),l.Sb(),l.Tb(10,"label-value",7),l.Ob(11,"user-link",8),l.Sb(),l.Tb(12,"label-value",7),l.Hc(13),l.ec(14,"dateTime"),l.Sb(),l.Tb(15,"label-value",7),l.Hc(16),l.Sb(),l.Tb(17,"label-value",9),l.Fc(18,S,1,1,"textarea-field",10),l.Fc(19,T,2,1,"ng-container",1),l.Sb(),l.Sb(),l.Sb(),l.Fc(20,z,4,4,"actions",1),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.answerQuestion)("mobileHeading",e.i18n.ad.mobileTitle.answerQuestion),l.zb(1),l.kc("ngIf",e.data.advertisement.image&&l.fc(3,18,e.layout.ltsm$)),l.zb(3),l.kc("ngIf",e.data.advertisement.image&&l.fc(6,20,e.layout.gtxs$)),l.zb(3),l.kc("label",e.i18n.ad.name),l.zb(1),l.Jc(" ",e.data.advertisement.name," "),l.zb(1),l.kc("label",e.i18n.general.by),l.zb(1),l.kc("user",e.data.user),l.zb(1),l.kc("label",e.i18n.general.date),l.zb(1),l.Jc(" ",l.fc(14,22,e.data.questionDate)," "),l.zb(2),l.kc("label",e.i18n.ad.question),l.zb(1),l.Jc(" ",e.data.question," "),l.zb(1),l.kc("ngClass",l.nc(24,I,!e.data.answer))("label",e.i18n.ad.answer)("required",!e.data.answer),l.zb(1),l.kc("ngIf",!e.data.answer),l.zb(1),l.kc("ngIf",e.data.answer),l.zb(1),l.kc("ngIf",!e.data.answer)}}let w=(()=>{class e extends c.a{constructor(e,t){super(e),this.adQuestionService=t,this.answer=new n.j(null,n.G.required)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.adQuestionService.getAdQuestion({id:this.id}).subscribe(e=>this.data=e))}submit(){Object(s.F)(this.answer),this.answer.valid&&this.addSub(this.adQuestionService.answerAdQuestion({id:this.id,body:this.answer.value}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.questionAnswered),this.router.navigate(["/marketplace","unanswered-questions"],{replaceUrl:!0})}))}resolveMenu(){return o.b.UNANSWERED_QUESTIONS}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.c))},e.\u0275cmp=l.Hb({type:e,selectors:[["answer-form"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],["class","d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label"],[3,"user"],[3,"ngClass","label","required"],["required","true",3,"formControl",4,"ngIf"],[1,"d-flex","justify-content-center","mt-2","mb-4"],["size","120","useLightbox","",3,"roundBorders","zoom","image"],[1,"image","ml-4"],["required","true",3,"formControl"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,O,21,26,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,f.a,b.q,h.a,p.a,n.D,n.v,n.k,g.a],pipes:[b.b,v.a],encapsulation:2,changeDetection:0}),e})();var x=i("XDzf"),F=i("txia"),H=i("3l1o"),C=i("9d5G"),N=i("LvDl"),A=i("2Vo4"),D=i("wR2l"),$=i("chz4"),P=i("sYqu"),M=i("qCwG"),R=i("Kj3r"),E=i("2KYv"),q=i("n1JJ"),Q=i("DAJ4"),J=i("wwxf"),L=i("978R"),B=i("H4pW"),G=i("iXUt"),U=i("I9hm");function V(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",9),l.Tb(1,"button",10),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(2).changeQuantity.emit([null,i,!1]),t.stopPropagation(),t.preventDefault()})),l.Ob(2,"icon",11),l.Sb(),l.Tb(3,"button",12),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(2).remove.emit(i),t.stopPropagation(),t.preventDefault()})),l.Ob(4,"icon",13),l.Sb(),l.Sb()}if(2&e){const e=l.dc(3);l.zb(1),l.kc("tooltip",e.i18n.ad.changeQuantity),l.zb(2),l.kc("tooltip",e.i18n.general.remove)}}function j(e,t){if(1&e&&(l.Tb(0,"mobile-result",5),l.Tb(1,"div",6),l.Tb(2,"div"),l.Tb(3,"div",7),l.Hc(4),l.ec(5,"currency"),l.Sb(),l.Tb(6,"div",7),l.Hc(7),l.Sb(),l.Tb(8,"div",7),l.Hc(9),l.ec(10,"currency"),l.Sb(),l.Tb(11,"div",7),l.Hc(12),l.Sb(),l.Sb(),l.Fc(13,V,5,2,"div",8),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc(2);l.kc("avatarImage",e.product.image)("title",e.product.name),l.zb(4),l.Kc(" ",i.i18n.transaction.amount,": ",l.gc(5,11,e.totalPrice,i.currency)," "),l.zb(3),l.Kc(" ",i.i18n.ad.number,": ",e.product.productNumber," "),l.zb(2),l.Kc(" ",i.i18n.ad.unitPrice,": ",l.gc(10,14,e.price,i.currency)," "),l.zb(3),l.Kc(" ",i.i18n.ad.quantity,": ",i.resolveQuantityLabel(e)," "),l.zb(1),l.kc("ngIf",i.detailed)}}function _(e,t){1&e&&l.Ob(0,"table")}function K(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"results-layout",2),l.Fc(2,j,14,17,"mobile-result",3),l.Fc(3,_,1,0,"table",4),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("results",e.items)("toLink",e.detailed?e.toLink:null)("embedded",!0)}}function W(e,t){1&e&&l.Ob(0,"th",22)}function Y(e,t){if(1&e&&l.Ob(0,"decimal-field",34),2&e){const e=l.dc(2).$implicit,t=l.dc(2);l.kc("formControlName",e.id)("minRange",t.minItemsRange(e))("maxRange",t.maxItemsRange(e))("customValueLabel",t.i18n.ad.customQuantity)("scale",e.product.allowDecimalQuantity?2:0)}}function X(e,t){if(1&e&&(l.Tb(0,"form",32),l.Fc(1,Y,1,5,"decimal-field",33),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(2);l.kc("formGroup",t.form),l.zb(1),l.kc("ngIf",t.isAvailable(e))}}function Z(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.Qb()),2&e){const e=l.dc().$implicit,t=l.dc(2);l.zb(1),l.Jc(" ",t.resolveQuantityLabel(e)," ")}}function ee(e,t){if(1&e){const e=l.Ub();l.Tb(0,"button",10),l.bc("click",(function(t){l.wc(e);const i=l.dc(2).$implicit;return l.dc(2).changeQuantity.emit([null,i,!1]),t.stopPropagation()})),l.Ob(1,"icon",11),l.Sb()}if(2&e){const e=l.dc(4);l.kc("tooltip",e.i18n.ad.changeQuantity)}}const te=function(e){return{"border-bottom-0":e}},ie=function(e){return{"ml-3":e}};function ae(e,t){if(1&e){const e=l.Ub();l.Tb(0,"td",35),l.Fc(1,ee,2,1,"button",36),l.ec(2,"async"),l.Tb(3,"button",37),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(2).remove.emit(i),t.stopPropagation()})),l.ec(4,"async"),l.Ob(5,"icon",13),l.Sb(),l.Sb()}if(2&e){const e=l.dc(),t=e.last,i=e.$implicit,a=l.dc(2);l.kc("ngClass",l.nc(8,te,t)),l.zb(1),l.kc("ngIf",!a.useForm(l.fc(2,4,a.layout.gtsm$))&&a.isAvailable(i)),l.zb(2),l.kc("tooltip",a.i18n.general.remove)("ngClass",l.nc(10,ie,!a.useForm(l.fc(4,6,a.layout.gtsm$))&&a.isAvailable(i)))}}const ne=function(e,t,i){return{"pb-0":e,"border-0":t,"border-bottom-0":i}},re=function(e,t){return{link:e,"border-bottom-0":t}},ce=function(e){return{"text-decoration":e}};function se(e,t){if(1&e){const e=l.Ub();l.Tb(0,"tr"),l.Tb(1,"td",23),l.ec(2,"async"),l.ec(3,"async"),l.Ob(4,"avatar",24),l.Sb(),l.Tb(5,"td",25),l.Tb(6,"span",26),l.bc("click",(function(){l.wc(e);const i=t.$implicit;return l.dc(2).navigate(i)})),l.Hc(7),l.Sb(),l.Sb(),l.Tb(8,"td",27),l.Hc(9),l.Sb(),l.Tb(10,"td",27),l.Fc(11,X,2,2,"form",28),l.ec(12,"async"),l.Fc(13,Z,2,1,"ng-container",29),l.ec(14,"async"),l.Sb(),l.Tb(15,"td",30),l.Hc(16),l.ec(17,"currency"),l.Sb(),l.Tb(18,"td",30),l.Hc(19),l.ec(20,"currency"),l.Sb(),l.Fc(21,ae,6,12,"td",31),l.Sb()}if(2&e){const e=t.$implicit,i=t.last,a=l.dc(2);l.zb(1),l.kc("ngClass",l.pc(30,ne,l.fc(2,16,a.layout.xxs$),l.fc(3,18,a.layout.xxs$),i)),l.zb(3),l.kc("image",e.product.image)("tooltip",e.product.name),l.zb(1),l.kc("ngClass",l.oc(34,re,a.detailed,i))("ngStyle",l.nc(37,ce,a.isAvailable(e)?"":"line-through")),l.zb(2),l.Ic(e.product.name),l.zb(1),l.kc("ngClass",l.nc(39,te,i)),l.zb(1),l.Jc(" ",e.product.productNumber,""),l.zb(1),l.kc("ngClass",l.nc(41,te,i)),l.zb(1),l.kc("ngIf",a.useForm(l.fc(12,20,a.layout.gtsm$))),l.zb(2),l.kc("ngIf",!a.useForm(l.fc(14,22,a.layout.gtsm$))),l.zb(2),l.kc("ngClass",l.nc(43,te,i)),l.zb(1),l.Jc(" ",l.gc(17,24,e.price,a.currency)," "),l.zb(2),l.kc("ngClass",l.nc(45,te,i)),l.zb(1),l.Jc(" ",l.gc(20,27,e.totalPrice,a.currency),""),l.zb(2),l.kc("ngIf",a.detailed)}}function oe(e,t){if(1&e&&(l.Tb(0,"h2",14),l.Hc(1),l.Sb(),l.Tb(2,"table",15),l.Tb(3,"thead"),l.Tb(4,"th",16),l.Hc(5),l.Sb(),l.Tb(6,"th",17),l.Hc(7),l.Sb(),l.Tb(8,"th",18),l.Hc(9),l.Sb(),l.Tb(10,"th",19),l.Hc(11),l.Sb(),l.Tb(12,"th",19),l.Hc(13),l.Sb(),l.Fc(14,W,1,0,"th",20),l.Sb(),l.Tb(15,"tbody"),l.Fc(16,se,22,47,"tr",21),l.Sb(),l.Sb()),2&e){const e=l.dc();l.zb(1),l.Jc("",e.i18n.ad.products," "),l.zb(4),l.Ic(e.i18n.ad.product),l.zb(2),l.Ic(e.i18n.ad.number),l.zb(2),l.Ic(e.i18n.ad.quantity),l.zb(2),l.Ic(e.i18n.ad.unitPrice),l.zb(2),l.Ic(e.i18n.transaction.amount),l.zb(1),l.kc("ngIf",e.detailed),l.zb(2),l.kc("ngForOf",e.items)}}let le=(()=>{class e extends M.a{constructor(e,t){super(e),this.marketplaceHelper=t,this.changeQuantity=new l.n,this.remove=new l.n}ngOnInit(){super.ngOnInit(),this.detailed&&(this.form=this.formBuilder.group({}),this.items.forEach(e=>{const t=this.formBuilder.control(e.quantity,{updateOn:"blur"});this.form.addControl(e.id,t),setTimeout(()=>{this.addSub(t.valueChanges.pipe(Object(R.a)(this.ApiHelper.DEBOUNCE_TIME)).subscribe(t=>{this.changeQuantity.emit([t,e,!0])}),!0)},1)}))}useForm(e){return this.detailed&&e}isAvailable(e){return e.availability===x.jb.AVAILABLE}path(e){return["/marketplace","view",e.product.id]}get toLink(){return e=>this.path(e)}navigate(e){this.detailed&&this.router.navigate(this.path(e))}minItemsRange(e){return e.product.allowDecimalQuantity?null:e.product.minAllowedInCart?+e.product.minAllowedInCart:1}maxItemsRange(e){return e.product.allowDecimalQuantity?null:e.product.maxAllowedInCart?+e.product.maxAllowedInCart:e.product.minAllowedInCart?+e.product.minAllowedInCart+10:10}resolveQuantityLabel(e){switch(e.availability){case x.jb.AVAILABLE:return this.marketplaceHelper.getFormattedQuantity(e);case x.jb.OUT_OF_STOCK:return this.i18n.ad.outOfStock;case x.jb.UNAVAILABLE:return this.i18n.ad.itemNotAvailable}return""}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(H.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["shopping-cart-items"]],inputs:{detailed:"detailed",items:"items",currency:"currency"},outputs:{changeQuantity:"changeQuantity",remove:"remove"},features:[l.wb],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["largeTable",""],["resultType","list",3,"results","toLink","embedded"],["avatarIcon","shopping_basket",3,"avatarImage","title",4,"mobileResult"],[4,"resultTable"],["avatarIcon","shopping_basket",3,"avatarImage","title"],[1,"d-flex"],[1,"cell-text"],["class","ml-auto text-right d-flex flex-column",4,"ngIf"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","edit"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],["icon","delete"],[1,"mt-4","mb-2"],[1,"table","table-hover","cursor-pointer"],["colspan","2",1,"avatar","no-border"],[1,"no-border"],["width","10%",1,"no-border"],[1,"text-right","no-border"],["class","actions no-border",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions","no-border"],[1,"avatar",3,"ngClass"],["icon","shopping_basket",3,"image","tooltip"],["width","30%",3,"ngClass","ngStyle"],[3,"click"],[3,"ngClass"],[3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"text-right",3,"ngClass"],["class","actions actions-multiple",3,"ngClass",4,"ngIf"],[3,"formGroup"],[3,"formControlName","minRange","maxRange","customValueLabel","scale",4,"ngIf"],[3,"formControlName","minRange","maxRange","customValueLabel","scale"],[1,"actions","actions-multiple",3,"ngClass"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],[1,"btn","btn-icon",3,"tooltip","ngClass","click"]],template:function(e,t){if(1&e&&(l.Fc(0,K,4,3,"ng-container",0),l.ec(1,"async"),l.Fc(2,oe,17,8,"ng-template",null,1,l.Gc)),2&e){const e=l.uc(3);l.kc("ngIf",l.fc(1,2,t.layout.ltsm$))("ngIfElse",e)}},directives:[b.t,E.a,q.a,Q.a,J.a,L.b,B.a,b.s,b.q,h.a,b.w,n.I,n.w,n.n,G.a,n.v,n.l],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();var de=i("lS/A"),be=i("bBjs");function ue(e,t){if(1&e&&l.Ob(0,"field-option",11),2&e){const e=t.$implicit;l.kc("value",e.id)("text",e.name)}}function me(e,t){if(1&e&&(l.Tb(0,"label-value",13),l.Hc(1),l.Sb()),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.minDeliveryTime),l.zb(1),l.Jc(" ",e.format.formatTimeInterval(e.deliveryMethod.minDeliveryTime)," ")}}function fe(e,t){if(1&e&&(l.Tb(0,"label-value",13),l.Hc(1),l.Sb()),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.maxDeliveryTime),l.zb(1),l.Jc(" ",e.format.formatTimeInterval(e.deliveryMethod.maxDeliveryTime)," ")}}function he(e,t){if(1&e&&(l.Rb(0),l.Fc(1,me,2,2,"label-value",12),l.Fc(2,fe,2,2,"label-value",12),l.Tb(3,"label-value",13),l.Hc(4),l.ec(5,"currency"),l.Sb(),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("ngIf",e.deliveryMethod.minDeliveryTime),l.zb(1),l.kc("ngIf",e.deliveryMethod.maxDeliveryTime),l.zb(1),l.kc("label",e.i18n.ad.price),l.zb(1),l.Jc(" ",e.negotiated?e.i18n.ad.negotiated:l.gc(5,4,e.deliveryMethod.chargeAmount,e.deliveryMethod.chargeCurrency)," ")}}function pe(e,t){if(1&e){const e=l.Ub();l.Tb(0,"page-content",3),l.ec(1,"async"),l.Tb(2,"form",4),l.Tb(3,"div",5),l.Tb(4,"radio-group-field",6),l.Fc(5,ue,1,2,"field-option",7),l.Sb(),l.Sb(),l.Sb(),l.Tb(6,"h2"),l.Hc(7),l.Sb(),l.Fc(8,he,6,7,"ng-container",8),l.ec(9,"async"),l.Tb(10,"actions",9),l.Tb(11,"button",10),l.bc("click",(function(){return l.wc(e),l.dc().next()})),l.Hc(12),l.Sb(),l.Sb(),l.Sb()}if(2&e){const e=l.dc();l.kc("heading",e.i18n.ad.title.deliveryMethod)("mobileHeading",e.i18n.ad.mobileTitle.deliveryMethod)("mode",l.fc(1,10,e.layout.ltsm$)?"fullHeight":"normal"),l.zb(2),l.kc("formGroup",e.form),l.zb(2),l.kc("asColumn",e.data.deliveryMethods.length>3)("label",e.i18n.ad.chooseDeliveryMethod),l.zb(1),l.kc("ngForOf",e.data.deliveryMethods),l.zb(2),l.Ic(e.i18n.ad.deliveryInformation),l.zb(1),l.kc("ngIf",l.fc(9,12,e.deliveryMethod$)),l.zb(4),l.Jc(" ",e.i18n.general.next," ")}}function ge(e,t){if(1&e&&l.Ob(0,"field-option",11),2&e){const e=t.$implicit;l.kc("value",e.id)("text",e.name)}}function ve(e,t){1&e&&l.Hc(0,"\xa0")}function ye(e,t){if(1&e){const e=l.Ub();l.Tb(0,"button",19),l.bc("click",(function(){return l.wc(e),l.dc(2).back()})),l.Hc(1),l.Sb()}if(2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.i18n.general.back," ")}}function ke(e,t){if(1&e){const e=l.Ub();l.Tb(0,"page-content",3),l.ec(1,"async"),l.Tb(2,"form",4),l.Tb(3,"div",5),l.Tb(4,"radio-group-field",14),l.Fc(5,ge,1,2,"field-option",7),l.Sb(),l.Sb(),l.Sb(),l.Ob(6,"hr"),l.Tb(7,"div",5),l.Ob(8,"address-form",15),l.Sb(),l.Tb(9,"h2"),l.Hc(10),l.Sb(),l.Tb(11,"form",4),l.Ob(12,"textarea-field",16),l.Sb(),l.Tb(13,"actions",9),l.Tb(14,"button",10),l.bc("click",(function(){return l.wc(e),l.dc().next()})),l.Hc(15),l.Sb(),l.Fc(16,ve,1,0,"ng-template",null,17,l.Gc),l.Fc(18,ye,2,1,"button",18),l.Sb(),l.Sb()}if(2&e){const e=l.dc();l.kc("heading",e.i18n.ad.title.deliveryAddress)("mobileHeading",e.i18n.ad.mobileTitle.deliveryAddress)("mode",l.fc(1,13,e.layout.ltsm$)?"fullHeight":"normal"),l.zb(2),l.kc("formGroup",e.form),l.zb(2),l.kc("asColumn",e.data.addresses.length>3)("label",e.i18n.ad.chooseDeliveryAddress),l.zb(1),l.kc("ngForOf",e.data.addresses),l.zb(3),l.kc("addressForm",e.addressForm)("configuration",e.data.addressConfiguration),l.zb(2),l.Ic(e.i18n.ad.remarks),l.zb(1),l.kc("formGroup",e.form),l.zb(4),l.Jc(" ",e.i18n.general.next," "),l.zb(3),l.kc("ngIf",e.data.deliveryMethods.length>1)}}function Se(e,t){if(1&e&&l.Ob(0,"field-option",11),2&e){const e=t.$implicit;l.kc("value",e.id)("text",e.name)}}function Te(e,t){1&e&&l.Hc(0,"\xa0")}function ze(e,t){if(1&e){const e=l.Ub();l.Tb(0,"page-content",3),l.ec(1,"async"),l.Tb(2,"form",4),l.Tb(3,"radio-group-field",20),l.Fc(4,Se,1,2,"field-option",7),l.Sb(),l.Sb(),l.Tb(5,"actions",9),l.Tb(6,"button",10),l.bc("click",(function(){return l.wc(e),l.dc().next()})),l.Hc(7),l.Sb(),l.Fc(8,Te,1,0,"ng-template",null,17,l.Gc),l.Tb(10,"button",19),l.bc("click",(function(){return l.wc(e),l.dc().back()})),l.Hc(11),l.Sb(),l.Sb(),l.Sb()}if(2&e){const e=l.dc();l.kc("heading",e.i18n.ad.title.paymentType)("mobileHeading",e.i18n.ad.mobileTitle.paymentType)("mode",l.fc(1,9,e.layout.ltsm$)?"fullHeight":"normal"),l.zb(2),l.kc("formGroup",e.form),l.zb(1),l.kc("asColumn",!0)("label",e.i18n.ad.choosePaymentType),l.zb(1),l.kc("ngForOf",e.data.paymentTypes),l.zb(3),l.Jc(" ",e.i18n.general.next," "),l.zb(4),l.Jc(" ",e.i18n.general.back," ")}}function Ie(e,t){1&e&&l.Ob(0,"hr",28)}function Oe(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Fc(1,Ie,1,0,"hr",26),l.ec(2,"async"),l.Tb(3,"form",4),l.Tb(4,"confirmation-password",27),l.bc("confirmationModeChanged",(function(t){return l.wc(e),l.dc(2).confirmationMode$.next(t)}))("confirmed",(function(t){return l.wc(e),l.dc(2).submit(t)})),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc(2);l.zb(1),l.kc("ngIf",l.fc(2,4,e.layout.gtxxs$)),l.zb(2),l.kc("formGroup",e.form),l.zb(1),l.kc("passwordInput",e.data.confirmationPasswordInput)("createDeviceConfirmation",e.createDeviceConfirmation)}}function we(e,t){if(1&e){const e=l.Ub();l.Tb(0,"button",29),l.bc("click",(function(){return l.wc(e),l.dc(2).next()})),l.ec(1,"async"),l.Hc(2),l.Sb()}if(2&e){const e=l.dc(2);l.kc("disabled",l.fc(1,2,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.general.confirm," ")}}function xe(e,t){1&e&&l.Hc(0,"\xa0")}function Fe(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",3),l.ec(2,"async"),l.Tb(3,"label-value",13),l.Ob(4,"user-link",21),l.Sb(),l.Tb(5,"label-value",13),l.Hc(6),l.ec(7,"currency"),l.Sb(),l.Ob(8,"hr"),l.Tb(9,"label-value",22),l.Hc(10),l.ec(11,"currency"),l.Sb(),l.Tb(12,"label",23),l.Hc(13),l.Sb(),l.Ob(14,"shopping-cart-items",24),l.Fc(15,Oe,5,6,"ng-container",8),l.Tb(16,"actions",9),l.Fc(17,we,3,4,"button",25),l.ec(18,"async"),l.Fc(19,xe,1,0,"ng-template",null,17,l.Gc),l.Tb(21,"button",19),l.bc("click",(function(){return l.wc(e),l.dc().back()})),l.Hc(22),l.Sb(),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.uc(20),t=l.dc();l.zb(1),l.kc("heading",t.i18n.ad.title.confirmOrder)("mobileHeading",t.i18n.ad.mobileTitle.confirmOrder)("mode",l.fc(2,16,t.layout.ltsm$)?"fullHeight":"normal"),l.zb(2),l.kc("label",t.i18n.ad.seller),l.zb(1),l.kc("user",t.data.cart.seller),l.zb(1),l.kc("label",t.i18n.ad.deliveryPrice),l.zb(1),l.Jc(" ",t.negotiated?t.i18n.ad.toBeConfirmedBySeller:l.gc(7,18,t.deliveryMethod.chargeAmount,t.deliveryMethod.chargeCurrency)," "),l.zb(3),l.kc("label",t.i18n.ad.total),l.zb(1),l.Jc(" ",l.gc(11,21,t.totalPrice,t.data.cart.currency)," "),l.zb(3),l.Jc(" ",t.negotiated?t.i18n.ad.deliveryPriceToBeConfirmed:t.i18n.ad.reserveAmount," "),l.zb(1),l.kc("items",t.data.cart.items)("currency",t.data.cart.currency),l.zb(1),l.kc("ngIf",!t.negotiated&&t.data.confirmationPasswordInput),l.zb(2),l.kc("ngIf",t.negotiated||l.fc(18,24,t.confirmationMode$)!=t.ConfirmationMode.Device)("ngIfElse",e),l.zb(5),l.Jc(" ",t.i18n.general.back," ")}}let He=(()=>{class e extends c.a{constructor(e,t,i,a){super(e),this.shoppingCartService=t,this.addressHelper=i,this.marketplaceHelper=a,this.ConfirmationMode=C.a,this.step$=new A.a(null),this.deliveryMethod$=new A.a(null),this.address$=new A.a(null),this.confirmationMode$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.addSub(this.shoppingCartService.getShoppingCartDataForCheckout({id:this.route.snapshot.params.id}).subscribe(e=>{this.data=e}))}onDataInitialized(e){const t=!Object(s.h)(e.deliveryMethods);if(this.form=this.formBuilder.group({remarks:null}),this.step=e.deliveryMethods.length>1?"delivery":"address",this.confirmationPassword=this.formBuilder.control(null),this.form.setControl("confirmationPassword",this.confirmationPassword),t){const t=this.formBuilder.control(e.deliveryMethods);this.form.addControl("deliveryMethod",t),this.addSub(t.valueChanges.subscribe(t=>this.updateDeliveryMethod(t,e))),t.setValue(e.deliveryMethods[0].id,{emitEvent:!0})}e.addresses.push({id:"customAddress",name:this.i18n.ad.customAddress});const i=this.formBuilder.control(e.addresses);if(this.form.addControl("address",i),this.addSub(i.valueChanges.subscribe(t=>this.updateAddress(t,e))),this.addressForm=this.addressHelper.addressFormGroup(e.addressConfiguration),i.setValue(e.addresses[0].id,{emitEvent:!0}),!Object(s.h)(e.paymentTypes)){const t=this.formBuilder.control(e.paymentTypes);this.form.addControl("paymentType",t),t.setValue(e.paymentTypes[0].id,{emitEvent:!0})}}updateDeliveryMethod(e,t){this.deliveryMethod=t.deliveryMethods.find(t=>t.id===e)}updateAddress(e,t){this.address=t.addresses.find(t=>t.id===e),"customAddress"===this.address.id?this.addressForm.reset():this.addressForm.patchValue(this.address)}resolveMenu(){return o.b.SHOPPING_CART}next(){switch(this.step){case"delivery":this.step="address";break;case"address":this.step=this.data.paymentTypes.length>1?"payment":"confirm";break;case"payment":this.step="confirm";break;case"confirm":this.submit()}}back(){switch(this.step){case"confirm":this.step=this.data.paymentTypes.length>1?"payment":"address";break;case"payment":this.step="address";break;case"address":this.data.deliveryMethods.length>1&&(this.step="delivery")}}submit(e){if(e&&this.confirmationPassword.setValue(e),!Object(s.F)(this.confirmationPassword))return;const t=Object(N.cloneDeep)(this.form.value);delete t.address,t.deliveryAddress=this.addressForm.value,this.addSub(this.shoppingCartService.checkoutShoppingCart({id:this.data.cart.id,body:t,confirmationPassword:this.confirmationPassword.value}).subscribe(e=>{this.marketplaceHelper.cartItems=e,this.notification.snackBar(this.i18n.ad.orderWaitingForSellersApproval),this.menu.navigate({menu:new o.a(o.b.PURCHASES),replaceUrl:!0})}))}get step(){return this.step$.value}set step(e){this.step$.next(e)}get deliveryMethod(){return this.deliveryMethod$.value}set deliveryMethod(e){this.deliveryMethod$.next(e)}get address(){return this.address$.value}set address(e){this.address$.next(e)}get totalPrice(){const e=+this.data.cart.totalPrice;return this.negotiated?e:+this.deliveryMethod.chargeAmount+e}get negotiated(){return null==this.deliveryMethod||null==this.deliveryMethod.chargeAmount}get createDeviceConfirmation(){return()=>({type:x.s.SHOPPING_CART_CHECKOUT,seller:this.ApiHelper.accountOwner(this.data.cart.seller),amount:this.totalPrice,paymentType:this.form.value.paymentType})}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.E),l.Nb(F.a),l.Nb(H.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["cart-checkout"]],features:[l.wb],decls:7,vars:10,consts:[[3,"ready","ngSwitch"],[3,"heading","mobileHeading","mode",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"heading","mobileHeading","mode"],[3,"formGroup"],[1,"mb-4"],["formControlName","deliveryMethod",3,"asColumn","label"],[3,"value","text",4,"ngFor","ngForOf"],[4,"ngIf"],["forceRow",""],[1,"btn","btn-primary",3,"click"],[3,"value","text"],[3,"label",4,"ngIf"],[3,"label"],["formControlName","address",3,"asColumn","label"],[3,"addressForm","configuration"],["formControlName","remarks"],["spacer",""],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"btn","btn-outline-primary",3,"click"],["formControlName","paymentType",3,"asColumn","label"],[3,"user"],[1,"totalAmount",3,"label"],[1,"any-label-value","notice","text-muted"],[3,"items","currency"],["class","btn btn-primary",3,"disabled","click",4,"ngIf","ngIfElse"],["class","mt-0",4,"ngIf"],["focused","","formControlName","confirmationPassword",3,"passwordInput","createDeviceConfirmation","confirmationModeChanged","confirmed"],[1,"mt-0"],[1,"btn","btn-primary",3,"disabled","click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.ec(2,"async"),l.Fc(3,pe,13,14,"page-content",1),l.Fc(4,ke,19,15,"page-content",1),l.Fc(5,ze,12,11,"page-content",1),l.Fc(6,Fe,23,26,"ng-container",2),l.Sb()),2&e&&(l.kc("ready",l.fc(1,6,t.data$))("ngSwitch",l.fc(2,8,t.step$)),l.zb(3),l.kc("ngSwitchCase","delivery"),l.zb(1),l.kc("ngSwitchCase","address"),l.zb(1),l.kc("ngSwitchCase","payment"),l.zb(1),l.kc("ngSwitchCase","confirm"))},directives:[d.a,b.x,b.y,u.a,n.I,n.w,n.n,D.a,n.v,n.l,b.s,b.t,g.a,$.a,m.a,P.a,p.a,f.a,le,de.a,be.a],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();function Ce(e,t){if(1&e&&(l.Tb(0,"mobile-result",7),l.Tb(1,"div"),l.Tb(2,"div",8),l.Hc(3),l.Sb(),l.Tb(4,"div",9),l.Hc(5),l.Sb(),l.Tb(6,"div",9),l.Hc(7),l.Sb(),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.kc("avatarImage",e.seller.image),l.zb(3),l.Jc(" ",e.seller.display," "),l.zb(2),l.Jc(" ",e.currency.name," "),l.zb(2),l.Jc(" ",e.items.length+" "+(e.items.length>1?i.i18n.ad.items:i.i18n.ad.item)," ")}}const Ne=function(e,t){return{"pb-0":e,"border-0":t}};function Ae(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"tr",13),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(4);return a.router.navigate(a.path(i))})),l.Tb(2,"td",14),l.ec(3,"async"),l.ec(4,"async"),l.Ob(5,"avatar",15),l.Sb(),l.Tb(6,"td"),l.Tb(7,"a",16),l.Hc(8),l.Sb(),l.Sb(),l.Tb(9,"td"),l.Hc(10),l.Sb(),l.Tb(11,"td"),l.Hc(12),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=t.$implicit,i=l.dc(4);l.zb(2),l.kc("ngClass",l.oc(11,Ne,l.fc(3,7,i.layout.xxs$),l.fc(4,9,i.layout.xxs$))),l.zb(3),l.kc("image",e.seller.image)("tooltip",e.seller.display),l.zb(2),l.kc("routerLink",i.path(e)),l.zb(1),l.Jc(" ",e.seller.shortDisplay," "),l.zb(2),l.Jc(" ",e.currency.name," "),l.zb(2),l.Jc(" ",e.items.length," ")}}function De(e,t){if(1&e&&(l.Tb(0,"table",10),l.Tb(1,"thead"),l.Ob(2,"th",11),l.Tb(3,"th"),l.Hc(4),l.Sb(),l.Tb(5,"th"),l.Hc(6),l.Sb(),l.Tb(7,"th"),l.Hc(8),l.Sb(),l.Sb(),l.Tb(9,"tbody"),l.Fc(10,Ae,13,14,"ng-container",12),l.Sb(),l.Sb()),2&e){const e=l.dc(3);l.zb(4),l.Ic(e.i18n.ad.seller),l.zb(2),l.Ic(e.i18n.general.currency),l.zb(2),l.Ic(e.i18n.ad.items),l.zb(2),l.kc("ngForOf",e.data)}}function $e(e,t){if(1&e&&(l.Tb(0,"results-layout",4),l.Fc(1,Ce,8,4,"mobile-result",5),l.Fc(2,De,11,4,"table",6),l.Sb()),2&e){const e=l.dc(2);l.kc("results",e.data)("toLink",e.toLink)}}function Pe(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Rb(3),l.Hc(4),l.Qb(),l.Sb(),l.Fc(5,$e,3,2,"results-layout",3),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.shoppingCart)("mobileHeading",e.i18n.ad.mobileTitle.shoppingCart)("headingActions",l.fc(2,5,e.headingActions$)),l.zb(3),l.Jc(" ",e.data.length>0?e.i18n.ad.chooseSeller:e.i18n.ad.cartEmpty," "),l.zb(1),l.kc("ngIf",e.data.length>0)}}let Me=(()=>{class e extends c.a{constructor(e,t){super(e),this.shoppingCartService=t}ngOnInit(){super.ngOnInit(),this.addSub(this.shoppingCartService.getShoppingCarts({}).subscribe(e=>{this.data=e}))}onDataInitialized(e){1===e.length&&this.router.navigate(this.path(e[0]),{replaceUrl:!0})}resolveMenu(){return o.b.SHOPPING_CART}get toLink(){return e=>this.path(e)}path(e){return["/marketplace","cart",e.id]}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.E))},e.\u0275cmp=l.Hb({type:e,selectors:[["list-shopping-cart"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"results","toLink",4,"ngIf"],[3,"results","toLink"],["avatarIcon","user",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["avatarIcon","user",3,"avatarImage"],[1,"cell-main"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],[4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],["icon","user",3,"image","tooltip"],[3,"routerLink"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Pe,6,7,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,E.a,q.a,Q.a,J.a,b.s,b.q,h.a,L.b,a.h],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();var Re=i("a/z7"),Ee=i("tAww");function qe(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.Qb()),2&e){const e=l.dc();l.zb(1),l.Jc(" ",e.i18n.ad.cartEmpty," ")}}function Qe(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"label-value",4),l.Ob(2,"user-link",5),l.Sb(),l.Tb(3,"label-value",6),l.Hc(4),l.ec(5,"currency"),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("label",e.i18n.ad.seller),l.zb(1),l.kc("user",e.data.seller),l.zb(1),l.kc("label",e.i18n.ad.total),l.zb(1),l.Jc(" ",l.gc(5,4,e.data.totalPrice,e.data.currency)," ")}}function Je(e,t){1&e&&l.Pb(0)}function Le(e,t){if(1&e&&(l.Rb(0),l.Fc(1,Je,1,0,"ng-container",7),l.Qb()),2&e){l.dc();const e=l.uc(12);l.zb(1),l.kc("ngTemplateOutlet",e)}}function Be(e,t){1&e&&l.Pb(0)}function Ge(e,t){if(1&e&&(l.Rb(0),l.Fc(1,Be,1,0,"ng-container",7),l.Qb()),2&e){l.dc();const e=l.uc(12);l.zb(1),l.kc("ngTemplateOutlet",e)}}function Ue(e,t){if(1&e){const e=l.Ub();l.Tb(0,"shopping-cart-items",8),l.bc("changeQuantity",(function(t){return l.wc(e),l.dc().changeQuantity(t)}))("remove",(function(t){return l.wc(e),l.dc().remove(t)})),l.Sb()}if(2&e){const e=l.dc();l.kc("detailed",!0)("items",e.data.items)("currency",e.data.currency)}}let Ve=(()=>{class e extends c.a{constructor(e,t,i){super(e),this.shoppingCartService=t,this.marketplaceHelper=i,this.emptyCart$=new A.a(!1)}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.errorHandler.requestWithCustomErrorHandler(t=>{const i=e.details?this.shoppingCartService.getShoppingCartDetails({id:this.id}):this.shoppingCartService.adjustAndGetShoppingCartDetails({id:this.id});e.details=!1,this.addSub(i.subscribe(e=>{this.data=e},e=>{e.status===Re.a.NOT_FOUND||e.status===Re.a.FORBIDDEN?this.emptyCart$.next(!0):t(e)}))})}onDataInitialized(e){this.headingActions=[new Ee.c("local_mall",this.i18n.ad.checkout,()=>this.checkout(),!0)],this.checkMessages(e)}checkMessages(e){const t=new Set;e.items.forEach(e=>{e.availability===x.jb.UNAVAILABLE?this.unavailable=!0:e.availability===x.jb.OUT_OF_STOCK?this.outOfStock=!0:null!=e.quantityAdjustment&&t.add(e.quantityAdjustment)});let i="";this.unavailable&&(i+=this.i18n.ad.itemsNoLongerAvailable),this.outOfStock&&(i+=this.i18n.ad.itemsOutOfStock),t.forEach(e=>{switch(e){case x.kb.MAX:i+=this.i18n.ad.adjustedQuantity.max;break;case x.kb.MIN:i+=this.i18n.ad.adjustedQuantity.min;break;case x.kb.STOCK:i+=this.i18n.ad.adjustedQuantity.stock}}),e.insufficientBalance&&(i+=this.i18n.ad.lowBalance(e.currency.name)),""!==i&&this.notification.warning(this.i18n.ad.articlesNotice(i),!0,!1)}checkout(){this.unavailable||this.outOfStock||this.data.insufficientBalance?this.notification.error(this.i18n.ad.error.cannotProceedToCheckout):this.router.navigate(["/marketplace","checkout",this.id])}isAvailable(e){return e.availability===x.jb.AVAILABLE}remove(e){this.addSub(this.shoppingCartService.removeItemFromShoppingCart({ad:e.product.id}).subscribe(e=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload(),this.marketplaceHelper.cartItems=e}))}changeQuantity(t){const i=i=>{0!=+i&&this.addSub(this.shoppingCartService.modifyItemQuantityOnShoppingCart({ad:t[1].product.id,quantity:+i}).subscribe(t=>{e.details=!0,this.reload(),this.marketplaceHelper.cartItems=t}))};t[2]?i(t[0]):this.notification.confirm({title:this.i18n.ad.changeQuantity,labelPosition:"above",customFields:[{internalName:"quantity",name:this.i18n.ad.quantity,type:t[1].product.allowDecimalQuantity?x.p.DECIMAL:x.p.INTEGER,defaultValue:this.marketplaceHelper.getFormattedQuantity(t[1])}],callback:e=>i(+e.customValues.quantity)})}resolveQuantityLabel(e){switch(e.availability){case x.jb.AVAILABLE:return this.marketplaceHelper.getFormattedQuantity(e);case x.jb.OUT_OF_STOCK:return this.i18n.ad.outOfStock;case x.jb.UNAVAILABLE:return this.i18n.ad.itemNotAvailable}return""}resolveMenu(){return o.b.SHOPPING_CART}}return e.details=!1,e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.E),l.Nb(H.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-cart"]],features:[l.wb],decls:13,vars:18,consts:[[3,"ready"],["mode","filters","mode","viewForm",3,"heading","mobileHeading","headingActions"],[4,"ngIf"],["cartItems",""],[3,"label"],[3,"user"],[1,"totalAmount",3,"label"],[4,"ngTemplateOutlet"],[3,"detailed","items","currency","changeQuantity","remove"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.ec(2,"async"),l.Tb(3,"page-content",1),l.ec(4,"async"),l.Fc(5,qe,2,1,"ng-container",2),l.Fc(6,Qe,6,7,"ng-container",2),l.Fc(7,Le,2,1,"ng-container",2),l.ec(8,"async"),l.Sb(),l.Fc(9,Ge,2,1,"ng-container",2),l.ec(10,"async"),l.Sb(),l.Fc(11,Ue,1,3,"ng-template",null,3,l.Gc)),2&e&&(l.kc("ready",l.fc(1,8,t.data$)||l.fc(2,10,t.emptyCart$)),l.zb(3),l.kc("heading",t.i18n.ad.title.shoppingCart)("mobileHeading",t.i18n.ad.mobileTitle.shoppingCart)("headingActions",l.fc(4,12,t.headingActions$)),l.zb(2),l.kc("ngIf",!t.data),l.zb(1),l.kc("ngIf",t.data),l.zb(1),l.kc("ngIf",!l.fc(8,14,t.layout.ltsm$)&&t.data),l.zb(2),l.kc("ngIf",l.fc(10,16,t.layout.ltsm$)&&t.data))},directives:[d.a,u.a,b.t,m.a,f.a,b.A,le],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();var je=i("DIHi"),_e=i("yHfF"),Ke=i("0C6t"),We=i("WYBn");function Ye(e,t){if(1&e&&(l.Tb(0,"radio-group-field",15),l.Ob(1,"field-option",16),l.Ob(2,"field-option",17),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.chargeType),l.zb(1),l.kc("text",e.i18n.ad.fixed),l.zb(1),l.kc("text",e.i18n.ad.negotiated)}}function Xe(e,t){if(1&e&&(l.Tb(0,"label-value",18),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.chargeType),l.zb(1),l.Jc(" ",e.data.deliveryMethod.chargeType===e.DeliveryMethodChargeTypeEnum.FIXED?e.i18n.ad.fixed:e.i18n.ad.negotiated," ")}}function Ze(e,t){if(1&e&&l.Ob(0,"field-option",21),2&e){const e=t.$implicit,i=l.dc(3);l.kc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function et(e,t){if(1&e&&(l.Tb(0,"single-selection-field",19),l.Fc(1,Ze,1,4,"field-option",20),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.currency),l.zb(1),l.kc("ngForOf",e.data.currencies)}}function tt(e,t){if(1&e&&l.Ob(0,"decimal-field",22),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.deliveryPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function it(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Tb(3,"form",3),l.Ob(4,"input-field",4),l.Fc(5,Ye,3,3,"radio-group-field",5),l.Fc(6,Xe,2,2,"label-value",6),l.Fc(7,et,2,2,"single-selection-field",7),l.ec(8,"async"),l.Fc(9,tt,1,4,"decimal-field",8),l.ec(10,"async"),l.Ob(11,"boolean-field",9),l.Ob(12,"time-interval-field",10),l.Ob(13,"time-interval-field",11),l.Ob(14,"textarea-field",12),l.Sb(),l.Tb(15,"actions",13),l.Tb(16,"button",14),l.bc("click",(function(){return l.wc(e),l.dc().save()})),l.ec(17,"async"),l.Hc(18),l.Sb(),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc();l.zb(1),l.kc("heading",e.create?e.i18n.ad.title.deliveryMethodNew:e.i18n.ad.title.deliveryMethod)("mobileHeading",e.create?e.i18n.ad.mobileTitle.deliveryMethodNew:e.i18n.ad.mobileTitle.deliveryMethod)("headingActions",l.fc(2,15,e.headingActions$)),l.zb(2),l.kc("formGroup",e.form),l.zb(1),l.kc("label",e.i18n.general.name),l.zb(1),l.kc("ngIf",e.create),l.zb(1),l.kc("ngIf",!e.create),l.zb(1),l.kc("ngIf","fixed"===(l.fc(8,17,e.form.get("chargeType").valueChanges)||e.form.get("chargeType").value)&&e.data.currencies&&e.data.currencies.length>1),l.zb(2),l.kc("ngIf",l.fc(10,19,e.currency$)),l.zb(2),l.kc("label",e.i18n.general.enabled),l.zb(1),l.kc("label",e.i18n.ad.minDeliveryTime),l.zb(1),l.kc("label",e.i18n.ad.maxDeliveryTime),l.zb(1),l.kc("label",e.i18n.general.details),l.zb(2),l.kc("disabled",l.fc(17,21,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.general.submit," ")}}let at=(()=>{class e extends c.a{constructor(e,t){super(e),this.deliveryMethodService=t,this.DeliveryMethodChargeTypeEnum=x.q,this.currency$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.id=this.route.snapshot.params.id,this.create=null==this.id;const e=this.create?this.deliveryMethodService.getDeliveryMethodDataForNew({user:this.user}):this.deliveryMethodService.getDeliveryMethodDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=e.deliveryMethod;this.form=this.formBuilder.group({name:[t.name,n.G.required],chargeType:t.chargeType,chargeCurrency:t.chargeCurrency,chargeAmount:t.chargeAmount,enabled:t.enabled,minDeliveryTime:t.minDeliveryTime,maxDeliveryTime:[t.maxDeliveryTime,n.G.required],description:[t.description,n.G.required],version:t.version}),this.updateCurrency(e),this.addSub(this.form.controls.chargeType.valueChanges.subscribe(()=>this.updateCurrency(e))),this.addSub(this.form.controls.chargeCurrency.valueChanges.subscribe(()=>this.updateCurrency(e)))}updateCurrency(e){if(Object(s.h)(e.currencies)||this.form.controls.chargeType.value!==x.q.FIXED)this.currency=null,this.form.patchValue({chargeCurrency:null,chargeAmount:null},{emitEvent:!1}),this.form.controls.chargeCurrency.clearValidators(),this.form.controls.chargeAmount.clearValidators();else{const t=this.form.controls.chargeCurrency.value;this.currency=e.currencies.find(e=>e.id===t||e.internalName===t)||e.currencies[0],this.form.patchValue({chargeCurrency:this.currency.id},{emitEvent:!1}),this.form.controls.chargeCurrency.setValidators(n.G.required),this.form.controls.chargeAmount.setValidators(n.G.required)}}save(){if(!Object(s.F)(this.form))return;const e=this.form.value,t=this.create?this.deliveryMethodService.createDeliveryMethod({body:e,user:this.user}):this.deliveryMethodService.updateDeliveryMethod({id:this.id,body:e});this.addSub(t.subscribe(()=>{this.notification.snackBar(this.create?this.i18n.ad.deliveryMethodCreated:this.i18n.ad.deliveryMethodSaved),history.back()}))}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.DELIVERY_METHODS)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.j))},e.\u0275cmp=l.Hb({type:e,selectors:[["edit-delivery-method"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["formControlName","name","required","",3,"label"],["formControlName","chargeType",3,"label",4,"ngIf"],[3,"label",4,"ngIf"],["formControlName","chargeCurrency","required","",3,"label",4,"ngIf"],["formControlName","chargeAmount","fieldSize","full","required","",3,"label","scale","prefix","suffix",4,"ngIf"],["formControlName","enabled",3,"label"],["formControlName","minDeliveryTime",3,"label"],["formControlName","maxDeliveryTime","required","",3,"label"],["formControlName","description","required","",3,"label"],["forceRow",""],[1,"btn","btn-primary",3,"disabled","click"],["formControlName","chargeType",3,"label"],["value","fixed",3,"text"],["value","negotiated",3,"text"],[3,"label"],["formControlName","chargeCurrency","required","",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","chargeAmount","fieldSize","full","required","",3,"label","scale","prefix","suffix"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,it,19,23,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,n.I,n.w,n.n,je.a,n.v,n.l,n.D,_e.a,Ke.a,p.a,g.a,D.a,$.a,m.a,We.a,b.s,G.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();var nt=i("bqp0");function rt(e,t){if(1&e&&l.Ob(0,"user-info",7),2&e){const e=l.dc(2);l.kc("user",e.data.user)}}function ct(e,t){if(1&e&&(l.Tb(0,"div",10),l.Hc(1),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(2);l.zb(1),l.Kc(" ",t.i18n.ad.minDeliveryTime,": ",t.format.formatTimeInterval(e.minDeliveryTime),"")}}function st(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",13),l.Tb(1,"button",14),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(2).remove(i),t.stopPropagation(),t.preventDefault()})),l.Ob(2,"icon",15),l.Sb(),l.Sb()}if(2&e){const e=l.dc(3);l.zb(1),l.kc("tooltip",e.i18n.general.remove)}}function ot(e,t){if(1&e&&(l.Tb(0,"mobile-result"),l.Tb(1,"div",8),l.Tb(2,"div"),l.Tb(3,"div",9),l.Hc(4),l.Sb(),l.Tb(5,"div",10),l.Hc(6),l.Sb(),l.Tb(7,"div",10),l.Hc(8),l.ec(9,"currency"),l.Sb(),l.Fc(10,ct,2,2,"div",11),l.Tb(11,"div",10),l.Hc(12),l.Sb(),l.Tb(13,"div",10),l.Hc(14),l.Sb(),l.Sb(),l.Fc(15,st,3,1,"div",12),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc(2);l.zb(4),l.Ic(e.name),l.zb(2),l.Kc(" ",i.i18n.ad.chargeType,": ",i.resolveChargeTypeLabel(e.chargeType),""),l.zb(2),l.Kc(" ",i.i18n.ad.price,": ",l.gc(9,11,e.chargeAmount,e.chargeCurrency),""),l.zb(2),l.kc("ngIf",e.minDeliveryTime),l.zb(2),l.Kc(" ",i.i18n.ad.maxDeliveryTime,": ",i.format.formatTimeInterval(e.maxDeliveryTime),""),l.zb(2),l.Kc(" ",i.i18n.general.enabled,": ",e.enabled?i.i18n.general.yes:i.i18n.general.no,""),l.zb(1),l.kc("ngIf",i.data.canManage)}}function lt(e,t){1&e&&l.Ob(0,"th",20)}function dt(e,t){if(1&e){const e=l.Ub();l.Tb(0,"td",20),l.Tb(1,"button",14),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(3).remove(i),t.stopPropagation()})),l.Ob(2,"icon",15),l.Sb(),l.Sb()}if(2&e){const e=l.dc(4);l.zb(1),l.kc("tooltip",e.i18n.general.remove)}}function bt(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"tr",21),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(3);return a.router.navigate(a.viewPath(i))})),l.Tb(2,"td"),l.Hc(3),l.Sb(),l.Tb(4,"td"),l.Hc(5),l.Sb(),l.Tb(6,"td",17),l.Hc(7),l.ec(8,"currency"),l.Sb(),l.Tb(9,"td"),l.Hc(10),l.Sb(),l.Tb(11,"td"),l.Hc(12),l.Sb(),l.Tb(13,"td"),l.Hc(14),l.Sb(),l.Fc(15,dt,3,1,"td",18),l.Sb(),l.Qb()}if(2&e){const e=t.$implicit,i=l.dc(3);l.zb(3),l.Jc(" ",e.name," "),l.zb(2),l.Jc(" ",i.resolveChargeTypeLabel(e.chargeType)," "),l.zb(2),l.Jc(" ",l.gc(8,7,e.chargeAmount,e.chargeCurrency)," "),l.zb(3),l.Jc(" ",i.format.formatTimeInterval(e.minDeliveryTime)," "),l.zb(2),l.Jc(" ",i.format.formatTimeInterval(e.maxDeliveryTime)," "),l.zb(2),l.Jc(" ",e.enabled?i.i18n.general.yes:i.i18n.general.no," "),l.zb(1),l.kc("ngIf",i.data.canManage)}}function ut(e,t){if(1&e&&(l.Tb(0,"table",16),l.Tb(1,"thead"),l.Tb(2,"th"),l.Hc(3),l.Sb(),l.Tb(4,"th"),l.Hc(5),l.Sb(),l.Tb(6,"th",17),l.Hc(7),l.Sb(),l.Tb(8,"th"),l.Hc(9),l.Sb(),l.Tb(10,"th"),l.Hc(11),l.Sb(),l.Tb(12,"th"),l.Hc(13),l.Sb(),l.Fc(14,lt,1,0,"th",18),l.Sb(),l.Tb(15,"tbody"),l.Fc(16,bt,16,10,"ng-container",19),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.zb(3),l.Ic(e.i18n.general.name),l.zb(2),l.Ic(e.i18n.ad.chargeType),l.zb(2),l.Ic(e.i18n.ad.price),l.zb(2),l.Ic(e.i18n.ad.minDeliveryTime),l.zb(2),l.Ic(e.i18n.ad.maxDeliveryTime),l.zb(2),l.Ic(e.i18n.general.enabled),l.zb(1),l.kc("ngIf",e.data.canManage),l.zb(2),l.kc("ngForOf",e.data.deliveryMethods)}}function mt(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,rt,1,1,"user-info",3),l.Sb(),l.Tb(4,"results-layout",4),l.Fc(5,ot,16,14,"mobile-result",5),l.Fc(6,ut,17,8,"table",6),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.deliveryMethods)("mobileHeading",e.i18n.ad.mobileTitle.deliveryMethods)("headingActions",l.fc(2,7,e.headingActions$))("mode",e.self?"empty":"normal"),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("results",e.data.deliveryMethods)("toLink",e.toLink)}}let ft=(()=>{class e extends c.a{constructor(e,t){super(e),this.deliveryMethodService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.addSub(this.deliveryMethodService.getUserDeliveryMethodsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user),e.canCreate&&(this.headingActions=[new Ee.c("add",this.i18n.general.addNew,()=>{this.router.navigate(["/marketplace",this.param,"delivery-methods","new"])},!0)])}viewPath(e){return["/marketplace","delivery-methods","view",e.id]}get toLink(){return e=>this.viewPath(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.deliveryMethodService.deleteDeliveryMethod({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.name)),this.reload()}))}resolveChargeTypeLabel(e){switch(e){case x.q.FIXED:return this.i18n.ad.fixed;case x.q.NEGOTIATED:return this.i18n.ad.negotiated}return""}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.DELIVERY_METHODS)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.j))},e.\u0275cmp=l.Hb({type:e,selectors:[["list-delivery-methods"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],[1,"cell-main"],[1,"cell-text"],["class","cell-text",4,"ngIf"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,mt,7,9,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,E.a,q.a,Q.a,nt.a,J.a,L.b,B.a,b.s],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();var ht=i("MhyI");function pt(e,t){if(1&e&&(l.Tb(0,"label-value",8),l.Ob(1,"user-link",9),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user)}}function gt(e,t){if(1&e&&(l.Tb(0,"label-value",6),l.Hc(1),l.ec(2,"currency"),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.price),l.zb(1),l.Jc(" ",l.gc(2,2,e.data.chargeAmount,e.data.chargeCurrency)," ")}}function vt(e,t){if(1&e&&(l.Tb(0,"label-value",6),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.minDeliveryTime),l.zb(1),l.Jc(" ",e.format.formatTimeInterval(e.data.minDeliveryTime)," ")}}function yt(e,t){if(1&e&&(l.Rb(0,10),l.Tb(1,"h2",11),l.Hc(2),l.Sb(),l.Tb(3,"div",12),l.Hc(4),l.Sb(),l.Qb()),2&e){const e=l.dc(2);l.zb(2),l.Jc(" ",e.i18n.general.description," "),l.zb(2),l.Jc(" ",e.data.description," ")}}function kt(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,pt,2,2,"label-value",3),l.Ob(4,"label-value",4),l.Ob(5,"label-value",4),l.Fc(6,gt,3,5,"label-value",5),l.Fc(7,vt,2,2,"label-value",5),l.Tb(8,"label-value",6),l.Hc(9),l.Sb(),l.Tb(10,"label-value",6),l.Hc(11),l.Sb(),l.Fc(12,yt,5,2,"ng-container",7),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.deliveryMethod)("mobileHeading",e.i18n.ad.mobileTitle.deliveryMethod)("headingActions",l.fc(2,15,e.headingActions$)),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("label",e.i18n.general.name)("value",e.data.name),l.zb(1),l.kc("label",e.i18n.ad.chargeType)("value",e.resolveChargeTypeLabel()),l.zb(1),l.kc("ngIf",e.data.chargeAmount),l.zb(1),l.kc("ngIf",e.data.minDeliveryTime),l.zb(1),l.kc("label",e.i18n.ad.maxDeliveryTime),l.zb(1),l.Jc(" ",e.format.formatTimeInterval(e.data.maxDeliveryTime)," "),l.zb(1),l.kc("label",e.i18n.general.enabled),l.zb(1),l.Jc(" ",e.data.enabled?e.i18n.general.yes:e.i18n.general.no," "),l.zb(1),l.kc("ngIf",e.data.description)}}let St=(()=>{class e extends ht.a{constructor(e,t){super(e),this.deliveryMethodService=t}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.deliveryMethodService.viewDeliveryMethod({id:this.id}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=[];e.canEdit&&t.push(new Ee.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/marketplace","delivery-methods","edit",this.id]),!0)),this.headingActions=t}resolveChargeTypeLabel(){switch(this.data.chargeType){case x.q.FIXED:return this.i18n.ad.fixed;case x.q.NEGOTIATED:return this.i18n.ad.negotiated}return""}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.DELIVERY_METHODS)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.j))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-delivery-method"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],[3,"label",4,"ngIf"],[3,"label"],["class","d-flex justify-content-start",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"],[1,"d-flex","justify-content-start"],[1,"mt-3"],[1,"break-nl"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,kt,13,17,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,f.a],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();var Tt=i("bER3"),zt=i("SxV6"),It=i("LqlI"),Ot=i("6g1M"),wt=i("lrfU"),xt=i("pz1b"),Ft=i("4APx"),Ht=i("Y+zs"),Ct=i("Aw04"),Nt=i("yL40");function At(e,t){if(1&e){const e=l.Ub();l.Tb(0,"button",31),l.bc("click",(function(){return l.wc(e),l.dc(),l.uc(12).perform()})),l.Hc(1),l.Sb()}if(2&e){const e=l.dc(3);l.zb(1),l.Jc(" ",e.i18n.field.image.upload," ")}}function Dt(e,t){if(1&e&&(l.Tb(0,"div",32),l.Ob(1,"avatar",33),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.zb(1),l.kc("image",e)("roundBorders",!1)("additionalImages",i.images)}}function $t(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"div",34),l.Hc(2),l.Sb(),l.Qb()),2&e){const e=l.dc(3);l.zb(2),l.Jc(" ",e.i18n.field.image.noImages," ")}}function Pt(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",35),l.Tb(1,"button",31),l.bc("click",(function(){return l.wc(e),l.dc(3).manageImages()})),l.Hc(2),l.Sb(),l.Sb()}if(2&e){const e=l.dc(3);l.zb(2),l.Jc(" ",e.i18n.field.image.manage," ")}}function Mt(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"h2",23),l.Tb(2,"div",24),l.Hc(3),l.Sb(),l.Fc(4,At,2,1,"button",25),l.ec(5,"async"),l.Sb(),l.Tb(6,"div",26),l.Fc(7,Dt,2,3,"div",27),l.ec(8,"async"),l.Fc(9,$t,3,1,"ng-container",1),l.Sb(),l.Fc(10,Pt,3,1,"div",28),l.Tb(11,"image-upload",29,30),l.bc("uploadDone",(function(t){return l.wc(e),l.dc(2).onUploadDone(t)})),l.Sb(),l.Qb()}if(2&e){const e=l.uc(12),t=l.dc(2);l.zb(3),l.Jc(" ",t.i18n.general.images," "),l.zb(1),l.kc("ngIf",t.canUploadImages&&!1===l.fc(5,8,e.uploading$)),l.zb(3),l.kc("ngForOf",l.fc(8,10,t.images$)),l.zb(2),l.kc("ngIf",0===t.images.length),l.zb(1),l.kc("ngIf",t.images.length>0),l.zb(1),l.kc("max",t.data.maxImages)("owner",t.id)("user",t.data.owner.id)}}function Rt(e,t){1&e&&l.Ob(0,"hr",36)}function Et(e,t){if(1&e&&(l.Tb(0,"label-value",37),l.Ob(1,"user-link",38),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.owner)}}function qt(e,t){if(1&e&&(l.Tb(0,"label-value",37),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.status),l.zb(1),l.Jc(" ",e.status," ")}}function Qt(e,t){if(1&e&&(l.Tb(0,"label-value",37),l.Hc(1),l.ec(2,"date"),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.creationDate),l.zb(1),l.Jc(" ",l.fc(2,2,e.creationDate)," ")}}function Jt(e,t){if(1&e&&l.Ob(0,"field-option",41),2&e){const e=t.$implicit,i=l.dc(3);l.Dc(e.leaf?"leaf":"parent"),l.kc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)("level",e.level)("disabled",!e.leaf)}}function Lt(e,t){if(1&e&&(l.Tb(0,"single-selection-field",39),l.Fc(1,Jt,1,8,"field-option",40),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.category),l.zb(1),l.kc("ngForOf",e.categories)}}function Bt(e,t){if(1&e&&l.Ob(0,"field-option",41),2&e){const e=t.$implicit,i=l.dc(3);l.Dc("hierarchy "+(e.leaf?"leaf":"parent")),l.kc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)("level",e.level)("disabled",!e.leaf)}}function Gt(e,t){if(1&e&&(l.Tb(0,"multi-selection-field",39),l.Fc(1,Bt,1,8,"field-option",40),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.categories),l.zb(1),l.kc("ngForOf",e.categories)}}function Ut(e,t){if(1&e&&l.Ob(0,"field-option",44),2&e){const e=t.$implicit,i=l.dc(3);l.kc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function Vt(e,t){if(1&e&&(l.Tb(0,"single-selection-field",42),l.Fc(1,Ut,1,4,"field-option",43),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.currency)("required",e.webshop),l.zb(1),l.kc("ngForOf",e.data.currencies)}}function jt(e,t){if(1&e&&l.Ob(0,"decimal-field",45),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.price)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)("required",e.webshop)}}function _t(e,t){if(1&e&&l.Ob(0,"decimal-field",50),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.promotionalPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function Kt(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"label-value",46),l.Tb(2,"div",11),l.Tb(3,"div",12),l.Ob(4,"date-field",47),l.Sb(),l.Tb(5,"div",14),l.Hc(6),l.Sb(),l.Tb(7,"div",15),l.Ob(8,"date-field",48),l.Sb(),l.Sb(),l.Sb(),l.Fc(9,_t,1,4,"decimal-field",49),l.ec(10,"async"),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.promotionalPeriod),l.zb(5),l.Jc(" ",e.i18n.general.periodTo," "),l.zb(3),l.kc("ngIf",l.fc(10,3,e.currency$))}}function Wt(e,t){if(1&e&&l.Ob(0,"custom-field-input",51),2&e){const e=t.$implicit,i=l.dc(2);l.kc("field",e)("formControl",i.form.get("customValues").get(e.internalName))("binaryValues",i.binaryValues)}}function Yt(e,t){if(1&e&&l.Ob(0,"field-option",54),2&e){const e=t.$implicit;l.kc("value",e.id)("id",e.id)("text",e.name)}}function Xt(e,t){if(1&e&&(l.Tb(0,"multi-selection-field",52),l.Fc(1,Yt,1,3,"field-option",53),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.showAddressOnMap),l.zb(1),l.kc("ngForOf",e.data.addresses)}}function Zt(e,t){if(1&e&&(l.Rb(0),l.Ob(1,"decimal-field",64),l.Ob(2,"decimal-field",65),l.Qb()),2&e){const e=l.dc(3);l.zb(1),l.kc("label",e.i18n.ad.stockQuantity)("scale",e.decimalQuantity),l.zb(1),l.kc("label",e.i18n.ad.lowStockNotification)("scale",e.decimalQuantity)}}function ei(e,t){if(1&e&&l.Ob(0,"input-field",66),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.productNumber)("mask",e.mask)("placeholder",e.mask)}}function ti(e,t){if(1&e&&l.Ob(0,"field-option",54),2&e){const e=t.$implicit;l.kc("value",e.id)("id",e.id)("text",e.name)}}function ii(e,t){if(1&e&&(l.Tb(0,"multi-selection-field",67),l.Fc(1,ti,1,3,"field-option",53),l.Sb()),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.deliveryMethods)("emptyLabel",0===e.deliveryMethods$.value.length?e.i18n.ad.noDeliveryMethodsAvailable:null),l.zb(1),l.kc("ngForOf",e.deliveryMethods$.value)}}function ai(e,t){if(1&e&&(l.Rb(0),l.Ob(1,"boolean-field",55),l.Tb(2,"radio-group-field",56),l.Ob(3,"field-option",57),l.Ob(4,"field-option",58),l.Ob(5,"field-option",59),l.Sb(),l.Fc(6,Zt,3,4,"ng-container",1),l.ec(7,"async"),l.Ob(8,"decimal-field",60),l.Ob(9,"decimal-field",61),l.Fc(10,ei,1,3,"input-field",62),l.Fc(11,ii,2,3,"multi-selection-field",63),l.ec(12,"async"),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.allowDecimalQuantity),l.zb(1),l.kc("label",e.i18n.ad.stockType),l.zb(1),l.kc("text",e.i18n.ad.available),l.zb(1),l.kc("text",e.i18n.ad.notAvailable),l.zb(1),l.kc("text",e.i18n.ad.quantity),l.zb(1),l.kc("ngIf","quantity"===(e.form.value||l.fc(7,12,e.form.valueChanges)).stockType),l.zb(2),l.kc("label",e.i18n.ad.maxAllowedInCart)("scale",e.decimalQuantity),l.zb(1),l.kc("label",e.i18n.ad.minAllowedInCart)("scale",e.decimalQuantity),l.zb(1),l.kc("ngIf",e.requiredProductNumber),l.zb(1),l.kc("ngIf",l.fc(12,14,e.deliveryMethods$))}}function ni(e,t){if(1&e){const e=l.Ub();l.Tb(0,"button",68),l.bc("click",(function(){return l.wc(e),l.dc(2).save(!0)})),l.ec(1,"async"),l.Hc(2),l.Sb()}if(2&e){const e=l.dc(2);l.kc("disabled",l.fc(1,2,e.requesting$)),l.zb(2),l.Ic(e.i18n.ad.saveAndInsertNew)}}function ri(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Tb(3,"form",3),l.Fc(4,Mt,13,12,"ng-container",1),l.Fc(5,Rt,1,0,"hr",4),l.Fc(6,Et,2,2,"label-value",5),l.Fc(7,qt,2,2,"label-value",5),l.Fc(8,Qt,3,4,"label-value",5),l.Ob(9,"input-field",6),l.Fc(10,Lt,2,2,"single-selection-field",7),l.Fc(11,Gt,2,2,"multi-selection-field",7),l.Fc(12,Vt,2,3,"single-selection-field",8),l.Fc(13,jt,1,5,"decimal-field",9),l.ec(14,"async"),l.Tb(15,"label-value",10),l.ec(16,"async"),l.Tb(17,"div",11),l.Tb(18,"div",12),l.Ob(19,"date-field",13),l.Sb(),l.Tb(20,"div",14),l.Hc(21),l.Sb(),l.Tb(22,"div",15),l.Ob(23,"date-field",16),l.Sb(),l.Sb(),l.Sb(),l.Ob(24,"boolean-field",17),l.Fc(25,Kt,11,5,"ng-container",1),l.ec(26,"async"),l.Ob(27,"html-field",18),l.Fc(28,Wt,1,3,"custom-field-input",19),l.Fc(29,Xt,2,2,"multi-selection-field",20),l.Fc(30,ai,13,16,"ng-container",1),l.Sb(),l.Tb(31,"actions"),l.Tb(32,"button",21),l.bc("click",(function(){return l.wc(e),l.dc().save()})),l.Hc(33),l.Sb(),l.Fc(34,ni,3,4,"button",22),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc();l.zb(1),l.kc("heading",e.create?e.i18n.ad.title.new:e.i18n.ad.title.edit)("mobileHeading",e.create?e.i18n.ad.mobileTitle.new:e.i18n.ad.mobileTitle.edit)("headingActions",l.fc(2,25,e.headingActions$)),l.zb(2),l.kc("formGroup",e.form),l.zb(1),l.kc("ngIf",e.data.maxImages>0),l.zb(1),l.kc("ngIf",e.data.maxImages>0),l.zb(1),l.kc("ngIf",!e.self),l.zb(1),l.kc("ngIf",!e.create),l.zb(1),l.kc("ngIf",!e.create),l.zb(1),l.kc("label",e.i18n.general.name),l.zb(1),l.kc("ngIf",1==e.data.maxCategoriesPerAd),l.zb(1),l.kc("ngIf",e.data.maxCategoriesPerAd>1),l.zb(1),l.kc("ngIf",e.data.currencies&&e.data.currencies.length>1),l.zb(1),l.kc("ngIf",l.fc(14,27,e.currency$)),l.zb(2),l.kc("label",e.i18n.ad.publicationPeriod)("fieldSize",l.fc(16,29,e.layout.ltsm$)?"medium":""),l.zb(6),l.Jc(" ",e.i18n.general.periodTo," "),l.zb(3),l.kc("label",e.i18n.ad.setPromotionalPeriod),l.zb(1),l.kc("ngIf",l.fc(26,31,e.form.get("setPromotionalPeriod").valueChanges)||e.form.get("setPromotionalPeriod").value),l.zb(2),l.kc("label",e.i18n.general.description),l.zb(1),l.kc("ngForOf",e.data.customFields),l.zb(1),l.kc("ngIf",e.data.addresses),l.zb(1),l.kc("ngIf",e.webshop),l.zb(3),l.Jc(" ",e.i18n.general.save," "),l.zb(1),l.kc("ngIf",e.data.canCreateNew)}}let ci=(()=>{class e extends c.a{constructor(e,t,i,a,n,r){super(e),this.imagesService=t,this.modal=i,this.changeDetector=a,this.marketplaceHelper=n,this.marketplaceService=r,this.categories=[],this.images$=new A.a([]),this.currency$=new A.a(null),this.deliveryMethods$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.basedOnId=this.route.snapshot.queryParams.basedOnId,this.id=this.route.snapshot.params.id,this.kind=this.route.snapshot.paramMap.get("kind"),this.create=null==this.id;const e=this.create?this.marketplaceService.getAdDataForNew({basedOnId:this.basedOnId,user:this.route.snapshot.params.user,kind:this.kind}):this.marketplaceService.getAdDataForEdit({ad:this.id});this.addSub(e.subscribe(e=>{!this.create&&e.maxImages>0?this.addSub(this.imagesService.listAdImages({ad:this.id}).subscribe(t=>{this.images=t,this.mainImage=this.images.length>0?this.ApiHelper.internalNameOrId(this.images[0]):null,this.data=e})):this.data=e}))}onDataInitialized(e){this.kind=e.kind,this.webshop=this.kind===x.c.WEBSHOP,this.self=this.authHelper.isSelfOrOwner(e.user),this.owner=this.self?this.ApiHelper.SELF:e.user.id,this.marketplaceHelper.populateCategories(this.categories,e.categories,0);const t=e.advertisement,i=t,a=t.categories&&1===e.maxCategoriesPerAd?t.categories[0]:t.categories,r=e.webshopSettings||{};this.requiredProductNumber=this.webshop&&!r.productNumberGenerated,this.mask=r.productNumberGenerated?"":r.productNumberMask;const c=Object(s.h)(e.currencies)?null:e.currencies[0];this.form=this.formBuilder.group({name:[t.name,n.G.required],categories:[a,n.G.required],currency:[c?this.ApiHelper.internalNameOrId(c):null,n.G.required],price:[t.price,this.webshop?n.G.required:null],publicationBeginDate:[t.publicationPeriod.begin,n.G.required],publicationEndDate:[t.publicationPeriod.end,n.G.required],setPromotionalPeriod:null!=t.promotionalPeriod,promotionalBeginDate:t.promotionalPeriod?t.promotionalPeriod.begin:null,promotionalEndDate:t.promotionalPeriod?t.promotionalPeriod.end:null,promotionalPrice:t.promotionalPrice,description:[t.description,n.G.required],maxAllowedInCart:t.maxAllowedInCart,minAllowedInCart:t.minAllowedInCart,allowDecimalQuantity:t.allowDecimalQuantity,unlimitedStock:!!this.create||t.unlimitedStock,stockQuantity:t.stockQuantity,minStockQuantityToNotify:t.minStockQuantityToNotify,productNumber:[t.productNumber,this.requiredProductNumber?n.G.required:null],version:i.version,stockType:this.webshop?this.resolveStockType(t):null,id:this.id,kind:this.kind}),this.form.addControl("addresses",this.formBuilder.control(t.addresses)),this.form.addControl("deliveryMethods",this.formBuilder.control(t.deliveryMethods)),this.form.addControl("customValues",this.fieldHelper.customValuesFormGroup(e.customFields,{currentValues:t.customValues})),this.addSub(this.form.get("currency").valueChanges.subscribe(t=>{this.updateCurrency(t,e),this.updateDeliveryMethods(e)})),this.currency=c,this.addSub(this.form.controls.stockType.valueChanges.subscribe(()=>this.updateStockControls())),this.uploadedImages=[],this.updateDeliveryMethods(e),this.updateStockControls()}resolveMenu(e){return this.self?e.kind===x.c.SIMPLE?o.b.SEARCH_USER_ADS:o.b.SEARCH_USER_WEBSHOP:this.authHelper.userMenu(e.user,o.b.SEARCH_ADS)}updateStockControls(){if(this.webshop){const e=this.form.controls.stockType.value;"available"===e||"notAvailable"===e?this.form.controls.stockQuantity.clearValidators():this.form.controls.stockQuantity.setValidators(n.G.required),this.form.controls.stockQuantity.updateValueAndValidity()}}updateCurrency(e,t){this.currency=t.currencies.find(t=>t.id===e||t.internalName===e)}updateDeliveryMethods(e){this.deliveryMethods$.next(e.deliveryMethods.filter(e=>null==e.chargeCurrency||e.chargeCurrency.id===(this.currency||{}).id))}resolveStockType(e){return this.create||e.unlimitedStock?"available":e.stockQuantity?"quantity":"notAvailable"}get status(){return this.marketplaceHelper.resolveStatusLabel(this.data.status)}save(e){if(!Object(s.F)(this.form))return;const t=Object(N.cloneDeep)(this.form.value);t.publicationPeriod=this.ApiHelper.datePeriod(t.publicationBeginDate,t.publicationEndDate),delete t.publicationBeginDate,delete t.publicationEndDate,t.promotionalPeriod=t.setPromotionalPeriod?this.ApiHelper.datePeriod(t.promotionalBeginDate,t.promotionalEndDate):null,delete t.setPromotionalPeriod,delete t.promotionalBeginDate,delete t.promotionalEndDate,null==t.promotionalPeriod&&delete t.promotionalPrice,this.webshop&&(t.unlimitedStock="available"===t.stockType,"quantity"!==t.stockType&&(t.stockQuantity=null),delete t.stockType);const i=t=>{this.notification.snackBar(this.i18n.ad.adSaved),e?this.router.navigate(["/marketplace",this.owner,this.data.kind,"new"],{replaceUrl:!0,queryParams:{basedOnId:t||this.id}}):this.basedOnId?this.router.navigate(["/marketplace","edit",t],{replaceUrl:!0}):history.back()};if(this.data.requiresAuthorization&&this.self&&(t.submitForAuthorization=!1),this.create)t.images=this.uploadedImages.map(e=>e.id),this.addSub(this.marketplaceService.createAd({user:this.owner,body:t}).subscribe(i));else{const e=this.marketplaceService.updateAd({ad:this.id,body:t});this.mainImageChanged()?this.addSub(this.marketplaceService.getAdDataForEdit({ad:this.id,fields:["advertisement.version"]}).subscribe(a=>{t.version=a.advertisement.version,this.addSub(e.subscribe(i))})):this.addSub(e.subscribe(i))}}mainImageChanged(){const e=this.images.length>0?this.ApiHelper.internalNameOrId(this.images[0]):null;return null==this.mainImage&&null==e&&this.hasRemovedImages||this.mainImage!==e}manageImages(){const e=this.modal.show(Tt.a,{class:"modal-form",initialState:{images:this.images,manageAfterConfirm:this.create}});e.content.result.pipe(Object(zt.a)()).subscribe(t=>{if(this.hasRemovedImages=!Object(s.h)(t.removedImages),this.hasRemovedImages){for(const e of t.removedImages)this.addSub(this.imagesService.deleteImage({idOrKey:e}).subscribe());this.images=this.images.filter(e=>!t.removedImages.includes(e.id)),this.uploadedImages=this.uploadedImages.filter(e=>!t.removedImages.includes(e.id))}!Object(s.h)(t.order)&&(this.images=t.order.map(e=>this.images.find(t=>t.id===e)),this.create||this.addSub(this.imagesService.reorderAdImages({ids:t.order,ad:this.id}).subscribe())),e.hide()})}onUploadDone(e){this.images=[...this.images,...e],this.uploadedImages=[...this.uploadedImages||[],...e],this.changeDetector.detectChanges()}get canUploadImages(){return this.images.length<this.data.maxImages}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}get images(){return this.images$.value}set images(e){this.images$.next(e)}get creationDate(){return this.data.creationDate}get binaryValues(){return this.data.binaryValues}get decimalQuantity(){return this.form.controls.allowDecimalQuantity.value?2:0}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.p),l.Nb(It.b),l.Nb(l.h),l.Nb(H.a),l.Nb(r.r))},e.\u0275cmp=l.Hb({type:e,selectors:[["edit-ad"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"formGroup"],["class","mt-4 mb-2",4,"ngIf"],["kind","fieldView",3,"label",4,"ngIf"],["formControlName","name","required","",3,"label"],["formControlName","categories","required","",3,"label",4,"ngIf"],["formControlName","currency",3,"label","required",4,"ngIf"],["formControlName","price",3,"label","scale","prefix","suffix","required",4,"ngIf"],["kind","field","required","",3,"label","fieldSize"],[1,"d-flex","flex-column","flex-sm-row","flex-wrap"],[1,"flex-grow"],["labelPosition","side","formControlName","publicationBeginDate","minDate","past5","fieldSize","full"],[1,"mx-2","d-flex","align-items-center"],[1,"flex-grow","mt-2","mt-xl-0"],["labelPosition","side","formControlName","publicationEndDate","minDate","past5","fieldSize","full"],["formControlName","setPromotionalPeriod",3,"label"],["formControlName","description","required","",3,"label"],[3,"field","formControl","binaryValues",4,"ngFor","ngForOf"],["formControlName","addresses",3,"label",4,"ngIf"],[1,"btn","btn-primary",3,"click"],["class","btn btn-outline-primary",3,"disabled","click",4,"ngIf"],[1,"border-0","d-flex","mb-3","flex-column","flex-xs-row","justify-content-between","mt-2","mt-md-0"],[1,"mb-2","mb-xs-0"],["class","btn btn-outline-primary",3,"click",4,"ngIf"],[1,"row","no-gutters"],["class","col-12 col-xs-6 col-sm-4 col-md-3 d-flex justify-content-center justify-content-center",4,"ngFor","ngForOf"],["class","d-flex justify-content-end",4,"ngIf"],["target","marketplace",3,"max","owner","user","uploadDone"],["multiUpload",""],[1,"btn","btn-outline-primary",3,"click"],[1,"col-12","col-xs-6","col-sm-4","col-md-3","d-flex","justify-content-center","justify-content-center"],["size","huge","useLightbox","",1,"mb-1","mb-xs-3",3,"image","roundBorders","additionalImages"],[1,"col-12"],[1,"d-flex","justify-content-end"],[1,"mt-4","mb-2"],["kind","fieldView",3,"label"],[3,"user"],["formControlName","categories","required","",3,"label"],[3,"value","id","internalName","text","style","level","disabled",4,"ngFor","ngForOf"],[3,"value","id","internalName","text","level","disabled"],["formControlName","currency",3,"label","required"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","price",3,"label","scale","prefix","suffix","required"],["kind","field",3,"label"],["labelPosition","side","formControlName","promotionalBeginDate","minDate","past5","fieldSize","full"],["labelPosition","side","formControlName","promotionalEndDate","minDate","past5","fieldSize","full"],["formControlName","promotionalPrice",3,"label","scale","prefix","suffix",4,"ngIf"],["formControlName","promotionalPrice",3,"label","scale","prefix","suffix"],[3,"field","formControl","binaryValues"],["formControlName","addresses",3,"label"],[3,"value","id","text",4,"ngFor","ngForOf"],[3,"value","id","text"],["formControlName","allowDecimalQuantity",3,"label"],["formControlName","stockType",3,"label"],["value","available",3,"text"],["value","notAvailable",3,"text"],["value","quantity",3,"text"],["formControlName","maxAllowedInCart",3,"label","scale"],["formControlName","minAllowedInCart",3,"label","scale"],["type","text","formControlName","productNumber","required","",3,"label","mask","placeholder",4,"ngIf"],["formControlName","deliveryMethods",3,"label","emptyLabel",4,"ngIf"],["formControlName","stockQuantity","required","",3,"label","scale"],["formControlName","minStockQuantityToNotify",3,"label","scale"],["type","text","formControlName","productNumber","required","",3,"label","mask","placeholder"],["formControlName","deliveryMethods",3,"label","emptyLabel"],[1,"btn","btn-outline-primary",3,"disabled","click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,ri,35,33,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,n.I,n.w,n.n,je.a,n.v,n.l,n.D,m.a,Ot.a,_e.a,wt.a,b.s,g.a,xt.a,h.a,f.a,We.a,$.a,Ft.a,G.a,Ht.a,n.k,D.a,Ct.a],pipes:[b.b,Nt.a],encapsulation:2,changeDetection:0}),e})();var si=i("USuC"),oi=i("JbOn");function li(e,t){if(1&e&&(l.Tb(0,"label-value",18),l.Ob(1,"user-link",19),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user)}}function di(e,t){if(1&e&&l.Ob(0,"field-option",20),2&e){const e=t.$implicit,i=l.dc(2);l.Dc(e.leaf?"leaf":"parent"),l.kc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)("level",e.level)("disabled",!e.leaf)}}function bi(e,t){if(1&e&&l.Ob(0,"field-option",23),2&e){const e=t.$implicit,i=l.dc(3);l.kc("value",i.ApiHelper.internalNameOrId(e))("id",e.id)("internalName",e.internalName)("text",e.name)}}function ui(e,t){if(1&e&&(l.Tb(0,"single-selection-field",21),l.Fc(1,bi,1,4,"field-option",22),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.currency),l.zb(1),l.kc("ngForOf",e.data.currencies)}}function mi(e,t){if(1&e&&l.Ob(0,"decimal-field",24),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.minPrice)("textRight",!1)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function fi(e,t){if(1&e&&l.Ob(0,"decimal-field",25),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.maxPrice)("textRight",!1)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function hi(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,li,2,2,"label-value",3),l.Tb(4,"form",4),l.Ob(5,"input-field",5),l.Ob(6,"text-selection-field",6),l.Tb(7,"single-selection-field",7),l.Ob(8,"field-option",8),l.Ob(9,"field-option",9),l.Sb(),l.Ob(10,"user-field",10),l.Tb(11,"single-selection-field",11),l.Fc(12,di,1,8,"field-option",12),l.Sb(),l.Fc(13,ui,2,2,"single-selection-field",13),l.Fc(14,mi,1,5,"decimal-field",14),l.ec(15,"async"),l.Fc(16,fi,1,5,"decimal-field",15),l.ec(17,"async"),l.Sb(),l.Tb(18,"actions",16),l.Tb(19,"button",17),l.bc("click",(function(){return l.wc(e),l.dc().save()})),l.ec(20,"async"),l.Hc(21),l.Sb(),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc();l.zb(1),l.kc("heading",e.create?e.i18n.ad.title.adInterestNew:e.i18n.ad.title.adInterest)("mobileHeading",e.create?e.i18n.ad.mobileTitle.adInterestNew:e.i18n.ad.mobileTitle.adInterest)("headingActions",l.fc(2,19,e.headingActions$)),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("formGroup",e.form),l.zb(1),l.kc("label",e.i18n.general.name),l.zb(1),l.kc("label",e.i18n.general.keywords),l.zb(1),l.kc("label",e.i18n.general.type)("emptyOption",e.i18n.general.all),l.zb(1),l.kc("text",e.i18n.ad.type.simple),l.zb(1),l.kc("text",e.i18n.ad.type.webshop),l.zb(1),l.kc("label",e.i18n.general.by),l.zb(1),l.kc("label",e.i18n.ad.category),l.zb(1),l.kc("ngForOf",e.categories),l.zb(1),l.kc("ngIf",e.data.currencies&&e.data.currencies.length>1),l.zb(1),l.kc("ngIf",l.fc(15,21,e.currency$)),l.zb(2),l.kc("ngIf",l.fc(17,23,e.currency$)),l.zb(3),l.kc("disabled",l.fc(20,25,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.general.submit," ")}}let pi=(()=>{class e extends c.a{constructor(e,t,i){super(e),this.adInterestService=t,this.marketplaceHelper=i,this.categories=[],this.currency$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.id=this.route.snapshot.params.id,this.create=null==this.id;const e=this.create?this.adInterestService.getAdInterestDataForNew({user:this.user}):this.adInterestService.getAdInterestDataForEdit({id:this.id});this.addSub(e.subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=e.adInterest,i=t.currency?t.currency:Object(s.h)(e.currencies)?null:this.ApiHelper.internalNameOrId(e.currencies[0]);this.marketplaceHelper.populateCategories(this.categories,e.categories,0),this.form=this.formBuilder.group({name:[t.name,n.G.required],keywords:[t.keywords,null],kind:t.kind,category:t.category,user:t.user,minPrice:t.minPrice,maxPrice:t.maxPrice,currency:i,version:t.version}),this.updateCurrency(e),this.addSub(this.form.controls.currency.valueChanges.subscribe(()=>this.updateCurrency(e)))}updateCurrency(e){const t=this.form.controls.currency.value;this.currency=e.currencies.find(e=>e.id===t||e.internalName===t)||e.currencies[0]}save(){if(!Object(s.F)(this.form))return;const e=this.form.value,t=this.create?this.adInterestService.createAdInterest({body:e,user:this.user}):this.adInterestService.updateAdInterest({id:this.id,body:e});this.addSub(t.subscribe(()=>{this.notification.snackBar(this.create?this.i18n.ad.adInterestCreated:this.i18n.ad.adInterestSaved),history.back()}))}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.AD_INTERESTS)}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.b),l.Nb(H.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["edit-ad-interest"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[3,"label",4,"ngIf"],[3,"formGroup"],["formControlName","name","required","",3,"label"],["formControlName","keywords",3,"label"],["formControlName","kind",3,"label","emptyOption"],["value","simple",3,"text"],["value","webshop",3,"text"],["formControlName","user",3,"label"],["formControlName","category",3,"label"],[3,"value","id","internalName","text","style","level","disabled",4,"ngFor","ngForOf"],["formControlName","currency",3,"label",4,"ngIf"],["formControlName","minPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix",4,"ngIf"],["formControlName","maxPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix",4,"ngIf"],["forceRow",""],[1,"btn","btn-primary",3,"disabled","click"],[3,"label"],[3,"user"],[3,"value","id","internalName","text","level","disabled"],["formControlName","currency",3,"label"],[3,"value","id","internalName","text",4,"ngFor","ngForOf"],[3,"value","id","internalName","text"],["formControlName","minPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix"],["formControlName","maxPrice","fieldSize","small",3,"label","textRight","scale","prefix","suffix"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,hi,22,27,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,n.I,n.w,n.n,je.a,n.v,n.l,n.D,si.a,We.a,$.a,oi.a,b.s,g.a,m.a,f.a,G.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();function gi(e,t){if(1&e&&l.Ob(0,"user-info",7),2&e){const e=l.dc(2);l.kc("user",e.data.user)}}function vi(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",11),l.Tb(1,"button",12),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(2).remove(i),t.stopPropagation(),t.preventDefault()})),l.Ob(2,"icon",13),l.Sb(),l.Sb()}if(2&e){const e=l.dc(3);l.zb(1),l.kc("tooltip",e.i18n.general.remove)}}function yi(e,t){if(1&e&&(l.Tb(0,"mobile-result"),l.Tb(1,"div",8),l.Tb(2,"div",9),l.Hc(3),l.Sb(),l.Fc(4,vi,3,1,"div",10),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc(2);l.zb(3),l.Ic(e.name),l.zb(1),l.kc("ngIf",i.data.canManage)}}function ki(e,t){1&e&&l.Ob(0,"th",17)}function Si(e,t){if(1&e){const e=l.Ub();l.Tb(0,"td",17),l.Tb(1,"button",12),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(3).remove(i),t.stopPropagation()})),l.Ob(2,"icon",13),l.Sb(),l.Sb()}if(2&e){const e=l.dc(4);l.zb(1),l.kc("tooltip",e.i18n.general.remove)}}function Ti(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"tr",18),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(3);return a.router.navigate(a.viewPath(i))})),l.Tb(2,"td"),l.Hc(3),l.Sb(),l.Fc(4,Si,3,1,"td",15),l.Sb(),l.Qb()}if(2&e){const e=t.$implicit,i=l.dc(3);l.zb(3),l.Jc(" ",e.name," "),l.zb(1),l.kc("ngIf",i.data.canManage)}}function zi(e,t){if(1&e&&(l.Tb(0,"table",14),l.Tb(1,"thead"),l.Tb(2,"th"),l.Hc(3),l.Sb(),l.Fc(4,ki,1,0,"th",15),l.Sb(),l.Tb(5,"tbody"),l.Fc(6,Ti,5,2,"ng-container",16),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.zb(3),l.Ic(e.i18n.general.name),l.zb(1),l.kc("ngIf",e.data.canManage),l.zb(2),l.kc("ngForOf",e.data.adInterests)}}function Ii(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,gi,1,1,"user-info",3),l.Sb(),l.Tb(4,"results-layout",4),l.Fc(5,yi,5,2,"mobile-result",5),l.Fc(6,zi,7,3,"table",6),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.adInterests)("mobileHeading",e.i18n.ad.mobileTitle.adInterests)("headingActions",l.fc(2,7,e.headingActions$))("mode",e.self?"empty":"normal"),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("results",e.data.adInterests)("toLink",e.toLink)}}let Oi=(()=>{class e extends c.a{constructor(e,t){super(e),this.adInterestService=t}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.params.user||this.ApiHelper.SELF,this.addSub(this.adInterestService.getUserAdInterestsListData({user:this.param}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user),e.canCreate&&(this.headingActions=[new Ee.c("add",this.i18n.general.addNew,()=>{this.router.navigate(["/marketplace",this.param,"ad-interests","new"])},!0)])}viewPath(e){return["/marketplace","ad-interests","view",e.id]}get toLink(){return e=>this.viewPath(e)}remove(e){this.notification.confirm({message:this.i18n.general.removeConfirm(e.name),callback:()=>this.doRemove(e)})}doRemove(e){this.addSub(this.adInterestService.deleteAdInterest({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(e.name)),this.reload()}))}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.AD_INTERESTS)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.b))},e.\u0275cmp=l.Hb({type:e,selectors:[["list-ad-interests"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions","mode"],[3,"user",4,"ngIf"],[3,"results","toLink"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[3,"user"],[1,"d-flex"],[1,"cell-main"],["class","ml-auto text-right",4,"ngIf"],[1,"ml-auto","text-right"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],["class","actions",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Ii,7,9,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,E.a,q.a,Q.a,nt.a,J.a,L.b,B.a,b.s],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();function wi(e,t){if(1&e&&(l.Tb(0,"label-value",6),l.Ob(1,"user-link",7),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user)}}function xi(e,t){if(1&e&&l.Ob(0,"label-value",4),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.keywords)("value",e.data.keywords.join(", "))}}function Fi(e,t){if(1&e&&l.Ob(0,"label-value",4),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.type)("value",e.resolveKindLabel())}}function Hi(e,t){if(1&e&&l.Ob(0,"label-value",4),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.category)("value",e.data.category.name)}}function Ci(e,t){if(1&e&&(l.Tb(0,"label-value",6),l.Ob(1,"user-link",7),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.by),l.zb(1),l.kc("user",e.data.user)}}const Ni=function(e,t){return{min:e,max:t}};function Ai(e,t){if(1&e&&l.Ob(0,"label-value",4),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.price)("value",e.format.formatRange(l.oc(2,Ni,e.data.minPrice,e.data.maxPrice),e.data.currency))}}function Di(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,wi,2,2,"label-value",3),l.Ob(4,"label-value",4),l.Tb(5,"h2"),l.Hc(6),l.Sb(),l.Fc(7,xi,1,2,"label-value",5),l.Fc(8,Fi,1,2,"label-value",5),l.Fc(9,Hi,1,2,"label-value",5),l.Fc(10,Ci,2,2,"label-value",3),l.Fc(11,Ai,1,5,"label-value",5),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.adInterests)("mobileHeading",e.i18n.ad.mobileTitle.adInterests)("headingActions",l.fc(2,12,e.headingActions$)),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("label",e.i18n.general.name)("value",e.data.name),l.zb(2),l.Ic(e.i18n.ad.matchFields),l.zb(1),l.kc("ngIf",!e.empty(e.data.keywords)),l.zb(1),l.kc("ngIf",e.data.kind),l.zb(1),l.kc("ngIf",e.data.category),l.zb(1),l.kc("ngIf",e.data.user),l.zb(1),l.kc("ngIf",e.data.minPrice||e.data.maxPrice)}}let $i=(()=>{class e extends ht.a{constructor(e,t){super(e),this.adInterestService=t,this.empty=s.h}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.adInterestService.viewAdInterest({id:this.id}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=[];e.canEdit&&t.push(new Ee.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/marketplace","ad-interests","edit",this.id]),!0)),this.headingActions=t}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.AD_INTERESTS)}resolveKindLabel(){return this.data.kind===x.c.SIMPLE?this.i18n.ad.type.simple:this.i18n.ad.type.webshop}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.b))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-ad-interest"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"label",4,"ngIf"],[3,"label","value"],[3,"label","value",4,"ngIf"],[3,"label"],[3,"user"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Di,12,14,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,f.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();var Pi=i("Ky6R"),Mi=i("oj/z");const Ri=function(e){return{"text-decoration":e,"max-width":"75%"}};function Ei(e,t){if(1&e&&(l.Tb(0,"mobile-result",7),l.Tb(1,"div",8),l.Tb(2,"div",9),l.Hc(3),l.ec(4,"currency"),l.Sb(),l.Tb(5,"div",10),l.Hc(6),l.Sb(),l.Sb(),l.Ob(7,"div",11),l.Tb(8,"div",12),l.Hc(9),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc();l.kc("avatarImage",e.image),l.zb(3),l.Jc(" ",l.gc(4,6,e.promotionalPrice||e.price,i.currency)," "),l.zb(2),l.kc("ngStyle",l.nc(9,Ri,i.isOutOfStock(e)?"line-through":"")),l.zb(1),l.Jc(" ",e.name," "),l.zb(3),l.Kc(" ",i.i18n.ad.stock,": ",i.resolveStockLabel(e),"")}}const qi=function(e){return{"text-decoration":e}},Qi=function(e){return{"text-muted":e}};function Ji(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"tr",18),l.bc("click",(function(){l.wc(e);const i=t.$implicit;return l.dc(2).addProduct(i)})),l.Tb(2,"td",14),l.Ob(3,"avatar",19),l.Sb(),l.Tb(4,"td",20),l.Tb(5,"span",21),l.Hc(6),l.Sb(),l.Sb(),l.Tb(7,"td",22),l.Hc(8),l.Sb(),l.Tb(9,"td",16),l.Hc(10),l.ec(11,"currency"),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=t.$implicit,i=l.dc(2);l.zb(3),l.kc("image",e.image),l.zb(1),l.kc("ngStyle",l.nc(9,qi,i.isOutOfStock(e)?"line-through":"")),l.zb(2),l.Ic(e.name),l.zb(1),l.kc("ngClass",l.nc(11,Qi,i.isOutOfStock(e))),l.zb(1),l.Jc(" ",i.resolveStockLabel(e),""),l.zb(2),l.Jc(" ",l.gc(11,6,e.promotionalPrice||e.price,i.currency)," ")}}function Li(e,t){if(1&e&&(l.Tb(0,"table",13),l.Tb(1,"thead"),l.Ob(2,"th",14),l.Tb(3,"th",15),l.Hc(4),l.Sb(),l.Tb(5,"th"),l.Hc(6),l.Sb(),l.Tb(7,"th",16),l.Hc(8),l.Sb(),l.Sb(),l.Tb(9,"tbody"),l.Fc(10,Ji,12,13,"ng-container",17),l.ec(11,"async"),l.Sb(),l.Sb()),2&e){const e=l.dc();var i;const t=null==(i=l.fc(11,4,e.results$))?null:i.results;l.zb(4),l.Ic(e.i18n.ad.product),l.zb(2),l.Ic(e.i18n.ad.stockQuantity),l.zb(2),l.Ic(e.i18n.ad.price),l.zb(2),l.kc("ngForOf",t)}}function Bi(e,t){1&e&&l.Ob(0,"spinner",23)}const Gi=function(){return{"min-height":"44vh"}};let Ui=(()=>{class e extends M.a{constructor(e,t,i){super(e),this.modalRef=t,this.marketplaceService=i,this.pageSize=8,this.select=new l.n,this.results$=new A.a(null),this.rendering$=new A.a(!1)}ngOnInit(){super.ngOnInit(),this.form=this.formBuilder.group({keywords:null}),this.addSub(this.form.controls.keywords.valueChanges.subscribe(()=>this.update())),this.update()}update(e){this.rendering=!0,this.results=null,this.addSub(this.doSearch(e).subscribe(e=>this.results=Pi.a.from(e)))}get onClick(){return e=>this.addProduct(e)}addProduct(e){this.isOutOfStock(e)||(this.notification.snackBar(this.i18n.ad.addedProductOrder),this.select.emit(e))}doSearch(e){const t=e||{};return this.marketplaceService.searchUserAds$Response({user:this.ApiHelper.SELF,kind:x.c.WEBSHOP,currency:this.currency.id,statuses:[x.e.ACTIVE],pageSize:t.pageSize||this.pageSize,page:t.page||0,keywords:this.form.controls.keywords.value})}close(){this.modalRef.hide()}get results(){return this.results$.value}set results(e){this.results$.next(e)}get rendering(){return this.rendering$.value}set rendering(e){this.rendering$.next(e)}resolveStockLabel(e){if(!e.unlimitedStock){const t=+e.stockQuantity||0;return 0===t?this.i18n.ad.outOfStock:this.format.formatAsNumber(e.stockQuantity,t%1==0?0:2)}return this.i18n.ad.unlimited}isOutOfStock(e){return this.resolveStockLabel(e)===this.i18n.ad.outOfStock}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(It.a),l.Nb(r.r))},e.\u0275cmp=l.Hb({type:e,selectors:[["search-products"]],inputs:{currency:"currency"},outputs:{select:"select"},features:[l.wb],decls:13,vars:11,consts:[[1,"mb-2","mb-md-0",3,"formGroup"],["formControlName","keywords",3,"label"],["resultType","list",3,"results","onClick","rendering$","ngStyle","update"],["avatarIcon","shopping_basket",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"btn","btn-primary",3,"click"],["spinner",""],["avatarIcon","shopping_basket",3,"avatarImage"],[1,"cell-date-amount"],[1,"cell-amount"],[1,"cell-date","cell-main",3,"ngStyle"],[1,"clearfix"],[1,"cell-text"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","35%"],[1,"text-right"],[4,"ngFor","ngForOf"],[3,"click"],["icon","shopping_basket",3,"image"],[3,"ngStyle"],[1,"ellipsis-clamp-2"],[3,"ngClass"],[1,"mx-auto","my-3"]],template:function(e,t){1&e&&(l.Tb(0,"h1"),l.Hc(1),l.Sb(),l.Tb(2,"form",0),l.Ob(3,"input-field",1),l.Sb(),l.Tb(4,"results-layout",2),l.bc("update",(function(e){return t.update(e)})),l.ec(5,"async"),l.Fc(6,Ei,10,11,"mobile-result",3),l.Fc(7,Li,12,6,"table",4),l.Sb(),l.Tb(8,"actions"),l.Tb(9,"button",5),l.bc("click",(function(){return t.close()})),l.Hc(10),l.Sb(),l.Sb(),l.Fc(11,Bi,1,0,"ng-template",null,6,l.Gc)),2&e&&(l.zb(1),l.Ic(t.i18n.ad.addProducts),l.zb(1),l.kc("formGroup",t.form),l.zb(1),l.kc("label",t.i18n.general.keywords),l.zb(1),l.kc("results",l.fc(5,8,t.results$))("onClick",t.onClick)("rendering$",t.rendering$)("ngStyle",l.mc(10,Gi)),l.zb(6),l.Jc(" ",t.i18n.general.close," "))},directives:[n.I,n.w,n.n,je.a,n.v,n.l,E.a,b.w,q.a,Q.a,g.a,J.a,b.s,h.a,b.q,Mi.a],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();var Vi=i("/uUt");function ji(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.ec(2,"currency"),l.Qb()),2&e){const e=l.dc().$implicit,t=l.dc(2);l.zb(1),l.Jc(" ",l.gc(2,1,t.rowTotal(e),t.currency)," ")}}const _i=function(){return{"max-width":"130px"}};function Ki(e,t){if(1&e){const e=l.Ub();l.Tb(0,"tr"),l.Tb(1,"td"),l.Hc(2),l.Sb(),l.Tb(3,"td",19),l.Tb(4,"span",20),l.bc("click",(function(){l.wc(e);const i=t.$implicit;return l.dc(2).navigate(i)})),l.Hc(5),l.Sb(),l.Sb(),l.Tb(6,"td",21),l.Hc(7),l.ec(8,"currency"),l.Sb(),l.Tb(9,"td",21),l.Ob(10,"decimal-field",22),l.Sb(),l.Tb(11,"td",21),l.Ob(12,"decimal-field",22),l.Sb(),l.Tb(13,"td",21),l.Ob(14,"decimal-field",23),l.Sb(),l.Tb(15,"td",24),l.Fc(16,ji,3,4,"ng-container",13),l.ec(17,"async"),l.Sb(),l.Tb(18,"td",25),l.Tb(19,"button",26),l.bc("click",(function(){l.wc(e);const i=t.$implicit;return l.dc(2).remove(i)})),l.Ob(20,"icon",27),l.Sb(),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.dc(2);l.zb(2),l.Jc("",e.product.productNumber," "),l.zb(1),l.kc("ngStyle",l.mc(21,_i)),l.zb(2),l.Ic(e.product.name),l.zb(2),l.Jc(" ",l.gc(8,16,e.product.price,i.currency)," "),l.zb(3),l.kc("formControl",i.form.controls[i.discount(e)])("scale",2),l.zb(2),l.kc("formControl",i.form.controls[i.price(e)])("scale",i.currency.decimalDigits),l.zb(2),l.kc("formControl",i.form.controls[i.quantity(e)])("minRange",e.product.allowDecimalQuantity?null:1)("maxRange",e.product.allowDecimalQuantity?null:10)("customValueLabel",i.i18n.ad.customQuantity)("scale",e.product.allowDecimalQuantity?2:0),l.zb(1),l.kc("ngStyle",l.mc(22,_i)),l.zb(1),l.kc("ngIf",l.fc(17,19,i.form.valueChanges)||e.totalPrice),l.zb(3),l.kc("tooltip",i.i18n.general.remove)}}function Wi(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.ec(2,"currency"),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",l.gc(2,1,e.subtotal,e.currency)," ")}}function Yi(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.i18n.ad.deliveryMethod+": "+(e.deliveryMethod.name||"")," ")}}function Xi(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.ec(2,"currency"),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.deliveryMethod.price?l.gc(2,1,e.deliveryMethod.price,e.currency):e.i18n.general.notSet," ")}}function Zi(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.ec(2,"currency"),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",l.gc(2,1,e.total,e.currency)," ")}}function ea(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"form",2),l.Tb(2,"table",3),l.Tb(3,"thead"),l.Tb(4,"th",4),l.Hc(5),l.Sb(),l.Tb(6,"th",5),l.Hc(7),l.Sb(),l.Tb(8,"th",6),l.Hc(9),l.Sb(),l.Tb(10,"th",6),l.Hc(11),l.Sb(),l.Tb(12,"th",6),l.Hc(13),l.Sb(),l.Tb(14,"th",6),l.Hc(15),l.Sb(),l.Tb(16,"th",7),l.Hc(17),l.Sb(),l.Ob(18,"th",8),l.Sb(),l.Tb(19,"tbody"),l.Fc(20,Ki,21,23,"tr",9),l.Tb(21,"tr",10),l.Tb(22,"td",11),l.Hc(23),l.Sb(),l.Tb(24,"td",12),l.Fc(25,Wi,3,4,"ng-container",13),l.ec(26,"async"),l.Sb(),l.Ob(27,"td"),l.Sb(),l.Tb(28,"tr",10),l.Tb(29,"td"),l.Fc(30,Yi,2,1,"ng-container",13),l.ec(31,"async"),l.Sb(),l.Tb(32,"td",14),l.Fc(33,Xi,3,4,"ng-container",13),l.ec(34,"async"),l.Sb(),l.Ob(35,"td"),l.Sb(),l.Tb(36,"tr",15),l.Tb(37,"td",16),l.Hc(38),l.Sb(),l.Tb(39,"td",17),l.Fc(40,Zi,3,4,"ng-container",13),l.ec(41,"async"),l.ec(42,"async"),l.Sb(),l.Ob(43,"td",18),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("formGroup",e.form),l.zb(4),l.Ic(e.i18n.ad.number),l.zb(1),l.kc("ngStyle",l.mc(33,_i)),l.zb(1),l.Jc(" ",e.i18n.ad.product,""),l.zb(2),l.Jc("",e.i18n.ad.basePrice," "),l.zb(2),l.Jc("",e.i18n.ad.discount," "),l.zb(2),l.Ic(e.i18n.ad.price),l.zb(2),l.Jc("",e.i18n.ad.quantity," "),l.zb(1),l.kc("ngStyle",l.mc(34,_i)),l.zb(1),l.Jc(" ",e.i18n.transaction.amount,""),l.zb(3),l.kc("ngForOf",e.data),l.zb(2),l.Ab("colspan",4),l.zb(1),l.Jc(" ",e.i18n.ad.subtotal,""),l.zb(1),l.Ab("colspan",3),l.zb(1),l.kc("ngIf",l.fc(26,23,e.form.valueChanges)||e.data),l.zb(4),l.Ab("colspan",4),l.zb(1),l.kc("ngIf",l.fc(31,25,e.deliveryMethod$)),l.zb(2),l.Ab("colspan",3),l.zb(1),l.kc("ngIf",l.fc(34,27,e.deliveryMethod$)),l.zb(4),l.Ab("colspan",4),l.zb(1),l.Jc(" ",e.i18n.ad.total,""),l.zb(1),l.Ab("colspan",3),l.zb(1),l.kc("ngIf",l.fc(41,29,e.deliveryMethod$)||l.fc(42,31,e.form.valueChanges)||e.data)}}function ta(e,t){if(1&e&&(l.Tb(0,"div"),l.Hc(1),l.Sb()),2&e){const e=l.dc();l.zb(1),l.Ic(e.i18n.ad.itemsNone)}}let ia=(()=>{class e extends M.a{constructor(e){super(e),this.data$=new A.a(null)}ngOnInit(){super.ngOnInit(),this.products$.subscribe(e=>{this.form=this.formBuilder.group({}),Object(s.h)(e)||e.forEach(e=>{const t=this.formBuilder.control(this.calculateDiscount(e,+e.price));this.form.addControl(this.discount(e),t);const i=this.formBuilder.control(e.price);this.form.addControl(this.price(e),i),this.addSub(t.valueChanges.pipe(Object(Vi.a)(),Object(R.a)(550)).subscribe(t=>this.applyDiscount(e,t))),this.addSub(i.valueChanges.pipe(Object(Vi.a)(),Object(R.a)(550)).subscribe(t=>this.applyPrice(e,t)));const a=this.formBuilder.control(e.quantity);this.form.addControl(this.quantity(e),a),this.addSub(a.valueChanges.pipe(Object(Vi.a)(),Object(R.a)(550)).subscribe(t=>e.quantity=t))}),this.data=e})}applyDiscount(e,t){let i;i=t<0?+e.product.price:t>100?0:+e.product.price-t/100*+e.product.price,this.form.controls[this.price(e)].setValue(i,{emitEvent:!1}),e.price=i.toString()}applyPrice(e,t){const i=this.calculateDiscount(e,t);t>+e.price?this.form.controls[this.price(e)].setValue(+e.price,{emitEvent:!1,onlySelf:!0}):e.price=t?t.toString():"0",this.form.controls[this.discount(e)].setValue(i,{emitEvent:!1})}calculateDiscount(e,t){const i=100*(1-t/+e.product.price);return i<0?0:i>100?100:i}discount(e){return e.product.id+"_discount"}quantity(e){return e.product.id+"_quantity"}price(e){return e.product.id+"_price"}rowTotal(e){return this.form.value[this.quantity(e)]*this.form.value[this.price(e)]}get subtotal(){let e=0;return this.data$.value.forEach(t=>e+=this.rowTotal(t)),e}get total(){const e=this.deliveryMethod?this.deliveryMethod.price:"";return this.subtotal+(Object(s.h)(e)?0:+e)}get deliveryMethod(){return this.deliveryMethod$.value}get data(){return this.data$.value}set data(e){this.data$.next(e)}navigate(e){return this.router.navigate(["/marketplace","view",e.product.id])}remove(e){const t=this.products$.value.filter(t=>t.product.id!==e.product.id);this.products$.next(t)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r))},e.\u0275cmp=l.Hb({type:e,selectors:[["order-products"]],inputs:{products$:"products$",deliveryMethod$:"deliveryMethod$",currency:"currency"},features:[l.wb],decls:4,vars:4,consts:[[4,"ngIf","ngIfElse"],["noProducts",""],[3,"formGroup"],[1,"table","table-hover","cursor-pointer"],["width","13%",1,"no-border"],["width","13%",1,"no-border",3,"ngStyle"],["width","13%",1,"no-border","text-right"],[1,"no-border","text-right","ellipsis",3,"ngStyle"],[1,"actions"],[4,"ngFor","ngForOf"],[1,"no-hover"],[1,"table-head-color"],[1,"table-head-color","text-right","ellipsis"],[4,"ngIf"],[1,"text-right","ellipsis"],[1,"totalAmount","no-hover"],[1,"border-bottom-0","label","label-value-label"],[1,"border-bottom-0","text-right","label-value-value","ellipsis"],[1,"border-bottom-0"],[1,"link",3,"ngStyle"],[1,"ellipsis-clamp-2",3,"click"],[1,"text-right"],[3,"formControl","scale"],[3,"formControl","minRange","maxRange","customValueLabel","scale"],[1,"text-right","ellipsis",3,"ngStyle"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","delete"]],template:function(e,t){if(1&e&&(l.Fc(0,ea,44,35,"ng-container",0),l.ec(1,"async"),l.Fc(2,ta,2,1,"ng-template",null,1,l.Gc)),2&e){const e=l.uc(3);l.kc("ngIf",l.fc(1,2,t.data$)&&t.data.length>0)("ngIfElse",e)}},directives:[b.t,n.I,n.w,n.n,b.w,b.s,G.a,n.v,n.k,L.b,B.a],pipes:[b.b,U.a],encapsulation:2,changeDetection:0}),e})();function aa(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"label-value",3),l.Hc(2),l.Sb(),l.Tb(3,"label-value",3),l.Hc(4),l.ec(5,"dateTime"),l.Sb(),l.Tb(6,"label-value",3),l.Hc(7),l.Sb(),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.number),l.zb(1),l.Jc(" ",e.number," "),l.zb(1),l.kc("label",e.i18n.general.date),l.zb(1),l.Jc(" ",l.fc(5,6,e.creationDate)," "),l.zb(2),l.kc("label",e.i18n.general.status),l.zb(1),l.Jc(" ",e.resolveStatusLabel()," ")}}function na(e,t){if(1&e&&l.Ob(0,"field-option",24),2&e){const e=t.$implicit;l.kc("value",e.name)("text",e.name)}}function ra(e,t){if(1&e&&l.Ob(0,"field-option",24),2&e){const e=t.$implicit,i=l.dc(2);l.kc("value",i.resolveAddressId(e))("text",e.name)}}const ca=function(e){return{"section-title-action":e}};function sa(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",2),l.Fc(2,aa,8,8,"ng-container",1),l.Tb(3,"label-value",3),l.Ob(4,"user-link",4),l.Sb(),l.Tb(5,"div",5),l.Tb(6,"h2",6),l.Tb(7,"div",7),l.Hc(8),l.Sb(),l.Tb(9,"div",8),l.ec(10,"async"),l.Tb(11,"button",9),l.bc("click",(function(){return l.wc(e),l.dc().addProducts()})),l.Hc(12),l.Sb(),l.Sb(),l.Sb(),l.Ob(13,"order-products",10),l.Tb(14,"h2",11),l.Hc(15),l.Sb(),l.Tb(16,"single-selection-field",12),l.Fc(17,na,1,2,"field-option",13),l.Sb(),l.Ob(18,"div",14),l.Tb(19,"div",5),l.Ob(20,"input-field",15),l.Ob(21,"decimal-field",16),l.Ob(22,"time-interval-field",17),l.Ob(23,"time-interval-field",18),l.Sb(),l.Tb(24,"h2",11),l.Hc(25),l.Sb(),l.Tb(26,"single-selection-field",19),l.Fc(27,ra,1,2,"field-option",13),l.Sb(),l.Ob(28,"div",14),l.Ob(29,"address-form",20),l.Tb(30,"h2"),l.Hc(31),l.Sb(),l.Ob(32,"textarea-field",21),l.Sb(),l.Tb(33,"actions"),l.Tb(34,"button",22),l.bc("click",(function(){return l.wc(e),l.dc().save()})),l.ec(35,"async"),l.Hc(36),l.Sb(),l.Tb(37,"button",23),l.bc("click",(function(){return l.wc(e),l.dc().save(!0)})),l.ec(38,"async"),l.Hc(39),l.Sb(),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc();l.zb(1),l.kc("heading",e.create?e.i18n.ad.title.newOrder:e.i18n.ad.title.order)("mobileHeading",e.create?e.i18n.ad.mobileTitle.newOrder:e.i18n.ad.mobileTitle.order),l.zb(1),l.kc("ngIf",!e.create),l.zb(1),l.kc("label",e.i18n.ad.buyer),l.zb(1),l.kc("user",e.data.buyer),l.zb(1),l.kc("formGroup",e.form),l.zb(3),l.Jc(" ",e.i18n.ad.products," "),l.zb(1),l.kc("ngClass",l.nc(41,ca,l.fc(10,35,e.layout.gtsm$))),l.zb(3),l.Jc(" ",e.i18n.ad.addProducts," "),l.zb(1),l.kc("products$",e.products$)("deliveryMethod$",e.deliveryMethod$)("currency",e.currency),l.zb(2),l.Ic(e.i18n.ad.deliveryMethod),l.zb(1),l.kc("emptyOption",e.i18n.ad.customDeliveryMethod)("label",e.i18n.ad.chooseDeliveryMethod),l.zb(1),l.kc("ngForOf",e.data.deliveryMethods),l.zb(2),l.kc("formGroup",e.deliveryForm),l.zb(1),l.kc("label",e.i18n.general.name),l.zb(1),l.kc("label",e.i18n.ad.deliveryPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),l.zb(1),l.kc("label",e.i18n.ad.minDeliveryTime),l.zb(1),l.kc("label",e.i18n.ad.maxDeliveryTime),l.zb(2),l.Ic(e.i18n.ad.deliveryAddress),l.zb(1),l.kc("emptyOption",e.i18n.ad.customAddress)("label",e.i18n.ad.chooseDeliveryAddress),l.zb(1),l.kc("ngForOf",e.data.addresses),l.zb(2),l.kc("addressForm",e.addressForm)("configuration",e.data.addressConfiguration),l.zb(2),l.Ic(e.i18n.ad.remarks),l.zb(3),l.kc("disabled",l.fc(35,37,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.ad.submitToBuyer," "),l.zb(1),l.kc("disabled",l.fc(38,39,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.ad.saveDraft," ")}}let oa=(()=>{class e extends c.a{constructor(e,t,i,a,n){super(e),this.orderService=t,this.marketplaceHelper=i,this.addressHelper=a,this.modal=n,this.products$=new A.a(null),this.deliveryMethod$=new A.a(null),this.address$=new A.a(null)}ngOnInit(){super.ngOnInit();const e=this.route.snapshot.queryParams.buyer,t=this.route.snapshot.queryParams.currency;this.id=this.route.snapshot.params.id,this.user=this.route.snapshot.params.user,this.create=null==this.id;const i=this.create?this.orderService.getOrderDataForNew({buyer:e,user:this.user,currency:t}):this.orderService.getOrderDataForEdit({order:this.id});this.addSub(i.subscribe(e=>{this.data=e}))}onDataInitialized(e){this.form=this.formBuilder.group({remarks:e.order.remarks}),this.create&&!Object(s.h)(e.deliveryMethods)&&1===e.deliveryMethods.length&&(e.order.deliveryMethod=e.deliveryMethods[0]),this.deliveryForm=this.formBuilder.group({name:[null,n.G.required],price:[null,n.G.required],minTime:null,maxTime:[null,n.G.required]}),this.addSub(this.deliveryForm.valueChanges.subscribe(e=>this.deliveryMethod=e)),this.deliveryForm.patchValue(e.order.deliveryMethod);const t=this.formBuilder.control(e.deliveryMethods);this.form.addControl("deliveryMethod",t),e.order.deliveryMethod&&t.setValue(e.order.deliveryMethod.name),this.addSub(t.valueChanges.subscribe(t=>this.updateDelivery(t,e))),this.create&&!Object(s.h)(e.addresses)&&1===e.addresses.length&&(e.order.deliveryAddress=e.addresses[0]),this.addressForm=this.addressHelper.addressFormGroup(e.addressConfiguration),this.addressForm.patchValue(e.order.deliveryAddress);const i=this.formBuilder.control(e.addresses);this.form.addControl("address",i),this.address=e.order.deliveryAddress;const a=this.resolveAddressId(this.address);i.setValue(e.addresses.find(e=>a===this.resolveAddressId(e))?a:null),this.addSub(i.valueChanges.subscribe(t=>this.updateAddress(t,e)));const r=[];(e.items||[]).forEach(t=>{const i=e.order.items.filter(e=>e.product===t.id)[0];r.push({price:i.price,totalPrice:+i.price*+i.quantity,quantity:i.quantity,product:t})}),this.products=r}updateAddress(e,t){null==e?(this.addressForm.reset(),this.address=null):(this.address=t.addresses.find(t=>e===this.resolveAddressId(t)),this.addressForm.patchValue(this.address))}addProducts(){const e=this.modal.show(Ui,{class:"modal-form modal-form-medium",initialState:{currency:this.currency}});this.addSub(e.content.select.subscribe(e=>{this.addProduct(e)}))}addProduct(e){const t=this.products||[];let i=t.find(t=>t.product.id===e.id);null!=i?i.quantity=(+i.quantity+1).toString():(e.price=e.promotionalPrice||e.price,i={price:e.price,totalPrice:e.price,quantity:"1",product:e},t.push(i)),this.products=t}resolveAddressId(e){return null==e?null:[e.addressLine1,e.addressLine2,e.buildingNumber,e.city,e.complement,e.country,e.neighborhood,e.poBox,e.region,e.street,e.zip].join("")}updateDelivery(e,t){if(null==e)this.deliveryForm.reset();else{const i=t.deliveryMethods.find(t=>e===t.name);this.deliveryForm.patchValue(this.deliveryMethod?{name:i.name,price:i.chargeAmount||null,minTime:i.minDeliveryTime,maxTime:i.maxDeliveryTime}:null)}}get address(){return this.address$.value}set address(e){this.address$.next(e)}get products(){return this.products$.value}set products(e){this.products$.next(e)}get deliveryMethod(){return this.deliveryMethod$.value}set deliveryMethod(e){this.deliveryMethod$.next(e)}get currency(){return this.create?this.data.currencies[0]:this.data.currency}save(e){const t=this.data.order;t.items=[],this.products.forEach(e=>{t.items.push({price:e.price,product:e.product.id,quantity:e.quantity})}),t.deliveryMethod=this.deliveryForm.value,t.deliveryAddress=this.addressForm.value,t.remarks=this.form.controls.remarks.value,t.draft=e||!1;const i=()=>{this.notification.snackBar(e?this.i18n.ad.orderSavedAsDraft:this.i18n.ad.orderSubmittedToBuyer),history.back()},a=()=>{this.addSub(this.create?this.orderService.createOrder({user:this.user,body:t}).subscribe(i):this.orderService.updateOrder({order:this.id,body:t}).subscribe(i))};e?a():this.notification.confirm({message:this.i18n.ad.submitToBuyerConfirmation,callback:a})}resolveStatusLabel(){return this.marketplaceHelper.resolveOrderStatusLabel(this.data.status)}resolveMenu(){return o.b.SALES}get number(){return this.data.number}get creationDate(){return this.data.creationDate}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.x),l.Nb(H.a),l.Nb(F.a),l.Nb(It.b))},e.\u0275cmp=l.Hb({type:e,selectors:[["sale-form"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading"],[3,"label"],[3,"user"],[3,"formGroup"],[1,"mt-3","mb-2","d-flex","flex-column","flex-xs-row","justify-content-between"],[1,"mb-2","mb-xs-0"],[3,"ngClass"],[1,"btn","btn-outline-primary",3,"click"],[3,"products$","deliveryMethod$","currency"],[1,"mt-2"],["formControlName","deliveryMethod",3,"emptyOption","label"],[3,"value","text",4,"ngFor","ngForOf"],[1,"any-label-value"],["formControlName","name","required","",3,"label"],["formControlName","price","fieldSize","full","required","",3,"label","scale","prefix","suffix"],["formControlName","minTime",3,"label"],["formControlName","maxTime","required","",3,"label"],["formControlName","address",3,"emptyOption","label"],[3,"addressForm","configuration"],["formControlName","remarks"],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-outline-primary",3,"disabled","click"],[3,"value","text"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,sa,40,43,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,f.a,n.w,n.n,b.q,ia,We.a,n.v,n.l,b.s,je.a,n.D,G.a,Ke.a,P.a,p.a,g.a,$.a],pipes:[b.b,v.a],encapsulation:2,changeDetection:0}),e})();var la=i("BhKi"),da=i("rCAV"),ba=i("tVPo"),ua=i("75v4"),ma=i("VcWf");function fa(e,t){if(1&e){const e=l.Ub();l.Tb(0,"a",5),l.bc("click",(function(i){l.wc(e);const a=t.$implicit;return l.dc().emit(a,i)})),l.Hc(1),l.Sb()}if(2&e){const e=t.$implicit;l.zb(1),l.Jc(" ",e.name,"\n")}}let ha=(()=>{class e extends M.a{constructor(e,t){super(e),this.modalRef=t,this.select=new l.n}emit(e,t){this.select.emit(e),t.preventDefault(),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(It.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["show-sub-categories"]],inputs:{category:"category",image:"image",icon:"icon",color:"color"},outputs:{select:"select"},features:[l.wb],decls:9,vars:6,consts:[[1,"d-flex","justify-content-center"],["size","medium",3,"image","icon","iconColor"],["href","#",1,"ml-3","pt-1","flex-grow-1","undecorated",3,"click"],["class","d-block mb-1 undecorated","href","#",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary",3,"click"],["href","#",1,"d-block","mb-1","undecorated",3,"click"]],template:function(e,t){1&e&&(l.Tb(0,"h1",0),l.Ob(1,"avatar",1),l.Tb(2,"a",2),l.bc("click",(function(e){return t.emit(t.category,e)})),l.Hc(3),l.Sb(),l.Sb(),l.Fc(4,fa,2,1,"a",3),l.Tb(5,"actions"),l.Ob(6,"span"),l.Tb(7,"button",4),l.bc("click",(function(){return t.modalRef.hide()})),l.Hc(8),l.Sb(),l.Sb()),2&e&&(l.zb(1),l.kc("image",t.image)("icon",t.icon)("iconColor",t.color),l.zb(2),l.Jc(" ",t.category.name," "),l.zb(1),l.kc("ngForOf",t.category.children),l.zb(4),l.Jc(" ",t.i18n.general.cancel," "))},directives:[h.a,b.s,g.a],encapsulation:2,changeDetection:0}),e})();var pa=i("yWxo"),ga=i("T9y1"),va=i("RRWt"),ya=i("5Wk5"),ka=i("pgV1"),Sa=i("wezA"),Ta=i("cLCZ");function za(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"a",13),l.bc("click",(function(i){l.wc(e);const a=t.$implicit,n=l.dc(2);return i.preventDefault(),n.selectCategory(a)})),l.Hc(2),l.Sb(),l.Qb()}if(2&e){const e=t.$implicit;l.zb(2),l.Jc(" ",e.name," ")}}function Ia(e,t){if(1&e){const e=l.Ub();l.Tb(0,"a",14),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit,a=l.dc();return t.preventDefault(),a.showAllChildren(i)})),l.Hc(1),l.Sb()}if(2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.i18n.ad.showAllCategories," ")}}function Oa(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",6),l.Tb(1,"div",7),l.Tb(2,"a",8),l.bc("click",(function(i){l.wc(e);const a=t.$implicit,n=l.dc();return i.preventDefault(),n.selectCategory(a)})),l.Ob(3,"avatar",9),l.Hc(4),l.Sb(),l.Sb(),l.Tb(5,"div",10),l.Fc(6,za,3,1,"ng-container",11),l.Sb(),l.Fc(7,Ia,2,1,"a",12),l.ec(8,"async"),l.Sb()}if(2&e){const e=t.$implicit,i=l.dc();l.zb(3),l.kc("image",i.categoryImage(e))("icon",i.categoryIcon(e))("iconColor",i.categoryColor(e)),l.zb(1),l.Jc(" ",e.name," "),l.zb(2),l.kc("ngForOf",i.categoryChildren(e)),l.zb(1),l.kc("ngIf",l.fc(8,6,i.layout.gtxxs$)&&i.hasMoreChildren(e))}}function wa(e,t){if(1&e&&(l.Tb(0,"span",21),l.Hc(1),l.ec(2,"number"),l.Sb()),2&e){const e=l.dc(2).$implicit,t=l.dc();l.zb(1),l.Jc(" ",l.gc(2,1,e.price,t.decimals(e))," ")}}function xa(e,t){if(1&e&&(l.Tb(0,"div",19),l.Fc(1,wa,3,4,"span",20),l.Hc(2),l.ec(3,"currency"),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc();l.zb(1),l.kc("ngIf",e.promotionalPrice),l.zb(1),l.Jc(" ",l.gc(3,2,e.promotionalPrice||e.price,t.lookupCurrency(e))," ")}}function Fa(e,t){if(1&e&&(l.Tb(0,"div",22),l.Ob(1,"format-field-value",23),l.Sb()),2&e){const e=t.$implicit,i=l.dc().$implicit,a=l.dc();l.zb(1),l.kc("fields",a.data.customFields)("plainText",!0)("fieldName",e)("object",i)}}function Ha(e,t){if(1&e&&(l.Tb(0,"mobile-result",15),l.Fc(1,xa,4,5,"div",16),l.Tb(2,"div",17),l.Hc(3),l.Sb(),l.Tb(4,"div",17),l.Hc(5),l.Sb(),l.Fc(6,Fa,2,4,"div",18),l.Sb()),2&e){const e=t.$implicit,i=l.dc();l.kc("avatarImage",e.image),l.zb(1),l.kc("ngIf",e.price),l.zb(2),l.Jc(" ",e.name," "),l.zb(2),l.Jc(" ",i.i18n.ad.byOwner(e.owner.display)," "),l.zb(1),l.kc("ngForOf",i.data.fieldsInList)}}function Ca(e,t){if(1&e&&(l.Tb(0,"th",29),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.Ic(e.i18n.ad.owner)}}function Na(e,t){if(1&e&&(l.Tb(0,"th"),l.Hc(1),l.Sb()),2&e){const e=t.$implicit,i=l.dc(2);l.zb(1),l.Ic(i.fieldName(e))}}function Aa(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"td",25),l.Ob(2,"avatar",33),l.Sb(),l.Tb(3,"td"),l.Hc(4),l.Sb(),l.Qb()),2&e){const e=l.dc().$implicit;l.zb(2),l.kc("image",e.owner.image),l.zb(2),l.Jc(" ",e.owner.display," ")}}function Da(e,t){if(1&e&&(l.Tb(0,"td"),l.Ob(1,"format-field-value",23),l.Sb()),2&e){const e=t.$implicit,i=l.dc(2).$implicit,a=l.dc(2);l.zb(1),l.kc("fields",a.data.customFields)("plainText",!0)("fieldName",e)("object",i)}}function $a(e,t){if(1&e&&(l.Rb(0),l.Fc(1,Da,2,4,"td",11),l.Qb()),2&e){const e=l.dc(3);l.zb(1),l.kc("ngForOf",e.data.fieldsInList)}}function Pa(e,t){if(1&e&&(l.Tb(0,"span",21),l.Hc(1),l.ec(2,"number"),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(2);l.zb(1),l.Jc(" ",l.gc(2,1,e.price,t.decimals(e))," ")}}function Ma(e,t){if(1&e){const e=l.Ub();l.Tb(0,"tr",30),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(2);return a.router.navigate(a.path(i))})),l.Tb(1,"td",25),l.Ob(2,"avatar",31),l.Sb(),l.Tb(3,"td"),l.Hc(4),l.Sb(),l.Fc(5,Aa,5,2,"ng-container",32),l.Fc(6,$a,2,1,"ng-container",32),l.ec(7,"async"),l.Tb(8,"td",27),l.Fc(9,Pa,3,4,"span",20),l.Hc(10),l.ec(11,"currency"),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.dc(2);l.zb(2),l.kc("image",e.image),l.zb(2),l.Jc(" ",e.name," "),l.zb(1),l.kc("ngIf",!i.singleUser),l.zb(1),l.kc("ngIf",l.fc(7,6,i.layout.gtxs$)),l.zb(3),l.kc("ngIf",e.promotionalPrice),l.zb(1),l.Jc(" ",l.gc(11,8,e.promotionalPrice||e.price,i.lookupCurrency(e))," ")}}function Ra(e,t){if(1&e&&(l.Tb(0,"table",24),l.Tb(1,"thead"),l.Ob(2,"th",25),l.Tb(3,"th"),l.Hc(4),l.Sb(),l.Fc(5,Ca,2,1,"th",26),l.Fc(6,Na,2,1,"th",11),l.Tb(7,"th",27),l.Hc(8),l.Sb(),l.Sb(),l.Tb(9,"tbody"),l.Fc(10,Ma,12,11,"tr",28),l.Sb(),l.Sb()),2&e){const e=l.dc();l.zb(4),l.Ic(e.i18n.ad.name),l.zb(1),l.kc("ngIf",!e.singleUser),l.zb(1),l.kc("ngForOf",e.data.fieldsInList),l.zb(2),l.Ic(e.i18n.ad.price),l.zb(2),l.kc("ngForOf",null==e.results?null:e.results.results)}}function Ea(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"div",38),l.Tb(2,"avatar",39),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit,a=l.dc();return t.preventDefault(),a.router.navigate(["users",i.owner.id,"profile"])})),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc().$implicit;l.zb(2),l.kc("image",e.owner.image)("tooltip",e.owner.display)}}function qa(e,t){if(1&e&&(l.Tb(0,"span",21),l.Hc(1),l.ec(2,"number"),l.Sb()),2&e){const e=l.dc(2).$implicit,t=l.dc();l.zb(1),l.Jc(" ",l.gc(2,1,e.price,t.decimals(e))," ")}}function Qa(e,t){if(1&e&&(l.Tb(0,"div",40),l.Fc(1,qa,3,4,"span",20),l.Hc(2),l.ec(3,"currency"),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc();l.zb(1),l.kc("ngIf",e.promotionalPrice),l.zb(1),l.Jc(" ",l.gc(3,2,e.promotionalPrice||e.price,t.lookupCurrency(e))," ")}}function Ja(e,t){1&e&&(l.Tb(0,"div",40),l.Ob(1,"br"),l.Sb())}function La(e,t){if(1&e&&(l.Tb(0,"tiled-result",34),l.Fc(1,Ea,3,2,"ng-container",32),l.Fc(2,Qa,4,5,"div",35),l.Fc(3,Ja,2,0,"ng-template",null,36,l.Gc),l.Tb(5,"div",37),l.Hc(6),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.uc(4),a=l.dc();l.kc("image",e.image)("zoom",!0),l.zb(1),l.kc("ngIf",!a.singleUser),l.zb(1),l.kc("ngIf",e.price)("ngIfElse",i),l.zb(4),l.Jc(" ",e.name," ")}}function Ba(e,t){if(1&e&&(l.Tb(0,"span",21),l.Hc(1),l.ec(2,"number"),l.Sb()),2&e){const e=l.dc(2).$implicit,t=l.dc();l.zb(1),l.Jc(" ",l.gc(2,1,e.price,t.decimals(e))," ")}}function Ga(e,t){if(1&e&&(l.Tb(0,"div",44),l.Fc(1,Ba,3,4,"span",20),l.Hc(2),l.ec(3,"currency"),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc();l.zb(1),l.kc("ngIf",e.promotionalPrice),l.zb(1),l.Jc(" ",l.gc(3,2,e.promotionalPrice||e.price,t.lookupCurrency(e))," ")}}function Ua(e,t){if(1&e&&(l.Tb(0,"map-result",41),l.Tb(1,"div",42),l.Hc(2),l.Sb(),l.Fc(3,Ga,4,5,"div",43),l.Tb(4,"div"),l.Hc(5),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=t.address,a=l.dc();l.kc("image",e.image)("address",i),l.zb(2),l.Ic(e.name),l.zb(1),l.kc("ngIf",e.price),l.zb(2),l.Ic(a.i18n.ad.byOwner(e.owner.display))}}let Va=(()=>{class e extends M.a{constructor(e,t){super(e),this.modal=t,this.clazz="flex-grow-1 d-flex",this._singleUser=!1,this.update=new l.n,this.categorySelected=new l.n}get singleUser(){return this._singleUser}set singleUser(e){this._singleUser=Object(s.E)(e)}toAddress(e){return e.address}toMarkerTitle(e){return e.name}fieldName(e){return(this.data.customFields.find(t=>t.internalName===e)||{}).name}path(e){return["/marketplace","view",e.id]}lookupCurrency(e){return this.data.currencies.find(t=>t.internalName===e.currency||t.id===e.currency)}decimals(e){return(this.lookupCurrency(e)||{}).decimalDigits||0}selectCategory(e){null!=e.id?(this.resultType=this.layout.xxs?ua.a.LIST:ua.a.TILES,this.results=null,this.categorySelected.emit(e)):this.resultType=ua.a.CATEGORIES}categoryConfiguration(e){let t=null;return e.internalName&&(t=(ma.a.adCategories||{})[e.internalName]),null==e&&(t=(ma.a.adCategories||{})[e.id]),t||{}}categoryColor(e){return this.categoryConfiguration(e).color}categoryIcon(e){return this.categoryConfiguration(e).icon}categoryImage(e){return this.categoryIcon(e)?null:e.image}categoryChildren(e){const t=e.children||[];return this.layout.xxs||t.length<=5?t:t.slice(0,5)}hasMoreChildren(e){return(e.children||[]).length>5}showAllChildren(e){const t=this.modal.show(ha,{class:"modal-form modal-small",initialState:{category:e,image:this.categoryImage(e),icon:this.categoryIcon(e),color:this.categoryColor(e)}});this.addSub(t.content.select.subscribe(e=>{this.selectCategory(e)}))}get toLink(){return e=>this.path(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(It.b))},e.\u0275cmp=l.Hb({type:e,selectors:[["ads-results"]],hostVars:2,hostBindings:function(e,t){2&e&&l.Bb(t.clazz)},inputs:{resultType:"resultType",rendering$:"rendering$",singleUser:"singleUser",data:"data",results:"results",referencePoint:"referencePoint"},outputs:{update:"update",categorySelected:"categorySelected"},features:[l.wb],decls:6,vars:8,consts:[[3,"categories","results","rendering$","resultType","referencePoint","toAddress","toMarkerTitle","toLink","update"],["class","card",4,"resultCategory"],["avatarIcon","shopping_basket",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["icon","shopping_basket",3,"image","zoom",4,"resultTile"],[3,"image","address",4,"resultInfoWindow"],[1,"card"],[1,"category-title"],["href","#",1,"category-title-text",3,"click"],["size","small",3,"image","icon","iconColor"],[1,"card-body"],[4,"ngFor","ngForOf"],["class","category-footer","href","#",3,"click",4,"ngIf"],["href","#",1,"sub-category-text",3,"click"],["href","#",1,"category-footer",3,"click"],["avatarIcon","shopping_basket",3,"avatarImage"],["class","cell-main",4,"ngIf"],[1,"cell-text"],["class","cell-small",4,"ngFor","ngForOf"],[1,"cell-main"],["class","promo-price",4,"ngIf"],[1,"promo-price"],[1,"cell-small"],[3,"fields","plainText","fieldName","object"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["colspan","2",4,"ngIf"],[1,"text-right"],[3,"click",4,"ngFor","ngForOf"],["colspan","2"],[3,"click"],["icon","shopping_basket",3,"image"],[4,"ngIf"],[3,"image"],["icon","shopping_basket",3,"image","zoom"],["class","card-title",4,"ngIf","ngIfElse"],["blankPrice",""],[1,"card-text"],[1,"tile-floating-avatar"],["icon","user_full","size","medium-large",1,"solid-icon",3,"image","tooltip","click"],[1,"card-title"],[3,"image","address"],[1,"font-weight-bold","mb-2"],["class","font-weight-bold",4,"ngIf"],[1,"font-weight-bold"]],template:function(e,t){1&e&&(l.Tb(0,"results-layout",0),l.bc("update",(function(e){return t.update.emit(e)})),l.Fc(1,Oa,9,8,"div",1),l.Fc(2,Ha,7,5,"mobile-result",2),l.Fc(3,Ra,11,5,"table",3),l.Fc(4,La,7,6,"tiled-result",4),l.Fc(5,Ua,6,5,"map-result",5),l.Sb()),2&e&&l.kc("categories",t.data.categories)("results",t.results)("rendering$",t.rendering$)("resultType",t.resultType)("referencePoint",t.referencePoint)("toAddress",t.toAddress)("toMarkerTitle",t.toMarkerTitle)("toLink",t.toLink)},directives:[E.a,pa.a,q.a,Q.a,ga.a,va.a,h.a,b.s,b.t,J.a,ya.a,ka.a,L.b,Sa.a],pipes:[b.b,U.a,Ta.a],encapsulation:2,changeDetection:0}),e})();var ja=i("z3FF"),_a=i("uao2"),Ka=i("fe3a"),Wa=i("PzFp");function Ya(e,t){1&e&&l.Pb(0)}function Xa(e,t){if(1&e&&(l.Tb(0,"div",6),l.Ob(1,"max-distance-field",14),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("data",e.data.searchByDistanceData)("label",e.i18n.general.distanceFilter)}}function Za(e,t){if(1&e&&l.Ob(0,"field-option",22),2&e){const e=l.dc(3);l.kc("text",e.i18n.ad.status.pending)}}function en(e,t){if(1&e&&(l.Tb(0,"div",6),l.Tb(1,"multi-selection-field",15),l.Ob(2,"field-option",16),l.Ob(3,"field-option",17),l.Fc(4,Za,1,1,"field-option",18),l.Ob(5,"field-option",19),l.Ob(6,"field-option",20),l.Ob(7,"field-option",21),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.general.status),l.zb(1),l.kc("text",e.i18n.ad.status.active),l.zb(1),l.kc("text",e.i18n.ad.status.disabled),l.zb(1),l.kc("ngIf",e.canViewPending),l.zb(1),l.kc("text",e.i18n.ad.status.expired),l.zb(1),l.kc("text",e.i18n.ad.status.hidden),l.zb(1),l.kc("text",e.i18n.ad.status.scheduled)}}function tn(e,t){if(1&e&&(l.Tb(0,"div",6),l.Ob(1,"custom-field-filter",24),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.zb(1),l.kc("field",e)("formControl",i.form.get("customValues").get(e.internalName))}}function an(e,t){if(1&e&&(l.Rb(0),l.Fc(1,tn,2,2,"div",23),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("ngForOf",e.basicFields)}}function nn(e,t){if(1&e&&(l.Tb(0,"div",6),l.Ob(1,"custom-field-filter",24),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.zb(1),l.kc("field",e)("formControl",i.form.get("customValues").get(e.internalName))}}function rn(e,t){if(1&e&&(l.Tb(0,"div",6),l.Ob(1,"basic-profile-field-filter",24),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.zb(1),l.kc("field",e)("formControl",i.form.get("profileFields").get(e.field))}}function cn(e,t){if(1&e&&(l.Tb(0,"div",6),l.Ob(1,"custom-field-filter",24),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.zb(1),l.kc("field",e)("formControl",i.form.get("profileFields").get(e.internalName))}}function sn(e,t){if(1&e&&l.Ob(0,"field-option",32),2&e){const e=l.dc(4);l.kc("text",e.i18n.ad.type.simple)}}function on(e,t){if(1&e&&l.Ob(0,"field-option",33),2&e){const e=l.dc(4);l.kc("text",e.i18n.ad.type.webshop)}}function ln(e,t){if(1&e&&(l.Tb(0,"div",6),l.Tb(1,"single-selection-field",29),l.Fc(2,sn,1,1,"field-option",30),l.Fc(3,on,1,1,"field-option",31),l.Sb(),l.Sb()),2&e){const e=l.dc(3);l.zb(1),l.kc("label",e.i18n.general.type)("emptyOption",e.i18n.general.notApplied),l.zb(1),l.kc("ngIf",e.marketplacePermissions.userSimple.view),l.zb(1),l.kc("ngIf",e.marketplacePermissions.userWebshop.view)}}function dn(e,t){if(1&e&&l.Ob(0,"field-option",36),2&e){const e=t.$implicit,i=l.dc(4);l.kc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)("parent",e.groupSet)}}function bn(e,t){if(1&e&&(l.Tb(0,"div",6),l.Tb(1,"multi-selection-field",34),l.Fc(2,dn,1,5,"field-option",35),l.Sb(),l.Sb()),2&e){const e=l.dc(3);l.zb(1),l.kc("label",e.i18n.user.groupFilter),l.zb(1),l.kc("ngForOf",e.data.groups)}}function un(e,t){if(1&e&&l.Ob(0,"field-option",39),2&e){const e=t.$implicit,i=l.dc(5);l.kc("value",i.ApiHelper.internalNameOrId(e))("internalName",e.internalName)("id",e.id)("text",e.name)}}function mn(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"div",6),l.Tb(2,"single-selection-field",37),l.Fc(3,un,1,4,"field-option",38),l.Sb(),l.Sb(),l.Qb()),2&e){const e=l.dc(4);l.zb(2),l.kc("label",e.i18n.general.currency)("emptyOption",e.i18n.general.notApplied),l.zb(1),l.kc("ngForOf",e.data.currencies)}}function fn(e,t){if(1&e&&(l.Rb(0),l.Ob(1,"div",26),l.Tb(2,"div",6),l.Ob(3,"decimal-field",40),l.Sb(),l.Tb(4,"div",6),l.Ob(5,"decimal-field",41),l.Sb(),l.Qb()),2&e){const e=l.dc(4);l.zb(3),l.kc("label",e.i18n.ad.minPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix),l.zb(2),l.kc("label",e.i18n.ad.maxPrice)("scale",e.currency.decimalDigits)("prefix",e.currency.prefix)("suffix",e.currency.suffix)}}function hn(e,t){if(1&e&&(l.Rb(0),l.Fc(1,mn,4,3,"ng-container",9),l.Fc(2,fn,6,8,"ng-container",9),l.ec(3,"async"),l.Qb()),2&e){const e=l.dc(3);l.zb(1),l.kc("ngIf",e.data.currencies.length>1),l.zb(1),l.kc("ngIf",l.fc(3,2,e.currency$))}}function pn(e,t){if(1&e&&(l.Rb(0),l.Fc(1,nn,2,2,"div",23),l.Fc(2,rn,2,2,"div",23),l.Fc(3,cn,2,2,"div",23),l.Fc(4,ln,4,4,"div",8),l.Fc(5,bn,3,2,"div",8),l.Tb(6,"div",6),l.Ob(7,"boolean-field",25),l.Sb(),l.Fc(8,hn,4,4,"ng-container",9),l.Ob(9,"div",26),l.Tb(10,"div",6),l.Ob(11,"date-field",27),l.Sb(),l.Tb(12,"div",6),l.Ob(13,"date-field",28),l.Sb(),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("ngForOf",e.advancedFields),l.zb(1),l.kc("ngForOf",e.data.basicProfileFields),l.zb(1),l.kc("ngForOf",e.data.customProfileFields),l.zb(1),l.kc("ngIf",e.marketplacePermissions.userSimple.view||e.marketplacePermissions.userWebshop.view),l.zb(1),l.kc("ngIf",(null==e.data.groups?null:e.data.groups.length)>1),l.zb(2),l.kc("label",e.i18n.ad.hasImages),l.zb(1),l.kc("ngIf",!e.hidePrice),l.zb(3),l.kc("label",e.i18n.ad.beginDate),l.zb(2),l.kc("label",e.i18n.ad.endDate)}}function gn(e,t){if(1&e&&(l.Tb(0,"div",46),l.Tb(1,"single-selection-field",47),l.Ob(2,"field-option",48),l.Ob(3,"field-option",49),l.Ob(4,"field-option",50),l.Sb(),l.Sb()),2&e){const e=l.dc(3);l.zb(1),l.kc("formControl",e.form.get("orderBy"))("display",e.i18n.general.orderBy)("emptyOption",e.i18n.general.orderByRelevance),l.zb(1),l.kc("text",e.i18n.ad.orderBy.date),l.zb(1),l.kc("text",e.i18n.ad.orderBy.priceAsc),l.zb(1),l.kc("text",e.i18n.ad.orderBy.priceDesc)}}const vn=function(){return["tiles","list"]};function yn(e,t){if(1&e&&(l.Tb(0,"div",42),l.Tb(1,"div",43),l.Ob(2,"result-type-field",44),l.ec(3,"async"),l.Sb(),l.Fc(4,gn,5,6,"div",45),l.Sb()),2&e){const e=l.dc(2);l.zb(2),l.kc("allowedResultTypes",l.fc(3,3,e.allowedResultTypes$))("formControl",e.resultTypeControl),l.zb(2),l.kc("ngIf",l.mc(5,vn).includes(e.resultType))}}function kn(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.Qb()),2&e){const e=l.dc().$implicit;l.zb(1),l.Ic(e.name)}}function Sn(e,t){if(1&e){const e=l.Ub();l.Tb(0,"a",55),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit,a=l.dc(3);return t.preventDefault(),a.onCategorySelected(i)})),l.Hc(1),l.Sb()}if(2&e){const e=l.dc().$implicit;l.zb(1),l.Ic(e.name)}}const Tn=function(e){return{active:e}};function zn(e,t){if(1&e&&(l.Tb(0,"li",53),l.Fc(1,kn,2,1,"ng-container",9),l.Fc(2,Sn,2,1,"a",54),l.Sb()),2&e){const e=t.last;l.kc("ngClass",l.nc(3,Tn,e)),l.zb(1),l.kc("ngIf",e),l.zb(1),l.kc("ngIf",!e)}}function In(e,t){if(1&e&&(l.Tb(0,"nav",51),l.Tb(1,"ol",51),l.Fc(2,zn,3,5,"li",52),l.ec(3,"async"),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.zb(2),l.kc("ngForOf",l.fc(3,1,e.categoryTrail$))}}function On(e,t){if(1&e){const e=l.Ub();l.Tb(0,"page-content",3),l.ec(1,"async"),l.Tb(2,"form",4),l.Tb(3,"div",5),l.Tb(4,"div",6),l.Ob(5,"input-field",7),l.Sb(),l.Fc(6,Xa,2,2,"div",8),l.Fc(7,en,8,7,"div",8),l.Fc(8,an,2,1,"ng-container",9),l.ec(9,"async"),l.Fc(10,pn,14,9,"ng-container",9),l.ec(11,"async"),l.Sb(),l.Sb(),l.Fc(12,yn,5,6,"div",10),l.ec(13,"async"),l.Sb(),l.Tb(14,"page-content",11),l.ec(15,"async"),l.Fc(16,In,4,3,"nav",12),l.ec(17,"async"),l.Sb(),l.Tb(18,"ads-results",13),l.bc("update",(function(t){return l.wc(e),l.dc().update(t)}))("categorySelected",(function(t){return l.wc(e),l.dc().onCategorySelected(t)})),l.ec(19,"async"),l.ec(20,"async"),l.ec(21,"async"),l.ec(22,"async"),l.Sb()}if(2&e){const e=l.dc();var i;const t=null!=(i=l.fc(15,25,e.categoryTrail$))&&i.length?"":"d-none";var a;const n=(null==(a=l.fc(17,27,e.categoryTrail$))?null:a.length)>0;l.kc("heading",e.i18n.ad.title.search)("mobileHeading",e.i18n.ad.mobileTitle.search)("headingActions",l.fc(1,17,e.headingActions$)),l.zb(2),l.kc("formGroup",e.form),l.zb(3),l.kc("label",e.i18n.general.keywords),l.zb(1),l.kc("ngIf",e.data.searchByDistanceData),l.zb(1),l.kc("ngIf",e.manager),l.zb(1),l.kc("ngIf",l.fc(9,19,e.layout.gtxxs$)),l.zb(2),l.kc("ngIf",l.fc(11,21,e.moreFilters$)),l.zb(2),l.kc("ngIf",l.fc(13,23,e.layout.gtxxs$)),l.zb(2),l.kc("ngClass",t),l.zb(2),l.kc("ngIf",n),l.zb(2),l.kc("results",l.fc(19,29,e.results$))("rendering$",e.rendering$)("data",l.fc(20,31,e.data$))("resultType",l.fc(21,33,e.resultType$))("referencePoint",(l.fc(22,35,e.form.valueChanges)||e.form.value).distanceFilter)}}let wn=(()=>{class e extends ba.a{constructor(e,t,i){super(e),this.marketplaceService=t,this.loginService=i,this.categoryTrail$=new A.a(null),this.currency$=new A.a(null)}getFormControlNames(){return["keywords","statuses","groups","category","customValues","distanceFilter","orderBy","kind","hasImages","minAmount","maxAmount","currency","beginDate","endDate"]}getInitialResultType(){return ua.a.TILES}getInitialFormValue(e){const t=super.getInitialFormValue(e);return(t.maxDistance||t.latitude||t.longitude)&&(t.distanceFilter=t),t}ngOnInit(){super.ngOnInit(),this.allowedResultTypes=this.layout.xxs?[ua.a.CATEGORIES,ua.a.LIST]:[ua.a.CATEGORIES,ua.a.TILES,ua.a.LIST,ua.a.MAP],this.resultType=this.getInitialResultType(),this.stateManager.cache("data",this.marketplaceService.getAdDataForSearch({})).subscribe(e=>{this.data=e})}onDataInitialized(e){this.marketplacePermissions=((this.dataForUiHolder.auth||{}).permissions||{}).marketplace||{};const t=t=>e.customFields.find(e=>e.internalName===t);this.basicFields=e.fieldsInBasicSearch.map(t),this.advancedFields=e.fieldsInAdvancedSearch.map(t),this.form.setControl("customValues",this.fieldHelper.customFieldsForSearchFormGroup(e.customFields)),this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(e.basicProfileFields,e.customProfileFields)),this.headingActions=[this.moreFiltersAction],this.addSub(this.form.get("currency").valueChanges.subscribe(t=>this.updateCurrency(t,e))),Object(s.h)(e.currencies)||1!==e.currencies.length||(this.currency=e.currencies[0]),super.onDataInitialized(e)}doSearch(e){return this.marketplaceService.searchAds$Response(e)}toSearchParams(e){const t=Object.assign({},e),i=this.resultType===ua.a.MAP;t.customFields=this.fieldHelper.toCustomValuesFilter(e.customValues),t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields),t.addressResult=i?x.b.ALL:x.b.NONE;const a=e.distanceFilter;return a&&(t.maxDistance=a.maxDistance,t.latitude=a.latitude,t.longitude=a.longitude,t.addressResult=x.b.NEAREST),t.publicationPeriod=da.a.dateRangeFilter(e.beginDate,e.endDate),t.priceRange=da.a.rangeFilter(e.minAmount,e.maxAmount),i&&(t.pageSize=99999),t}onResultTypeChanged(e,t){e===ua.a.CATEGORIES?(this.form.patchValue({category:null},{emitEvent:!1}),this.categoryTrail$.next([])):e===ua.a.MAP!=(t===ua.a.MAP)&&this.form.patchValue({page:0},{emitEvent:!1})}onCategorySelected(e){const t=da.a.internalNameOrId(e),i=[];if(t){this.form.patchValue({category:t}),i.unshift(e);const a=this.findParent(e);a&&i.unshift(a),i.unshift({name:this.i18n.ad.rootCategory})}else this.form.patchValue({category:t},{emitEvent:!1}),this.resultType=ua.a.CATEGORIES;this.categoryTrail$.next(i)}findParent(e){for(const t of this.data.categories)if(t.children.includes(e))return t;return null}resolveMenu(){return this.login.user?o.b.SEARCH_ADS:o.b.PUBLIC_MARKETPLACE}updateCurrency(e,t){this.currency=t.currencies.find(t=>t.id===e||t.internalName===e)}get manager(){return this.dataForUiHolder.role===x.eb.ADMINISTRATOR||this.dataForUiHolder.role===x.eb.BROKER&&!Object(s.h)(this.data.query.brokers)}get canViewPending(){return this.marketplacePermissions.userSimple.viewPending||this.marketplacePermissions.userWebshop.viewPending}get hidePrice(){return this.data.hidePrice||null==this.loginService.user}get currency(){return this.currency$.value}set currency(e){this.currency$.next(e)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.r),l.Nb(la.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["search-ads"]],features:[l.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator",3,"formGroup"],[1,"row","no-gutters"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords",3,"label"],["class","col-12 col-md-6",4,"ngIf"],[4,"ngIf"],["class","row no-gutters filters-row",4,"ngIf"],[3,"ngClass"],["class","breadcrumb",4,"ngIf"],[3,"results","rendering$","data","resultType","referencePoint","update","categorySelected"],["labelPosition","side","formControlName","distanceFilter",3,"data","label"],["labelPosition","side","formControlName","statuses",3,"label"],["value","active",3,"text"],["value","disabled",3,"text"],["value","pending",3,"text",4,"ngIf"],["value","expired",3,"text"],["value","hidden",3,"text"],["value","scheduled",3,"text"],["value","pending",3,"text"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["labelPosition","side",3,"field","formControl"],["labelPosition","sideForced","formControlName","hasImages",3,"label"],[1,"w-100"],["labelPosition","side","formControlName","beginDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","endDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","kind",3,"label","emptyOption"],["value","simple",3,"text",4,"ngIf"],["value","webshop",3,"text",4,"ngIf"],["value","simple",3,"text"],["value","webshop",3,"text"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side","formControlName","currency",3,"label","emptyOption"],[3,"value","internalName","id","text",4,"ngFor","ngForOf"],[3,"value","internalName","id","text"],["labelPosition","side","formControlName","minAmount","fieldSize","full",3,"label","scale","prefix","suffix"],["labelPosition","side","formControlName","maxAmount","fieldSize","full",3,"label","scale","prefix","suffix"],[1,"row","no-gutters","filters-row"],[1,"col-12","col-xs-7","col-md-9"],[3,"allowedResultTypes","formControl"],["class","col-12 col-xs-5 col-md-3",4,"ngIf"],[1,"col-12","col-xs-5","col-md-3"],[3,"formControl","display","emptyOption"],["value","date",3,"text"],["value","priceAsc",3,"text"],["value","priceDesc",3,"text"],[1,"breadcrumb"],["class","breadcrumb-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"breadcrumb-item",3,"ngClass"],["href","#",3,"click",4,"ngIf"],["href","#",3,"click"]],template:function(e,t){if(1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Ya,1,0,"ng-container",1),l.Sb(),l.Fc(3,On,23,37,"ng-template",null,2,l.Gc)),2&e){const e=l.uc(4);l.kc("ready",l.fc(1,3,t.data$)),l.zb(2),l.kc("ngIf",t.data)("ngIfThen",e)}},directives:[d.a,b.t,u.a,n.I,n.w,n.n,je.a,n.v,n.l,b.q,Va,ja.a,Ft.a,$.a,b.s,_a.a,n.k,_e.a,Ot.a,Ka.a,We.a,G.a,Wa.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();function xn(e,t){1&e&&l.Ob(0,"div",9)}function Fn(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"div",9),l.Tb(2,"label-value",28),l.Ob(3,"user-link",29),l.Sb(),l.Sb(),l.Fc(4,xn,1,0,"div",30),l.Qb()),2&e){const e=l.dc(3);l.zb(2),l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user),l.zb(1),l.kc("ngIf",e.layout.gtsm$)}}function Hn(e,t){if(1&e&&l.Ob(0,"field-option",31),2&e){const e=l.dc(3);l.kc("text",e.i18n.ad.orderStatus.draft)}}function Cn(e,t){if(1&e&&(l.Tb(0,"form",7),l.Tb(1,"div",8),l.Fc(2,Fn,5,3,"ng-container",1),l.Tb(3,"div",9),l.Tb(4,"single-selection-field",10),l.Fc(5,Hn,1,1,"field-option",11),l.Ob(6,"field-option",12),l.Ob(7,"field-option",13),l.Ob(8,"field-option",14),l.Ob(9,"field-option",15),l.Ob(10,"field-option",16),l.Ob(11,"field-option",17),l.Ob(12,"field-option",18),l.Ob(13,"field-option",19),l.Ob(14,"field-option",20),l.Ob(15,"field-option",21),l.Sb(),l.Sb(),l.Tb(16,"div",9),l.Ob(17,"user-field",22),l.Sb(),l.Tb(18,"div",23),l.Tb(19,"div",9),l.Ob(20,"date-field",24),l.Sb(),l.Tb(21,"div",9),l.Ob(22,"date-field",25),l.Sb(),l.Sb(),l.Tb(23,"div",9),l.Ob(24,"input-field",26),l.Sb(),l.Tb(25,"div",9),l.Ob(26,"input-field",27),l.Sb(),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.kc("formGroup",e.form),l.zb(2),l.kc("ngIf",e.data.user&&!e.authHelper.isSelfOrOwner(e.data.user)),l.zb(2),l.kc("label",e.i18n.general.status)("emptyOption",!0),l.zb(1),l.kc("ngIf",e.sales&&e.isOwner),l.zb(1),l.kc("text",!e.sales&&e.isOwner?e.i18n.ad.requiringMyConfirmation:e.i18n.ad.waitingForBuyersApproval),l.zb(1),l.kc("text",e.sales&&e.isOwner?e.i18n.ad.requiringMyConfirmation:e.i18n.ad.waitingForSellersApproval),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.completed),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.rejectedByBuyer),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.rejectedBySeller),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.paymentPending),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.paymentDenied),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.paymentCanceled),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.paymentExpired),l.zb(1),l.kc("text",e.i18n.ad.orderStatus.disposed),l.zb(2),l.kc("label",e.sales?e.i18n.ad.buyer:e.i18n.ad.seller),l.zb(3),l.kc("label",e.i18n.general.beginDate),l.zb(2),l.kc("label",e.i18n.general.endDate),l.zb(2),l.kc("label",e.i18n.ad.order),l.zb(2),l.kc("label",e.i18n.ad.productNumber)}}function Nn(e,t){if(1&e&&(l.Tb(0,"mobile-result"),l.Tb(1,"div",32),l.Tb(2,"div"),l.Tb(3,"div",33),l.Hc(4),l.Sb(),l.Tb(5,"div",34),l.Hc(6),l.ec(7,"date"),l.Sb(),l.Tb(8,"div",35),l.Hc(9),l.Sb(),l.Sb(),l.Tb(10,"div",36),l.Hc(11),l.ec(12,"currency"),l.Sb(),l.Sb(),l.Sb()),2&e){const e=t.$implicit;l.zb(4),l.Jc(" ",e.number," "),l.zb(2),l.Jc(" ",l.fc(7,4,e.creationDate)," "),l.zb(3),l.Jc(" ",e.relatedUser.shortDisplay," "),l.zb(2),l.Jc(" ",l.gc(12,6,e.totalPrice,e.currency)," ")}}function An(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"tr",40),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(3);return a.router.navigate(a.path(i))})),l.Tb(2,"td"),l.Hc(3),l.Sb(),l.Tb(4,"td"),l.Hc(5),l.Sb(),l.Tb(6,"td"),l.Hc(7),l.ec(8,"date"),l.Sb(),l.Tb(9,"td"),l.Hc(10),l.Sb(),l.Tb(11,"td",38),l.Hc(12),l.ec(13,"currency"),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=t.$implicit,i=l.dc(3);l.zb(3),l.Ic(e.number),l.zb(2),l.Ic(i.resolveStatusLabel(e)),l.zb(2),l.Ic(l.fc(8,5,e.creationDate)),l.zb(3),l.Ic(e.relatedUser.shortDisplay),l.zb(2),l.Jc(" ",l.gc(13,7,e.totalPrice,e.currency),"")}}function Dn(e,t){if(1&e&&(l.Tb(0,"table",37),l.Tb(1,"thead"),l.Tb(2,"th"),l.Hc(3),l.Sb(),l.Tb(4,"th"),l.Hc(5),l.Sb(),l.Tb(6,"th"),l.Hc(7),l.Sb(),l.Tb(8,"th"),l.Hc(9),l.Sb(),l.Tb(10,"th",38),l.Hc(11),l.Sb(),l.Sb(),l.Tb(12,"tbody"),l.Fc(13,An,14,10,"ng-container",39),l.ec(14,"async"),l.Sb(),l.Sb()),2&e){const e=l.dc(2);var i;const t=null==(i=l.fc(14,6,e.results$))?null:i.results;l.zb(3),l.Ic(e.i18n.ad.order),l.zb(2),l.Ic(e.i18n.general.status),l.zb(2),l.Ic(e.i18n.general.date),l.zb(2),l.Ic(e.sales?e.i18n.ad.buyer:e.i18n.ad.seller),l.zb(2),l.Ic(e.i18n.ad.total),l.zb(2),l.kc("ngForOf",t)}}function $n(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.ec(3,"async"),l.ec(4,"async"),l.Fc(5,Cn,27,20,"form",3),l.ec(6,"async"),l.ec(7,"async"),l.Sb(),l.Tb(8,"results-layout",4),l.bc("update",(function(t){return l.wc(e),l.dc().update(t)})),l.ec(9,"async"),l.Fc(10,Nn,13,9,"mobile-result",5),l.Fc(11,Dn,15,8,"table",6),l.Sb(),l.Qb()}if(2&e){const e=l.dc();l.zb(1),l.kc("mode",l.fc(2,8,e.moreFilters$)||!1===l.fc(3,10,e.layout.ltsm$)?"filters":"emptyFilters")("heading",e.sales?e.i18n.ad.title.sales:e.i18n.ad.title.purchases)("mobileHeading",e.sales?e.i18n.ad.mobileTitle.sales:e.i18n.ad.mobileTitle.purchases)("headingActions",l.fc(4,12,e.headingActions$)),l.zb(4),l.kc("ngIf",l.fc(6,14,e.moreFilters$)||!1===l.fc(7,16,e.layout.ltsm$)),l.zb(3),l.kc("results",l.fc(9,18,e.results$))("rendering$",e.rendering$)("toLink",e.toLink)}}let Pn=(()=>{class e extends ba.a{constructor(e,t,i){super(e),this.marketplaceHelper=t,this.orderService=i,this.showForm$=new A.a(!1)}getFormControlNames(){return["statuses","periodBegin","periodEnd","relatedUser","number","productNumber"]}ngOnInit(){super.ngOnInit(),this.sales="sales"===this.route.snapshot.url[1].path,this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.isOwner=this.authHelper.isSelf(this.param),this.addSub(this.orderService.getOrderDataForSearch({user:this.param,sales:this.sales}).subscribe(e=>this.data=e))}toSearchParams(e){const t=e;return e.user=this.param,e.sales=this.sales,(e.periodBegin||e.periodEnd)&&(t.creationPeriod=this.ApiHelper.dateRangeFilter(e.periodBegin,e.periodEnd)),e}onDataInitialized(e){super.onDataInitialized(e),this.headingActions=this.initActions(e),this.addSub(this.layout.ltsm$.subscribe(()=>{this.headingActions=this.initActions(e)}))}initActions(e){const t=[];if(this.sales&&e.canCreateNew){const e=new Ee.c("add",this.i18n.general.addNew,()=>this.addNew(),!0);t.push(e)}return this.layout.ltsm&&t.push(this.moreFiltersAction),t}addNew(){this.notification.confirm({title:this.i18n.ad.title.newOrder,labelPosition:"above",customFields:this.newOrderFields(),callback:e=>{this.addSub(this.orderService.getOrderDataForNew({buyer:e.customValues.buyer,user:this.param,currency:e.customValues.currency}).subscribe(()=>{this.router.navigate(["marketplace",this.param,"sale","new"],{queryParams:{buyer:e.customValues.buyer,currency:e.customValues.currency}})}))}})}newOrderFields(){const e=[{internalName:"buyer",name:this.i18n.ad.buyer,type:x.p.LINKED_ENTITY,control:x.n.ENTITY_SELECTION,linkedEntityType:x.H.USER,hasValuesList:!1,required:!0}];return!Object(s.h)(this.data.currencies)&&this.data.currencies.length>1&&e.push({internalName:"currency",name:this.i18n.general.currency,type:x.p.SINGLE_SELECTION,control:x.n.SINGLE_SELECTION,hasValuesList:!0,defaultValue:this.data.currencies[0].id,possibleValues:this.data.currencies.map(e=>({id:e.id,value:e.name})),required:!0}),e}showMoreFiltersLabel(){return this.i18n.general.showFilters}showLessFiltersLabel(){return this.i18n.general.hideFilters}doSearch(e){return this.orderService.searchUserOrders$Response(e)}get toLink(){return e=>this.path(e)}path(e){return e.status===x.Q.DRAFT?["/marketplace","sale",e.id]:["/marketplace","order",e.id]}resolveStatusLabel(e){return this.marketplaceHelper.resolveOrderStatusLabel(e.status)}resolveMenu(e){return this.isOwner?this.sales?o.b.SALES:o.b.PURCHASES:this.authHelper.searchUsersMenu(e.user)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(H.a),l.Nb(r.x))},e.\u0275cmp=l.Hb({type:e,selectors:[["search-orders"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[1,"no-padding",3,"mode","heading","mobileHeading","headingActions"],["class","filters-form filters-form-separator border-0",3,"formGroup",4,"ngIf"],["resultType","list",3,"results","rendering$","toLink","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","statuses",3,"label","emptyOption"],["value","draft",3,"text",4,"ngIf"],["value","pendingBuyer",3,"text"],["value","pendingSeller",3,"text"],["value","completed",3,"text"],["value","rejectedByBuyer",3,"text"],["value","rejectedBySeller",3,"text"],["value","paymentPending",3,"text"],["value","paymentDenied",3,"text"],["value","paymentCanceled",3,"text"],["value","paymentExpired",3,"text"],["value","disposed",3,"text"],["labelPosition","side","formControlName","relatedUser",3,"label"],[1,"row","no-gutters","col-12"],["labelPosition","side","formControlName","periodBegin","minDate","past100","maxDate","todayEnd","fieldSize","full",1,"",3,"label"],["labelPosition","side","formControlName","periodEnd","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","number","fieldSize","full",3,"label"],["labelPosition","side","formControlName","productNumber","fieldSize","full",3,"label"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["value","draft",3,"text"],[1,"d-flex"],[1,"cell-main"],[1,"cell-cell-date"],[1,"cell-text"],[1,"ml-auto"],[1,"table","table-hover","cursor-pointer"],[1,"text-right"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,$n,12,20,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,E.a,q.a,Q.a,n.I,n.w,n.n,We.a,n.v,n.l,$.a,oi.a,Ot.a,je.a,m.a,f.a,J.a,b.s],pipes:[b.b,Nt.a,U.a],encapsulation:2,changeDetection:0}),e})();function Mn(e,t){if(1&e&&(l.Tb(0,"div",6),l.Tb(1,"single-selection-field",7),l.Ob(2,"field-option",8),l.Ob(3,"field-option",9),l.Sb(),l.Sb()),2&e){const e=l.dc();l.zb(1),l.kc("label",e.i18n.general.type),l.zb(1),l.kc("text",e.i18n.ad.type.simple),l.zb(1),l.kc("text",e.i18n.ad.type.webshop)}}function Rn(e,t){if(1&e){const e=l.Ub();l.Tb(0,"mobile-result",10),l.Tb(1,"div",11),l.Tb(2,"div"),l.Tb(3,"div",12),l.Hc(4),l.Sb(),l.Tb(5,"div",13),l.Hc(6),l.ec(7,"dateTime"),l.Sb(),l.Tb(8,"div",14),l.Hc(9),l.Sb(),l.Sb(),l.Tb(10,"div",15),l.Tb(11,"button",16),l.bc("click",(function(i){l.wc(e);const a=t.$implicit;return l.dc().remove(a),i.stopPropagation(),i.preventDefault()})),l.Ob(12,"icon",17),l.Sb(),l.Sb(),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.dc();l.kc("avatarImage",e.advertisement.image),l.zb(4),l.Jc(" ",e.advertisement.name," "),l.zb(2),l.Jc(" ",l.fc(7,5,e.questionDate)," "),l.zb(3),l.Jc(" ",e.question," "),l.zb(2),l.kc("tooltip",i.i18n.general.remove)}}const En=function(e,t){return{"pb-0":e,"border-0":t}};function qn(e,t){if(1&e){const e=l.Ub();l.Tb(0,"tr",23),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(2);return a.router.navigate(a.path(i))})),l.Tb(1,"td",24),l.ec(2,"async"),l.ec(3,"async"),l.Ob(4,"avatar",25),l.Sb(),l.Tb(5,"td",26),l.Tb(6,"span",23),l.bc("click",(function(){l.wc(e);const i=t.$implicit;return l.dc(2).navigateToAd(i)})),l.Hc(7),l.Sb(),l.Sb(),l.Tb(8,"td"),l.Hc(9),l.Sb(),l.Tb(10,"td"),l.Hc(11),l.ec(12,"date"),l.Sb(),l.Tb(13,"td",27),l.Tb(14,"button",28),l.bc("click",(function(i){l.wc(e);const a=t.$implicit;return l.dc(2).remove(a),i.stopPropagation()})),l.Ob(15,"icon",17),l.Sb(),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.dc(2);l.zb(1),l.kc("ngClass",l.oc(13,En,l.fc(2,7,i.layout.xxs$),l.fc(3,9,i.layout.xxs$))),l.zb(3),l.kc("image",e.advertisement.image)("tooltip",e.advertisement.name),l.zb(3),l.Ic(e.advertisement.name),l.zb(2),l.Jc(" ",e.question," "),l.zb(2),l.Jc(" ",l.fc(12,11,e.questionDate)," "),l.zb(3),l.kc("tooltip",i.i18n.general.remove)}}function Qn(e,t){if(1&e&&(l.Tb(0,"table",18),l.Tb(1,"thead"),l.Ob(2,"th",19),l.Tb(3,"th",20),l.Hc(4),l.Sb(),l.Tb(5,"th"),l.Hc(6),l.Sb(),l.Tb(7,"th"),l.Hc(8),l.Sb(),l.Ob(9,"th",21),l.Sb(),l.Tb(10,"tbody"),l.Fc(11,qn,16,16,"tr",22),l.ec(12,"async"),l.Sb(),l.Sb()),2&e){const e=l.dc();var i;const t=null==(i=l.fc(12,4,e.results$))?null:i.results;l.zb(4),l.Ic(e.i18n.ad.name),l.zb(2),l.Ic(e.i18n.ad.question),l.zb(2),l.Ic(e.i18n.general.date),l.zb(3),l.kc("ngForOf",t)}}let Jn=(()=>{class e extends ba.a{constructor(e,t){super(e),this.adQuestionService=t}ngOnInit(){super.ngOnInit();const e=((this.dataForUiHolder.auth||{}).permissions||{}).marketplace||{},t=e.myWebshop||{};this.simpleQuestions=(e.mySimple||{}).questions,this.webshopQuestions=t.questions,this.data={}}getFormControlNames(){return["kind"]}path(e){return["/marketplace","unanswered-questions","view",e.id]}get toLink(){return e=>this.path(e)}navigate(e){this.router.navigate(this.path(e))}navigateToAd(e){this.router.navigate(["/marketplace","view",e.advertisement.id])}remove(e){this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:()=>{this.addSub(this.adQuestionService.deleteAdQuestion({id:e.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeItemDone),this.reload()}))}})}getInitialFormValue(e){const t=super.getInitialFormValue(e);return this.simpleQuestions?t.kind=x.c.SIMPLE:this.webshopQuestions&&(t.kind=x.c.WEBSHOP),t}toSearchParams(e){return e.user="self",e}doSearch(e){return this.adQuestionService.searchUnansweredAdQuestions$Response(e)}resolveMenu(){return o.b.UNANSWERED_QUESTIONS}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.c))},e.\u0275cmp=l.Hb({type:e,selectors:[["search-unanswered-questions"]],features:[l.wb],decls:8,vars:10,consts:[[1,"no-padding",3,"mode","heading","mobileHeading"],[1,"filters-form","filters-form-separator",3,"formGroup"],["class","col-12 col-md-6",4,"ngIf"],["resultType","list",3,"results","toLink","rendering$","update"],["avatarIcon","shopping_basket",3,"avatarImage",4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","kind",3,"label"],["value","simple",3,"text"],["value","webshop",3,"text"],["avatarIcon","shopping_basket",3,"avatarImage"],[1,"d-flex"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"ml-auto","text-right","d-flex","flex-column"],[1,"btn","btn-icon","mt-2",3,"tooltip","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[1,"avatar"],["width","30%"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"avatar",3,"ngClass"],["icon","shopping_basket",3,"image","tooltip"],[1,"link"],[1,"actions","actions-multiple"],[1,"btn","btn-icon",3,"tooltip","click"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout"),l.Tb(1,"page-content",0),l.Tb(2,"form",1),l.Fc(3,Mn,4,3,"div",2),l.Sb(),l.Sb(),l.Tb(4,"results-layout",3),l.bc("update",(function(e){return t.update(e)})),l.ec(5,"async"),l.Fc(6,Rn,13,7,"mobile-result",4),l.Fc(7,Qn,13,6,"table",5),l.Sb(),l.Sb()),2&e&&(l.zb(1),l.kc("mode",t.simpleQuestions&&t.webshopQuestions?"filters":"empty")("heading",t.i18n.ad.title.unansweredQuestions)("mobileHeading",t.i18n.ad.mobileTitle.unansweredQuestions),l.zb(1),l.kc("formGroup",t.form),l.zb(1),l.kc("ngIf",t.simpleQuestions&&t.webshopQuestions),l.zb(1),l.kc("results",l.fc(5,8,t.results$))("toLink",t.toLink)("rendering$",t.rendering$))},directives:[d.a,u.a,n.I,n.w,n.n,b.t,E.a,q.a,Q.a,We.a,n.v,n.l,$.a,J.a,L.b,B.a,b.s,b.q,h.a],pipes:[b.b,v.a,Nt.a],encapsulation:2,changeDetection:0}),e})();var Ln=i("TV7p");function Bn(e,t){1&e&&l.Pb(0)}function Gn(e,t){if(1&e&&(l.Tb(0,"div",7),l.Tb(1,"label-value",26),l.Ob(2,"user-link",27),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user)}}function Un(e,t){if(1&e&&(l.Tb(0,"div",7),l.Ob(1,"input-field",28),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.productNumber)}}function Vn(e,t){if(1&e&&l.Ob(0,"field-option",29),2&e){const e=l.dc(2);l.kc("text",e.i18n.ad.status.draft)}}function jn(e,t){if(1&e&&l.Ob(0,"field-option",30),2&e){const e=l.dc(2);l.kc("text",e.i18n.ad.status.pending)}}function _n(e,t){if(1&e){const e=l.Ub();l.Tb(0,"page-content",3),l.ec(1,"async"),l.Tb(2,"form",4),l.Tb(3,"div",5),l.Fc(4,Gn,3,2,"div",6),l.Tb(5,"div",7),l.Ob(6,"input-field",8),l.Sb(),l.Fc(7,Un,2,1,"div",6),l.Tb(8,"div",7),l.Tb(9,"single-selection-field",9),l.Ob(10,"field-option",10),l.Ob(11,"field-option",11),l.Ob(12,"field-option",12),l.Ob(13,"field-option",13),l.Ob(14,"field-option",14),l.Sb(),l.Sb(),l.Tb(15,"div",7),l.Tb(16,"multi-selection-field",15),l.Ob(17,"field-option",16),l.Ob(18,"field-option",17),l.Fc(19,Vn,1,1,"field-option",18),l.Fc(20,jn,1,1,"field-option",19),l.Ob(21,"field-option",20),l.Ob(22,"field-option",21),l.Ob(23,"field-option",22),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(24,"div",23),l.Ob(25,"result-type-field",24),l.ec(26,"async"),l.Sb(),l.Sb(),l.Tb(27,"ads-results",25),l.bc("update",(function(t){return l.wc(e),l.dc().update(t)})),l.ec(28,"async"),l.ec(29,"async"),l.ec(30,"async"),l.Sb()}if(2&e){const e=l.dc();l.kc("heading",e.resolveHeading(!1))("mobileHeading",e.resolveHeading(!0))("headingActions",l.fc(1,29,e.headingActions$)),l.zb(2),l.kc("formGroup",e.form),l.zb(2),l.kc("ngIf",!e.self),l.zb(2),l.kc("label",e.i18n.general.keywords),l.zb(1),l.kc("ngIf",!e.simple),l.zb(2),l.kc("label",e.i18n.general.orderBy)("emptyOption",e.i18n.general.noOptionSelected),l.zb(1),l.kc("text",e.i18n.ad.orderBy.date),l.zb(1),l.kc("text",e.i18n.ad.orderBy.distance),l.zb(1),l.kc("text",e.i18n.ad.orderBy.priceDesc),l.zb(1),l.kc("text",e.i18n.ad.orderBy.priceAsc),l.zb(1),l.kc("text",e.i18n.ad.orderBy.relevance),l.zb(2),l.kc("label",e.i18n.general.status)("emptyLabel",e.i18n.general.all),l.zb(1),l.kc("text",e.i18n.ad.status.active),l.zb(1),l.kc("text",e.i18n.ad.status.disabled),l.zb(1),l.kc("ngIf",e.canViewDraft),l.zb(1),l.kc("ngIf",e.canViewPending),l.zb(1),l.kc("text",e.i18n.ad.status.expired),l.zb(1),l.kc("text",e.i18n.ad.status.hidden),l.zb(1),l.kc("text",e.i18n.ad.status.scheduled),l.zb(2),l.kc("formControl",e.resultTypeControl)("allowedResultTypes",l.fc(26,31,e.allowedResultTypes$)),l.zb(2),l.kc("results",l.fc(28,33,e.results$))("rendering$",e.rendering$)("data",l.fc(29,35,e.data$))("resultType",l.fc(30,37,e.resultType$))}}let Kn=(()=>{class e extends ba.a{constructor(e,t){super(e),this.marketplaceService=t}getFormControlNames(){return["keywords","user","orderBy","statuses","productNumber"]}getInitialResultType(){return ua.a.TILES}ngOnInit(){super.ngOnInit(),this.param=this.route.snapshot.paramMap.get("user")||this.ApiHelper.SELF,this.kind=this.route.snapshot.paramMap.get("kind"),this.allowedResultTypes=[ua.a.TILES,ua.a.LIST],this.addSub(this.marketplaceService.getUserAdsDataForSearch({user:this.param,kind:this.kind}).subscribe(e=>this.data=e))}onDataInitialized(e){super.onDataInitialized(e),this.self=this.authHelper.isSelfOrOwner(e.user),this.shortName=Object(s.G)(e.user.display,Ln.a),e.createNew&&(this.headingActions=[new Ee.c("add",this.i18n.general.addNew,()=>this.router.navigate(["/marketplace",this.param,this.kind,"ad","new"]),!0)])}toSearchParams(e){const t=e;return t.user=this.param,t.kind=this.kind,t}resolveHeading(e){return this.self?this.simple?e?this.i18n.ad.mobileTitle.myAdvertisements:this.i18n.ad.title.myAdvertisements:e?this.i18n.ad.mobileTitle.myWebshop:this.i18n.ad.title.myWebshop:this.simple?e?this.i18n.ad.mobileTitle.viewAdvertisements:this.i18n.ad.title.viewAdvertisements:e?this.i18n.ad.mobileTitle.viewWebshop:this.i18n.ad.title.viewWebshop}doSearch(e){return this.marketplaceService.searchUserAds$Response(e)}resolveMenu(){return this.param===this.ApiHelper.SELF?this.simple?o.b.SEARCH_USER_ADS:o.b.SEARCH_USER_WEBSHOP:o.b.SEARCH_ADS}get simple(){return this.kind===x.c.SIMPLE}get canViewPending(){const e=((this.dataForUiHolder.auth||{}).permissions||{}).marketplace||{};return this.data.requiresAuthorization&&(this.self||(this.simple?e.userSimple.viewPending:e.userWebshop.viewPending))}get canViewDraft(){return this.data.requiresAuthorization&&!this.isManager}get isManager(){return!self&&(this.dataForUiHolder.role===x.eb.BROKER||this.dataForUiHolder.role===x.eb.ADMINISTRATOR)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.r))},e.\u0275cmp=l.Hb({type:e,selectors:[["user-ads"]],features:[l.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],["class","col-12 col-md-6",4,"ngIf"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords","fieldSize","full",3,"label"],["labelPosition","side","formControlName","orderBy",3,"label","emptyOption"],["value","date",3,"text"],["value","distance",3,"text"],["value","priceDesc",3,"text"],["value","priceAsc",3,"text"],["value","relevance",3,"text"],["labelPosition","side","formControlName","statuses",3,"label","emptyLabel"],["value","active",3,"text"],["value","disabled",3,"text"],["value","draft",3,"text",4,"ngIf"],["value","pending",3,"text",4,"ngIf"],["value","expired",3,"text"],["value","hidden",3,"text"],["value","scheduled",3,"text"],[1,"filters-row"],[3,"formControl","allowedResultTypes"],["singleUser","",3,"results","rendering$","data","resultType","update"],["kind","fieldView","labelPosition","side",3,"label"],[3,"user"],["labelPosition","side","formControlName","productNumber","fieldSize","full",3,"label"],["value","draft",3,"text"],["value","pending",3,"text"]],template:function(e,t){if(1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Bn,1,0,"ng-container",1),l.Sb(),l.Fc(3,_n,31,39,"ng-template",null,2,l.Gc)),2&e){const e=l.uc(4);l.kc("ready",l.fc(1,3,t.data$)),l.zb(2),l.kc("ngIf",t.data)("ngIfThen",e)}},directives:[d.a,b.t,u.a,n.I,n.w,n.n,je.a,n.v,n.l,We.a,$.a,Ft.a,Wa.a,n.k,Va,m.a,f.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();function Wn(e,t){if(1&e&&(l.Tb(0,"label-value",12),l.Ob(1,"user-link",13),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user)}}function Yn(e,t){if(1&e&&l.Ob(0,"input-field",14),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.productNumberMask)}}function Xn(e,t){if(1&e&&(l.Rb(0),l.Ob(1,"input-field",15),l.Ob(2,"decimal-field",16),l.Ob(3,"input-field",17),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.prefix),l.zb(1),l.kc("label",e.i18n.ad.length)("textRight",!1),l.zb(1),l.kc("label",e.i18n.ad.suffix)}}function Zn(e,t){if(1&e){const e=l.Ub();l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,Wn,2,2,"label-value",3),l.Tb(4,"form",4),l.Tb(5,"radio-group-field",5),l.Ob(6,"field-option",6),l.Ob(7,"field-option",7),l.Sb(),l.Fc(8,Yn,1,1,"input-field",8),l.ec(9,"async"),l.Tb(10,"radio-group-field",9),l.Ob(11,"field-option",6),l.Ob(12,"field-option",7),l.Sb(),l.Fc(13,Xn,4,4,"ng-container",1),l.ec(14,"async"),l.Sb(),l.Tb(15,"actions",10),l.Tb(16,"button",11),l.bc("click",(function(){return l.wc(e),l.dc().save()})),l.ec(17,"async"),l.Hc(18),l.Sb(),l.Sb(),l.Sb(),l.Qb()}if(2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.webshopSettings)("mobileHeading",e.i18n.ad.mobileTitle.webshopSettings)("headingActions",l.fc(2,15,e.headingActions$)),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("formGroup",e.form),l.zb(1),l.kc("label",e.i18n.ad.productNumber),l.zb(1),l.kc("text",e.i18n.ad.generated),l.zb(1),l.kc("text",e.i18n.ad.manual),l.zb(1),l.kc("ngIf","manual"===(l.fc(9,17,e.form.get("productGenerationType").valueChanges)||e.form.get("productGenerationType").value)),l.zb(2),l.kc("label",e.i18n.ad.orderNumber),l.zb(1),l.kc("text",e.i18n.ad.generated),l.zb(1),l.kc("text",e.i18n.ad.manual),l.zb(1),l.kc("ngIf","manual"===(l.fc(14,19,e.form.get("orderGenerationType").valueChanges)||e.form.get("orderGenerationType").value)),l.zb(3),l.kc("disabled",l.fc(17,21,e.requesting$)),l.zb(2),l.Jc(" ",e.i18n.general.submit," ")}}let er=(()=>{class e extends c.a{constructor(e,t){super(e),this.webshopSettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.webshopSettingsService.viewWebshopSettings({user:this.user}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user),this.form=this.formBuilder.group({productNumberGenerated:e.productNumberGenerated,productGenerationType:e.productNumberGenerated?"generated":"manual",productNumberMask:e.productNumberMask,customOrderNumberFormat:e.customOrderNumberFormat,orderGenerationType:e.customOrderNumberFormat?"manual":"generated",orderNumberInnerLength:e.orderNumberInnerLength,orderNumberPrefix:e.orderNumberPrefix,orderNumberSuffix:e.orderNumberSuffix}),this.addSub(this.form.controls.productGenerationType.valueChanges.subscribe(()=>this.updateMaskControl())),this.addSub(this.form.controls.orderGenerationType.valueChanges.subscribe(()=>this.updateOrderControls())),this.updateMaskControl(),this.updateOrderControls()}updateMaskControl(){"generated"===this.form.controls.productGenerationType.value?this.form.controls.productNumberMask.clearValidators():this.form.controls.productNumberMask.setValidators(n.G.required),this.form.controls.productNumberMask.updateValueAndValidity()}updateOrderControls(){const e=[this.form.controls.orderNumberInnerLength,this.form.controls.orderNumberPrefix,this.form.controls.orderNumberSuffix];e.forEach("generated"===this.form.controls.orderGenerationType.value?e=>e.clearValidators():e=>e.setValidators(n.G.required)),e.forEach(e=>e.updateValueAndValidity())}save(){if(!Object(s.F)(this.form))return;const e=Object(N.cloneDeep)(this.form.value);e.productNumberGenerated="generated"===this.form.controls.productGenerationType.value,delete e.productGenerationType,e.customOrderNumberFormat="manual"===this.form.controls.orderGenerationType.value,delete e.orderGenerationType,this.addSub(this.webshopSettingsService.updateWebshopSettings({user:this.user,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.webshopSettingsSaved)}))}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.WEBSHOP_SETTINGS)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.N))},e.\u0275cmp=l.Hb({type:e,selectors:[["edit-webshop-settings"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],["class","mb-3","labelPosition","side",3,"label",4,"ngIf"],[3,"formGroup"],["formControlName","productGenerationType",3,"label"],["value","generated",3,"text"],["value","manual",3,"text"],["formControlName","productNumberMask","required","",3,"label",4,"ngIf"],["formControlName","orderGenerationType",3,"label"],["forceRow",""],[1,"btn","btn-primary",3,"disabled","click"],["labelPosition","side",1,"mb-3",3,"label"],[3,"user"],["formControlName","productNumberMask","required","",3,"label"],["formControlName","orderNumberPrefix","fieldSize","small","required","",3,"label"],["formControlName","orderNumberInnerLength","fieldSize","small","required","",3,"label","textRight"],["formControlName","orderNumberSuffix","fieldSize","small","required","",3,"label"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Zn,19,23,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,n.I,n.w,n.n,D.a,n.v,n.l,$.a,g.a,m.a,f.a,je.a,n.D,G.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();function tr(e,t){if(1&e&&(l.Tb(0,"label-value",6),l.Ob(1,"user-link",7),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.user),l.zb(1),l.kc("user",e.data.user)}}function ir(e,t){if(1&e&&l.Ob(0,"label-value",4),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.productNumberMask)("value",e.data.productNumberMask)}}function ar(e,t){1&e&&l.Ob(0,"hr")}function nr(e,t){if(1&e&&(l.Rb(0),l.Ob(1,"label-value",4),l.Ob(2,"label-value",4),l.Ob(3,"label-value",4),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.prefix)("value",e.data.orderNumberPrefix),l.zb(1),l.kc("label",e.i18n.ad.length)("value",e.data.orderNumberInnerLength),l.zb(1),l.kc("label",e.i18n.ad.suffix)("value",e.data.orderNumberSuffix)}}function rr(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"page-content",2),l.ec(2,"async"),l.Fc(3,tr,2,2,"label-value",3),l.Ob(4,"label-value",4),l.Fc(5,ir,1,2,"label-value",5),l.Fc(6,ar,1,0,"hr",1),l.Ob(7,"label-value",4),l.Fc(8,nr,4,6,"ng-container",1),l.Sb(),l.Qb()),2&e){const e=l.dc();l.zb(1),l.kc("heading",e.i18n.ad.title.webshopSettings)("mobileHeading",e.i18n.ad.mobileTitle.webshopSettings)("headingActions",l.fc(2,11,e.headingActions$)),l.zb(2),l.kc("ngIf",!e.self),l.zb(1),l.kc("label",e.i18n.ad.productNumber)("value",e.data.productNumberGenerated?e.i18n.ad.generated:e.i18n.ad.manual),l.zb(1),l.kc("ngIf",!e.data.productNumberGenerated),l.zb(1),l.kc("ngIf",!e.data.productNumberGenerated||e.data.customOrderNumberFormat),l.zb(1),l.kc("label",e.i18n.ad.orderNumber)("value",e.data.customOrderNumberFormat?e.i18n.ad.manual:e.i18n.ad.generated),l.zb(1),l.kc("ngIf",e.data.customOrderNumberFormat)}}let cr=(()=>{class e extends ht.a{constructor(e,t){super(e),this.webshopSettingsService=t}ngOnInit(){super.ngOnInit(),this.user=this.route.snapshot.params.user,this.addSub(this.webshopSettingsService.viewWebshopSettings({user:this.user}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.self=this.authHelper.isSelfOrOwner(e.user);const t=[];e.canEdit&&(t.push(new Ee.c("edit",this.i18n.general.edit,()=>this.router.navigate(["/marketplace",this.user,"webshop-settings","edit"]),!0)),this.headingActions=t)}resolveMenu(e){return this.authHelper.userMenu(e.user,o.b.WEBSHOP_SETTINGS)}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(r.N))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-webshop-settings"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["labelPosition","side",3,"label",4,"ngIf"],[3,"label","value"],[3,"label","value",4,"ngIf"],["labelPosition","side",3,"label"],[3,"user"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,rr,9,13,"ng-container",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,f.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();var sr=i("aLb1"),or=i("xBqp"),lr=i("AH7H"),dr=i("IAdc"),br=i("nznZ");function ur(e,t){if(1&e&&l.Ob(0,"profile-images",20),2&e){const e=l.dc(2);l.kc("image",e.ad.image)("additionalImages",e.ad.additionalImages)}}function mr(e,t){if(1&e&&l.Ob(0,"profile-images",21),2&e){const e=l.dc(2);l.kc("image",e.ad.image)("additionalImages",e.ad.additionalImages)}}function fr(e,t){1&e&&(l.Rb(0),l.Hc(1," > "),l.Qb())}function hr(e,t){if(1&e&&(l.Rb(0),l.Fc(1,fr,2,0,"ng-container",13),l.Hc(2),l.Qb()),2&e){const e=t.$implicit,i=t.first;l.zb(1),l.kc("ngIf",!i),l.zb(1),l.Jc(" ",e.name," ")}}function pr(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"div"),l.Fc(2,hr,3,2,"ng-container",10),l.Sb(),l.Qb()),2&e){const e=t.$implicit,i=l.dc(2);l.zb(2),l.kc("ngForOf",i.categoryLevels(e))}}function gr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.general.status),l.zb(1),l.Jc(" ",e.status," ")}}function vr(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"label-value",9),l.Tb(2,"span"),l.Hc(3),l.ec(4,"date"),l.Tb(5,"span",22),l.Hc(6," - "),l.Sb(),l.Hc(7),l.ec(8,"date"),l.Sb(),l.Sb(),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("label",e.i18n.ad.publicationPeriod),l.zb(2),l.Ic(l.fc(4,3,e.data.publicationPeriod.begin)),l.zb(4),l.Ic(l.fc(8,5,e.data.publicationPeriod.end))}}function yr(e,t){1&e&&l.Ob(0,"custom-field-value",23),2&e&&l.kc("fieldValue",t.$implicit)}function kr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.Sb()),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.stockQuantity),l.zb(1),l.Jc(" ",e.stock," ")}}function Sr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.Sb()),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.minAllowedInCart),l.zb(1),l.Jc(" ",e.formatStock(e.data.minAllowedInCart)," ")}}function Tr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.Sb()),2&e){const e=l.dc(3);l.kc("label",e.i18n.ad.maxAllowedInCart),l.zb(1),l.Jc(" ",e.formatStock(e.data.maxAllowedInCart)," ")}}function zr(e,t){if(1&e&&(l.Rb(0),l.Fc(1,kr,2,2,"label-value",12),l.Fc(2,Sr,2,2,"label-value",12),l.Fc(3,Tr,2,2,"label-value",12),l.Tb(4,"label-value",9),l.Hc(5),l.Sb(),l.Qb()),2&e){const e=l.dc(2);l.zb(1),l.kc("ngIf",!e.data.unlimitedStock),l.zb(1),l.kc("ngIf",e.data.minAllowedInCart),l.zb(1),l.kc("ngIf",e.data.maxAllowedInCart),l.zb(1),l.kc("label",e.i18n.ad.productNumber),l.zb(1),l.Jc(" ",e.data.productNumber," ")}}function Ir(e,t){if(1&e&&(l.Rb(0),l.Hc(1),l.ec(2,"currency"),l.Tb(3,"span",26),l.Hc(4),l.ec(5,"currency"),l.Sb(),l.Qb()),2&e){const e=l.dc(3);l.zb(1),l.Jc(" ",l.gc(2,2,e.ad.promotionalPrice,e.ad.currency)," "),l.zb(3),l.Jc(" ",l.gc(5,5,e.ad.price,e.ad.currency)," ")}}function Or(e,t){if(1&e&&(l.Tb(0,"label-value",24),l.Fc(1,Ir,6,8,"ng-container",25),l.Sb()),2&e){const e=l.dc(2),t=l.uc(4);l.kc("label",e.i18n.ad.price),l.zb(1),l.kc("ngIf",e.ad.promotionalPrice)("ngIfElse",t)}}function wr(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"h2",16),l.Hc(2),l.Sb(),l.Ob(3,"hr",18),l.Hc(4),l.Qb()),2&e){const e=l.dc(2);l.zb(2),l.Jc(" ",e.i18n.ad.authorizationNotes," "),l.zb(2),l.Jc(" ",e.ad.lastAuthorizationComments," ")}}function xr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(3);l.kc("label",t.i18n.ad.minDeliveryTime),l.zb(1),l.Jc(" ",t.format.formatTimeInterval(e.minDeliveryTime)," ")}}function Fr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.ec(2,"currency"),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(3);l.kc("label",t.i18n.ad.price),l.zb(1),l.Jc(" ",l.gc(2,2,e.chargeAmount,t.ad.currency)," ")}}function Hr(e,t){if(1&e&&(l.Tb(0,"label-value",9),l.Hc(1),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(3);l.kc("label",t.i18n.general.description),l.zb(1),l.Jc(" ",e.description," ")}}const Cr=function(e){return{"pt-2":e}};function Nr(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"h3",28),l.Hc(2),l.Sb(),l.Fc(3,xr,2,2,"label-value",12),l.Tb(4,"label-value",9),l.Hc(5),l.Sb(),l.Fc(6,Fr,3,5,"label-value",12),l.Fc(7,Hr,2,2,"label-value",12),l.Qb()),2&e){const e=t.$implicit,i=t.first,a=l.dc(3);l.zb(1),l.kc("ngClass",l.nc(7,Cr,!i)),l.zb(1),l.Jc(" ",e.name," "),l.zb(1),l.kc("ngIf",e.minDeliveryTime),l.zb(1),l.kc("label",a.i18n.ad.maxDeliveryTime),l.zb(1),l.Jc(" ",a.format.formatTimeInterval(e.maxDeliveryTime)," "),l.zb(1),l.kc("ngIf",a.hasFixedDeliveryPrice(e)),l.zb(1),l.kc("ngIf",e.description)}}function Ar(e,t){if(1&e&&(l.Tb(0,"div"),l.Tb(1,"h2",27),l.Hc(2),l.Sb(),l.Fc(3,Nr,8,9,"ng-container",10),l.Sb()),2&e){const e=l.dc(2);l.zb(2),l.Jc(" ",e.i18n.ad.deliveryMethods," "),l.zb(1),l.kc("ngForOf",e.data.deliveryMethods)}}function Dr(e,t){if(1&e){const e=l.Ub();l.Tb(0,"div",39),l.Tb(1,"a",40),l.bc("click",(function(t){l.wc(e);const i=l.dc().$implicit;return l.dc(3).removeQuestion(i.id),t.preventDefault()})),l.Ob(2,"icon",41),l.Sb(),l.Sb()}if(2&e){const e=l.dc(4);l.zb(1),l.kc("tooltip",e.i18n.ad.removeQuestion)}}function $r(e,t){if(1&e&&(l.Tb(0,"div",42),l.Tb(1,"div",31),l.Ob(2,"icon",43),l.Sb(),l.Tb(3,"div",33),l.Hc(4),l.Tb(5,"div",35),l.Hc(6),l.ec(7,"dateTime"),l.Sb(),l.Sb(),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(3);l.zb(4),l.Jc(" ",e.answer," "),l.zb(2),l.Kc(" ",t.data.owner.display," - ",l.fc(7,3,e.answerDate),"")}}function Pr(e,t){1&e&&l.Ob(0,"hr",44)}function Mr(e,t){if(1&e&&(l.Rb(0),l.Tb(1,"div",30),l.Tb(2,"div",31),l.Ob(3,"icon",32),l.Sb(),l.Tb(4,"div",33),l.Tb(5,"span",34),l.Hc(6),l.Sb(),l.Tb(7,"div",35),l.Hc(8),l.ec(9,"dateTime"),l.Sb(),l.Sb(),l.Fc(10,Dr,3,1,"div",36),l.Sb(),l.Fc(11,$r,8,5,"div",37),l.Fc(12,Pr,1,0,"hr",38),l.Qb()),2&e){const e=t.$implicit,i=t.last,a=l.dc(3);l.zb(6),l.Ic(e.question),l.zb(2),l.Kc("",e.user.display," - ",l.fc(9,6,e.questionDate),""),l.zb(2),l.kc("ngIf",a.canRemoveQuestion(e)),l.zb(1),l.kc("ngIf",e.answer),l.zb(1),l.kc("ngIf",!i)}}function Rr(e,t){if(1&e&&(l.Tb(0,"div"),l.Tb(1,"h2",29),l.Tb(2,"div",17),l.Hc(3),l.Sb(),l.Sb(),l.Fc(4,Mr,13,8,"ng-container",10),l.Sb()),2&e){const e=l.dc(2);l.zb(3),l.Jc(" ",e.i18n.ad.questionsAndAnswers," "),l.zb(1),l.kc("ngForOf",e.data.questions)}}const Er=function(){return[]};function qr(e,t){if(1&e&&(l.Tb(0,"page-content",3),l.ec(1,"async"),l.Fc(2,ur,1,2,"profile-images",4),l.ec(3,"async"),l.Tb(4,"div",5),l.Fc(5,mr,1,2,"profile-images",6),l.ec(6,"async"),l.Tb(7,"div",7),l.Ob(8,"label-value",8),l.Tb(9,"label-value",9),l.Fc(10,pr,3,1,"ng-container",10),l.Sb(),l.Tb(11,"label-value",9),l.Ob(12,"user-link",11),l.Sb(),l.Fc(13,gr,2,2,"label-value",12),l.Fc(14,vr,9,7,"ng-container",13),l.Fc(15,yr,1,1,"custom-field-value",14),l.Fc(16,zr,6,5,"ng-container",13),l.Fc(17,Or,2,3,"label-value",15),l.Sb(),l.Sb(),l.Fc(18,wr,5,2,"ng-container",13),l.Tb(19,"h2",16),l.Tb(20,"div",17),l.Hc(21,' Para entrar em contato clique sobre o nome no campo "Autor". '),l.Sb(),l.Sb(),l.Tb(22,"h2",16),l.Hc(23),l.Sb(),l.Ob(24,"hr",18),l.Ob(25,"rich-text-container",19),l.Fc(26,Ar,4,2,"div",13),l.Fc(27,Rr,5,2,"div",13),l.Sb()),2&e){const e=l.dc();l.kc("heading",e.title)("mobileHeading",e.i18n.ad.mobileTitle.details)("headingActions",l.fc(1,21,e.headingActions$)),l.zb(2),l.kc("ngIf",e.ad.image&&l.fc(3,23,e.layout.ltsm$)),l.zb(3),l.kc("ngIf",e.ad.image&&l.fc(6,25,e.layout.gtxs$)),l.zb(3),l.kc("label",e.i18n.ad.name)("value",e.ad.name),l.zb(1),l.kc("label",e.categoryLabel),l.zb(1),l.kc("ngForOf",e.ad.categories||l.mc(27,Er)),l.zb(1),l.kc("label",e.i18n.ad.owner),l.zb(1),l.kc("user",e.ad.owner),l.zb(1),l.kc("ngIf",e.status),l.zb(1),l.kc("ngIf",e.data.publicationPeriod),l.zb(1),l.kc("ngForOf",e.ad.customValues),l.zb(1),l.kc("ngIf",e.webshop),l.zb(1),l.kc("ngIf",e.ad.price),l.zb(1),l.kc("ngIf",e.data.lastAuthorizationComments),l.zb(5),l.Jc("",e.i18n.general.description," "),l.zb(2),l.kc("value",e.ad.description),l.zb(1),l.kc("ngIf",e.data.deliveryMethods&&e.data.deliveryMethods.length>0),l.zb(1),l.kc("ngIf",e.questionsEnabled)}}function Qr(e,t){if(1&e&&(l.Hc(0),l.ec(1,"currency")),2&e){const e=l.dc();l.Jc(" ",l.gc(1,1,e.ad.price,e.ad.currency),"\n")}}let Jr=(()=>{class e extends ht.a{constructor(e,t,i,a,n,r,c,s){super(e),this.modal=t,this.operationHelper=i,this.loginService=a,this.adQuestionService=n,this.marketplaceHelper=r,this.marketplaceService=c,this.shoppingCartService=s}get ad(){return this.data}ngOnInit(){super.ngOnInit(),this.guest=null==this.loginService.user,this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.marketplaceService.viewAd({ad:this.id}).subscribe(e=>{this.data=e}))}doRemove(){this.addSub(this.marketplaceService.deleteAd({ad:this.id}).subscribe(()=>{this.notification.snackBar(this.i18n.general.removeDone(this.ad.name)),history.back()}))}updateStatus(e,t,i){this.addSub(e.subscribe(()=>{this.notification.snackBar(t),i&&this.dataForUiHolder.role===x.eb.BROKER&&!this.authHelper.isSelfOrOwner(this.data.user)||this.dataForUiHolder.role===x.eb.ADMINISTRATOR?history.back():this.reload(),this.reload()}))}addToCart(){this.addSub(this.shoppingCartService.addItemToShoppingCart({ad:this.ad.id}).subscribe(e=>{this.notification.snackBar(e===this.marketplaceHelper.cartItems?this.i18n.ad.addedProductAlreadyInCart:this.i18n.ad.addedProduct),this.marketplaceHelper.cartItems=e}))}onDataInitialized(e){this.webshop=e.kind===x.c.WEBSHOP,this.hasStatus=!this.guest&&(this.authHelper.isSelfOrOwner(e.user)||this.dataForUiHolder.role===x.eb.ADMINISTRATOR||this.dataForUiHolder.role===x.eb.BROKER);const t=[];if(e.canEdit){const e=new Ee.c("edit",this.i18n.general.edit,()=>{this.router.navigate(["/marketplace","edit",this.id])},!0);t.push(e)}e.canBuy&&t.push(new Ee.c("add_shopping_cart",this.i18n.ad.addToCart,()=>this.addToCart())),e.canAsk&&t.push(new Ee.c("chat",this.i18n.ad.askQuestion,()=>this.ask())),e.canHide&&t.push(new Ee.c("lock",this.i18n.ad.hide,()=>this.updateStatus(this.marketplaceService.hideAd({ad:this.id}),this.i18n.ad.adHidden))),e.canUnhide&&t.push(new Ee.c("public",this.i18n.ad.unhide,()=>this.updateStatus(this.marketplaceService.unhideAd({ad:this.id}),this.i18n.ad.adUnhidden))),e.canRequestAuthorization&&t.push(new Ee.c("gavel",this.i18n.ad.submitForAuthorization,()=>this.updateStatus(this.marketplaceService.submitAdForAuthorization({ad:this.id}),this.i18n.ad.pendingForAuth))),e.canSetAsDraft&&t.push(new Ee.c("edit",this.i18n.ad.setAsDraft,()=>this.updateStatus(this.marketplaceService.setAdAsDraft({ad:this.id}),this.i18n.ad.backToDraft,!0))),e.canApprove&&t.push(new Ee.c("thumb_up_alt",this.i18n.ad.authorize,()=>this.updateStatus(this.marketplaceService.approveAd({ad:this.id}),this.i18n.ad.authorized))),e.canReject&&t.push(new Ee.c("thumb_down_alt",this.i18n.ad.reject,()=>this.reject())),e.canRemove&&t.push(new Ee.c("clear",this.i18n.general.remove,()=>{this.notification.confirm({message:this.i18n.general.removeConfirm(this.ad.name),callback:()=>this.doRemove()})})),this.exportHelper.headingActions(e.exportFormats,t=>this.marketplaceService.exportAd$Response({format:t.internalName,ad:e.id})).forEach(e=>t.push(e));for(const i of e.operations||[])t.push(this.operationHelper.headingAction(i,e.id));this.headingActions=t,this.title=Object(s.G)(e.name,60)}reject(){const e=this.modal.show(or.a,{class:"modal-form",initialState:{title:this.i18n.ad.reject}});this.addSub(e.content.done.subscribe(e=>{this.updateStatus(this.marketplaceService.rejectAd({ad:this.id,body:e}),this.i18n.ad.rejected,!0)}))}get categoryLabel(){return 1===(this.ad.categories||[]).length?this.i18n.ad.category:this.i18n.ad.categories}get status(){return this.ad.status?this.marketplaceHelper.resolveStatusLabel(this.ad.status):null}get stock(){return this.data.unlimitedStock?"":0===(+this.data.stockQuantity||0)?this.i18n.ad.outOfStock:this.formatStock(this.data.stockQuantity)}get questionsEnabled(){return!this.guest&&this.data.questionsEnabled&&this.data.questions.length>0}canRemoveQuestion(e){return!this.guest&&(this.dataForUiHolder.role===x.eb.ADMINISTRATOR?this.data.canEdit:!!(this.dataForUiHolder.role===x.eb.BROKER||this.authHelper.isSelfOrOwner(this.data.user)||this.authHelper.isSelfOrOwner(e.user)&&this.dataForUiHolder.role!==x.eb.OPERATOR)&&this.data.canEdit&&Object(s.h)(e.answer))}hasFixedDeliveryPrice(e){return e.chargeType===x.q.FIXED}formatStock(e){return this.format.numberToFixed(e,this.data.allowDecimal?2:0)||""}categoryLevels(e){const t=[];for(;null!=e;)t.unshift(e),e=e.parent;return t}ask(){const e=this.modal.show(or.a,{class:"modal-form",initialState:{title:this.i18n.ad.askQuestion}});this.addSub(e.content.done.subscribe(e=>{Object(s.h)(e)||this.addSub(this.adQuestionService.createAdQuestion({ad:this.id,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.questionAsked),this.reload()}))}))}resolveMenu(){return o.b.SEARCH_ADS}removeQuestion(e){this.addSub(this.adQuestionService.deleteAdQuestion({id:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.questionRemoved),this.reload()}))}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(It.b),l.Nb(sr.a),l.Nb(la.a),l.Nb(r.c),l.Nb(H.a),l.Nb(r.r),l.Nb(r.E))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-ad"]],features:[l.wb],decls:5,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["plainPrice",""],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"image","additionalImages",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["icon","shopping_basket",3,"image","additionalImages",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label","value"],[3,"label"],[4,"ngFor","ngForOf"],[3,"user"],[3,"label",4,"ngIf"],[4,"ngIf"],[3,"fieldValue",4,"ngFor","ngForOf"],["class","totalAmount",3,"label",4,"ngIf"],[1,"d-none","d-sm-block","my-ls","pt-ls"],[1,"mb-2","mb-xs-0"],[1,"d-block","d-sm-none"],["autoHeight","",3,"value"],[3,"image","additionalImages"],["icon","shopping_basket",3,"image","additionalImages"],[1,"d-inline","pl-2","pr-2"],[3,"fieldValue"],[1,"totalAmount",3,"label"],[4,"ngIf","ngIfElse"],[1,"promo-price"],[1,"mt-3"],[3,"ngClass"],[1,"d-flex","mb-ls","flex-column","flex-xs-row","justify-content-between","mt-ls"],[1,"d-flex","flex-row","pb-1"],[1,"d-flex"],["size","1rem","icon","chat"],[1,"pl-2",2,"line-height","1rem"],[1,"font-weight-bold"],[2,"font-size","0.6rem"],["class","d-flex","style","margin-left: auto",4,"ngIf"],["class","d-flex flex-row pb-1 pt-1",4,"ngIf"],["class","inner-separator pb-1",4,"ngIf"],[1,"d-flex",2,"margin-left","auto"],["href","#",1,"icon",3,"tooltip","click"],["size","1rem","icon","delete"],[1,"d-flex","flex-row","pb-1","pt-1"],["size","1rem","icon","comment"],[1,"inner-separator","pb-1"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,qr,28,28,"page-content",1),l.Sb(),l.Fc(3,Qr,2,4,"ng-template",null,2,l.Gc)),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,b.s,f.a,lr.a,dr.a,br.a,b.q,B.a,L.b],pipes:[b.b,Nt.a,U.a,v.a],encapsulation:2,changeDetection:0}),e})();function Lr(e,t){1&e&&l.Pb(0)}function Br(e,t){if(1&e&&(l.Tb(0,"label-value",8),l.Ob(1,"user-link",9),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.seller),l.zb(1),l.kc("user",e.data.seller)}}function Gr(e,t){if(1&e&&(l.Tb(0,"label-value",8),l.Ob(1,"user-link",9),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.buyer),l.zb(1),l.kc("user",e.data.buyer)}}function Ur(e,t){if(1&e&&(l.Tb(0,"mobile-result"),l.Tb(1,"div",10),l.Hc(2),l.Sb(),l.Tb(3,"div",11),l.Hc(4),l.ec(5,"dateTime"),l.Sb(),l.Tb(6,"div",12),l.Hc(7),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc(2);l.zb(2),l.Jc(" ",i.resolveStatusLabel(e.status)," "),l.zb(2),l.Jc(" ",l.fc(5,4,e.date)," "),l.zb(3),l.Kc(" ",i.i18n.general.by," ",e.by.shortDisplay," ")}}function Vr(e,t){if(1&e&&(l.Tb(0,"tr"),l.Tb(1,"td"),l.Hc(2),l.ec(3,"dateTime"),l.Sb(),l.Tb(4,"td"),l.Hc(5),l.Sb(),l.Tb(6,"td"),l.Hc(7),l.Sb(),l.Tb(8,"td"),l.Hc(9),l.Sb(),l.Sb()),2&e){const e=t.$implicit,i=l.dc(3);l.zb(2),l.Ic(l.fc(3,4,e.date)),l.zb(3),l.Ic(i.resolveStatusLabel(e.status)),l.zb(2),l.Ic(e.by.shortDisplay),l.zb(2),l.Ic(e.remarks)}}function jr(e,t){if(1&e&&(l.Tb(0,"table",13),l.Tb(1,"thead"),l.Tb(2,"th"),l.Hc(3),l.Sb(),l.Tb(4,"th"),l.Hc(5),l.Sb(),l.Tb(6,"th"),l.Hc(7),l.Sb(),l.Tb(8,"th"),l.Hc(9),l.Sb(),l.Sb(),l.Tb(10,"tbody"),l.Fc(11,Vr,10,6,"tr",14),l.Sb(),l.Sb()),2&e){const e=l.dc(2);l.zb(3),l.Ic(e.i18n.general.date),l.zb(2),l.Ic(e.i18n.general.status),l.zb(2),l.Ic(e.i18n.general.by),l.zb(2),l.Ic(e.i18n.ad.remarks),l.zb(2),l.kc("ngForOf",e.data.history)}}function _r(e,t){if(1&e&&(l.Tb(0,"page-content",3),l.Fc(1,Br,2,2,"label-value",4),l.Fc(2,Gr,2,2,"label-value",4),l.Sb(),l.Tb(3,"results-layout",5),l.Fc(4,Ur,8,6,"mobile-result",6),l.Fc(5,jr,12,5,"table",7),l.Sb()),2&e){const e=l.dc();l.kc("heading",e.i18n.ad.title.history)("mobileHeading",e.i18n.ad.mobileTitle.history),l.zb(1),l.kc("ngIf",!e.seller),l.zb(1),l.kc("ngIf",!e.buyer),l.zb(1),l.kc("results",e.data.history)("onClick",e.onClick)}}let Kr=(()=>{class e extends ht.a{constructor(e,t,i){super(e),this.marketplaceHelper=t,this.orderService=i}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.params.id,this.addSub(this.orderService.viewOrder({order:this.id,fields:["seller","buyer","history"]}).subscribe(e=>{this.data=e}))}onDataInitialized(e){this.seller=this.authHelper.isSelfOrOwner(e.seller),this.buyer=!this.seller&&this.authHelper.isSelfOrOwner(e.buyer)}get onClick(){return e=>null!=e}resolveStatusLabel(e){return this.marketplaceHelper.resolveOrderStatusLabel(e)}resolveMenu(){return this.buyer?o.b.PURCHASES:this.seller?o.b.SALES:this.authHelper.searchUsersMenu()}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(H.a),l.Nb(r.x))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-order-history"]],features:[l.wb],decls:5,vars:5,consts:[[3,"ready"],[4,"ngIf","ngIfThen"],["content",""],[3,"heading","mobileHeading"],[3,"label",4,"ngIf"],[3,"results","onClick"],[4,"mobileResult"],["class","table table-hover",4,"resultTable"],[3,"label"],[3,"user"],[1,"cell-main"],[1,"cell-date"],[1,"cell-text"],[1,"table","table-hover"],[4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,Lr,1,0,"ng-container",1),l.Sb(),l.Fc(3,_r,6,6,"ng-template",null,2,l.Gc)),2&e){const e=l.uc(4);l.kc("ready",l.fc(1,3,t.data$)),l.zb(2),l.kc("ngIf",t.data)("ngIfThen",e)}},directives:[d.a,b.t,u.a,E.a,q.a,Q.a,m.a,f.a,J.a,b.s],pipes:[b.b,v.a],encapsulation:2,changeDetection:0}),e})();function Wr(e,t){if(1&e&&l.Ob(0,"input-field",9),2&e){const e=l.dc();l.kc("label",e.i18n.general.name)}}let Yr=(()=>{class e extends M.a{constructor(e,t){super(e),this.modalRef=t,this.done=new l.n}ngOnInit(){this.form=this.formBuilder.group({name:[this.name,n.G.required],chargeAmount:[this.chargeAmount,n.G.required],minTime:this.minTime,maxTime:[this.maxTime,n.G.required],remarks:""})}submit(){this.done.emit(this.form.value),this.modalRef.hide()}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(It.a))},e.\u0275cmp=l.Hb({type:e,selectors:[["set-delivery-method"]],inputs:{name:"name",chargeAmount:"chargeAmount",minTime:"minTime",maxTime:"maxTime",currency:"currency"},outputs:{done:"done"},features:[l.wb],decls:14,vars:15,consts:[[3,"formGroup"],["formControlName","name","required","",3,"label",4,"ngIf"],["formControlName","chargeAmount","fieldSize","full","required","",3,"label","scale","prefix","suffix"],["formControlName","minTime",3,"label"],["formControlName","maxTime","required","",3,"label"],["formControlName","remarks",3,"label"],["forceRow",""],[1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-outline-primary",3,"click"],["formControlName","name","required","",3,"label"]],template:function(e,t){1&e&&(l.Tb(0,"h1"),l.Hc(1),l.Sb(),l.Tb(2,"form",0),l.Fc(3,Wr,1,1,"input-field",1),l.Ob(4,"decimal-field",2),l.Ob(5,"time-interval-field",3),l.Ob(6,"time-interval-field",4),l.Ob(7,"textarea-field",5),l.Sb(),l.Tb(8,"actions",6),l.Tb(9,"button",7),l.bc("click",(function(){return t.submit()})),l.ec(10,"async"),l.Hc(11),l.Sb(),l.Tb(12,"button",8),l.bc("click",(function(){return t.modalRef.hide()})),l.Hc(13),l.Sb(),l.Sb()),2&e&&(l.zb(1),l.Ic(t.i18n.ad.deliveryMethod),l.zb(1),l.kc("formGroup",t.form),l.zb(1),l.kc("ngIf",!t.name),l.zb(1),l.kc("label",t.i18n.ad.deliveryPrice)("scale",t.currency.decimalDigits)("prefix",t.currency.prefix)("suffix",t.currency.suffix),l.zb(1),l.kc("label",t.i18n.ad.minDeliveryTime),l.zb(1),l.kc("label",t.i18n.ad.maxDeliveryTime),l.zb(1),l.kc("label",t.i18n.ad.remarks),l.zb(2),l.kc("disabled",l.fc(10,13,t.requesting$)),l.zb(2),l.Jc(" ",t.i18n.general.submit," "),l.zb(2),l.Jc(" ",t.i18n.general.cancel," "))},directives:[n.I,n.w,n.n,b.t,G.a,n.v,n.l,n.D,Ke.a,p.a,g.a,je.a],pipes:[b.b],encapsulation:2,changeDetection:0}),e})();var Xr=i("7qm1");function Zr(e,t){if(1&e&&(l.Tb(0,"div",28),l.Ob(1,"avatar",29),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("roundBorders",!1)("zoom",!1)("image",e.data.image)}}function ec(e,t){if(1&e&&(l.Tb(0,"div",30),l.Ob(1,"avatar",29),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.kc("roundBorders",!1)("zoom",!1)("image",e.data.image)}}function tc(e,t){if(1&e&&(l.Tb(0,"label-value",7),l.Ob(1,"user-link",31),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.seller),l.zb(1),l.kc("user",e.data.seller)}}function ic(e,t){if(1&e&&(l.Tb(0,"label-value",7),l.Ob(1,"user-link",31),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.buyer),l.zb(1),l.kc("user",e.data.buyer)}}function ac(e,t){if(1&e&&(l.Tb(0,"label-value",7),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.remarks),l.zb(1),l.Jc(" ",e.data.remarks," ")}}function nc(e,t){if(1&e&&(l.Tb(0,"th",12),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.i18n.ad.number,"")}}function rc(e,t){if(1&e&&(l.Tb(0,"th",14),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.Jc(" ",e.i18n.ad.unitPrice," ")}}function cc(e,t){if(1&e&&(l.Tb(0,"td"),l.Hc(1),l.Sb()),2&e){const e=l.dc().$implicit;l.zb(1),l.Jc("",e.product.productNumber," ")}}function sc(e,t){if(1&e&&(l.Tb(0,"td",19),l.Hc(1),l.ec(2,"currency"),l.Sb()),2&e){const e=l.dc().$implicit,t=l.dc(2);l.zb(1),l.Jc(" ",l.gc(2,1,e.price,t.data.currency),"")}}function oc(e,t){if(1&e){const e=l.Ub();l.Tb(0,"tr",32),l.bc("click",(function(){l.wc(e);const i=t.$implicit,a=l.dc(2);return a.router.navigate(a.path(i))})),l.Fc(1,cc,2,1,"td",33),l.ec(2,"async"),l.Tb(3,"td",34),l.Hc(4),l.Sb(),l.Tb(5,"td"),l.Hc(6),l.Sb(),l.Fc(7,sc,3,4,"td",35),l.ec(8,"async"),l.Tb(9,"td",19),l.Hc(10),l.ec(11,"currency"),l.Sb(),l.Sb()}if(2&e){const e=t.$implicit,i=l.dc(2);l.zb(1),l.kc("ngIf",l.fc(2,5,i.layout.gtxs$)),l.zb(3),l.Ic(e.product.name),l.zb(2),l.Ic(e.quantity),l.zb(1),l.kc("ngIf",l.fc(8,7,i.layout.gtxs$)),l.zb(3),l.Jc(" ",l.gc(11,9,e.totalPrice,i.data.currency)," ")}}function lc(e,t){if(1&e&&(l.Tb(0,"label-value",7),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.minDeliveryTime),l.zb(1),l.Jc(" ",e.format.formatTimeInterval(e.data.minDeliveryTime)," ")}}function dc(e,t){if(1&e&&(l.Tb(0,"label-value",7),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.maxDeliveryTime),l.zb(1),l.Jc(" ",e.format.formatTimeInterval(e.data.maxDeliveryTime)," ")}}function bc(e,t){if(1&e&&(l.Tb(0,"label-value",7),l.Hc(1),l.ec(2,"currency"),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.price),l.zb(1),l.Jc(" ",l.gc(2,2,e.data.deliveryPrice,e.data.currency)," ")}}function uc(e,t){if(1&e&&(l.Tb(0,"label-value",36),l.Ob(1,"address-details",37),l.Sb()),2&e){const e=l.dc(2);l.kc("label",e.i18n.ad.deliveryAddress),l.zb(1),l.kc("address",e.data.deliveryAddress)}}function mc(e,t){if(1&e&&(l.Tb(0,"h2",23),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.Jc("",e.i18n.ad.remarks," ")}}function fc(e,t){if(1&e&&(l.Tb(0,"label",38),l.Hc(1),l.Sb()),2&e){const e=l.dc(2);l.zb(1),l.Ic(e.remarks)}}const hc=function(e){return{"mt-4":e}};function pc(e,t){if(1&e&&(l.Tb(0,"form",39),l.Ob(1,"textarea-field",40),l.Sb()),2&e){const e=l.dc(2);l.kc("ngClass",l.nc(2,hc,e.remarks))("formGroup",e.form)}}function gc(e,t){if(1&e&&(l.Tb(0,"page-content",2),l.ec(1,"async"),l.Fc(2,Zr,2,3,"div",3),l.ec(3,"async"),l.Tb(4,"div",4),l.Fc(5,ec,2,3,"div",5),l.ec(6,"async"),l.Tb(7,"div",6),l.Tb(8,"label-value",7),l.Hc(9),l.Sb(),l.Tb(10,"label-value",7),l.Hc(11),l.ec(12,"dateTime"),l.Sb(),l.Tb(13,"label-value",7),l.Hc(14),l.Sb(),l.Fc(15,tc,2,2,"label-value",8),l.Fc(16,ic,2,2,"label-value",8),l.Fc(17,ac,2,2,"label-value",8),l.Sb(),l.Sb(),l.Tb(18,"h2",9),l.Hc(19),l.Sb(),l.Tb(20,"table",10),l.Tb(21,"thead"),l.Fc(22,nc,2,1,"th",11),l.ec(23,"async"),l.Tb(24,"th",12),l.Hc(25),l.Sb(),l.Tb(26,"th",12),l.Hc(27),l.Sb(),l.Fc(28,rc,2,1,"th",13),l.ec(29,"async"),l.Tb(30,"th",14),l.Hc(31),l.Sb(),l.Sb(),l.Tb(32,"tbody"),l.Fc(33,oc,12,12,"tr",15),l.Tb(34,"tr",16),l.Tb(35,"td",17),l.ec(36,"async"),l.Hc(37),l.Sb(),l.Tb(38,"td",18),l.Hc(39),l.ec(40,"currency"),l.Sb(),l.Sb(),l.Tb(41,"tr",16),l.Tb(42,"td"),l.ec(43,"async"),l.Hc(44),l.Sb(),l.Tb(45,"td",19),l.Hc(46),l.ec(47,"currency"),l.Sb(),l.Sb(),l.Tb(48,"tr",20),l.Tb(49,"td",21),l.ec(50,"async"),l.Hc(51),l.Sb(),l.Tb(52,"td",22),l.Hc(53),l.ec(54,"currency"),l.Sb(),l.Sb(),l.Sb(),l.Sb(),l.Tb(55,"h2",23),l.Hc(56),l.Sb(),l.Fc(57,lc,2,2,"label-value",8),l.Fc(58,dc,2,2,"label-value",8),l.Fc(59,bc,3,5,"label-value",8),l.Fc(60,uc,2,2,"label-value",24),l.Fc(61,mc,2,1,"h2",25),l.Fc(62,fc,2,1,"label",26),l.Fc(63,pc,2,4,"form",27),l.Sb()),2&e){const e=l.dc();l.kc("heading",e.i18n.ad.title.order)("mobileHeading",e.i18n.ad.mobileTitle.order)("headingActions",l.fc(1,38,e.headingActions$)),l.zb(2),l.kc("ngIf",e.data.image&&l.fc(3,40,e.layout.ltsm$)),l.zb(3),l.kc("ngIf",e.data.image&&l.fc(6,42,e.layout.gtxs$)),l.zb(3),l.kc("label",e.i18n.ad.order),l.zb(1),l.Jc(" ",e.data.number," "),l.zb(1),l.kc("label",e.i18n.general.date),l.zb(1),l.Jc(" ",l.fc(12,44,e.data.creationDate)," "),l.zb(2),l.kc("label",e.i18n.general.status),l.zb(1),l.Jc(" ",e.resolveStatusLabel()," "),l.zb(1),l.kc("ngIf",!e.seller),l.zb(1),l.kc("ngIf",!e.buyer),l.zb(1),l.kc("ngIf",e.data.remarks),l.zb(2),l.Jc("",e.i18n.ad.products," "),l.zb(3),l.kc("ngIf",l.fc(23,46,e.layout.gtxs$)),l.zb(3),l.Ic(e.i18n.ad.product),l.zb(2),l.Ic(e.i18n.ad.quantity),l.zb(1),l.kc("ngIf",l.fc(29,48,e.layout.gtxs$)),l.zb(3),l.Jc("",e.i18n.transaction.amount," "),l.zb(2),l.kc("ngForOf",e.data.items),l.zb(2),l.Ab("colspan",l.fc(36,50,e.layout.gtxs$)?4:2),l.zb(2),l.Jc(" ",e.i18n.ad.subtotal,""),l.zb(2),l.Jc(" ",l.gc(40,52,e.subtotal,e.data.currency),""),l.zb(3),l.Ab("colspan",l.fc(43,55,e.layout.gtxs$)?4:2),l.zb(2),l.Jc(" ",e.i18n.ad.deliveryMethod+": "+e.resolveDeliveryLabel()," "),l.zb(2),l.Jc(" ",l.gc(47,57,e.data.deliveryPrice,e.data.currency),""),l.zb(3),l.Ab("colspan",l.fc(50,60,e.layout.gtxs$)?4:2),l.zb(2),l.Jc(" ",e.i18n.ad.total,""),l.zb(2),l.Jc(" ",l.gc(54,62,e.data.totalPrice,e.data.currency),""),l.zb(3),l.Ic(e.i18n.ad.deliveryInformation),l.zb(1),l.kc("ngIf",e.data.minDeliveryTime),l.zb(1),l.kc("ngIf",e.data.maxDeliveryTime),l.zb(1),l.kc("ngIf",e.data.deliveryPrice),l.zb(1),l.kc("ngIf",e.hasAddressFields),l.zb(1),l.kc("ngIf",e.remarks||e.canSetRemarks),l.zb(1),l.kc("ngIf",e.remarks),l.zb(1),l.kc("ngIf",e.canSetRemarks)}}const vc=[{path:"",children:[{path:"search",component:wn},{path:":user/:kind/list",component:Kn},{path:":user/purchases",component:Pn},{path:":user/sales",component:Pn},{path:"sale/:id",component:oa},{path:":user/sale/new",component:oa},{path:":user/:kind/ad/new",component:ci},{path:"view/:id",component:Jr},{path:"edit/:id",component:ci},{path:"order/:id",component:(()=>{class e extends ht.a{constructor(e,t,i,a,n){super(e),this.modal=t,this.marketplaceHelper=i,this.addressHelper=a,this.orderService=n,this.OrderStatusEnum=x.Q}ngOnInit(){super.ngOnInit(),this.id=this.route.snapshot.paramMap.get("id"),this.addSub(this.orderService.viewOrder({order:this.id,fields:["-history"]}).subscribe(e=>this.data=e))}onDataInitialized(e){this.seller=this.authHelper.isSelfOrOwner(e.seller),this.buyer=!this.seller&&this.authHelper.isSelfOrOwner(e.buyer),this.form=this.formBuilder.group({remarks:null});const t=[];(e.canAccept||e.canSetDeliveryInformation)&&t.push(new Ee.c("done",e.canSetDeliveryInformation?this.i18n.ad.setDeliveryMethod:this.i18n.ad.accept,()=>this.accept())),e.canReject&&t.push(new Ee.c("clear",this.i18n.ad.reject,()=>this.reject())),e.history&&t.push(new Ee.c("history",this.i18n.general.viewHistory,()=>this.router.navigate(["/marketplace","order",this.id,"history"]))),this.exportHelper.headingActions(e.exportFormats,t=>this.orderService.exportOrder$Response({format:t.internalName,order:e.id})).forEach(e=>t.push(e)),this.headingActions=t}path(e){return["/marketplace","view",e.product.id]}resolveStatusLabel(){return this.marketplaceHelper.resolveOrderStatusLabel(this.data.status)}resolveDeliveryLabel(){const e=(this.data.deliveryMethod||{}).name;return Object(s.h)(e)?this.i18n.ad.toBeConfirmedBySeller:e}resolveMenu(){return this.buyer?o.b.PURCHASES:this.seller?o.b.SALES:this.authHelper.searchUsersMenu()}orderDeviceConfirmation(e){return()=>({type:e,order:this.id})}orderFields(e){const t=[];return e&&!Object(s.h)(e.paymentTypes)&&e.paymentTypes.length>1&&t.push({internalName:"paymentType",name:this.i18n.transaction.type,type:x.p.SINGLE_SELECTION,control:x.n.RADIO,hasValuesList:!0,defaultValue:e.paymentTypes[0].id,possibleValues:e.paymentTypes.map(e=>({id:e.id,value:e.name})),required:!0}),t.push({internalName:"remarks",name:this.i18n.ad.remarks,type:x.p.TEXT}),t}acceptByBuyer(){this.addSub(this.orderService.getOrderDataForAcceptByBuyer({order:this.id}).subscribe(e=>{this.notification.confirm({title:this.i18n.ad.acceptOrder,labelPosition:"above",customFields:this.orderFields(e),passwordInput:e.confirmationPasswordInput,createDeviceConfirmation:this.orderDeviceConfirmation(x.s.ACCEPT_ORDER),callback:t=>{this.addSub(this.orderService.acceptOrderByBuyer({order:this.id,confirmationPassword:t.confirmationPassword,body:{remarks:t.customValues.remarks,paymentType:t.customValues.paymentType||(Object(s.h)(e.paymentTypes)?null:e.paymentTypes[0].id)}}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderAccepted),this.reload()}))}})}))}acceptBySeller(){this.addSub(this.orderService.acceptOrderBySeller({order:this.id,body:this.form.value}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderAccepted),this.reload()}))}setDeliveryMethod(){const e=this.data.deliveryMethod||{},t=this.modal.show(Yr,{class:"modal-form",initialState:{title:this.i18n.ad.deliveryMethod,name:e.name,chargeAmount:e.price,minTime:e.minTime,maxTime:e.maxTime,currency:this.data.currency}});this.addSub(t.content.done.subscribe(e=>{this.orderService.setDeliveryMethod({order:this.id,body:e}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderAccepted),this.reload()})}))}accept(){this.data.status===x.Q.PENDING_BUYER?this.acceptByBuyer():this.data.status===x.Q.PENDING_SELLER&&(this.data.canSetDeliveryInformation?this.setDeliveryMethod():this.acceptBySeller())}reject(){this.notification.confirm({title:this.i18n.ad.rejectOrder,labelPosition:"above",customFields:this.orderFields(),callback:e=>{this.addSub(this.orderService.rejectOrder({order:this.id,body:{remarks:e.customValues.remarks}}).subscribe(()=>{this.notification.snackBar(this.i18n.ad.orderRejected),this.reload()}))}})}get hasAddressFields(){return this.addressHelper.hasFields(this.data.deliveryAddress)}get subtotal(){let e=0;return this.data.items.forEach(t=>e+=+t.totalPrice),e}get remarks(){return this.data.remarks?this.data.remarks:null}get canSetRemarks(){return this.data.status===x.Q.PENDING_SELLER&&this.seller&&this.data.canAccept}}return e.\u0275fac=function(t){return new(t||e)(l.Nb(l.r),l.Nb(It.b),l.Nb(H.a),l.Nb(F.a),l.Nb(r.x))},e.\u0275cmp=l.Hb({type:e,selectors:[["view-order"]],features:[l.wb],decls:3,vars:4,consts:[[3,"ready"],["mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["mode","viewForm",3,"heading","mobileHeading","headingActions"],["class","d-flex justify-content-center mt-2 mb-4",4,"ngIf"],[1,"d-flex","flex-row-reverse"],["class","image ml-4",4,"ngIf"],[1,"d-flex","flex-grow-1","flex-column"],[3,"label"],[3,"label",4,"ngIf"],[1,"mt-4","mb-2"],[1,"table","table-hover","cursor-pointer","small-height"],["class","no-border",4,"ngIf"],[1,"no-border"],["class","no-border text-right",4,"ngIf"],[1,"no-border","text-right"],[3,"click",4,"ngFor","ngForOf"],[1,"no-hover"],[1,"table-head-color"],[1,"table-head-color","text-right"],[1,"text-right"],[1,"totalAmount","no-hover"],[1,"border-bottom-0","label","label-value-label"],[1,"border-bottom-0","text-right","label-value-value"],[1,"mb-2"],["class","align-items-baseline",3,"label",4,"ngIf"],["class","mb-2",4,"ngIf"],["class","any-label-value",4,"ngIf"],[3,"ngClass","formGroup",4,"ngIf"],[1,"d-flex","justify-content-center","mt-2","mb-4"],["size","140","useLightbox","",3,"roundBorders","zoom","image"],[1,"image","ml-4"],[3,"user"],[3,"click"],[4,"ngIf"],[1,"link"],["class","text-right",4,"ngIf"],[1,"align-items-baseline",3,"label"],[3,"address"],[1,"any-label-value"],[3,"ngClass","formGroup"],["formControlName","remarks"]],template:function(e,t){1&e&&(l.Tb(0,"page-layout",0),l.ec(1,"async"),l.Fc(2,gc,64,65,"page-content",1),l.Sb()),2&e&&(l.kc("ready",l.fc(1,2,t.data$)),l.zb(2),l.kc("ngIf",t.data))},directives:[d.a,b.t,u.a,m.a,b.s,h.a,f.a,Xr.a,n.I,n.w,b.q,n.n,p.a,n.v,n.l],pipes:[b.b,v.a,U.a],encapsulation:2,changeDetection:0}),e})()},{path:"order/:id/history",component:Kr},{path:"shopping-cart",component:Me},{path:"cart/:id",component:Ve},{path:"checkout/:id",component:He},{path:":user/delivery-methods",component:ft},{path:":user/ad-interests",component:Oi},{path:"delivery-methods/view/:id",component:St},{path:"ad-interests/view/:id",component:$i},{path:"delivery-methods/edit/:id",component:at},{path:":user/delivery-methods/new",component:at},{path:":user/ad-interests/new",component:pi},{path:"ad-interests/edit/:id",component:pi},{path:":user/webshop-settings/view",component:cr},{path:":user/webshop-settings/edit",component:er},{path:"unanswered-questions",component:Jn},{path:"unanswered-questions/view/:id",component:w}]}];let yc=(()=>{class e{}return e.\u0275mod=l.Lb({type:e}),e.\u0275inj=l.Kb({factory:function(t){return new(t||e)},imports:[[a.i.forChild(vc)],a.i]}),e})();var kc=i("PCNd");let Sc=(()=>{class e{}return e.\u0275mod=l.Lb({type:e}),e.\u0275inj=l.Kb({factory:function(t){return new(t||e)},imports:[[yc,kc.a]]}),e})()}}]);