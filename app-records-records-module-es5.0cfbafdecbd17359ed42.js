function _createForOfIteratorHelper(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e))){var t=0,i=function(){};return{s:i,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,r,a=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){o=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(o)throw r}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=_superPropBase(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,n=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"1V/X":function(e,t,i){"use strict";i.r(t),i.d(t,"RecordsModule",(function(){return ft}));var n=i("iInd"),r=i("ofEL"),a=i("XDzf"),o=i("Do6i"),l=i("WI1B"),c=i("x6mR"),s=i("ObUu"),u=i("LvDl"),d=i("8Y7J"),f=i("8UBS"),b=i("SVse"),p=i("HQV3"),h=i("s7LF"),v=i("UXR7"),m=i("bqp0"),g=i("AH7H"),y=i("Y+zs");function k(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"user-info",9),d.Ob(2,"hr"),d.Qb()),2&e){var i=d.dc(2);d.zb(1),d.kc("user",i.data.user)}}function S(e,t){1&e&&d.Ob(0,"hr",12)}function F(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"rich-text-container",10),d.Fc(2,S,1,0,"hr",11),d.Qb()),2&e){var i=d.dc(2);d.zb(1),d.kc("value",i.data.type.informationText),d.zb(1),d.kc("ngIf",i.data.fields)}}var T=function(e,t,i){return{"mb-0":e,"mb-2":t,"border-top-0":i}};function I(e,t){if(1&e&&(d.Tb(0,"h2",13),d.Hc(1),d.Sb()),2&e){var i=d.dc(2);d.kc("ngClass",d.pc(2,T,"above"===i.labelPosition,"above"!==i.labelPosition,!i.data.type.informationText)),d.zb(1),d.Jc(" ",i.i18n.record.fields," ")}}function O(e,t){if(1&e&&d.Ob(0,"custom-field-input",14),2&e){var i=t.$implicit,n=d.dc(2);d.Bb(n.resolveColumnClass(i)),d.kc("labelPosition",n.labelPosition)("field",i)("formControl",n.form.get("customValues").get(i.internalName))("binaryValues",n.binaryValues)}}function w(e,t){if(1&e&&d.Ob(0,"custom-field-input",14),2&e){var i=t.$implicit,n=d.dc(3);d.Bb(n.resolveColumnClass(i)),d.kc("labelPosition",n.labelPosition)("field",i)("formControl",n.form.get("customValues").get(i.internalName))("binaryValues",n.binaryValues)}}var z=function(e,t,i,n){return{"mb-0":e,"mb-2":t,"mt-4":i,"border-top-0":n}};function C(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"h2",13),d.Hc(2),d.Sb(),d.Fc(3,w,1,6,"custom-field-input",6),d.Qb()),2&e){var i=t.$implicit,n=t.first,r=d.dc(2);d.zb(1),d.kc("ngClass",d.qc(3,z,"above"===r.labelPosition,"above"!==r.labelPosition,r.fieldsWithoutSection.length>0,n&&0==r.fieldsWithoutSection.length)),d.zb(1),d.Jc(" ",i.name," "),d.zb(1),d.kc("ngForOf",r.fieldsWithSection.get(i))}}var P=function(e){return{"mr-n3":e}};function R(e,t){if(1&e){var i=d.Ub();d.Tb(0,"page-content",2),d.Fc(1,k,3,1,"ng-container",3),d.Tb(2,"form",4),d.Fc(3,F,3,2,"ng-container",3),d.Fc(4,I,2,6,"h2",5),d.Fc(5,O,1,6,"custom-field-input",6),d.Fc(6,C,4,8,"ng-container",7),d.Sb(),d.Tb(7,"actions"),d.Tb(8,"button",8),d.bc("click",(function(){return d.wc(i),d.dc().save()})),d.ec(9,"async"),d.Hc(10),d.Sb(),d.Sb(),d.Sb()}if(2&e){var n=d.dc();d.kc("heading",n.create?n.i18n.record.title.new(n.data.type.name):n.i18n.record.title.edit(n.data.type.name))("mobileHeading",n.create?n.i18n.record.mobileTitle.new(n.data.type.name):n.i18n.record.mobileTitle.edit(n.data.type.name)),d.zb(1),d.kc("ngIf",n.data.user&&!n.authHelper.isSelf(n.data.user)),d.zb(1),d.kc("formGroup",n.form)("ngClass",d.nc(13,P,n.columnLayout)),d.zb(1),d.kc("ngIf",n.data.type.informationText),d.zb(1),d.kc("ngIf",n.fieldsWithoutSection.length>0),d.zb(1),d.kc("ngForOf",n.fieldsWithoutSection),d.zb(1),d.kc("ngForOf",n.fieldsWithSection.keys()),d.zb(2),d.kc("disabled",d.fc(9,11,n.requesting$)),d.zb(2),d.Jc(" ",n.i18n.general.save," ")}}var _,H=((_=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n,r){var a;return _classCallCheck(this,i),(a=t.call(this,e)).recordsService=n,a.recordsHelper=r,a.fieldsWithSection=new Map,a}return _createClass(i,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(i.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.owner,this.type=this.route.snapshot.params.type,this.create=null!=this.param,this.id=this.route.snapshot.paramMap.get("id");var t=this.create?this.recordsService.getRecordDataForNew({owner:this.param,type:this.type}):this.recordsService.getRecordDataForEdit({id:this.id});this.addSub(t.subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.columnLayout=this.recordsHelper.isColumnLayout(e.type),this.fieldsWithoutSection=e.fields.filter((function(e){return null==e.section}))||[],(e.type.sections||[]).forEach((function(i){var n=e.fields.filter((function(e){return null!=e.section&&e.section.id===i.id}));Object(s.h)(n)||t.fieldsWithSection.set(i,n)})),this.form=this.formBuilder.group({}),this.form.setControl("customValues",this.fieldHelper.customValuesFormGroup(e.fields,{currentValues:e.record.customValues,disabledProvider:function(i){return!t.create&&-1===(e.editableFields||[]).indexOf(i.internalName)}}))}},{key:"resolveColumnClass",value:function(e){return this.recordsHelper.resolveColumnClass(e,this.data.type)}},{key:"resolveMenu",value:function(e){return this.recordsHelper.menuForRecordType(e.user,e.type)}},{key:"save",value:function(){var e=this;if(Object(s.F)(this.form),this.form.valid){var t=Object(u.cloneDeep)(this.data.record);t.customValues=this.form.value.customValues;var i=this.create?this.recordsService.createRecord({owner:this.param,type:this.type,body:t}):this.recordsService.updateRecord({id:this.id,body:t});this.addSub(i.subscribe((function(t){e.notification.snackBar(e.create?e.i18n.record.created(e.data.type.name):e.i18n.record.saved(e.data.type.name));var i=null==e.id;if(i&&e.data.type.layout===a.ab.SINGLE){var n,r=_createForOfIteratorHelper(e.recordsHelper.recordPermissions(null==e.data.user));try{for(r.s();!(n=r.n()).done;){var o=n.value;o.type.id===e.data.type.id&&(o.singleRecordId=t)}}catch(l){r.e(l)}finally{r.f()}}e.router.navigate(["/records","view",t||e.id],{replaceUrl:i})})))}}},{key:"binaryValues",get:function(){return this.data.binaryValues}},{key:"labelPosition",get:function(){return this.columnLayout?"above":"auto"}}]),i}(c.a)).\u0275fac=function(e){return new(e||_)(d.Nb(d.r),d.Nb(o.C),d.Nb(l.a))},_.\u0275cmp=d.Hb({type:_,selectors:[["record-form"]],features:[d.wb],decls:3,vars:4,consts:[[3,"ready"],[3,"heading","mobileHeading",4,"ngIf"],[3,"heading","mobileHeading"],[4,"ngIf"],[3,"formGroup","ngClass"],[3,"ngClass",4,"ngIf"],[3,"labelPosition","field","formControl","class","binaryValues",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"disabled","click"],[3,"user"],[3,"value"],["class","border-0",4,"ngIf"],[1,"border-0"],[3,"ngClass"],[3,"labelPosition","field","formControl","binaryValues"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,R,11,15,"page-content",1),d.Sb()),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,b.t,p.a,h.I,h.w,h.n,b.q,b.s,v.a,m.a,g.a,y.a,h.v,h.k],pipes:[b.b],encapsulation:2,changeDetection:0}),_),$=i("tAww"),N=i("rCAV"),D=i("tVPo"),V=i("DIHi"),A=i("JbOn"),x=i("6g1M"),L=i("2KYv"),M=i("n1JJ"),B=i("DAJ4"),E=i("JFlR"),j=i("7HWn"),J=i("4APx"),U=i("chz4"),W=i("uao2"),G=i("fe3a"),q=i("wwxf"),Q=i("5Wk5"),K=i("978R"),Y=i("H4pW"),X=i("/kmK");function Z(e,t){1&e&&d.Ob(0,"div",5)}function ee(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"div",5),d.Tb(2,"label-value",15),d.Ob(3,"user-link",16),d.Sb(),d.Sb(),d.Fc(4,Z,1,0,"div",17),d.Qb()),2&e){var i=d.dc(2);d.zb(2),d.kc("label",i.i18n.general.user),d.zb(1),d.kc("user",i.user),d.zb(1),d.kc("ngIf",i.layout.gtsm$)}}function te(e,t){if(1&e&&d.Ob(0,"field-option",22),2&e){var i=t.$implicit,n=d.dc(4);d.kc("value",n.ApiHelper.internalNameOrId(i))("internalName",i.internalName)("id",i.id)("text",i.name)("parent",i.groupSet)}}function ie(e,t){if(1&e&&(d.Tb(0,"div",5),d.Tb(1,"multi-selection-field",20),d.Fc(2,te,1,5,"field-option",21),d.Sb(),d.Sb()),2&e){var i=d.dc(3);d.zb(1),d.kc("label",i.i18n.user.groups),d.zb(1),d.kc("ngForOf",i.groups)}}var ne=function(){return["broker"]},re=function(e){return{roles:e}};function ae(e,t){if(1&e&&(d.Rb(0),d.Fc(1,ie,3,2,"div",17),d.Tb(2,"div",5),d.Ob(3,"user-field",18),d.Sb(),d.Tb(4,"div",5),d.Ob(5,"user-field",19),d.Sb(),d.Qb()),2&e){var i=d.dc(2);d.zb(1),d.kc("ngIf",i.groups.length>1),d.zb(2),d.kc("label",i.i18n.user.broker)("filters",d.nc(5,re,d.mc(4,ne))),d.zb(2),d.kc("label",i.i18n.general.user)}}function oe(e,t){if(1&e&&(d.Tb(0,"div",5),d.Ob(1,"custom-field-filter",23),d.Sb()),2&e){var i=t.$implicit,n=d.dc(2);d.zb(1),d.kc("field",i)("formControl",n.form.get("customValues").get(i.internalName))}}function le(e,t){if(1&e&&(d.Tb(0,"div",5),d.Ob(1,"basic-profile-field-filter",23),d.Sb()),2&e){var i=t.$implicit,n=d.dc(3);d.zb(1),d.kc("field",i)("formControl",n.form.get("profileFields").get(i.field))}}function ce(e,t){if(1&e&&(d.Tb(0,"div",5),d.Ob(1,"custom-field-filter",23),d.Sb()),2&e){var i=t.$implicit,n=d.dc(3);d.zb(1),d.kc("field",i)("formControl",n.form.get("profileFields").get(i.internalName))}}function se(e,t){if(1&e&&(d.Rb(0),d.Fc(1,le,2,2,"div",11),d.Fc(2,ce,2,2,"div",11),d.Qb()),2&e){var i=d.dc(2);d.zb(1),d.kc("ngForOf",i.basicProfileFields),d.zb(1),d.kc("ngForOf",i.customProfileFields)}}function ue(e,t){if(1&e&&(d.Tb(0,"label-value",25),d.Hc(1),d.Sb()),2&e){var i=d.dc().$implicit,n=d.dc(2);d.kc("label",n.i18n.general.user),d.zb(1),d.Jc(" ",n.recordOwner(i)," ")}}function de(e,t){if(1&e&&(d.Tb(0,"label-value",25),d.Ob(1,"format-field-value",31),d.Sb()),2&e){var i=t.$implicit,n=d.dc().$implicit,r=d.dc(2);d.kc("label",i.name),d.zb(1),d.kc("fields",r.data.customFields)("plainText",!0)("fieldName",i.internalName)("object",n)("customValues",n.customValues)}}function fe(e,t){if(1&e){var i=d.Ub();d.Tb(0,"button",32),d.bc("click",(function(e){d.wc(i);var t=d.dc().$implicit,n=d.dc(2);return n.router.navigate(n.editPath(t)),e.stopPropagation(),e.preventDefault()})),d.Ob(1,"icon",33),d.Sb()}if(2&e){var n=d.dc(3);d.kc("tooltip",n.i18n.general.edit)}}var be=function(e){return{"mt-2":e}};function pe(e,t){if(1&e){var i=d.Ub();d.Tb(0,"button",34),d.bc("click",(function(e){d.wc(i);var t=d.dc().$implicit;return d.dc(2).remove(t),e.stopPropagation(),e.preventDefault()})),d.Ob(1,"icon",35),d.Sb()}if(2&e){var n=d.dc(3);d.kc("tooltip",n.i18n.general.remove)("ngClass",d.nc(2,be,n.data.edit))}}function he(e,t){if(1&e&&(d.Tb(0,"mobile-result"),d.Tb(1,"div",24),d.Tb(2,"div"),d.Tb(3,"label-value",25),d.Hc(4),d.ec(5,"dateTime"),d.Sb(),d.Fc(6,ue,2,2,"label-value",26),d.Fc(7,de,2,6,"label-value",27),d.Sb(),d.Tb(8,"div",28),d.Fc(9,fe,2,1,"button",29),d.Fc(10,pe,2,4,"button",30),d.Sb(),d.Sb(),d.Sb()),2&e){var i=t.$implicit,n=d.dc(2);d.zb(3),d.kc("label",n.i18n.general.creationDate),d.zb(1),d.Jc(" ",d.fc(5,6,i.creationDate)," "),d.zb(2),d.kc("ngIf",n.generalSearch),d.zb(1),d.kc("ngForOf",n.fieldsInList),d.zb(2),d.kc("ngIf",n.data.edit),d.zb(1),d.kc("ngIf",n.data.remove)}}function ve(e,t){if(1&e&&(d.Tb(0,"th"),d.Hc(1),d.Sb()),2&e){var i=d.dc(3);d.zb(1),d.Ic(i.i18n.general.user)}}function me(e,t){if(1&e&&(d.Tb(0,"th"),d.Hc(1),d.Sb()),2&e){var i=t.$implicit,n=d.dc(3);d.zb(1),d.Jc(" ",n.fieldName(i.internalName)," ")}}function ge(e,t){if(1&e&&(d.Tb(0,"td"),d.Hc(1),d.Sb()),2&e){var i=d.dc().$implicit,n=d.dc(3);d.zb(1),d.Ic(n.recordOwner(i))}}function ye(e,t){if(1&e&&(d.Tb(0,"td"),d.Ob(1,"format-field-value",31),d.Sb()),2&e){var i=t.$implicit,n=d.dc().$implicit,r=d.dc(3);d.zb(1),d.kc("fields",r.data.customFields)("plainText",!0)("fieldName",i.internalName)("object",n)("customValues",n.customValues)}}function ke(e,t){if(1&e){var i=d.Ub();d.Tb(0,"button",32),d.bc("click",(function(e){d.wc(i);var t=d.dc().$implicit,n=d.dc(3);return n.router.navigate(n.editPath(t)),e.stopPropagation()})),d.Ob(1,"icon",33),d.Sb()}if(2&e){var n=d.dc(4);d.kc("tooltip",n.i18n.general.edit)}}function Se(e,t){if(1&e){var i=d.Ub();d.Tb(0,"button",34),d.bc("click",(function(e){d.wc(i);var t=d.dc().$implicit;return d.dc(3).remove(t),e.stopPropagation()})),d.Ob(1,"icon",35),d.Sb()}if(2&e){var n=d.dc(4);d.kc("tooltip",n.i18n.general.remove)("ngClass",n.data.edit?"ml-3":"")}}function Fe(e,t){if(1&e){var i=d.Ub();d.Tb(0,"tr",40),d.bc("click",(function(){d.wc(i);var e=t.$implicit,n=d.dc(3);return n.router.navigate(n.viewPath(e))})),d.Tb(1,"td"),d.Hc(2),d.ec(3,"dateTime"),d.Sb(),d.Fc(4,ge,2,1,"td",1),d.Fc(5,ye,2,5,"td",37),d.Tb(6,"td",41),d.Fc(7,ke,2,1,"button",29),d.Fc(8,Se,2,2,"button",30),d.Sb(),d.Sb()}if(2&e){var n=t.$implicit,r=d.dc(3);d.zb(2),d.Ic(d.fc(3,5,n.creationDate)),d.zb(2),d.kc("ngIf",r.generalSearch),d.zb(1),d.kc("ngForOf",r.fieldsInList),d.zb(2),d.kc("ngIf",r.data.edit),d.zb(1),d.kc("ngIf",r.data.remove)}}function Te(e,t){if(1&e&&(d.Tb(0,"table",36),d.Tb(1,"thead"),d.Tb(2,"th"),d.Hc(3),d.Sb(),d.Fc(4,ve,2,1,"th",1),d.Fc(5,me,2,1,"th",37),d.Ob(6,"th",38),d.Sb(),d.Tb(7,"tbody"),d.Fc(8,Fe,9,7,"tr",39),d.ec(9,"async"),d.Sb(),d.Sb()),2&e){var i,n=d.dc(2),r=null==(i=d.fc(9,4,n.results$))?null:i.results;d.zb(3),d.Ic(n.i18n.general.creationDate),d.zb(1),d.kc("ngIf",n.generalSearch),d.zb(1),d.kc("ngForOf",n.fieldsInList),d.zb(3),d.kc("ngForOf",r)}}function Ie(e,t){if(1&e){var i=d.Ub();d.Rb(0),d.Tb(1,"page-content",2),d.ec(2,"async"),d.Tb(3,"form",3),d.Tb(4,"div",4),d.Fc(5,ee,5,3,"ng-container",1),d.Tb(6,"div",5),d.Ob(7,"input-field",6),d.Sb(),d.Fc(8,ae,6,7,"ng-container",1),d.Tb(9,"div",5),d.Ob(10,"user-field",7),d.Sb(),d.Ob(11,"div",8),d.Tb(12,"div",5),d.Ob(13,"date-field",9),d.Sb(),d.Tb(14,"div",5),d.Ob(15,"date-field",10),d.Sb(),d.Fc(16,oe,2,2,"div",11),d.Fc(17,se,3,2,"ng-container",1),d.Sb(),d.Sb(),d.Sb(),d.Tb(18,"results-layout",12),d.bc("update",(function(e){return d.wc(i),d.dc().update(e)})),d.ec(19,"async"),d.Fc(20,he,11,8,"mobile-result",13),d.Fc(21,Te,10,6,"table",14),d.Sb(),d.Qb()}if(2&e){var n=d.dc();d.zb(1),d.kc("heading",n.data.type.pluralName)("mobileHeading",n.data.type.pluralName)("headingActions",d.fc(2,15,n.headingActions$)),d.zb(2),d.kc("formGroup",n.form),d.zb(2),d.kc("ngIf",n.user&&!n.authHelper.isSelf(n.user)),d.zb(2),d.kc("label",n.i18n.general.keywords),d.zb(1),d.kc("ngIf",n.generalSearch),d.zb(2),d.kc("label",n.i18n.record.createdBy),d.zb(3),d.kc("label",n.i18n.general.beginDate),d.zb(2),d.kc("label",n.i18n.general.endDate),d.zb(1),d.kc("ngForOf",n.fieldsInSearch),d.zb(1),d.kc("ngIf",n.generalSearch),d.zb(1),d.kc("results",d.fc(19,17,n.results$))("rendering$",n.rendering$)("toLink",n.toLink)}}var Oe,we=((Oe=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n,r){var a;return _classCallCheck(this,i),(a=t.call(this,e)).recordsService=n,a.recordsHelper=r,a}return _createClass(i,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(i.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.owner,this.type=this.route.snapshot.params.type,this.addSub(this.generalSearch?this.recordsService.getRecordDataForGeneralSearch({type:this.type}).subscribe((function(t){return e.data=t})):this.recordsService.getRecordDataForOwnerSearch({owner:this.param,type:this.type}).subscribe((function(t){return e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;if(!this.generalSearch&&e.type.layout!==a.ab.LIST)throw new Error("Invalid record layout: ".concat(e.type.layout));if(this.fieldsInSearch=e.customFields.filter((function(t){return e.fieldsInSearch.includes(t.internalName)})),this.fieldsInList=e.customFields.filter((function(t){return e.fieldsInList.includes(t.internalName)})),this.form.setControl("customValues",this.fieldHelper.customFieldsForSearchFormGroup(this.fieldsInSearch)),this.generalSearch){var n=e;this.basicProfileFields=n.basicProfileFields,this.customProfileFields=n.customProfileFields,this.groups=n.groups||[],this.form.setControl("profileFields",this.fieldHelper.profileFieldsForSearchFormGroup(this.basicProfileFields,this.customProfileFields))}this.form.patchValue(e.query);var r=[];!this.generalSearch&&e.create&&r.push(new $.c("add",this.i18n.general.addNew,(function(){return t.router.navigate(["/records",t.param,t.type,"new"])}),!0)),this.exportHelper.headingActions(e.exportFormats,(function(e){var i=Object.assign({format:e.internalName},t.toSearchParams(t.form.value));return t.generalSearch?t.recordsService.exportGeneralRecords$Response(i):t.recordsService.exportOwnerRecords$Response(i)})),this.headingActions=r,_get(_getPrototypeOf(i.prototype),"onDataInitialized",this).call(this,e)}},{key:"doSearch",value:function(e){return this.generalSearch?this.recordsService.searchGeneralRecords$Response(e):this.recordsService.searchOwnerRecords$Response(e)}},{key:"remove",value:function(e){var t=this;this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:function(){return t.doRemove(e)}})}},{key:"doRemove",value:function(e){var t=this;this.addSub(this.recordsService.deleteRecord({id:e.id}).subscribe((function(){t.notification.snackBar(t.i18n.general.removeItemDone),t.update()})))}},{key:"recordOwner",value:function(e){return this.generalSearch?e.user.display:""}},{key:"fieldName",value:function(e){return this.fieldHelper.fieldDisplay(e,this.data.customFields)}},{key:"viewPath",value:function(e){return["/records","view",e.id]}},{key:"editPath",value:function(e){return["/records","edit",e.id]}},{key:"toSearchParams",value:function(e){var t=Object.assign({},e);if(t.customFields=this.fieldHelper.toCustomValuesFilter(e.customValues),t.profileFields=this.fieldHelper.toProfileFieldsFilter(e.profileFields),t.creationPeriod=N.a.dateRangeFilter(e.beginDate,e.endDate),this.generalSearch){var i=t;i.brokers=e.broker?[e.broker]:[],delete i.broker}else t.owner=this.param;return t.type=this.type,t}},{key:"getFormControlNames",value:function(){return["keywords","customValues","createdBy","beginDate","endDate","broker","groups","user","profileFields"]}},{key:"resolveMenu",value:function(e){return this.recordsHelper.menuForRecordType(this.generalSearch?null:e.user,e.type)}},{key:"toLink",get:function(){var e=this;return function(t){return e.viewPath(t)}}},{key:"user",get:function(){return this.data?this.data.user:null}},{key:"generalSearch",get:function(){return this.param===l.a.GENERAL_SEARCH}}]),i}(D.a)).\u0275fac=function(e){return new(e||Oe)(d.Nb(d.r),d.Nb(o.C),d.Nb(l.a))},Oe.\u0275cmp=d.Hb({type:Oe,selectors:[["search-records"]],features:[d.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],["mode","filters",3,"heading","mobileHeading","headingActions"],[1,"filters-form","filters-form-separator","border-0",3,"formGroup"],[1,"row"],[1,"col-12","col-md-6"],["labelPosition","side","formControlName","keywords","fieldSize","full",3,"label"],["labelPosition","side","formControlName","createdBy",3,"label"],[1,"w-100"],["labelPosition","side","formControlName","beginDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["labelPosition","side","formControlName","endDate","minDate","past100","maxDate","todayEnd","fieldSize","full",3,"label"],["class","col-12 col-md-6",4,"ngFor","ngForOf"],["resultType","list",3,"results","rendering$","toLink","update"],[4,"mobileResult"],["class","table table-hover cursor-pointer",4,"resultTable"],["labelPosition","side","kind","fieldView",3,"label"],[3,"user"],["class","col-12 col-md-6",4,"ngIf"],["labelPosition","side","formControlName","broker",3,"label","filters"],["labelPosition","side","formControlName","user",3,"label"],["labelPosition","side","hierarchyProperty","groupSet","formControlName","groups",3,"label"],[3,"value","internalName","id","text","parent",4,"ngFor","ngForOf"],[3,"value","internalName","id","text","parent"],["labelPosition","side",3,"field","formControl"],[1,"d-flex"],["labelPosition","above",3,"label"],["labelPosition","above",3,"label",4,"ngIf"],["labelPosition","above",3,"label",4,"ngFor","ngForOf"],[1,"ml-auto","text-right","d-flex","flex-column"],["class","btn btn-icon",3,"tooltip","click",4,"ngIf"],["class","btn btn-icon",3,"tooltip","ngClass","click",4,"ngIf"],[3,"fields","plainText","fieldName","object","customValues"],[1,"btn","btn-icon",3,"tooltip","click"],["icon","edit"],[1,"btn","btn-icon",3,"tooltip","ngClass","click"],["icon","clear"],[1,"table","table-hover","cursor-pointer"],[4,"ngFor","ngForOf"],[1,"actions"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"actions","actions-multiple"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Ie,22,19,"ng-container",1),d.Sb()),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,b.t,p.a,h.I,h.w,h.n,V.a,h.v,h.l,A.a,x.a,b.s,L.a,M.a,B.a,E.a,j.a,J.a,U.a,W.a,h.k,G.a,q.a,Q.a,K.b,Y.a,b.q],pipes:[b.b,X.a],encapsulation:2,changeDetection:0}),Oe),ze=i("2Vo4");function Ce(e,t){if(1&e&&(d.Rb(0),d.Ob(1,"user-info",4),d.Ob(2,"hr"),d.Qb()),2&e){var i=d.dc(2);d.zb(1),d.kc("user",i.data.user)}}function Pe(e,t){1&e&&d.Ob(0,"hr")}function Re(e,t){if(1&e&&(d.Tb(0,"label-value",5),d.Hc(1),d.ec(2,"dateTime"),d.Sb()),2&e){var i=d.dc().$implicit,n=d.dc(2);d.kc("label",n.i18n.record.lastModificationDate),d.zb(1),d.Jc(" ",d.fc(2,2,i.lastModificationDate)," ")}}function _e(e,t){if(1&e&&(d.Tb(0,"label-value",5),d.Hc(1),d.Sb()),2&e){var i=d.dc().$implicit,n=d.dc(2);d.kc("label",n.i18n.record.lastModifiedBy),d.zb(1),d.Jc(" ",i.lastModifiedBy.display," ")}}function He(e,t){if(1&e&&(d.Tb(0,"label-value",5),d.Ob(1,"format-field-value",12),d.Sb()),2&e){var i=t.$implicit,n=d.dc().$implicit,r=d.dc(2);d.kc("label",i.name),d.zb(1),d.kc("fields",r.data.customFields)("plainText",!0)("fieldName",i.internalName)("object",n)("customValues",n.customValues)}}function $e(e,t){if(1&e){var i=d.Ub();d.Tb(0,"button",10),d.bc("click",(function(){d.wc(i);var e=d.dc().$implicit,t=d.dc(2);return t.router.navigate(t.editPath(e))})),d.ec(1,"async"),d.Hc(2),d.Sb()}if(2&e){var n=d.dc(3);d.kc("disabled",d.fc(1,2,n.requesting$)),d.zb(2),d.Ic(n.i18n.general.edit)}}function Ne(e,t){if(1&e){var i=d.Ub();d.Tb(0,"button",13),d.bc("click",(function(){d.wc(i);var e=d.dc().$implicit;return d.dc(2).remove(e)})),d.ec(1,"async"),d.Hc(2),d.Sb()}if(2&e){var n=d.dc(3);d.kc("disabled",d.fc(1,2,n.requesting$)),d.zb(2),d.Ic(n.i18n.general.remove)}}function De(e,t){if(1&e){var i=d.Ub();d.Rb(0),d.Fc(1,Pe,1,0,"hr",1),d.Tb(2,"label-value",5),d.Hc(3),d.ec(4,"dateTime"),d.Sb(),d.Tb(5,"label-value",5),d.Hc(6),d.Sb(),d.Fc(7,Re,3,4,"label-value",6),d.Fc(8,_e,2,2,"label-value",6),d.Fc(9,He,2,6,"label-value",7),d.Tb(10,"actions",8),d.Fc(11,$e,3,4,"button",9),d.Tb(12,"button",10),d.bc("click",(function(){d.wc(i);var e=t.$implicit,n=d.dc(2);return n.router.navigate(n.viewPath(e))})),d.ec(13,"async"),d.Hc(14),d.Sb(),d.Fc(15,Ne,3,4,"button",11),d.Sb(),d.Qb()}if(2&e){var n=t.$implicit,r=t.first,a=d.dc(2);d.zb(1),d.kc("ngIf",!r),d.zb(1),d.kc("label",a.i18n.general.creationDate),d.zb(1),d.Jc(" ",d.fc(4,12,n.creationDate)," "),d.zb(2),d.kc("label",a.i18n.record.createdBy),d.zb(1),d.Jc(" ",n.createdBy.display," "),d.zb(1),d.kc("ngIf",n.lastModifiedBy),d.zb(1),d.kc("ngIf",n.lastModifiedBy),d.zb(1),d.kc("ngForOf",a.fieldsInList),d.zb(2),d.kc("ngIf",a.data.edit),d.zb(1),d.kc("disabled",d.fc(13,14,a.requesting$)),d.zb(2),d.Ic(a.i18n.general.view),d.zb(1),d.kc("ngIf",a.data.remove)}}function Ve(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"page-content",2),d.ec(2,"async"),d.Fc(3,Ce,3,1,"ng-container",1),d.Fc(4,De,16,16,"ng-container",3),d.ec(5,"async"),d.Sb(),d.Qb()),2&e){var i=d.dc();d.zb(1),d.kc("heading",i.data.type.pluralName)("mobileHeading",i.data.type.pluralName)("headingActions",d.fc(2,5,i.headingActions$)),d.zb(2),d.kc("ngIf",i.data.user&&!i.authHelper.isSelf(i.data.user)),d.zb(1),d.kc("ngForOf",d.fc(5,7,i.results$))}}var Ae,xe=((Ae=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n,r){var a;return _classCallCheck(this,i),(a=t.call(this,e)).recordsService=n,a.recordsHelper=r,a.results$=new ze.a(null),a}return _createClass(i,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(i.prototype),"ngOnInit",this).call(this),this.param=this.route.snapshot.params.owner,this.type=this.route.snapshot.params.type,this.addSub(this.recordsService.getRecordDataForOwnerSearch({owner:this.param,type:this.type}).subscribe((function(t){if(t.type.layout!==a.ab.TILED)throw new Error("Invalid record layout: ".concat(t.type.layout));e.fieldsInList=t.customFields.filter((function(e){return t.fieldsInList.includes(e.internalName)})),e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this,i=[];e.create&&i.push(new $.c("add",this.i18n.general.addNew,(function(){return t.router.navigate(["/records",t.param,t.type,"new"])}),!0)),this.headingActions=i,this.addSub(this.doSearch(this.toSearchParams()).subscribe((function(e){t.results$.next(e.body)})))}},{key:"editPath",value:function(e){return["/records","edit",e.id]}},{key:"viewPath",value:function(e){return["/records","view",e.id]}},{key:"remove",value:function(e){var t=this;this.notification.confirm({message:this.i18n.general.removeItemConfirm,callback:function(){return t.doRemove(e)}})}},{key:"doRemove",value:function(e){var t=this;this.addSub(this.recordsService.deleteRecord({id:e.id}).subscribe((function(){t.notification.snackBar(t.i18n.general.removeItemDone),t.reload()})))}},{key:"toSearchParams",value:function(){return{pageSize:2147483647,owner:this.param,type:this.type}}},{key:"doSearch",value:function(e){return this.recordsService.searchOwnerRecords$Response(e)}},{key:"getFormControlNames",value:function(){return[]}},{key:"resolveMenu",value:function(e){return this.recordsHelper.menuForRecordType(e.user,e.type)}}]),i}(c.a)).\u0275fac=function(e){return new(e||Ae)(d.Nb(d.r),d.Nb(o.C),d.Nb(l.a))},Ae.\u0275cmp=d.Hb({type:Ae,selectors:[["tiled-records"]],features:[d.wb],decls:3,vars:4,consts:[[3,"ready"],[4,"ngIf"],[3,"heading","mobileHeading","headingActions"],[4,"ngFor","ngForOf"],[3,"user"],[3,"label"],[3,"label",4,"ngIf"],[3,"label",4,"ngFor","ngForOf"],[1,"mb-3"],["class","btn btn-primary",3,"disabled","click",4,"ngIf"],[1,"btn","btn-primary",3,"disabled","click"],["class","btn btn-outline-primary",3,"disabled","click",4,"ngIf"],[3,"fields","plainText","fieldName","object","customValues"],[1,"btn","btn-outline-primary",3,"disabled","click"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,Ve,6,9,"ng-container",1),d.Sb()),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,b.t,p.a,b.s,m.a,E.a,v.a,Q.a],pipes:[b.b,X.a],encapsulation:2,changeDetection:0}),Ae),Le=i("aLb1"),Me=i("MhyI"),Be=i("nznZ");function Ee(e,t){if(1&e&&(d.Tb(0,"label-value",9),d.Ob(1,"user-link",10),d.Sb()),2&e){var i=d.dc(2);d.Bb(i.resolveColumnClass()),d.kc("labelPosition",i.labelPosition)("label",i.i18n.general.user),d.zb(1),d.kc("user",i.data.user)}}function je(e,t){if(1&e&&(d.Tb(0,"label-value",9),d.Hc(1),d.ec(2,"dateTime"),d.Sb()),2&e){var i=d.dc(2);d.Bb(i.resolveColumnClass()),d.kc("labelPosition",i.labelPosition)("label",i.i18n.general.creationDate),d.zb(1),d.Jc(" ",d.fc(2,5,i.data.creationDate)," ")}}function Je(e,t){if(1&e&&(d.Tb(0,"label-value",9),d.Hc(1),d.Sb()),2&e){var i=d.dc(2);d.Bb(i.resolveColumnClass()),d.kc("labelPosition",i.labelPosition)("label",i.i18n.record.createdBy),d.zb(1),d.Jc(" ",i.data.createdBy.display," ")}}function Ue(e,t){if(1&e&&(d.Tb(0,"label-value",9),d.Hc(1),d.ec(2,"dateTime"),d.Sb()),2&e){var i=d.dc(2);d.Bb(i.resolveColumnClass()),d.kc("labelPosition",i.labelPosition)("label",i.i18n.record.lastModificationDate),d.zb(1),d.Jc(" ",d.fc(2,5,i.data.lastModificationDate)," ")}}function We(e,t){if(1&e&&(d.Tb(0,"label-value",9),d.Hc(1),d.Sb()),2&e){var i=d.dc(2);d.Bb(i.resolveColumnClass()),d.kc("labelPosition",i.labelPosition)("label",i.i18n.record.lastModifiedBy),d.zb(1),d.Jc(" ",i.data.lastModifiedBy.display," ")}}function Ge(e,t){1&e&&d.Ob(0,"hr")}function qe(e,t){1&e&&d.Ob(0,"hr")}function Qe(e,t){if(1&e&&(d.Rb(0),d.Fc(1,Ge,1,0,"hr",5),d.Ob(2,"rich-text-container",11),d.Fc(3,qe,1,0,"hr",5),d.Qb()),2&e){var i=d.dc(2);d.zb(1),d.kc("ngIf",i.hasPreviousFields),d.zb(1),d.kc("value",i.data.type.informationText),d.zb(1),d.kc("ngIf",i.data.customValues)}}var Ke=function(e,t,i){return{"mt-2 pt-0 border-0":e,"mb-0":t,"mb-2":i}};function Ye(e,t){if(1&e&&(d.Tb(0,"h2",3),d.Hc(1),d.Sb()),2&e){var i=d.dc(2);d.kc("ngClass",d.pc(2,Ke,i.data.type.informationText,"above"===i.labelPosition,"above"!==i.labelPosition)),d.zb(1),d.Jc(" ",i.i18n.record.fields," ")}}var Xe=function(e){return{"mt-0":e}};function Ze(e,t){if(1&e&&d.Ob(0,"custom-field-value",12),2&e){var i=t.$implicit,n=d.dc(2);d.Bb(n.resolveColumnClass(i)),d.kc("labelPosition",n.labelPosition)("fieldValue",i)("ngClass",d.nc(5,Xe,!(n.hasPreviousFields&&n.valuesWithoutSection.length>0)))}}function et(e,t){if(1&e&&d.Ob(0,"custom-field-value",14),2&e){var i=t.$implicit,n=d.dc(3);d.Bb(n.resolveColumnClass(i)),d.kc("labelPosition",n.labelPosition)("fieldValue",i)}}var tt=function(e,t,i,n){return{"mt-4":e,"mb-0":t,"mb-2":i,"border-top-0":n}};function it(e,t){if(1&e&&(d.Rb(0),d.Tb(1,"h2",3),d.Hc(2),d.Sb(),d.Fc(3,et,1,4,"custom-field-value",13),d.Qb()),2&e){var i=t.$implicit,n=t.first,r=d.dc(2);d.zb(1),d.kc("ngClass",d.qc(3,tt,r.valuesWithoutSection.length>0,"above"===r.labelPosition,"above"!==r.labelPosition,n&&0==r.valuesWithoutSection.length&&(!r.hasPreviousFields||r.data.type.informationText))),d.zb(1),d.Jc(" ",i.name," "),d.zb(1),d.kc("ngForOf",r.valuesWithSection.get(i))}}var nt=function(e,t){return{"d-flex flex-row-reverse":e,"mt-n3":t}},rt=function(e,t){return{"d-flex flex-grow-1 flex-column":e,"mr-n3":t}};function at(e,t){if(1&e&&(d.Tb(0,"page-content",2),d.ec(1,"async"),d.Tb(2,"div",3),d.Tb(3,"div",3),d.Fc(4,Ee,2,5,"label-value",4),d.Fc(5,je,3,7,"label-value",4),d.Fc(6,Je,2,5,"label-value",4),d.Fc(7,Ue,3,7,"label-value",4),d.Fc(8,We,2,5,"label-value",4),d.Fc(9,Qe,4,3,"ng-container",5),d.Fc(10,Ye,2,6,"h2",6),d.Fc(11,Ze,1,7,"custom-field-value",7),d.Fc(12,it,4,8,"ng-container",8),d.Sb(),d.Sb(),d.Sb()),2&e){var i=d.dc();d.kc("heading",i.i18n.record.title.details(i.title))("mobileHeading",i.i18n.record.mobileTitle.details(i.title))("headingActions",d.fc(1,14,i.headingActions$)),d.zb(2),d.kc("ngClass",d.oc(16,nt,!i.columnLayout,i.hasPreviousFields&&i.columnLayout)),d.zb(1),d.kc("ngClass",d.oc(19,rt,!i.columnLayout,i.columnLayout)),d.zb(1),d.kc("ngIf",!i.isOwner()),d.zb(1),d.kc("ngIf",i.data.creationDate),d.zb(1),d.kc("ngIf",i.data.createdBy),d.zb(1),d.kc("ngIf",i.data.lastModificationDate),d.zb(1),d.kc("ngIf",i.data.lastModifiedBy),d.zb(1),d.kc("ngIf",i.data.type.informationText),d.zb(1),d.kc("ngIf",i.hasPreviousFields&&i.valuesWithoutSection.length>0),d.zb(1),d.kc("ngForOf",i.valuesWithoutSection),d.zb(1),d.kc("ngForOf",i.valuesWithSection.keys())}}var ot,lt,ct,st=[{path:":owner/:type/list",component:we,canActivate:[r.a]},{path:":owner/:type/tiled",component:xe,canActivate:[r.a]},{path:"view/:id",component:(ot=function(e){_inherits(i,e);var t=_createSuper(i);function i(e,n,r,a){var o;return _classCallCheck(this,i),(o=t.call(this,e)).recordsService=n,o.recordsHelper=r,o.operationHelper=a,o.valuesWithSection=new Map,o}return _createClass(i,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(i.prototype),"ngOnInit",this).call(this);var t=this.route.snapshot.paramMap.get("id");this.addSub(this.recordsService.viewRecord({id:t}).subscribe((function(t){e.data=t})))}},{key:"onDataInitialized",value:function(e){var t=this;this.headingActions=[],this.title=Object(s.h)(e.display)?e.type.name:e.display,this.columnLayout=this.recordsHelper.isColumnLayout(e.type);var i=e.customValues||[];this.valuesWithoutSection=i.filter((function(e){return null==e.field.section}))||[],(e.type.sections||[]).forEach((function(e){var n=i.filter((function(t){return null!=t.field.section&&t.field.section.id===e.id}));n&&t.valuesWithSection.set(e,n)})),e.canEdit&&this.headingActions.push(new $.c("edit",this.i18n.general.edit,(function(){t.router.navigate(["/records","edit",e.id])}),!0));var n,r=_createForOfIteratorHelper(e.operations||[]);try{for(r.s();!(n=r.n()).done;){var a=n.value;this.headingActions.push(this.operationHelper.headingAction(a,e.id))}}catch(o){r.e(o)}finally{r.f()}}},{key:"resolveColumnClass",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.recordsHelper.resolveColumnClass(null==e?null:e.field,this.data.type)}},{key:"isOwner",value:function(){return this.authHelper.isSelf(this.data.user)}},{key:"resolveMenu",value:function(e){return this.recordsHelper.menuForRecordType(e.user,e.type)}},{key:"labelPosition",get:function(){return this.columnLayout?"above":"auto"}},{key:"hasPreviousFields",get:function(){return this.data.createdBy||this.data.lastModifiedBy}}]),i}(Me.a),ot.\u0275fac=function(e){return new(e||ot)(d.Nb(d.r),d.Nb(o.C),d.Nb(l.a),d.Nb(Le.a))},ot.\u0275cmp=d.Hb({type:ot,selectors:[["view-record"]],features:[d.wb],decls:3,vars:4,consts:[[3,"ready"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions",4,"ngIf"],["last","","mode","viewForm",3,"heading","mobileHeading","headingActions"],[3,"ngClass"],[3,"labelPosition","class","label",4,"ngIf"],[4,"ngIf"],[3,"ngClass",4,"ngIf"],[3,"labelPosition","fieldValue","class","ngClass",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"labelPosition","label"],[3,"user"],[3,"value"],[3,"labelPosition","fieldValue","ngClass"],[3,"labelPosition","fieldValue","class",4,"ngFor","ngForOf"],[3,"labelPosition","fieldValue"]],template:function(e,t){1&e&&(d.Tb(0,"page-layout",0),d.ec(1,"async"),d.Fc(2,at,13,22,"page-content",1),d.Sb()),2&e&&(d.kc("ready",d.fc(1,2,t.data$)),d.zb(2),d.kc("ngIf",t.data))},directives:[f.a,b.t,p.a,b.q,b.s,E.a,j.a,g.a,Be.a],pipes:[b.b,X.a],encapsulation:2,changeDetection:0}),ot),canActivate:[r.a]},{path:":owner/:type/new",component:H,canActivate:[r.a]},{path:"edit/:id",component:H,canActivate:[r.a]}],ut=((lt=function e(){_classCallCheck(this,e)}).\u0275mod=d.Lb({type:lt}),lt.\u0275inj=d.Kb({factory:function(e){return new(e||lt)},imports:[[n.i.forChild(st)],n.i]}),lt),dt=i("PCNd"),ft=((ct=function e(){_classCallCheck(this,e)}).\u0275mod=d.Lb({type:ct}),ct.\u0275inj=d.Kb({factory:function(e){return new(e||ct)},imports:[[ut,dt.a]]}),ct)},tVPo:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i("s7LF"),r=i("mwYl"),a=i("tAww"),o=i("rCAV"),l=i("x6mR"),c=i("Ky6R"),s=i("75v4"),u=i("LvDl"),d=i("2Vo4"),f=i("Kj3r"),b=i("8Y7J"),p=function(){var e=function(e){_inherits(i,e);var t=_createSuper(i);function i(e){var a;_classCallCheck(this,i),(a=t.call(this,e)).ResultType=s.a,a.resultType$=new d.a(null),a.resultTypeControl=new n.j(null),a.results$=new d.a(null),a.allowedResultTypes$=new d.a([s.a.LIST]),a.rendering$=new d.a(!1),a.moreFilters$=new d.a(!1),a.ignoreNextUpdate=!1,a.nextRequestState=e.get(r.a);var o={page:0};o.resultType=a.getInitialResultType();var l,c=_createForOfIteratorHelper(a.getFormControlNames()||[]);try{for(c.s();!(l=c.n()).done;){o[l.value]=null}}catch(u){c.e(u)}finally{c.f()}return a.form=a.formBuilder.group(o),a}return _createClass(i,[{key:"getInitialFormValue",value:function(e){return e.query||{}}},{key:"onDataInitialized",value:function(e){var t=this;this.form.patchValue(this.getInitialFormValue(e)),this.stateManager.manage(this.form),this.stateManager.manage(this.resultTypeControl,"resultType"),this.stateManager.manageValue(this.moreFilters$,"moreFilters"),this.previousValue=this.form.value,this.previousResultType=this.resultType,this.resultType$.next(this.previousResultType),this.addSub(this.resultTypeControl.valueChanges.subscribe((function(e){var i=t.previousResultType;t.previousResultType=e,t.resultType$.next(e),t.shouldUpdateOnResultTypeChange(e,i)&&t.update(),null!=i&&i===e||(t.rendering=!0,t.stateManager.set("resultType",e),t.onResultTypeChanged(e,i))}))),setTimeout((function(){t.addSub(t.form.valueChanges.pipe(Object(f.a)(o.a.DEBOUNCE_TIME)).subscribe((function(e){t.shouldUpdateOnChange(e)&&t.update(),t.previousValue=e})),!0),t.previousResultType!==s.a.CATEGORIES&&t.update()}),1)}},{key:"shouldUpdateOnResultTypeChange",value:function(e,t){return e!==s.a.CATEGORIES&&([s.a.LIST,s.a.TILES].includes(t)!==[s.a.LIST,s.a.TILES].includes(e)||t===s.a.MAP!=(e===s.a.MAP))}},{key:"shouldUpdateOnChange",value:function(e){return!Object(u.isEqual)(this.previousValue,e)}},{key:"ngOnInit",value:function(){_get(_getPrototypeOf(i.prototype),"ngOnInit",this).call(this),this.resultType=this.getInitialResultType()}},{key:"showMoreFiltersLabel",value:function(){return this.i18n.general.showMoreFilters}},{key:"showLessFiltersLabel",value:function(){return this.i18n.general.showLessFilters}},{key:"showMoreFiltersIcon",value:function(){return"filter_list"}},{key:"showLessFiltersIcon",value:function(){return"filter_list"}},{key:"onResultTypeChanged",value:function(e,t){}},{key:"getInitialResultType",value:function(){return s.a.LIST}},{key:"update",value:function(e){var t=this;if(!this.ignoreNextUpdate){e&&(this.form.patchValue(e,{emitEvent:!1}),this.stateManager.set("form",this.form.value)),this.rendering=!0,this.results=null,this.nextRequestState.leaveNotification=!0;var i=this.form.value;i.pageSize=this.layout.searchPageSize,this.addSub(this.doSearch(this.toSearchParams(i)).subscribe((function(e){t.resultType===s.a.CATEGORIES&&(t.resultType=t.allowedResultTypes.find((function(e){return e!==s.a.CATEGORIES}))),t.results=c.a.from(e)})))}}},{key:"resetPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.form.patchValue({page:0},{emitEvent:e})}},{key:"doIgnoringUpdate",value:function(e){this.ignoreNextUpdate=!0;try{e()}finally{this.ignoreNextUpdate=!1}}},{key:"results",get:function(){return this.results$.value},set:function(e){this.results$.next(e)}},{key:"rendering",get:function(){return this.rendering$.value},set:function(e){this.rendering$.next(e)}},{key:"allowedResultTypes",get:function(){return this.allowedResultTypes$.value},set:function(e){this.allowedResultTypes$.next(e)}},{key:"moreFilters",get:function(){return this.moreFilters$.value},set:function(e){this.moreFilters$.next(e)}},{key:"pageData",get:function(){var e=this.form.value;return{page:e.page,pageSize:e.pageSize}},set:function(e){this.form.patchValue(e)}},{key:"resultType",get:function(){return this.resultTypeControl.value},set:function(e){null==e&&(e=this.getInitialResultType()),this.resultTypeControl.setValue(e)}},{key:"moreFiltersAction",get:function(){var e=this;return this._moreFiltersAction||(this._moreFiltersAction=new a.c(this.showMoreFiltersIcon(),this.showMoreFiltersLabel(),(function(){e.moreFilters=!e.moreFilters,e._moreFiltersAction.icon=e.moreFilters?e.showLessFiltersIcon():e.showMoreFiltersIcon(),e._moreFiltersAction.label=e.moreFilters?e.showLessFiltersLabel():e.showMoreFiltersLabel()}),!0),this._moreFiltersAction.breakpoint="gt-xxs",this._moreFiltersAction.maybeRoot=!0),this._moreFiltersAction}}]),i}(l.a);return e.\u0275fac=function(t){return new(t||e)(b.Nb(b.r))},e.\u0275dir=b.Ib({type:e,features:[b.wb]}),e}()}}]);